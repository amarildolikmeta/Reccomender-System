{"version":"NotebookV1","origId":440968250896212,"name":"Content","language":"python","commands":[{"version":"CommandV1","origId":440968250896214,"guid":"86c426ff-d5a5-467f-a2b5-39e4d21e99d4","subtype":"command","commandType":"auto","position":1.0,"command":"import numpy as np\nimport pandas as pd \nfrom math import sqrt \n","commandVersion":0,"state":"finished","results":{"type":"html","data":"<div class=\"ansiout\"></div>","arguments":{},"addedWidgets":{},"removedWidgets":[],"datasetInfos":[]},"errorSummary":null,"error":null,"workflows":[],"startTime":1499161237349,"submitTime":1499161098484,"finishTime":1499161237499,"collapsed":false,"bindings":{},"inputWidgets":{},"displayType":"table","width":"auto","height":"auto","xColumns":null,"yColumns":null,"pivotColumns":null,"pivotAggregation":null,"customPlotOptions":{},"commentThread":[],"commentsVisible":false,"parentHierarchy":[],"diffInserts":[],"diffDeletes":[],"globalVars":{},"latestUser":"amarildolikmeta@gmail.com","latestUserId":null,"commandTitle":"","showCommandTitle":false,"hideCommandCode":false,"hideCommandResult":false,"iPythonMetadata":null,"streamStates":{},"datasetPreviewNameToCmdIdMap":{},"nuid":"45ac0adc-3a08-4e6d-b61a-f070e2dba534"},{"version":"CommandV1","origId":440968250896215,"guid":"667a0f19-3c28-4668-a228-3eda90698b74","subtype":"command","commandType":"auto","position":2.0,"command":"numberOfItemsToRecommend=5","commandVersion":0,"state":"finished","results":{"type":"html","data":"<div class=\"ansiout\"></div>","arguments":{},"addedWidgets":{},"removedWidgets":[],"datasetInfos":[]},"errorSummary":null,"error":null,"workflows":[],"startTime":1499161237660,"submitTime":1499161098485,"finishTime":1499161237736,"collapsed":false,"bindings":{},"inputWidgets":{},"displayType":"table","width":"auto","height":"auto","xColumns":null,"yColumns":null,"pivotColumns":null,"pivotAggregation":null,"customPlotOptions":{},"commentThread":[],"commentsVisible":false,"parentHierarchy":[],"diffInserts":[],"diffDeletes":[],"globalVars":{},"latestUser":"amarildolikmeta@gmail.com","latestUserId":null,"commandTitle":"","showCommandTitle":false,"hideCommandCode":false,"hideCommandResult":false,"iPythonMetadata":null,"streamStates":{},"datasetPreviewNameToCmdIdMap":{},"nuid":"bcda6ad8-787c-495b-b587-144b88049ce0"},{"version":"CommandV1","origId":440968250896216,"guid":"775276c8-2a44-4dbc-b556-030a8eedce54","subtype":"command","commandType":"auto","position":3.0,"command":"train=sqlContext.sql(\"SELECT * from train\")\ntrainRDD=train.rdd","commandVersion":0,"state":"finished","results":{"type":"html","data":"<div class=\"ansiout\"></div>","arguments":{},"addedWidgets":{},"removedWidgets":[],"datasetInfos":[]},"errorSummary":null,"error":null,"workflows":[],"startTime":1499161237744,"submitTime":1499161098489,"finishTime":1499161240870,"collapsed":false,"bindings":{},"inputWidgets":{},"displayType":"table","width":"auto","height":"auto","xColumns":null,"yColumns":null,"pivotColumns":null,"pivotAggregation":null,"customPlotOptions":{},"commentThread":[],"commentsVisible":false,"parentHierarchy":[],"diffInserts":[],"diffDeletes":[],"globalVars":{},"latestUser":"amarildolikmeta@gmail.com","latestUserId":null,"commandTitle":"","showCommandTitle":false,"hideCommandCode":false,"hideCommandResult":false,"iPythonMetadata":null,"streamStates":{},"datasetPreviewNameToCmdIdMap":{},"nuid":"48170dbe-3562-4157-91f4-78ebf0cceb9e"},{"version":"CommandV1","origId":440968250896217,"guid":"82ae14c8-61a7-4a48-848c-5df7bd3d8f3b","subtype":"command","commandType":"auto","position":4.0,"command":"userSeenItems = trainRDD.map(lambda x: (x[0], [x[1]])).reduceByKey(lambda x,y : x+y)\nuserSeenItems_dict = userSeenItems.collectAsMap()","commandVersion":0,"state":"finished","results":{"type":"html","data":"<div class=\"ansiout\"></div>","arguments":{},"addedWidgets":{},"removedWidgets":[],"datasetInfos":[]},"errorSummary":null,"error":null,"workflows":[],"startTime":1499161240882,"submitTime":1499161098495,"finishTime":1499161243812,"collapsed":false,"bindings":{},"inputWidgets":{},"displayType":"table","width":"auto","height":"auto","xColumns":null,"yColumns":null,"pivotColumns":null,"pivotAggregation":null,"customPlotOptions":{},"commentThread":[],"commentsVisible":false,"parentHierarchy":[],"diffInserts":[],"diffDeletes":[],"globalVars":{},"latestUser":"amarildolikmeta@gmail.com","latestUserId":null,"commandTitle":"","showCommandTitle":false,"hideCommandCode":false,"hideCommandResult":false,"iPythonMetadata":null,"streamStates":{},"datasetPreviewNameToCmdIdMap":{},"nuid":"9307ae00-c630-4ae9-9f0c-13bfad709bf3"},{"version":"CommandV1","origId":440968250896218,"guid":"e8b30ac8-3201-4b99-b08d-b664303c5207","subtype":"command","commandType":"auto","position":5.0,"command":"ratings=sqlContext.sql(\"Select itemId ,sum(rating)/(count(rating)+8) as AvgRating from train group by itemId order by AvgRating desc\").rdd\nAvgItemratings_dict=ratings.map(lambda x:(x[0],float(x[1]))).collectAsMap()","commandVersion":0,"state":"finished","results":{"type":"html","data":"<div class=\"ansiout\"></div>","arguments":{},"addedWidgets":{},"removedWidgets":[],"datasetInfos":[]},"errorSummary":null,"error":null,"workflows":[],"startTime":1499161243822,"submitTime":1499161098499,"finishTime":1499161259304,"collapsed":false,"bindings":{},"inputWidgets":{},"displayType":"table","width":"auto","height":"auto","xColumns":null,"yColumns":null,"pivotColumns":null,"pivotAggregation":null,"customPlotOptions":{},"commentThread":[],"commentsVisible":false,"parentHierarchy":[],"diffInserts":[],"diffDeletes":[],"globalVars":{},"latestUser":"amarildolikmeta@gmail.com","latestUserId":null,"commandTitle":"","showCommandTitle":false,"hideCommandCode":false,"hideCommandResult":false,"iPythonMetadata":null,"streamStates":{},"datasetPreviewNameToCmdIdMap":{},"nuid":"f0332d36-7182-46ab-bf4c-6775d692dfde"},{"version":"CommandV1","origId":440968250896219,"guid":"d71c200b-9dd0-47f4-8e99-8718ff3d6e67","subtype":"command","commandType":"auto","position":6.0,"command":"ratings=ratings.map(lambda x:str(x[0])).collect()\nratings=np.array(ratings)","commandVersion":0,"state":"finished","results":{"type":"html","data":"<div class=\"ansiout\"></div>","arguments":{},"addedWidgets":{},"removedWidgets":[],"datasetInfos":[]},"errorSummary":null,"error":null,"workflows":[],"startTime":1499161259312,"submitTime":1499161098505,"finishTime":1499161261431,"collapsed":false,"bindings":{},"inputWidgets":{},"displayType":"table","width":"auto","height":"auto","xColumns":null,"yColumns":null,"pivotColumns":null,"pivotAggregation":null,"customPlotOptions":{},"commentThread":[],"commentsVisible":false,"parentHierarchy":[],"diffInserts":[],"diffDeletes":[],"globalVars":{},"latestUser":"amarildolikmeta@gmail.com","latestUserId":null,"commandTitle":"","showCommandTitle":false,"hideCommandCode":false,"hideCommandResult":false,"iPythonMetadata":null,"streamStates":{},"datasetPreviewNameToCmdIdMap":{},"nuid":"ed528f93-daf6-472a-98a2-ebee6814d5ec"},{"version":"CommandV1","origId":440968250896220,"guid":"c534c2b6-855d-45b7-ab6a-376a6cb9ce1a","subtype":"command","commandType":"auto","position":7.0,"command":"avgGlobalRating=str(sqlContext.sql(\"Select avg(rating) from train\").rdd.collect()[0][0])\navgGloabalRating=float(avgGlobalRating) ","commandVersion":0,"state":"finished","results":{"type":"html","data":"<div class=\"ansiout\"></div>","arguments":{},"addedWidgets":{},"removedWidgets":[],"datasetInfos":[]},"errorSummary":null,"error":null,"workflows":[],"startTime":1499161261439,"submitTime":1499161098510,"finishTime":1499161262651,"collapsed":false,"bindings":{},"inputWidgets":{},"displayType":"table","width":"auto","height":"auto","xColumns":null,"yColumns":null,"pivotColumns":null,"pivotAggregation":null,"customPlotOptions":{},"commentThread":[],"commentsVisible":false,"parentHierarchy":[],"diffInserts":[],"diffDeletes":[],"globalVars":{},"latestUser":"amarildolikmeta@gmail.com","latestUserId":null,"commandTitle":"","showCommandTitle":false,"hideCommandCode":false,"hideCommandResult":false,"iPythonMetadata":null,"streamStates":{},"datasetPreviewNameToCmdIdMap":{},"nuid":"5d1c35e5-82de-439c-b1cf-5f910c6dcf07"},{"version":"CommandV1","origId":440968250896221,"guid":"18eb42f3-b1bd-4234-a45f-97e87e07edaf","subtype":"command","commandType":"auto","position":8.0,"command":"userRatings=trainRDD.map(lambda x:(x[0],[(x[1],int(x[2]))])).reduceByKey(lambda x,y:x+y)\nuserRatings_dict=userRatings.collectAsMap()\nfor key in userRatings_dict:\n  userRatings_dict[key]=dict(userRatings_dict[key])\nuserRatings_dict[\"4446\"][\"14644\"]","commandVersion":0,"state":"finished","results":{"type":"html","data":"<div class=\"ansiout\"><span class=\"ansired\">Out[</span><span class=\"ansired\">8</span><span class=\"ansired\">]: </span>10\n</div>","arguments":{},"addedWidgets":{},"removedWidgets":[],"datasetInfos":[]},"errorSummary":null,"error":null,"workflows":[],"startTime":1499161262658,"submitTime":1499161098515,"finishTime":1499161264698,"collapsed":false,"bindings":{},"inputWidgets":{},"displayType":"table","width":"auto","height":"auto","xColumns":null,"yColumns":null,"pivotColumns":null,"pivotAggregation":null,"customPlotOptions":{},"commentThread":[],"commentsVisible":false,"parentHierarchy":[],"diffInserts":[],"diffDeletes":[],"globalVars":{},"latestUser":"amarildolikmeta@gmail.com","latestUserId":null,"commandTitle":"","showCommandTitle":false,"hideCommandCode":false,"hideCommandResult":false,"iPythonMetadata":null,"streamStates":{},"datasetPreviewNameToCmdIdMap":{},"nuid":"bb7aa7e5-3252-46a7-8832-f334bd70919c"},{"version":"CommandV1","origId":440968250896222,"guid":"9e50fcbf-c6b3-4117-bb7e-a4f9bbc2c427","subtype":"command","commandType":"auto","position":9.0,"command":"itemRaters=sqlContext.sql(\"Select itemId, userId from train\").rdd.map(lambda x:(x[0],[x[1]])).reduceByKey(lambda x,y:x+y)\nitemRaters_dict=itemRaters.collectAsMap()\nitemRaters_dict[\"15\"]","commandVersion":0,"state":"finished","results":{"type":"html","data":"<div class=\"ansiout\"><span class=\"ansired\">Out[</span><span class=\"ansired\">9</span><span class=\"ansired\">]: </span>[u&apos;3418&apos;, u&apos;4672&apos;, u&apos;9052&apos;, u&apos;9520&apos;]\n</div>","arguments":{},"addedWidgets":{},"removedWidgets":[],"datasetInfos":[]},"errorSummary":null,"error":null,"workflows":[],"startTime":1499161264706,"submitTime":1499161098519,"finishTime":1499161266427,"collapsed":false,"bindings":{},"inputWidgets":{},"displayType":"table","width":"auto","height":"auto","xColumns":null,"yColumns":null,"pivotColumns":null,"pivotAggregation":null,"customPlotOptions":{},"commentThread":[],"commentsVisible":false,"parentHierarchy":[],"diffInserts":[],"diffDeletes":[],"globalVars":{},"latestUser":"amarildolikmeta@gmail.com","latestUserId":null,"commandTitle":"","showCommandTitle":false,"hideCommandCode":false,"hideCommandResult":false,"iPythonMetadata":null,"streamStates":{},"datasetPreviewNameToCmdIdMap":{},"nuid":"7935fc53-291b-4fc8-897a-b2ec9aecdd7a"},{"version":"CommandV1","origId":440968250896223,"guid":"6a05ed20-6997-4a3c-bd26-a6694c9c199e","subtype":"command","commandType":"auto","position":10.0,"command":"itemList=sqlContext.sql(\"Select distinct itemId from train\").rdd.map(lambda x:x[0]).collect()\nitemList[0:5]","commandVersion":0,"state":"finished","results":{"type":"html","data":"<div class=\"ansiout\"><span class=\"ansired\">Out[</span><span class=\"ansired\">10</span><span class=\"ansired\">]: </span>[u&apos;330&apos;, u&apos;781&apos;, u&apos;899&apos;, u&apos;943&apos;, u&apos;1098&apos;]\n</div>","arguments":{},"addedWidgets":{},"removedWidgets":[],"datasetInfos":[]},"errorSummary":null,"error":null,"workflows":[],"startTime":1499161266433,"submitTime":1499161098524,"finishTime":1499161268754,"collapsed":false,"bindings":{},"inputWidgets":{},"displayType":"table","width":"auto","height":"auto","xColumns":null,"yColumns":null,"pivotColumns":null,"pivotAggregation":null,"customPlotOptions":{},"commentThread":[],"commentsVisible":false,"parentHierarchy":[],"diffInserts":[],"diffDeletes":[],"globalVars":{},"latestUser":"amarildolikmeta@gmail.com","latestUserId":null,"commandTitle":"","showCommandTitle":false,"hideCommandCode":false,"hideCommandResult":false,"iPythonMetadata":null,"streamStates":{},"datasetPreviewNameToCmdIdMap":{},"nuid":"3427c7bb-560a-4b3d-b745-f9fba8e69c40"},{"version":"CommandV1","origId":440968250896224,"guid":"cd241eb7-c4ef-464c-a30e-d5c889295f78","subtype":"command","commandType":"auto","position":11.0,"command":"def recommendTopRated(user_id, removeSeen=1):\n    recommendedList = ratings\n    if(removeSeen):\n      seenItems = np.array(userSeenItems_dict[user_id])\n      unseen_mask = np.in1d(recommendedList, seenItems, invert=True)\n      recommendedList = recommendedList[unseen_mask]      \n    return [user_id,recommendedList[0:numberOfItemsToRecommend].tolist()]","commandVersion":0,"state":"finished","results":{"type":"html","data":"<div class=\"ansiout\"></div>","arguments":{},"addedWidgets":{},"removedWidgets":[],"datasetInfos":[]},"errorSummary":null,"error":null,"workflows":[],"startTime":1499161268762,"submitTime":1499161098529,"finishTime":1499161268835,"collapsed":false,"bindings":{},"inputWidgets":{},"displayType":"table","width":"auto","height":"auto","xColumns":null,"yColumns":null,"pivotColumns":null,"pivotAggregation":null,"customPlotOptions":{},"commentThread":[],"commentsVisible":false,"parentHierarchy":[],"diffInserts":[],"diffDeletes":[],"globalVars":{},"latestUser":"amarildolikmeta@gmail.com","latestUserId":null,"commandTitle":"","showCommandTitle":false,"hideCommandCode":false,"hideCommandResult":false,"iPythonMetadata":null,"streamStates":{},"datasetPreviewNameToCmdIdMap":{},"nuid":"158a50e7-15d0-4c0c-8b2d-95ae2a001eb6"},{"version":"CommandV1","origId":440968250896225,"guid":"ee1ec89d-9873-43d9-9419-56b4ef7f426a","subtype":"command","commandType":"auto","position":12.0,"command":"features=sqlContext.sql(\"Select * from icm \").rdd.map(lambda x:(x[0],x[1]))\nfeatures.take(10)","commandVersion":0,"state":"finished","results":{"type":"html","data":"<div class=\"ansiout\"><span class=\"ansired\">Out[</span><span class=\"ansired\">13</span><span class=\"ansired\">]: </span>\n[(2135, 1),\n (2303, 1),\n (6292, 1),\n (12395, 1),\n (24520, 1),\n (25297, 1),\n (32548, 1),\n (34303, 1),\n (36141, 1),\n (11812, 2)]\n</div>","arguments":{},"addedWidgets":{},"removedWidgets":[],"datasetInfos":[]},"errorSummary":null,"error":null,"workflows":[],"startTime":1499161268926,"submitTime":1499161098539,"finishTime":1499161269501,"collapsed":false,"bindings":{},"inputWidgets":{},"displayType":"table","width":"auto","height":"auto","xColumns":null,"yColumns":null,"pivotColumns":null,"pivotAggregation":null,"customPlotOptions":{},"commentThread":[],"commentsVisible":false,"parentHierarchy":[],"diffInserts":[],"diffDeletes":[],"globalVars":{},"latestUser":"amarildolikmeta@gmail.com","latestUserId":null,"commandTitle":"","showCommandTitle":false,"hideCommandCode":false,"hideCommandResult":false,"iPythonMetadata":null,"streamStates":{},"datasetPreviewNameToCmdIdMap":{},"nuid":"8826ee39-d4ba-4f11-b4a8-29e5ad4b4487"},{"version":"CommandV1","origId":440968250896226,"guid":"ff2bc56a-8720-49e3-8d1d-d6f10fd0181f","subtype":"command","commandType":"auto","position":13.0,"command":"features_dict=features.map(lambda x:(str(x[0]),[x[1]])).reduceByKey(lambda x,y:x+y).collectAsMap() \nfeatures_dict[\"2135\"] #features of item 2135","commandVersion":0,"state":"finished","results":{"type":"html","data":"<div class=\"ansiout\"><span class=\"ansired\">Out[</span><span class=\"ansired\">16</span><span class=\"ansired\">]: </span>[1, 3250, 4715, 5786, 6524, 8317]\n</div>","arguments":{},"addedWidgets":{},"removedWidgets":[],"datasetInfos":[]},"errorSummary":"Command skipped","error":null,"workflows":[],"startTime":1499161270760,"submitTime":1499161098554,"finishTime":1499161272275,"collapsed":false,"bindings":{},"inputWidgets":{},"displayType":"table","width":"auto","height":"auto","xColumns":null,"yColumns":null,"pivotColumns":null,"pivotAggregation":null,"customPlotOptions":{},"commentThread":[],"commentsVisible":false,"parentHierarchy":[],"diffInserts":[],"diffDeletes":[],"globalVars":{},"latestUser":"amarildolikmeta@gmail.com","latestUserId":null,"commandTitle":"","showCommandTitle":false,"hideCommandCode":false,"hideCommandResult":false,"iPythonMetadata":null,"streamStates":{},"datasetPreviewNameToCmdIdMap":{},"nuid":"4669c18a-0ed3-4613-adb3-0e04e55e7e80"},{"version":"CommandV1","origId":440968250896227,"guid":"5dae6a09-79ae-4ff4-9922-6359e0513a0d","subtype":"command","commandType":"auto","position":14.0,"command":"from scipy import spatial\n\ndef itemFeatureSimilarity(item1,item2):\n  try :\n    featuresItems1=set(features_dict[item1])\n    featuresItems2=set(features_dict[item2])\n    totalFeatures=featuresItems1&featuresItems2\n    totalFeatures=list(totalFeatures)\n    if len(totalFeatures)==0:\n      return 0\n    number_of_features=len(totalFeatures)\n    len1=sqrt(len(featuresItems1))\n    len2=sqrt(len(featuresItems2))\n    shrink=7\n    return number_of_features/((len1*len2)+shrink)\n  except:\n    return 0","commandVersion":0,"state":"finished","results":{"type":"html","data":"<div class=\"ansiout\"></div>","arguments":{},"addedWidgets":{},"removedWidgets":[],"datasetInfos":[]},"errorSummary":"Command skipped","error":null,"workflows":[],"startTime":1499161272449,"submitTime":1499161098568,"finishTime":1499161272493,"collapsed":false,"bindings":{},"inputWidgets":{},"displayType":"table","width":"auto","height":"auto","xColumns":null,"yColumns":null,"pivotColumns":null,"pivotAggregation":null,"customPlotOptions":{},"commentThread":[],"commentsVisible":false,"parentHierarchy":[],"diffInserts":[],"diffDeletes":[],"globalVars":{},"latestUser":"amarildolikmeta@gmail.com","latestUserId":null,"commandTitle":"","showCommandTitle":false,"hideCommandCode":false,"hideCommandResult":false,"iPythonMetadata":null,"streamStates":{},"datasetPreviewNameToCmdIdMap":{},"nuid":"ceb6d3dc-86f1-4c54-afee-0dc68eee1b8b"},{"version":"CommandV1","origId":440968250896228,"guid":"acea452d-5419-43e1-b47c-7f08c60c0511","subtype":"command","commandType":"auto","position":15.0,"command":"itemFeatureSimilarity(\"15\",\"87\")","commandVersion":0,"state":"finished","results":{"type":"html","data":"<div class=\"ansiout\"><span class=\"ansired\">Out[</span><span class=\"ansired\">20</span><span class=\"ansired\">]: </span>0.19112964242498626\n</div>","arguments":{},"addedWidgets":{},"removedWidgets":[],"datasetInfos":[]},"errorSummary":"Command skipped","error":null,"workflows":[],"startTime":1499161272498,"submitTime":1499161098573,"finishTime":1499161272523,"collapsed":false,"bindings":{},"inputWidgets":{},"displayType":"table","width":"auto","height":"auto","xColumns":null,"yColumns":null,"pivotColumns":null,"pivotAggregation":null,"customPlotOptions":{},"commentThread":[],"commentsVisible":false,"parentHierarchy":[],"diffInserts":[],"diffDeletes":[],"globalVars":{},"latestUser":"amarildolikmeta@gmail.com","latestUserId":null,"commandTitle":"","showCommandTitle":false,"hideCommandCode":false,"hideCommandResult":false,"iPythonMetadata":null,"streamStates":{},"datasetPreviewNameToCmdIdMap":{},"nuid":"e3d1d147-248e-4fba-8968-96c61ef2e9fb"},{"version":"CommandV1","origId":440968250896229,"guid":"1a580d3e-2599-4c74-99c8-f3789c127949","subtype":"command","commandType":"auto","position":16.0,"command":"userRatingsList_dict=userRatings.collectAsMap()\nuserRatingsList_dict[\"15\"]","commandVersion":0,"state":"finished","results":{"type":"html","data":"<div class=\"ansiout\"><span class=\"ansired\">Out[</span><span class=\"ansired\">21</span><span class=\"ansired\">]: </span>[(u&apos;1686&apos;, 9), (u&apos;4949&apos;, 7), (u&apos;13298&apos;, 8), (u&apos;25363&apos;, 9), (u&apos;33993&apos;, 7)]\n</div>","arguments":{},"addedWidgets":{},"removedWidgets":[],"datasetInfos":[]},"errorSummary":"Command skipped","error":null,"workflows":[],"startTime":1499161272529,"submitTime":1499161098578,"finishTime":1499161272952,"collapsed":false,"bindings":{},"inputWidgets":{},"displayType":"table","width":"auto","height":"auto","xColumns":null,"yColumns":null,"pivotColumns":null,"pivotAggregation":null,"customPlotOptions":{},"commentThread":[],"commentsVisible":false,"parentHierarchy":[],"diffInserts":[],"diffDeletes":[],"globalVars":{},"latestUser":"amarildolikmeta@gmail.com","latestUserId":null,"commandTitle":"","showCommandTitle":false,"hideCommandCode":false,"hideCommandResult":false,"iPythonMetadata":null,"streamStates":{},"datasetPreviewNameToCmdIdMap":{},"nuid":"016e7fae-7ecc-4377-8b95-6e1d62ad0ed9"},{"version":"CommandV1","origId":440968250896230,"guid":"de9da579-3978-4ea5-ba1a-ca870cf323f0","subtype":"command","commandType":"auto","position":17.0,"command":"for key in userRatingsList_dict:\n  userRatingsList_dict[key]=sorted(userRatingsList_dict[key],key=lambda tup: tup[1],reverse=True)\n  userRatingsList_dict[key]=[ seq[0] for seq in userRatingsList_dict[key] ]\nuserRatingsList_dict[\"15\"]  #OrderFavoriteItemsForEachUser","commandVersion":0,"state":"finished","results":{"type":"html","data":"<div class=\"ansiout\"><span class=\"ansired\">Out[</span><span class=\"ansired\">22</span><span class=\"ansired\">]: </span>[u&apos;1686&apos;, u&apos;25363&apos;, u&apos;13298&apos;, u&apos;4949&apos;, u&apos;33993&apos;]\n</div>","arguments":{},"addedWidgets":{},"removedWidgets":[],"datasetInfos":[]},"errorSummary":"Command skipped","error":null,"workflows":[],"startTime":1499161272957,"submitTime":1499161098583,"finishTime":1499161273079,"collapsed":false,"bindings":{},"inputWidgets":{},"displayType":"table","width":"auto","height":"auto","xColumns":null,"yColumns":null,"pivotColumns":null,"pivotAggregation":null,"customPlotOptions":{},"commentThread":[],"commentsVisible":false,"parentHierarchy":[],"diffInserts":[],"diffDeletes":[],"globalVars":{},"latestUser":"amarildolikmeta@gmail.com","latestUserId":null,"commandTitle":"","showCommandTitle":false,"hideCommandCode":false,"hideCommandResult":false,"iPythonMetadata":null,"streamStates":{},"datasetPreviewNameToCmdIdMap":{},"nuid":"1e6fc7cc-334a-446d-8e3c-6533cb80d7ca"},{"version":"CommandV1","origId":440968250896231,"guid":"9cbe01c2-c1ac-4719-9cce-d349e7122a92","subtype":"command","commandType":"auto","position":18.0,"command":"featuredItems=sqlContext.sql(\"Select distinct itemId from icm\").rdd.map(lambda x:str(x[0]))\nfeaturedItemsList=featuredItems.collect()\nfeaturedItemsList[0:10]","commandVersion":0,"state":"finished","results":{"type":"html","data":"<div class=\"ansiout\"><span class=\"ansired\">Out[</span><span class=\"ansired\">23</span><span class=\"ansired\">]: </span>\n[&apos;6031&apos;,\n &apos;23831&apos;,\n &apos;30031&apos;,\n &apos;27631&apos;,\n &apos;9031&apos;,\n &apos;31431&apos;,\n &apos;29231&apos;,\n &apos;14631&apos;,\n &apos;4631&apos;,\n &apos;33231&apos;]\n</div>","arguments":{},"addedWidgets":{},"removedWidgets":[],"datasetInfos":[]},"errorSummary":"Command skipped","error":null,"workflows":[],"startTime":1499161273085,"submitTime":1499161098588,"finishTime":1499161275205,"collapsed":false,"bindings":{},"inputWidgets":{},"displayType":"table","width":"auto","height":"auto","xColumns":null,"yColumns":null,"pivotColumns":null,"pivotAggregation":null,"customPlotOptions":{},"commentThread":[],"commentsVisible":false,"parentHierarchy":[],"diffInserts":[],"diffDeletes":[],"globalVars":{},"latestUser":"amarildolikmeta@gmail.com","latestUserId":null,"commandTitle":"","showCommandTitle":false,"hideCommandCode":false,"hideCommandResult":false,"iPythonMetadata":null,"streamStates":{},"datasetPreviewNameToCmdIdMap":{},"nuid":"c04ce0ac-3e06-4974-975a-d52dba2b1971"},{"version":"CommandV1","origId":440968250896232,"guid":"402fce6d-fe3d-4801-9571-c3d1ef044414","subtype":"command","commandType":"auto","position":19.0,"command":"def getSimilarRatingItems(item,itemList,k):\n  similar=[]\n  for i in itemList:\n    if i!=item:\n      similarity=itemRatingSimilarity(item,i)\n      if similarity!=0:\n        similar.append((str(i),similarity))\n  similar = sorted(similar, key=lambda tup: tup[1],reverse=True)\n  if len(similar)>k:\n    return similar[0:k]\n  else:\n    return similar","commandVersion":0,"state":"finished","results":{"type":"html","data":"<div class=\"ansiout\"></div>","arguments":{},"addedWidgets":{},"removedWidgets":[],"datasetInfos":[]},"errorSummary":"Command skipped","error":null,"workflows":[],"startTime":1499161275320,"submitTime":1499161098603,"finishTime":1499161275344,"collapsed":false,"bindings":{},"inputWidgets":{},"displayType":"table","width":"auto","height":"auto","xColumns":null,"yColumns":null,"pivotColumns":null,"pivotAggregation":null,"customPlotOptions":{},"commentThread":[],"commentsVisible":false,"parentHierarchy":[],"diffInserts":[],"diffDeletes":[],"globalVars":{},"latestUser":"amarildolikmeta@gmail.com","latestUserId":null,"commandTitle":"","showCommandTitle":false,"hideCommandCode":false,"hideCommandResult":false,"iPythonMetadata":null,"streamStates":{},"datasetPreviewNameToCmdIdMap":{},"nuid":"5e86a7f3-dcdd-4bcb-8d22-1deff18b4674"},{"version":"CommandV1","origId":440968250896233,"guid":"b62e4cc6-684f-4757-aaa4-024a1e41941a","subtype":"command","commandType":"auto","position":20.0,"command":"def CollaborativeItemFiltering(userId):\n  userId=str(userId)\n  seenItems = np.array(userSeenItems_dict[userId])\n  reccomendedList=[]\n  reccomendedItems=[]\n  k=20\n  shrink=7\n  ratio=1\n  for item in itemList:\n    if item not in seenItems:\n      similarItems=getSimilarRatingItems(item,seenItems,k)\n      rating=0\n      denominator=shrink\n      for t in similarItems:\n        #sim1=itemFeatureSimilarity(item,item2)\n        #sim2=itemRatingSimilarity(item,item2)\n        #sim=ratio*sim1+(1-ratio)*sim2\n        rating=rating+(userRatings_dict[userId][t[0]]*t[1])\n        denominator=denominator+t[1]\n      if denominator!=0:\n        tup=(item,rating/denominator)\n        reccomendedList.append(tup)\n  reccomendedList = sorted(reccomendedList, key=lambda tup: tup[1],reverse=True)\n  reccomendedList=[ seq[0] for seq in reccomendedList ]\n  #reccomendedList=list(set(reccomendedList))\n  return [userId,reccomendedList[0:numberOfItemsToRecommend]]","commandVersion":0,"state":"finished","results":{"type":"html","data":"<div class=\"ansiout\"></div>","arguments":{},"addedWidgets":{},"removedWidgets":[],"datasetInfos":[]},"errorSummary":"Command skipped","error":null,"workflows":[],"startTime":1499164483398,"submitTime":1499164483393,"finishTime":1499164483473,"collapsed":false,"bindings":{},"inputWidgets":{},"displayType":"table","width":"auto","height":"auto","xColumns":null,"yColumns":null,"pivotColumns":null,"pivotAggregation":null,"customPlotOptions":{},"commentThread":[],"commentsVisible":false,"parentHierarchy":[],"diffInserts":[],"diffDeletes":[],"globalVars":{},"latestUser":"amarildolikmeta@gmail.com","latestUserId":null,"commandTitle":"","showCommandTitle":false,"hideCommandCode":false,"hideCommandResult":false,"iPythonMetadata":null,"streamStates":{},"datasetPreviewNameToCmdIdMap":{},"nuid":"0e8bc154-8a13-433d-96bf-a9c7c65b7a36"},{"version":"CommandV1","origId":440968250896234,"guid":"5a370c3a-8fa2-494e-88cf-efecc1d3ec19","subtype":"command","commandType":"auto","position":21.0,"command":"ContentFiltering(5)","commandVersion":0,"state":"finished","results":{"type":"html","data":"<div class=\"ansiout\"><span class=\"ansired\">Out[</span><span class=\"ansired\">35</span><span class=\"ansired\">]: </span>[&apos;5&apos;, [&apos;1269&apos;, &apos;10&apos;, &apos;2762&apos;, &apos;9676&apos;, &apos;35637&apos;]]\n</div>","arguments":{},"addedWidgets":{},"removedWidgets":[],"datasetInfos":[]},"errorSummary":"Command skipped","error":null,"workflows":[],"startTime":1499161278624,"submitTime":1499161098648,"finishTime":1499161282237,"collapsed":false,"bindings":{},"inputWidgets":{},"displayType":"table","width":"auto","height":"auto","xColumns":null,"yColumns":null,"pivotColumns":null,"pivotAggregation":null,"customPlotOptions":{},"commentThread":[],"commentsVisible":false,"parentHierarchy":[],"diffInserts":[],"diffDeletes":[],"globalVars":{},"latestUser":"amarildolikmeta@gmail.com","latestUserId":null,"commandTitle":"","showCommandTitle":false,"hideCommandCode":false,"hideCommandResult":false,"iPythonMetadata":null,"streamStates":{},"datasetPreviewNameToCmdIdMap":{},"nuid":"7060ad40-910c-4234-b30c-8fab819fed79"},{"version":"CommandV1","origId":440968250896235,"guid":"741acc6e-a590-4e8a-bd9c-4d2b2f9b4c00","subtype":"command","commandType":"auto","position":22.0,"command":"recomendationsContentBased=sc.parallelize(testList.toLocalIterator()).map(CollaborativeItemFiltering).collect()","commandVersion":0,"state":"finished","results":{"type":"html","data":"<div class=\"ansiout\"></div>","arguments":{},"addedWidgets":{},"removedWidgets":[],"datasetInfos":[]},"errorSummary":"Cancelled","error":null,"workflows":[],"startTime":1499164491261,"submitTime":1499164491258,"finishTime":1499166603012,"collapsed":false,"bindings":{},"inputWidgets":{},"displayType":"table","width":"auto","height":"auto","xColumns":null,"yColumns":null,"pivotColumns":null,"pivotAggregation":null,"customPlotOptions":{},"commentThread":[],"commentsVisible":false,"parentHierarchy":[],"diffInserts":[],"diffDeletes":[],"globalVars":{},"latestUser":"amarildolikmeta@gmail.com","latestUserId":null,"commandTitle":"","showCommandTitle":false,"hideCommandCode":false,"hideCommandResult":false,"iPythonMetadata":null,"streamStates":{},"datasetPreviewNameToCmdIdMap":{},"nuid":"10176d35-679a-4271-8900-ee00f80b37c5"},{"version":"CommandV1","origId":440968250896236,"guid":"140dcc58-93a6-4dfa-b45b-8861a76b5be3","subtype":"command","commandType":"auto","position":23.0,"command":"recomendations=recomendationsContentBased\nusers=[]\nrecs=[]\n\nfor i in xrange(len(recomendations)):\n  try:\n    users.append([recomendations[i][0],str(recomendations[i][1][0])+\" \"+str(recomendations[i][1][1])+\" \"+str(recomendations[i][1][2])+\" \"+str(recomendations[i][1][3])+\" \"+str(recomendations[i][1][4])])\n  except:\n    recomendations[i][1]=recomendations[i][1]+recommendTopRated(recomendations[i][0])[1]\n    recomendations[i][1]=recomendations[i][1][0:5]\n    print(recomendations[i][1])\n  recs.append(recomendations[i][1])","commandVersion":0,"state":"finished","results":{"type":"html","data":"<div class=\"ansiout\"></div>","arguments":{},"addedWidgets":{},"removedWidgets":[],"datasetInfos":[]},"errorSummary":"Command skipped","error":null,"workflows":[],"startTime":1499166834337,"submitTime":1499166834328,"finishTime":1499166834411,"collapsed":false,"bindings":{},"inputWidgets":{},"displayType":"table","width":"auto","height":"auto","xColumns":null,"yColumns":null,"pivotColumns":null,"pivotAggregation":null,"customPlotOptions":{},"commentThread":[],"commentsVisible":false,"parentHierarchy":[],"diffInserts":[],"diffDeletes":[],"globalVars":{},"latestUser":"amarildolikmeta@gmail.com","latestUserId":null,"commandTitle":"","showCommandTitle":false,"hideCommandCode":false,"hideCommandResult":false,"iPythonMetadata":null,"streamStates":{},"datasetPreviewNameToCmdIdMap":{},"nuid":"15ad52b2-d492-41f2-8b54-0c8a0d236da0"},{"version":"CommandV1","origId":440968250896237,"guid":"230e9c3a-48cc-4472-8e56-6b0f5ab43571","subtype":"command","commandType":"auto","position":21.5,"command":"testRDD=sqlContext.sql(\"Select * from target\").rdd.map(lambda x:x[0])\ntestList=testRDD.sortBy(lambda x:float(x))","commandVersion":0,"state":"finished","results":{"type":"html","data":"<div class=\"ansiout\"></div>","arguments":{},"addedWidgets":{},"removedWidgets":[],"datasetInfos":[]},"errorSummary":"Command skipped","error":null,"workflows":[],"startTime":1499161287450,"submitTime":1499161098662,"finishTime":1499161288225,"collapsed":false,"bindings":{},"inputWidgets":{},"displayType":"table","width":"auto","height":"auto","xColumns":null,"yColumns":null,"pivotColumns":null,"pivotAggregation":null,"customPlotOptions":{},"commentThread":[],"commentsVisible":false,"parentHierarchy":[],"diffInserts":[],"diffDeletes":[],"globalVars":{},"latestUser":"amarildolikmeta@gmail.com","latestUserId":null,"commandTitle":"","showCommandTitle":false,"hideCommandCode":false,"hideCommandResult":false,"iPythonMetadata":null,"streamStates":{},"datasetPreviewNameToCmdIdMap":{},"nuid":"5a78115c-c4ac-4744-9f77-c3dd9b32f581"},{"version":"CommandV1","origId":440968250896239,"guid":"e7957d22-ed07-49c9-b868-36f127fbb504","subtype":"command","commandType":"auto","position":11.5,"command":"recommendTopRated(\"4\")","commandVersion":0,"state":"finished","results":{"type":"html","data":"<div class=\"ansiout\"><span class=\"ansired\">Out[</span><span class=\"ansired\">12</span><span class=\"ansired\">]: </span>[&apos;4&apos;, [&apos;33173&apos;, &apos;33475&apos;, &apos;1076&apos;, &apos;35300&apos;, &apos;15743&apos;]]\n</div>","arguments":{},"addedWidgets":{},"removedWidgets":[],"datasetInfos":[]},"errorSummary":null,"error":null,"workflows":[],"startTime":1499161268841,"submitTime":1499161098534,"finishTime":1499161268921,"collapsed":false,"bindings":{},"inputWidgets":{},"displayType":"table","width":"auto","height":"auto","xColumns":null,"yColumns":null,"pivotColumns":null,"pivotAggregation":null,"customPlotOptions":{},"commentThread":[],"commentsVisible":false,"parentHierarchy":[],"diffInserts":[],"diffDeletes":[],"globalVars":{},"latestUser":"amarildolikmeta@gmail.com","latestUserId":null,"commandTitle":"","showCommandTitle":false,"hideCommandCode":false,"hideCommandResult":false,"iPythonMetadata":null,"streamStates":{},"datasetPreviewNameToCmdIdMap":{},"nuid":"9377151d-606d-412f-baf5-ae42c0047c1e"},{"version":"CommandV1","origId":440968250896240,"guid":"785a3706-2420-4ec6-ac37-e7b422a47726","subtype":"command","commandType":"auto","position":25.0,"command":"df=pd.DataFrame(data=users  # values\n                      # 1st column as index,\n                ,columns=[\"userId\",\"RecommendedItemIds\"]\n                    )\ndisplay(sqlContext.createDataFrame(df))","commandVersion":0,"state":"finished","results":{"type":"table","data":[["4","21647 7707 27414 34859 35384"],["5","37053 33939 30003 6848 37036"],["8","36927 23368 6 34982 7346"],["9","30287 35465 24837 16372 2818"],["13","23137 22870 25286 34889 28257"],["18","13782 266 14503 6152 9125"],["19","20554 29355 14912 27225 5658"],["23","3719 36220 33709 5286 35036"],["26","17469 36362 5879 33563 5138"],["29","7976 26516 3847 4503 27216"],["31","24377 11503 18839 22294 7833"],["32","20645 21335 10032 30414 7581"],["33","3665 16221 18543 4752 12752"],["35","36843 29081 21505 10342 33102"],["37","32083 22514 30923 18222 14953"],["51","25694 13284 25512 24786 2143"],["52","15918 17938 19904 20380 25038"],["53","12826 3165 17679 34443 11429"],["54","29045 20230 12240 31051 1106"],["61","17529 30176 36853 16569 15037"],["64","107 12582 9577 11871 21651"],["69","29262 24076 26460 33315 26119"],["76","21187 26332 12697 1617 31152"],["78","35281 20264 16307 28527 16074"],["79","2134 457 238 11419 26046"],["85","31085 34222 9577 24771 11774"],["89","22845 18353 4845 36133 36343"],["92","33220 24516 34168 8515 19885"],["93","28076 1520 21986 28814 11868"],["95","2053 28462 25694 8205 13885"],["100","33185 9119 11906 20407 14398"],["104","21827 20444 19926 17678 15420"],["105","28568 24880 35065 31978 32019"],["109","26346 20995 11237 22408 14629"],["110","20055 15551 18612 23739 16608"],["111","14616 12669 28102 651 28814"],["112","26407 7141 1306 4359 9348"],["122","26658 14323 9582 14234 22628"],["126","19668 1153 34365 27236 4410"],["131","27425 12689 34312 31154 36995"],["132","5548 35344 10076 18453 11879"],["136","34829 15770 33673 36684 13470"],["140","2447 30872 24410 10452 33755"],["144","8057 11213 12949 18089 8734"],["145","15816 16910 2808 23735 14052"],["146","27367 31663 35344 29301 21412"],["151","6014 16609 16283 33693 15599"],["152","30096 10026 9336 28739 26619"],["155","36047 15394 24351 23010 5546"],["156","14660 36718 25694 29848 8832"],["160","11058 10468 19182 22663 28774"],["162","7392 31069 32226 33574 24178"],["164","16278 12313 5360 36112 7555"],["165","12516 26332 17763 23340 34773"],["166","3203 19293 27598 4634 30552"],["169","23826 11072 10353 1434 22427"],["173","7719 4212 10514 18170 652"],["179","26658 13284 21912 15274 11529"],["184","2247 33957 4122 14629 36855"],["185","22427 35331 19668 28950 12473"],["186","18963 30863 35331 10946 16451"],["187","6735 29959 9336 19668 26512"],["189","19358 22087 9570 30096 13127"],["190","4976 34766 25111 14271 23384"],["191","28014 7892 35621 33683 6041"],["197","16962 21919 25547 34868 2053"],["205","21073 1956 21171 15391 2256"],["208","1434 7886 4222 11554 31085"],["209","420 26407 5361 30960 29448"],["217","11869 12203 33276 12685 22983"],["218","5138 7722 27723 5444 36788"],["222","7465 27776 29805 8549 27610"],["223","27569 17975 17656 23976 36599"],["234","4105 36855 14535 21175 18483"],["240","21195 23273 418 28805 11092"],["246","13896 21311 32702 19505 21215"],["247","18801 24473 25461 21917 20413"],["250","36902 22744 30969 12582 35331"],["257","23273 14988 30989 35726 13382"],["258","21215 19052 19505 4963 9257"],["268","3514 34619 32111 9553 18901"],["269","19668 24886 36019 25946 4868"],["270","27755 31038 22706 35100 14572"],["274","12305 21441 33562 31057 5827"],["278","8791 36663 26743 18319 17332"],["281","25624 27270 7342 12851 6122"],["288","27950 37023 18498 8966 34128"],["294","37053 27374 2431 23070 35834"],["296","16425 7759 20995 1448 8931"],["299","17611 11887 28568 24519 26346"],["301","18535 35801 13418 14503 14792"],["308","23188 21501 17383 6473 12077"],["310","19668 52 30173 31069 14351"],["312","14023 30030 30021 5633 20791"],["314","14323 5704 18405 31731 12313"],["318","37053 13054 33223 16148 23401"],["321","24971 23340 29678 10502 30123"],["326","3339 29391 29347 14293 17975"],["327","24356 36788 34128 21311 11423"],["333","34756 17398 24076 6658 1053"],["336","26227 4961 12669 5926 36056"],["337","12196 5926 64 21187 8599"],["339","24547 14072 21101 32287 3216"],["344","10996 4276 13852 5844 22870"],["350","23756 1709 154 24919 33298"],["353","31828 5145 34829 8882 228"],["355","34085 17447 18542 29926 12693"],["359","27192 30034 31232 10090 8523"],["361","23273 35726 16739 12925 22040"],["364","266 23211 25110 19887 12161"],["365","22894 30096 9336 10024 26046"],["374","7014 37053 5607 22813 32337"],["375","19789 1686 24867 10024 18394"],["376","17193 16471 34580 7815 28775"],["378","14177 18918 14912 5656 19284"],["379","24404 36356 88 21125 30872"],["380","36843 4833 36645 3387 15826"],["383","21640 28967 14762 8454 7546"],["385","15232 31611 26716 28739 8806"],["388","14323 34619 27773 11711 20981"],["390","26028 36317 12720 33076 6967"],["393","15274 2053 6152 8482 3826"],["399","8216 3100 7573 9222 5170"],["401","22811 20417 25883 33732 37053"],["405","11281 19968 36750 8387 10794"],["412","28950 28928 14077 26044 35328"],["413","2523 26046 6561 21667 25462"],["415","16148 31963 24352 35189 14023"],["418","19505 8231 3976 27348 31184"],["431","17044 21322 25512 3601 10231"],["433","843 26658 3826 32287 28462"],["441","26658 2523 18170 30925 2053"],["443","32947 36362 10237 26815 12720"],["445","1397 2623 7932 27682 33981"],["449","34237 14375 990 17270 23387"],["456","3719 1355 23247 27380 3374"],["458","24929 19668 15930 13382 21667"],["459","14197 19912 18595 22449 10758"],["463","17679 19718 9222 25665 14988"],["466","31828 867 23967 17332 29518"],["477","14660 37053 25180 23785 34125"],["478","28966 1430 33106 15141 28329"],["481","8866 12669 7750 20619 30759"],["487","19938 30287 7635 8711 13116"],["488","25424 15513 28003 24781 23662"],["491","21454 25512 33693 28023 775"],["494","17604 23888 16895 25512 30009"],["503","23049 16408 22087 34320 12376"],["504","8013 17705 3528 14076 4836"],["508","35930 25301 18451 33429 15788"],["509","36599 9404 20965 133 1363"],["510","8791 36663 26743 18319 17332"],["511","8040 10301 1388 3109 10724"],["516","1149 23833 30441 8959 26346"],["524","18376 14546 20023 3784 8040"],["527","9163 2134 18200 12894 10446"],["531","25330 27747 2160 21844 32606"],["532","31796 25645 228 10546 16845"],["541","33574 33012 3976 15721 8909"],["542","12 14734 8832 14660 14595"],["543","330 781 899 943 1098"],["549","22569 34619 34642 3165 37078"],["551","17381 13069 20063 32956 6205"],["559","330 781 899 943 1098"],["565","25141 21986 26799 4765 30455"],["568","32287 33250 34930 31736 14734"],["569","32287 3163 26658 16219 35390"],["572","29652 7886 34886 15959 816"],["582","8671 23291 4222 11636 8358"],["589","35856 32369 2053 2523 3680"],["590","6205 24971 23336 154 17381"],["592","4804 13880 3437 35481 14583"],["595","20180 26260 23063 17307 1678"],["599","20417 33376 26820 32230 31611"],["600","1899 24980 25180 13257 14177"],["603","14660 21063 16818 37053 19370"],["605","14595 22976 22892 35020 18306"],["606","33102 11918 9576 9894 9577"],["615","31236 25461 21760 29664 9348"],["616","16356 2424 30156 27944 1470"],["617","31611 4157 4410 18031 37108"],["621","36831 7197 27950 36385 34886"],["632","18662 17359 32857 6826 23363"],["643","15954 6621 32186 2442 14560"],["646","7168 23314 25978 22250 22525"],["651","2484 21182 25027 18350 8185"],["652","4105 14535 4122 32578 8572"],["653","843 13094 11017 21037 26621"],["654","22811 2363 10887 4897 20326"],["658","8216 30003 35381 27836 76"],["659","17407 36192 15618 14784 11215"],["663","18453 11529 36521 7342 11116"],["665","33400 12298 19542 34090 17155"],["673","7948 23455 17810 16959 21827"],["675","6735 37053 22811 35282 25883"],["680","8886 27477 31085 33029 23273"],["681","10701 6073 14076 15680 30253"],["684","17383 27753 17011 15932 10278"],["691","9420 23756 7161 10546 37083"],["696","32270 12083 12169 2822 29658"],["700","32287 31107 17611 34910 14271"],["705","32538 843 3366 3163 29848"],["706","33337 24679 23795 7393 32342"],["710","13516 10946 30960 16830 32206"],["712","24488 228 37065 2623 21495"],["713","37065 25499 27650 22976 9127"],["715","6312 8764 1452 28114 30694"],["717","10212 19224 3366 7463 2635"],["722","4105 7815 14792 32911 11017"],["725","18468 14264 2756 2339 2247"],["729","24809 17705 14019 22244 12151"],["733","19370 14387 3937 3436 27246"],["739","36843 21910 457 14762 26325"],["741","2134 33102 12347 24034 5889"],["744","11994 4817 5385 34655 16837"],["747","2010 33428 7488 24352 4069"],["750","10076 37053 23326 6561 26419"],["757","13615 14932 21245 34119 21322"],["759","27640 21571 21037 25626 24195"],["761","4887 18236 26872 904 36743"],["773","9784 9133 26405 19001 18383"],["777","35266 3921 7399 16860 28301"],["780","28462 27780 10206 27833 11529"],["782","2041 2049 9233 26983 10082"],["784","23393 20561 16471 1089 24109"],["787","31341 13027 30616 2623 29268"],["788","6464 10825 33295 13123 35913"],["789","15278 27464 30699 14626 21223"],["791","24021 8937 14579 11116 19242"],["792","6654 3367 30039 33831 20111"],["796","33710 21175 9125 35020 12011"],["801","26657 12345 25966 13094 17272"],["806","19505 36927 25804 22232 4709"],["808","33376 23138 19688 7292 21761"],["810","20618 27008 4157 18031 29500"],["813","6294 34869 3165 14169 20283"],["816","24408 18576 21335 2215 12045"],["820","27675 33014 8358 22762 16818"],["826","19860 17707 30818 15039 7463"],["827","19668 34718 10946 2402 17889"],["828","33288 5467 36127 3482 18033"],["831","3081 5624 24076 22506 7926"],["833","5926 6423 14727 17611 1836"],["834","17808 14271 26407 35327 27477"],["835","1265 21498 16331 3810 29204"],["839","9336 31889 8249 5065 17956"],["850","24247 5489 25210 4222 9651"],["852","4485 28928 4013 13580 29159"],["853","14601 3992 33543 31726 1520"],["854","26002 15277 23340 8020 34352"],["857","10812 23967 28431 3543 5543"],["862","20048 15192 16451 24786 4976"],["867","17383 19524 5723 26064 9176"],["869","30964 228 2523 7421 6561"],["873","10688 4468 7595 14659 5996"],["874","5156 23760 1188 28703 11210"],["879","26346 32287 7992 35973 612"],["883","35085 21648 25720 28257 11215"],["884","20186 18622 19199 11774 15086"],["886","17763 22136 33536 1166 4804"],["888","31889 17679 14709 238 20234"],["890","18801 20852 26658 33238 22717"],["899","16736 33918 30342 14486 10736"],["900","5926 10514 8599 10546 36937"],["905","33940 20211 19739 11528 14020"],["907","6932 24031 30726 11085 11745"],["908","848 17236 25512 30853 14886"],["909","14720 19965 15991 2192 19004"],["916","29980 3483 4272 5237 22818"],["919","5443 35020 33793 18261 3578"],["926","8328 25977 1159 1779 27702"],["927","9194 9354 23772 1434 12720"],["929","8482 32337 30253 15503 33155"],["937","4746 25938 33106 27672 13173"],["942","31828 29485 30308 2053 23067"],["944","197 26369 15530 28194 29939"],["946","10419 7622 23134 23816 31556"],["947","8387 30263 15073 14085 30824"],["949","29382 30750 23967 9018 3270"],["956","32956 10206 36056 21157 3601"],["958","30813 37023 23785 30198 33055"],["961","7392 26092 21311 13029 19890"],["968","25307 13852 19913 10301 24034"],["969","4976 4276 20714 7721 19025"],["972","21740 9222 12056 8599 8781"],["977","32820 26704 25180 9728 18467"],["978","25275 33376 20507 22628 35665"],["979","9349 1520 23188 31085 36492"],["982","24760 26046 9336 28575 15530"],["983","32764 9336 16741 7197 21311"],["987","3869 18440 5861 18316 33939"],["990","8996 16421 36835 36575 19858"],["1005","23747 9228 30603 22339 36790"],["1010","31726 765 4589 18164 10572"],["1011","3457 26621 32287 28705 13502"],["1014","31341 30616 13027 2623 29268"],["1016","3077 25275 19817 36862 17992"],["1017","7217 21590 37054 23758 16818"],["1033","18128 11054 29888 1265 26046"],["1043","330 781 899 943 1098"],["1044","31699 14103 6423 5331 9125"],["1046","26227 16055 17001 32229 18543"],["1055","20995 28568 8549 36855 14264"],["1060","18299 11453 758 31120 10009"],["1061","9679 3212 10595 15232 31611"],["1067","37053 21844 18416 24076 10246"],["1068","23915 14476 19890 33806 35151"],["1076","16095 15315 32107 12197 148"],["1077","33708 25272 32287 5331 3216"],["1084","21063 8096 11868 22870 22066"],["1097","20484 10415 17272 5425 2339"],["1102","9354 30414 4327 36841 9194"],["1107","5951 28966 25512 20645 35806"],["1110","14390 21652 34648 12931 35775"],["1112","26600 4921 10110 8239 23935"],["1113","228 9651 2523 36937 16451"],["1114","816 14685 2550 22895 21572"],["1117","12841 32375 17082 26491 20468"],["1118","5827 14271 1311 16916 843"],["1121","34886 31512 16750 8292 35516"],["1122","22763 34319 15192 37123 3680"],["1128","33315 13050 7205 33270 19789"],["1135","7566 22430 37053 27935 14177"],["1136","3719 36220 33709 5286 35036"],["1137","23580 33603 14583 35726 29678"],["1144","25715 1069 9676 37119 33223"],["1145","30611 17099 21458 29414 23461"],["1146","15786 28527 5164 3826 33788"],["1148","26407 22859 16307 1289 5850"],["1151","25512 30863 30839 15471 25506"],["1152","6381 19668 26046 28462 16031"],["1157","14579 6842 19887 11579 30197"],["1159","4961 32068 14837 20673 33720"],["1161","34886 26679 24319 33288 30477"],["1163","35523 22158 21293 6522 11976"],["1165","21223 27477 11413 2402 19996"],["1173","30832 33957 31730 31699 6250"],["1175","19505 9336 31726 35154 24488"],["1177","7463 1434 21354 9119 28864"],["1178","9913 6871 12669 36488 7392"],["1180","9546 22245 4698 23020 34332"],["1181","21412 1203 29301 30087 17178"],["1184","22294 30481 16547 33415 23935"],["1189","7217 12081 16095 21238 31227"],["1190","15471 32956 30712 1759 5138"],["1193","19668 24217 22569 34352 18652"],["1201","17813 7392 17380 17299 31504"],["1204","2240 29658 4364 36459 18158"],["1205","26320 6068 11529 30674 28587"],["1218","7138 19907 2247 7342 20428"],["1222","13494 23635 35502 15642 13263"],["1224","35705 32813 17915 29159 19303"],["1229","3222 12685 26619 4118 23179"],["1233","24076 23457 15291 29013 31963"],["1235","31293 13470 19238 9834 23524"],["1236","36831 4157 1212 30096 7434"],["1238","5548 18768 8827 26953 10346"],["1240","238 33102 35331 31135 19897"],["1249","18304 14804 3759 12570 3296"],["1256","24698 27773 24867 2759 33710"],["1263","12347 21826 35819 34365 36795"],["1264","30253 6073 4765 15680 32253"],["1279","9177 12720 31796 36362 13595"],["1280","26167 32141 20963 3064 14362"],["1282","20417 21311 30096 7463 33840"],["1289","6615 35295 15740 27488 11636"],["1291","16753 1934 14332 33943 32849"],["1292","22120 34756 20209 7998 5164"],["1297","33102 27054 10712 23772 35806"],["1298","25541 3403 7704 16739 2590"],["1314","8312 7014 13902 5098 27026"],["1316","16613 399 26131 36192 33102"],["1322","32938 22894 18055 19789 17679"],["1327","12048 37054 23758 3339 11871"],["1333","29088 33650 23444 7428 25049"],["1334","9799 6312 3027 31700 34868"],["1335","11116 8181 23211 9999 3146"],["1336","26050 10658 8173 4967 33428"],["1343","11065 13356 21268 27833 6996"],["1345","1574 1678 14271 24837 25694"],["1346","33246 34119 29046 2523 29534"],["1348","7984 15599 22302 8358 33732"],["1356","21482 23174 22328 25025 9335"],["1361","18792 15914 27295 5016 20340"],["1365","31889 28928 24516 30096 19996"],["1373","26658 24639 16996 3002 17611"],["1378","6731 10073 33783 32895 21384"],["1379","23380 10706 848 22430 32737"],["1387","30096 37053 26585 10237 12347"],["1391","23077 16187 18576 12354 27244"],["1405","19375 8846 24522 9608 2850"],["1406","16733 28587 2247 13190 15083"],["1408","19736 15843 13412 5539 13382"],["1416","6703 651 16372 35207 33565"],["1417","35591 12991 30096 29115 8482"],["1418","1501 33683 14806 10871 1529"],["1420","11887 9498 12264 35065 8549"],["1423","3413 27969 27270 2865 4895"],["1426","35020 26346 33710 36855 5331"],["1428","16490 26068 22617 28871 5334"],["1431","25976 19323 6539 5274 34638"],["1433","37053 9380 13739 34603 13872"],["1436","36599 26851 3681 1460 20417"],["1438","35065 8549 4105 24880 9498"],["1444","4851 3059 34859 34889 33602"],["1445","36898 25480 33823 35676 24424"],["1447","35863 26657 5176 2374 7663"],["1452","28200 34794 33056 14117 12368"],["1453","32721 16411 35972 15077 20110"],["1463","36192 10672 713 1007 28368"],["1470","4796 24151 30925 24547 35229"],["1473","9142 30759 15918 57 22971"],["1474","23588 35672 22795 27164 3764"],["1476","6503 14271 16316 26911 20588"],["1481","13284 37053 3165 14684 12991"],["1484","20338 64 17272 33250 26596"],["1486","28257 17681 1378 16579 35613"],["1487","21157 21443 2623 2523 11529"],["1493","7215 29391 31171 8085 34580"],["1501","27526 29829 24356 9703 10427"],["1502","30788 34956 8937 36990 24021"],["1503","14312 18468 26191 5292 8423"],["1506","14372 3958 476 7392 34686"],["1508","23291 12720 33137 9562 19938"],["1509","16074 16307 23336 21322 17272"],["1510","843 2053 1289 2424 29046"],["1511","34365 17096 5286 19668 1520"],["1516","20208 24349 15170 10170 33102"],["1527","23134 3366 9380 35065 18170"],["1528","24653 36385 9366 6848 1675"],["1538","35426 13051 33873 5538 8276"],["1547","21609 36903 8448 5253 6648"],["1551","9336 11906 30096 31889 35968"],["1555","14709 10734 20048 36645 3456"],["1560","26888 15103 32656 5654 25359"],["1564","14583 32375 24349 15192 6035"],["1572","1177 5926 31293 28688 11141"],["1576","26529 34222 31432 13276 10997"],["1577","33430 6675 9833 16219 1531"],["1578","6411 16825 12669 7246 25936"],["1587","14583 6769 12669 34868 33266"],["1588","16768 25927 2886 14234 2053"],["1606","10278 3719 19668 9336 3350"],["1607","8292 12669 4930 4731 7567"],["1617","2995 29112 6735 16172 26820"],["1620","32281 18542 6735 30725 34859"],["1624","15192 18813 28519 30759 1007"],["1626","2616 2424 31486 8420 3041"],["1627","26524 28603 32506 22942 35650"],["1635","25461 32019 35065 31978 26417"],["1636","27828 21529 21247 5488 36788"],["1637","30441 2486 7707 29805 27131"],["1638","34910 17593 9380 22330 10946"],["1641","35160 32699 17549 8523 23054"],["1642","36831 2601 19505 9336 4963"],["1643","6330 18599 5146 1974 19981"],["1644","15192 4315 6556 6735 33849"],["1645","35374 330 781 899 943"],["1647","26068 37054 23758 1792 17975"],["1648","6994 14317 9276 28257 15918"],["1649","21322 7086 5734 27414 30481"],["1657","28915 20417 8292 13382 19358"],["1658","33261 20569 6769 28761 6935"],["1661","22579 14062 15620 18622 22744"],["1663","13585 6443 22427 22250 33573"],["1664","37053 10278 6035 18650 11092"],["1667","20963 3064 14362 13653 31758"],["1670","10568 27816 6089 25533 10278"],["1675","28568 16733 31556 24880 20995"],["1681","25512 14932 2523 228 25645"],["1684","2808 23735 14052 8661 12434"],["1685","4013 22425 27416 10802 19668"],["1686","32980 29534 19604 1520 35592"],["1693","11045 30287 7778 2727 18451"],["1696","35084 33543 27506 22976 14644"],["1699","20389 30825 22341 32727 20518"],["1707","18081 24512 22807 7923 775"],["1713","5403 7463 9009 33102 31611"],["1719","30287 1306 26096 27221 33014"],["1723","22408 24230 18405 26407 8482"],["1726","30750 22406 13902 10098 33720"],["1727","3764 23302 1755 26153 20696"],["1728","26407 11529 27352 16956 16307"],["1734","27270 32287 2424 26658 16768"],["1739","15601 20001 27023 1309 22734"],["1740","10082 21651 3719 31085 11366"],["1750","3958 2441 33270 6504 27770"],["1756","17259 1097 35856 8496 14508"],["1757","27550 21084 5370 33428 19390"],["1760","20873 26756 30173 5619 35860"],["1761","11486 36168 34718 7236 31471"],["1764","33298 7074 6561 30255 2777"],["1765","14804 22800 37034 30811 3002"],["1766","33376 20417 29112 21647 24105"],["1767","3680 23958 14660 29417 12023"],["1768","36192 17332 22460 6577 10015"],["1773","19696 15597 13 15293 14734"],["1782","31512 21988 31611 30096 31889"],["1785","15523 1212 14973 28187 33840"],["1786","2247 14705 6932 24031 9555"],["1787","13367 5201 2523 35149 10546"],["1788","26658 22330 7937 14234 5360"],["1789","5370 4873 4410 24403 2991"],["1792","17604 23888 16895 25512 30009"],["1796","15392 20417 11636 10835 12585"],["1800","8176 20746 1621 22337 2476"],["1803","33732 25506 18178 23978 3826"],["1804","21322 24552 31023 869 6343"],["1805","13580 19857 13119 34772 19137"],["1806","18542 28449 29810 32281 5021"],["1807","27044 36855 24880 14072 31192"],["1808","29364 29502 16628 6744 36192"],["1812","35557 37069 18580 26814 35565"],["1813","34718 36168 6035 36841 25716"],["1816","16187 32137 17956 27700 7392"],["1818","7488 33428 4069 29178 23665"],["1820","17771 26500 31638 12723 24525"],["1823","31319 22408 3945 34910 20995"],["1827","37053 18599 11579 15280 30037"],["1829","5043 29421 8642 21788 17469"],["1833","3165 34642 36503 17696 21667"],["1845","18112 12888 14395 33928 33768"],["1857","25829 6797 27912 22894 29457"],["1858","24894 18645 17611 13069 30514"],["1862","22806 11529 5592 5624 35151"],["1866","33009 14553 15009 22724 28415"],["1874","32914 35908 35318 17982 26260"],["1875","35710 29008 25928 20230 14526"],["1876","19858 553 21678 34619 6035"],["1879","4013 21648 11952 13272 27416"],["1881","17465 23119 8667 29378 32993"],["1883","9902 16545 2256 16647 17564"],["1885","32697 24229 36140 36158 2519"],["1888","19052 30759 28519 33674 7393"],["1898","17975 36957 32332 12826 17332"],["1899","14601 7911 36726 1833 27804"],["1900","35020 19197 29865 26743 29637"],["1901","25883 197 34164 24031 5179"],["1906","11929 4275 2765 1520 22606"],["1910","15152 25976 27220 24920 21084"],["1911","16956 31659 5575 36790 27713"],["1918","3456 16628 21872 27488 24349"],["1919","3337 553 3387 9979 34325"],["1920","30759 11868 37055 9385 14660"],["1933","26200 9329 18170 13382 26815"],["1935","36855 9125 34595 34284 6152"],["1936","9974 32345 34886 5043 15173"],["1938","32083 36528 11887 14721 15649"],["1940","1265 13522 19460 30607 31115"],["1941","31611 7463 13382 31889 25883"],["1943","24608 27244 25663 3953 17973"],["1944","2612 19022 2053 20995 24837"],["1945","6954 13163 10121 29711 1247"],["1947","21740 20981 7886 6831 35977"],["1948","18416 25694 9349 10278 21910"],["1950","5336 29678 23772 21073 26378"],["1952","2041 2049 26983 24433 23179"],["1954","33475 25940 27559 33620 8962"],["1955","29588 1416 23772 14402 13076"],["1956","13638 13135 5489 30686 36275"],["1957","19298 26482 6450 20340 5685"],["1963","33674 4222 12642 8671 10246"],["1964","1897 36162 12623 26064 18192"],["1976","9454 13253 23852 22569 35426"],["1977","14929 14660 34153 21907 6035"],["1978","1434 3366 33376 36338 2041"],["1981","10231 5575 28601 2497 19624"],["1985","17140 2759 22885 20995 16221"],["1986","8673 11869 36723 23049 11868"],["1991","33840 13936 17358 33185 16910"],["1993","18170 3245 13284 9308 9336"],["1999","22408 5612 20995 27823 2886"],["2007","14444 14312 18468 32340 35981"],["2009","12292 17044 35805 12347 30719"],["2011","21673 13635 26407 16257 33029"],["2013","2898 27784 28015 1897 4209"],["2017","33724 8033 6745 10955 5065"],["2020","2345 8604 5570 27944 17516"],["2027","26157 11090 15860 13259 24178"],["2028","15388 7737 24894 25084 15520"],["2037","28462 15274 16030 2424 14583"],["2040","12097 8897 17402 5489 17950"],["2041","28966 12368 16845 13473 28203"],["2042","28789 21409 1766 32666 34332"],["2045","5080 34499 12841 12961 17813"],["2051","4276 27969 14784 24662 20696"],["2052","5201 24488 18170 31306 10788"],["2053","26407 28462 8482 154 2886"],["2054","10641 19965 35288 9655 17608"],["2058","2041 2049 26983 24433 23179"],["2060","2919 20096 4833 34333 26270"],["2061","330 781 899 943 1098"],["2066","20417 12408 652 33840 33102"],["2072","21073 1956 21171 15391 2256"],["2073","33400 12298 19542 34090 17155"],["2080","1434 23378 36192 12720 11327"],["2081","31699 13615 28928 6381 5038"],["2084","29355 26529 7086 10514 5889"],["2086","34829 36472 12908 15262 1088"],["2090","8764 8714 17403 34790 14915"],["2091","23976 12669 37054 23758 5861"],["2095","4180 5543 33673 8882 17452"],["2097","330 781 899 943 1098"],["2106","6932 24031 4976 15291 17089"],["2108","16964 5467 33399 22495 31512"],["2117","14660 8832 18316 9797 21063"],["2119","6721 1810 4381 31695 34595"],["2121","8505 22311 33745 20817 21073"],["2124","26658 6561 35331 1836 33376"],["2129","19627 14624 6677 13070 5076"],["2130","12305 21441 33562 31057 5827"],["2132","4083 25059 6238 23569 25180"],["2133","2523 16768 25020 2050 13148"],["2135","8205 6595 26658 14932 23756"],["2136","20683 1259 9064 18530 3874"],["2137","34686 30522 35650 3651 11054"],["2146","2296 9638 19496 24720 23174"],["2147","5624 13363 17666 16794 7911"],["2149","31203 25456 11885 14312 4967"],["2155","7392 30428 34619 2523 18170"],["2156","22155 34850 35973 21273 14904"],["2157","5488 15232 29624 34222 18963"],["2164","8292 13382 22384 129 3059"],["2167","31460 8832 13740 34046 27379"],["2168","27088 19304 18001 21175 23211"],["2179","31466 18444 6592 30095 4041"],["2182","7614 2041 24516 31499 6848"],["2186","21671 4922 6454 21063 7210"],["2195","19991 7643 36552 14709 28012"],["2202","1897 465 26057 36430 32660"],["2212","29112 32619 33246 5624 4410"],["2227","11092 31022 22811 7124 7393"],["2236","3828 7892 13272 25663 13227"],["2244","27683 12264 36322 33045 11708"],["2247","17982 20773 5713 22894 36560"],["2248","33342 2061 22321 30924 10469"],["2254","3343 370 8040 27042 19981"],["2257","32287 9292 30111 10195 25513"],["2261","24512 17144 19451 13050 20570"],["2263","28568 2247 7342 322 612"],["2265","31796 4410 36853 25553 35420"],["2268","30349 7368 34868 30009 9644"],["2270","28814 36370 10278 33037 25025"],["2272","10802 24516 36607 7368 16845"],["2273","7438 21570 23481 17738 21799"],["2274","34509 19808 14019 14323 14390"],["2280","557 18955 21084 25852 33428"],["2285","22330 30719 26813 29558 2715"],["2287","5216 31696 2377 34328 11392"],["2290","11423 33680 24356 10927 5828"],["2298","27832 321 10231 9495 33376"],["2305","29641 339 30119 5654 25359"],["2306","33220 17332 32287 14271 34509"],["2312","1715 36449 27416 3027 3014"],["2313","32046 21986 17957 7144 24991"],["2319","21767 33683 19240 11423 36087"],["2320","7796 17975 8096 37054 23758"],["2324","14488 31081 4811 17795 13288"],["2326","2523 14076 23073 24257 14101"],["2330","20186 15254 14785 9676 28429"],["2338","23512 2156 6119 12621 29446"],["2341","31328 33159 34766 13739 5562"],["2345","31611 2274 33600 27933 31273"],["2346","31611 33102 1212 31889 9336"],["2347","35738 20186 13791 10752 36784"],["2351","2523 36620 21322 11529 26743"],["2352","6205 24971 6788 27730 8045"],["2357","31420 27236 2408 8988 27433"],["2360","23374 21667 5389 26307 5940"],["2361","25694 23976 5578 36248 6473"],["2366","26346 12264 21952 14264 32287"],["2368","27270 22230 25927 35133 33939"],["2369","14583 20048 23976 10712 33993"],["2374","9161 36418 15388 339 13162"],["2379","2424 2053 31726 26419 10712"],["2388","19022 30996 34070 14169 8361"],["2394","12884 23721 33679 32483 372"],["2397","31539 15170 21379 21386 25301"],["2398","36048 6464 9349 23179 2402"],["2399","33673 775 34829 12023 25886"],["2403","24837 154 36343 843 27780"],["2404","13027 7874 36493 14394 37002"],["2407","36831 30096 19505 31889 1495"],["2409","26658 14734 17207 29642 22807"],["2410","7392 26529 17878 27675 30171"],["2414","36028 9930 33246 843 27928"],["2421","1007 11092 3492 31022 28368"],["2426","35293 25512 7421 2523 6258"],["2428","32704 37034 35071 2958 9635"],["2435","16425 7027 34536 11887 35191"],["2442","31796 23020 24516 14583 26002"],["2448","29125 29895 25337 27691 30634"],["2449","16343 35024 12347 30156 24604"],["2452","3395 12074 8306 28257 15960"],["2455","8632 25636 32993 2290 387"],["2466","15681 11165 35968 36218 9651"],["2467","12641 19101 16372 32380 33543"],["2472","10915 33223 32229 33422 25802"],["2474","3413 12350 27969 27270 2865"],["2480","30441 23833 2486 36469 17782"],["2489","6735 25883 29345 4839 7932"],["2496","7212 266 6122 21652 17096"],["2500","9588 13148 16856 1672 24416"],["2502","13571 11869 19722 19997 21974"],["2504","35523 22158 21293 6522 11976"],["2506","12523 35088 28034 7022 5149"],["2508","26525 6484 2391 37053 18299"],["2512","3028 31286 25890 30051 13050"],["2519","12780 30276 26228 9056 34269"],["2520","30925 3945 25512 10546 25886"],["2521","20645 14715 7253 11911 12313"],["2524","5149 14660 21846 6476 11631"],["2528","21084 36341 21561 21336 18724"],["2543","17044 37023 17876 33250 36146"],["2547","27116 35281 16368 26407 14767"],["2549","23340 22323 34352 18652 20894"],["2551","19218 34156 35972 25193 36993"],["2557","6561 2523 30278 14932 34930"],["2560","35407 9639 13148 17956 18593"],["2561","29678 26529 6848 32591 5527"],["2564","33498 23273 36598 34499 13350"],["2569","35953 20995 6152 33115 28568"],["2570","11008 29384 26632 36020 22417"],["2571","12376 13580 23996 29003 14912"],["2581","9420 7161 23756 37083 10546"],["2582","27244 2053 9336 29355 13241"],["2585","25074 15947 29685 929 12785"],["2591","7584 32362 7577 1760 36015"],["2595","11072 32583 20377 6089 24454"],["2597","19240 1057 27522 8233 6931"],["2599","24809 9229 7911 36667 32023"],["2602","27864 25709 30621 28034 21775"],["2603","21167 34718 9336 10082 31085"],["2604","327 1520 24763 7436 26528"],["2610","3163 17611 30925 11347 32287"],["2617","28739 34642 25721 26002 8298"],["2621","23130 28102 21767 31069 28762"],["2623","2201 16234 12181 17584 4611"],["2624","25111 28805 1165 5743 7750"],["2629","21028 5600 18975 3691 28854"],["2631","32287 1149 843 24894 34930"],["2633","15503 36341 23565 13382 34584"],["2638","28759 32803 7463 28664 29586"],["2644","13896 35297 7463 2800 25928"],["2645","33367 25976 1786 29294 26007"],["2647","10299 8312 7600 14583 27221"],["2648","15678 12669 29013 8673 8576"],["2651","16861 19888 1866 16136 9872"],["2654","23220 9576 18963 17813 24933"],["2655","10792 23834 14415 28358 23228"],["2658","31828 9546 27319 34868 28213"],["2661","15170 29833 23186 20208 22355"],["2662","21644 14264 19860 36465 13701"],["2667","25886 32980 25624 21913 22433"],["2674","19840 32928 964 21322 5111"],["2675","24608 27244 25663 3953 17973"],["2680","29209 21945 12671 18213 35665"],["2686","34686 30522 35650 3651 11054"],["2690","13264 1730 23273 29414 23461"],["2696","33710 23211 12161 33220 17272"],["2697","12669 33163 4345 13356 29013"],["2699","34375 34766 28774 6848 9862"],["2701","6561 10712 25512 30925 25694"],["2709","21750 12738 18966 2485 15107"],["2712","37036 7614 7355 9768 36194"],["2713","14792 15252 14535 20314 13268"],["2716","9651 34345 27074 31085 24247"],["2718","11054 372 7889 16728 30489"],["2721","27755 31038 22706 35100 14572"],["2728","21667 26002 36927 16020 3283"],["2729","14904 20162 37040 7992 11458"],["2734","25401 36270 35049 18292 25745"],["2737","2919 20096 10137 27348 28634"],["2743","11474 31889 19890 9974 7434"],["2751","9125 36528 1448 32578 17181"],["2762","3165 9336 26046 28102 19668"],["2764","30287 11366 17086 22245 21073"],["2772","31556 5926 2523 28462 6561"],["2775","34163 9336 28237 7463 17878"],["2776","26951 322 16339 843 32287"],["2782","33400 17074 12298 9476 19542"],["2784","12766 18457 21878 758 31205"],["2785","36927 2616 33246 14508 36521"],["2795","30096 11149 22294 25533 33550"],["2800","713 1007 25059 28814 32983"],["2801","20234 19004 35860 20731 579"],["2808","14660 34125 26529 5889 9893"],["2812","31559 6450 8420 2980 15557"],["2813","8482 4746 24786 30428 31713"],["2816","32656 21717 30185 26109 22894"],["2823","35154 9336 23785 34619 18055"],["2829","21765 9894 2381 21196 16414"],["2830","34222 31038 22199 12852 34018"],["2832","32485 4010 23020 25990 12863"],["2835","33009 14553 15009 22724 28415"],["2837","2053 5164 19668 5734 2339"],["2839","34869 33014 23976 5901 10024"],["2843","37053 23386 1247 21091 5969"],["2845","36757 17578 91 14192 7463"],["2850","30385 24804 36835 35359 36263"],["2860","35860 22811 9333 33375 32203"],["2862","35020 20878 31695 7188 33220"],["2865","330 781 899 943 1098"],["2867","1470 35712 33327 36098 8932"],["2869","9570 31451 21025 5818 57"],["2875","31695 26191 7107 16219 13649"],["2877","330 781 899 943 1098"],["2880","18405 37053 14660 19808 5889"],["2883","33340 18001 16356 35065 18801"],["2884","27088 19304 18001 21175 23211"],["2886","10712 5734 24698 1470 11708"],["2888","33660 2031 27935 20264 31699"],["2895","11327 25070 29059 25663 13069"],["2903","32287 843 7342 16304 35065"],["2904","330 781 899 943 1098"],["2908","33220 373 17207 228 10698"],["2909","31085 1934 7392 27860 16238"],["2914","23922 22405 5970 18648 36927"],["2917","10343 3820 36003 18456 36628"],["2921","228 22149 24834 9222 27358"],["2926","14875 17557 18605 21277 30094"],["2933","13284 1097 36552 36645 20048"],["2935","34889 22811 26119 33831 33564"],["2951","17383 5723 17648 2134 14616"],["2957","33732 5861 14660 76 28449"],["2964","1212 21311 5805 7463 24668"],["2967","12354 13241 34686 10278 22894"],["2968","28462 6561 2053 18801 34949"],["2978","18648 33376 31512 1934 17608"],["2985","20947 24356 19704 6330 36266"],["2990","5157 5970 30925 24349 28153"],["2993","13797 9578 30287 9863 2148"],["2996","8384 27414 32731 21541 21094"],["2997","15700 10924 23302 3764 30159"],["2998","852 35154 24450 2046 11010"],["3001","5589 14595 6706 28157 33564"],["3003","27610 1448 9070 11887 9125"],["3014","27571 7350 13281 6199 33288"],["3017","3719 8292 9677 22407 19004"],["3019","16525 24031 16579 7984 7498"],["3020","32591 37053 12669 13284 7393"],["3023","9163 2134 18200 12894 10446"],["3028","16148 31963 24352 35189 14023"],["3032","12766 21878 758 31365 36266"],["3041","14264 28568 12264 2953 29805"],["3043","21212 6099 29695 33708 10076"],["3050","21490 16821 27355 37036 6708"],["3056","9969 16845 11058 28724 13094"],["3057","17717 6385 4042 15671 1705"],["3059","8791 36663 26743 18319 17332"],["3064","21667 13098 17235 30096 23368"],["3065","8823 26025 5167 3549 17186"],["3066","1335 27711 7889 21344 28860"],["3069","14714 19013 13094 18565 30746"],["3071","7463 29404 12991 36841 11072"],["3072","21976 21637 34482 13284 32857"],["3073","7392 3165 8233 13797 31085"],["3074","23391 31937 33858 32046 16566"],["3077","12669 18558 19668 5889 7393"],["3082","5403 9677 27148 22407 22759"],["3091","32914 17608 16238 18648 36170"],["3093","816 31341 33106 13284 16307"],["3095","30812 15182 20919 14593 34086"],["3098","7445 4019 22806 2519 4168"],["3101","27950 9336 18170 14684 23330"],["3104","8216 20526 17383 6473 12582"],["3105","24760 26046 9336 28575 27244"],["3106","7161 14583 28607 26307 29452"],["3107","8037 35133 27833 33102 2711"],["3108","10355 6094 7816 14657 11730"],["3113","19052 25735 31276 21768 35475"],["3118","14264 14020 14535 8959 16733"],["3123","30287 21167 17792 6484 26491"],["3127","28462 37053 2523 14660 18405"],["3133","35293 22863 19263 31989 5278"],["3137","4468 29169 1543 3719 29068"],["3157","6949 15667 26406 35902 5370"],["3163","28039 26984 25286 35592 25852"],["3165","23049 7223 24933 15278 9862"],["3166","24971 2924 27610 14790 29988"],["3167","24359 9849 5798 31190 545"],["3168","31796 9336 30096 24516 35331"],["3173","1265 13522 19460 30607 31115"],["3180","34813 32703 28677 11618 4583"],["3188","16962 25938 10032 10082 16184"],["3189","24281 31828 23901 33220 25626"],["3190","7138 11247 14792 10488 36157"],["3191","5744 5861 21063 14538 25286"],["3192","32980 29534 19604 1520 35592"],["3195","14312 18468 26191 5292 8423"],["3198","18170 2523 2339 27833 2836"],["3201","4476 15681 36344 25241 30530"],["3202","9877 21084 26133 27832 26342"],["3203","17044 15530 22330 22408 5850"],["3206","7393 8671 33014 6821 31085"],["3212","515 5340 24608 2825 12373"],["3214","10254 3514 36220 17975 3719"],["3216","29384 22870 29747 24919 3265"],["3218","7393 37053 33674 6312 33376"],["3221","31695 33220 28587 23836 21907"],["3227","25886 21495 21187 14583 775"],["3229","30767 25074 30096 17236 9951"],["3240","5575 17611 34829 36521 27275"],["3243","423 438 16074 22535 31828"],["3244","8040 26713 34222 3343 34657"],["3248","3505 29570 3366 8146 21442"],["3249","32877 19668 3953 35860 12368"],["3250","9893 21040 30726 34458 34619"],["3253","1212 29364 33102 28498 33840"],["3256","21961 13495 19259 22515 34766"],["3260","7897 4410 11350 23884 13595"],["3265","24170 28675 1899 15108 30358"],["3273","15831 30475 9216 24467 24350"],["3279","30253 4765 21844 26465 3456"],["3281","21846 2053 26658 25506 35281"],["3287","31611 7434 31512 4157 33376"],["3294","19716 15674 25976 32631 15800"],["3296","10706 6152 31157 25134 15350"],["3298","32980 29534 19604 1520 35592"],["3302","7679 22713 14101 20025 17359"],["3304","11678 19505 19961 20128 8231"],["3309","12305 21441 33562 31057 5827"],["3319","23981 26468 32046 4600 22424"],["3320","36503 30096 31512 13902 31889"],["3324","17172 20171 34949 30098 4955"],["3325","28701 4933 23220 16939 15523"],["3326","2041 2049 26983 24433 23179"],["3328","24898 17044 29421 35831 4423"],["3330","32287 843 1289 30674 31085"],["3332","17359 8642 14101 23779 3295"],["3336","29209 21945 12671 18213 13029"],["3350","9074 26585 4833 36843 14583"],["3351","9928 6381 19668 20824 2829"],["3354","9194 31085 20048 19991 23049"],["3358","15917 11413 29805 11253 27744"],["3360","31085 11072 4485 9893 32938"],["3361","6561 30925 21038 5926 18170"],["3364","37053 34869 13284 12669 14169"],["3374","9504 5639 20789 26267 35096"],["3376","13284 28643 21788 4162 14192"],["3378","8234 22263 21152 19925 34621"],["3379","36362 26621 26815 23340 34619"],["3387","27971 31291 37056 18181 24404"],["3392","25886 22338 11064 9699 20991"],["3396","36420 37053 16123 17281 10724"],["3402","330 781 899 943 1098"],["3407","34164 11153 30485 19077 8096"],["3411","19242 26346 10488 20484 36855"],["3413","7138 32343 28568 18001 10620"],["3418","16172 28257 19052 6035 33532"],["3421","8040 33480 13740 18549 22904"],["3422","28568 6152 27610 14792 843"],["3424","34823 9292 11739 13276 31179"],["3434","17089 27319 25877 12867 27432"],["3435","27221 23580 15954 34351 1434"],["3438","20380 19668 9913 26173 5279"],["3439","25853 21239 14450 1771 22860"],["3452","31085 25421 535 19996 10246"],["3455","26658 23008 21412 33298 25512"],["3459","27953 26619 36902 17679 35913"],["3461","24230 31020 9459 4170 3946"],["3464","26745 30650 27068 10208 26769"],["3468","16090 19323 19938 29747 12824"],["3469","3921 35516 8292 31283 17465"],["3474","27477 21495 15274 18170 36533"],["3475","30208 12524 17794 4476 13903"],["3482","36504 11448 23958 30039 33119"],["3487","24933 17030 6497 12290 17359"],["3488","37108 13208 36749 9126 11423"],["3492","6205 29645 14583 16030 10413"],["3496","36192 13819 15278 33675 6235"],["3505","29588 1416 3222 23772 19072"],["3511","31512 37108 22232 10946 5391"],["3513","6821 24488 17529 2924 9570"],["3518","37053 22870 18316 22811 7393"],["3523","34829 3826 34119 27663 8634"],["3525","25663 1156 6561 18170 7886"],["3528","19668 34642 30851 23081 30676"],["3532","36192 8488 34739 34715 36263"],["3540","28415 29201 4750 549 24654"],["3543","20283 10741 35300 14709 17529"],["3548","23001 10522 31971 27356 7086"],["3550","15258 25666 7144 13335 33883"],["3552","9490 21159 27583 6192 30892"],["3558","7340 1971 9395 32908 8231"],["3560","3869 8148 28462 31366 19808"],["3561","23833 1448 17107 266 12851"],["3563","24519 20878 31695 30156 3163"],["3564","35559 9336 31512 31420 1212"],["3565","23833 15274 3216 19242 22909"],["3572","26948 35708 32484 19008 1649"],["3581","21788 9476 34930 20737 18544"],["3582","23378 32690 17384 8596 18160"],["3583","7796 15918 1378 20116 35805"],["3587","3413 11092 9069 18985 26109"],["3591","31611 2616 264 31486 25663"],["3592","32656 7519 14293 20526 19938"],["3596","28197 7546 11871 8711 11081"],["3602","2523 22807 8205 26658 22330"],["3604","14949 36975 23291 781 36261"]],"arguments":{},"addedWidgets":{},"removedWidgets":[],"schema":[{"name":"userId","type":"\"string\""},{"name":"RecommendedItemIds","type":"\"string\""}],"overflow":true,"aggData":[],"aggSchema":[],"aggOverflow":false,"aggSeriesLimitReached":false,"aggError":"","aggType":"","plotOptions":null,"isJsonSchema":true,"dbfsResultPath":"dbfs:/databricks-results/440968250896240/part-00000","datasetInfos":[],"columnCustomDisplayInfos":{}},"errorSummary":"Command skipped","error":null,"workflows":[],"startTime":1499166841403,"submitTime":1499166841387,"finishTime":1499166842707,"collapsed":false,"bindings":{},"inputWidgets":{},"displayType":"table","width":"auto","height":"auto","xColumns":null,"yColumns":null,"pivotColumns":null,"pivotAggregation":null,"customPlotOptions":{},"commentThread":[],"commentsVisible":false,"parentHierarchy":[],"diffInserts":[],"diffDeletes":[],"globalVars":{},"latestUser":"amarildolikmeta@gmail.com","latestUserId":null,"commandTitle":"","showCommandTitle":false,"hideCommandCode":false,"hideCommandResult":false,"iPythonMetadata":null,"streamStates":{},"datasetPreviewNameToCmdIdMap":{},"nuid":"f329d7eb-168d-4d58-a077-35b68cdd07f6"},{"version":"CommandV1","origId":440968250896241,"guid":"a7ad696d-0284-4c5c-b051-96cc832a78cc","subtype":"command","commandType":"auto","position":26.0,"command":"print 7","commandVersion":0,"state":"finished","results":{"type":"html","data":"<div class=\"ansiout\">7\n</div>","arguments":{},"addedWidgets":{},"removedWidgets":[],"datasetInfos":[]},"errorSummary":"Command skipped","error":null,"workflows":[],"startTime":1499163433321,"submitTime":1499161098770,"finishTime":1499163433398,"collapsed":false,"bindings":{},"inputWidgets":{},"displayType":"table","width":"auto","height":"auto","xColumns":null,"yColumns":null,"pivotColumns":null,"pivotAggregation":null,"customPlotOptions":{},"commentThread":[],"commentsVisible":false,"parentHierarchy":[],"diffInserts":[],"diffDeletes":[],"globalVars":{},"latestUser":"amarildolikmeta@gmail.com","latestUserId":null,"commandTitle":"","showCommandTitle":false,"hideCommandCode":false,"hideCommandResult":false,"iPythonMetadata":null,"streamStates":{},"datasetPreviewNameToCmdIdMap":{},"nuid":"9e33116a-67cf-4d92-835b-e5bc72d2acee"},{"version":"CommandV1","origId":2043221726472608,"guid":"d35f2649-d419-43a9-b4db-8b56c23ba703","subtype":"command","commandType":"auto","position":18.5,"command":"commonItems=list(set(itemList)&set(featuredItemsList))","commandVersion":0,"state":"finished","results":{"type":"html","data":"<div class=\"ansiout\"></div>","arguments":{},"addedWidgets":{},"removedWidgets":[],"datasetInfos":[]},"errorSummary":null,"error":null,"workflows":[],"startTime":1499161275210,"submitTime":1499161098593,"finishTime":1499161275266,"collapsed":false,"bindings":{},"inputWidgets":{},"displayType":"table","width":"auto","height":"auto","xColumns":null,"yColumns":null,"pivotColumns":null,"pivotAggregation":null,"customPlotOptions":{},"commentThread":[],"commentsVisible":false,"parentHierarchy":[],"diffInserts":[],"diffDeletes":[],"globalVars":{},"latestUser":"amarildolikmeta@gmail.com","latestUserId":null,"commandTitle":"","showCommandTitle":false,"hideCommandCode":false,"hideCommandResult":false,"iPythonMetadata":null,"streamStates":{},"datasetPreviewNameToCmdIdMap":{},"nuid":"c5b819ba-af1e-4082-a8e5-3a0c719c58a2"},{"version":"CommandV1","origId":2043221726472609,"guid":"b020d31e-bb91-4890-9a28-7cac485c36ba","subtype":"command","commandType":"auto","position":18.75,"command":"commonItems[0:5]","commandVersion":0,"state":"finished","results":{"type":"html","data":"<div class=\"ansiout\"><span class=\"ansired\">Out[</span><span class=\"ansired\">25</span><span class=\"ansired\">]: </span>[u&apos;11542&apos;, u&apos;11543&apos;, u&apos;11540&apos;, u&apos;11541&apos;, u&apos;11546&apos;]\n</div>","arguments":{},"addedWidgets":{},"removedWidgets":[],"datasetInfos":[]},"errorSummary":null,"error":null,"workflows":[],"startTime":1499161275271,"submitTime":1499161098598,"finishTime":1499161275315,"collapsed":false,"bindings":{},"inputWidgets":{},"displayType":"table","width":"auto","height":"auto","xColumns":null,"yColumns":null,"pivotColumns":null,"pivotAggregation":null,"customPlotOptions":{},"commentThread":[],"commentsVisible":false,"parentHierarchy":[],"diffInserts":[],"diffDeletes":[],"globalVars":{},"latestUser":"amarildolikmeta@gmail.com","latestUserId":null,"commandTitle":"","showCommandTitle":false,"hideCommandCode":false,"hideCommandResult":false,"iPythonMetadata":null,"streamStates":{},"datasetPreviewNameToCmdIdMap":{},"nuid":"dac2e440-314d-478e-95ae-b07b631cc321"},{"version":"CommandV1","origId":2346192297036124,"guid":"6b34496e-46c7-471f-994c-3615ae4acf0c","subtype":"command","commandType":"auto","position":19.5,"command":"from math import sqrt\ndef itemRatingSimilarity(item1,item2):\n  item1=str(item1)\n  item2=str(item2)\n  itemRaters1=set(itemRaters_dict[item1])\n  itemRaters2=set(itemRaters_dict[item2])\n  commonRaters=itemRaters1&itemRaters2\n  commonRaters=list(commonRaters)\n  if len(commonRaters)==0:\n    return 0\n  shrink=7\n  numerator_value=len(commonRaters)\n  sum1=sqrt(len(itemRaters1))\n  sum2=sqrt(len(itemRaters2))\n  denominator_value=shrink+sum1*sum2\n  r = numerator_value / denominator_value\n  return r","commandVersion":0,"state":"finished","results":{"type":"html","data":"<div class=\"ansiout\"></div>","arguments":{},"addedWidgets":{},"removedWidgets":[],"datasetInfos":[]},"errorSummary":"Command skipped","error":null,"workflows":[],"startTime":1499161278368,"submitTime":1499161098623,"finishTime":1499161278439,"collapsed":false,"bindings":{},"inputWidgets":{},"displayType":"table","width":"auto","height":"auto","xColumns":null,"yColumns":null,"pivotColumns":null,"pivotAggregation":null,"customPlotOptions":{},"commentThread":[],"commentsVisible":false,"parentHierarchy":[],"diffInserts":[],"diffDeletes":[],"globalVars":{},"latestUser":"amarildolikmeta@gmail.com","latestUserId":null,"commandTitle":"","showCommandTitle":false,"hideCommandCode":false,"hideCommandResult":false,"iPythonMetadata":null,"streamStates":{},"datasetPreviewNameToCmdIdMap":{},"nuid":"7e37d658-2b32-4803-8158-a292c3f1d123"},{"version":"CommandV1","origId":2346192297036125,"guid":"4ddbf149-3de0-4b50-82e4-9d99bf3e0c2d","subtype":"command","commandType":"auto","position":19.25,"command":"itemRaters=trainRDD.map(lambda x:(x[1],[x[0]]))\nitemRaters=itemRaters.reduceByKey(lambda x,y:x+y)\nitemRaters_dict=itemRaters.collectAsMap()\nitemRaters_dict[\"1145\"]","commandVersion":0,"state":"finished","results":{"type":"html","data":"<div class=\"ansiout\"><span class=\"ansired\">Out[</span><span class=\"ansired\">27</span><span class=\"ansired\">]: </span>[u&apos;9252&apos;, u&apos;12822&apos;]\n</div>","arguments":{},"addedWidgets":{},"removedWidgets":[],"datasetInfos":[]},"errorSummary":"Command skipped","error":null,"workflows":[],"startTime":1499161275349,"submitTime":1499161098608,"finishTime":1499161276868,"collapsed":false,"bindings":{},"inputWidgets":{},"displayType":"table","width":"auto","height":"auto","xColumns":null,"yColumns":null,"pivotColumns":null,"pivotAggregation":null,"customPlotOptions":{},"commentThread":[],"commentsVisible":false,"parentHierarchy":[],"diffInserts":[],"diffDeletes":[],"globalVars":{},"latestUser":"amarildolikmeta@gmail.com","latestUserId":null,"commandTitle":"","showCommandTitle":false,"hideCommandCode":false,"hideCommandResult":false,"iPythonMetadata":null,"streamStates":{},"datasetPreviewNameToCmdIdMap":{},"nuid":"16e2d3a3-2f75-49bd-91f2-3a32242dbdea"},{"version":"CommandV1","origId":2346192297036126,"guid":"e1504c34-b69c-4c30-bf72-b7a8295d597a","subtype":"command","commandType":"auto","position":19.375,"command":"userAverages=trainRDD.map(lambda x:(x[0],(float(x[2]),1)))\nuserAverages=userAverages.reduceByKey(lambda x,y:(x[0]+y[0],x[1]+y[1]))\nuserAverages=userAverages.map(lambda x:(x[0],x[1][0]/x[1][1]))\nuserAverages_dict=userAverages.collectAsMap()","commandVersion":0,"state":"finished","results":{"type":"html","data":"<div class=\"ansiout\"></div>","arguments":{},"addedWidgets":{},"removedWidgets":[],"datasetInfos":[]},"errorSummary":"Command skipped","error":null,"workflows":[],"startTime":1499161276873,"submitTime":1499161098613,"finishTime":1499161278284,"collapsed":false,"bindings":{},"inputWidgets":{},"displayType":"table","width":"auto","height":"auto","xColumns":null,"yColumns":null,"pivotColumns":null,"pivotAggregation":null,"customPlotOptions":{},"commentThread":[],"commentsVisible":false,"parentHierarchy":[],"diffInserts":[],"diffDeletes":[],"globalVars":{},"latestUser":"amarildolikmeta@gmail.com","latestUserId":null,"commandTitle":"","showCommandTitle":false,"hideCommandCode":false,"hideCommandResult":false,"iPythonMetadata":null,"streamStates":{},"datasetPreviewNameToCmdIdMap":{},"nuid":"0c812761-9c29-4af6-98f2-658cb4f82fea"},{"version":"CommandV1","origId":2346192297036127,"guid":"283da00f-e7ac-421f-80a6-87501edd7f94","subtype":"command","commandType":"auto","position":19.4375,"command":"userAverages_dict[\"4\"]","commandVersion":0,"state":"finished","results":{"type":"html","data":"<div class=\"ansiout\"><span class=\"ansired\">Out[</span><span class=\"ansired\">29</span><span class=\"ansired\">]: </span>9.0\n</div>","arguments":{},"addedWidgets":{},"removedWidgets":[],"datasetInfos":[]},"errorSummary":"Command skipped","error":null,"workflows":[],"startTime":1499161278290,"submitTime":1499161098618,"finishTime":1499161278363,"collapsed":false,"bindings":{},"inputWidgets":{},"displayType":"table","width":"auto","height":"auto","xColumns":null,"yColumns":null,"pivotColumns":null,"pivotAggregation":null,"customPlotOptions":{},"commentThread":[],"commentsVisible":false,"parentHierarchy":[],"diffInserts":[],"diffDeletes":[],"globalVars":{},"latestUser":"amarildolikmeta@gmail.com","latestUserId":null,"commandTitle":"","showCommandTitle":false,"hideCommandCode":false,"hideCommandResult":false,"iPythonMetadata":null,"streamStates":{},"datasetPreviewNameToCmdIdMap":{},"nuid":"aa861b9b-05e2-4c55-937f-ed6a308cfc0b"},{"version":"CommandV1","origId":2346192297036128,"guid":"30d84f58-b84b-4fbd-ae2f-e10d8b5dea1d","subtype":"command","commandType":"auto","position":19.75,"command":"itemRatingSimilarity(15,98)","commandVersion":0,"state":"finished","results":{"type":"html","data":"<div class=\"ansiout\"><span class=\"ansired\">Out[</span><span class=\"ansired\">31</span><span class=\"ansired\">]: </span>0\n</div>","arguments":{},"addedWidgets":{},"removedWidgets":[],"datasetInfos":[]},"errorSummary":"Command skipped","error":null,"workflows":[],"startTime":1499161278444,"submitTime":1499161098627,"finishTime":1499161278484,"collapsed":false,"bindings":{},"inputWidgets":{},"displayType":"table","width":"auto","height":"auto","xColumns":null,"yColumns":null,"pivotColumns":null,"pivotAggregation":null,"customPlotOptions":{},"commentThread":[],"commentsVisible":false,"parentHierarchy":[],"diffInserts":[],"diffDeletes":[],"globalVars":{},"latestUser":"amarildolikmeta@gmail.com","latestUserId":null,"commandTitle":"","showCommandTitle":false,"hideCommandCode":false,"hideCommandResult":false,"iPythonMetadata":null,"streamStates":{},"datasetPreviewNameToCmdIdMap":{},"nuid":"355e0b10-d141-4768-b9c7-a2518ad9ce96"},{"version":"CommandV1","origId":2717149371605260,"guid":"d77678e4-116c-47df-b313-fb1f72898751","subtype":"command","commandType":"auto","position":13.5,"command":"from scipy import spatial\n\ndef itemFeatureWeightedSimilarity(item1,item2):\n  try:\n    featuresItems1=set(features_dict[item1])\n    featuresItems2=set(features_dict[item2])\n    totalFeatures=featuresItems1&featuresItems2\n    totalFeatures=list(totalFeatures)\n    shrink=5;\n    ratings1=list(totalFeatures)\n    if len(totalFeatures)==0:\n      return 0\n    for i in xrange(len(totalFeatures)):\n      try:\n        ratings1[i]=float((maxKey-0.5*featuresWeight_dict[totalFeatures[i]])/maxKey)\n      except:\n        ratings1[i]=0.5\n     \n    numerator_value = sum(ratings1)/(len(totalFeatures)+shrink)#/len(ratings1)+\n    return numerator_value\n    #len1=sqrt(len(featuresItems1))\n    #len2=sqrt(len(featuresItems2))\n    #denominator_value = len1*len2\n    #if denominator_value == 0:\n      #return 0\n    #else:\n      #r = numerator_value / (denominator_value+shrink)\n      #return r\n  except:\n    return 0","commandVersion":0,"state":"finished","results":{"type":"html","data":"<div class=\"ansiout\"></div>","arguments":{},"addedWidgets":{},"removedWidgets":[],"datasetInfos":[]},"errorSummary":"Command skipped","error":null,"workflows":[],"startTime":1499161272284,"submitTime":1499161098558,"finishTime":1499161272415,"collapsed":false,"bindings":{},"inputWidgets":{},"displayType":"table","width":"auto","height":"auto","xColumns":null,"yColumns":null,"pivotColumns":null,"pivotAggregation":null,"customPlotOptions":{},"commentThread":[],"commentsVisible":false,"parentHierarchy":[],"diffInserts":[],"diffDeletes":[],"globalVars":{},"latestUser":"amarildolikmeta@gmail.com","latestUserId":null,"commandTitle":"","showCommandTitle":false,"hideCommandCode":false,"hideCommandResult":false,"iPythonMetadata":null,"streamStates":{},"datasetPreviewNameToCmdIdMap":{},"nuid":"350da18c-1961-4421-8d7d-260c19db8f76"},{"version":"CommandV1","origId":2717149371605261,"guid":"a175dae7-46b5-4d93-b71a-0059307c40d4","subtype":"command","commandType":"auto","position":12.5,"command":"featuresWeight=features.map(lambda x:(x[1],1))\nfeaturesWeight=featuresWeight.reduceByKey(lambda x,y:x+y)\nfeaturesWeight_dict=featuresWeight.collectAsMap()\nfeaturesWeight_dict[1]","commandVersion":0,"state":"finished","results":{"type":"html","data":"<div class=\"ansiout\"><span class=\"ansired\">Out[</span><span class=\"ansired\">14</span><span class=\"ansired\">]: </span>9\n</div>","arguments":{},"addedWidgets":{},"removedWidgets":[],"datasetInfos":[]},"errorSummary":"<span class=\"ansired\">NameError</span>: name &apos;features&apos; is not defined","error":null,"workflows":[],"startTime":1499161269507,"submitTime":1499161098544,"finishTime":1499161270616,"collapsed":false,"bindings":{},"inputWidgets":{},"displayType":"table","width":"auto","height":"auto","xColumns":null,"yColumns":null,"pivotColumns":null,"pivotAggregation":null,"customPlotOptions":{},"commentThread":[],"commentsVisible":false,"parentHierarchy":[],"diffInserts":[],"diffDeletes":[],"globalVars":{},"latestUser":"amarildolikmeta@gmail.com","latestUserId":null,"commandTitle":"","showCommandTitle":false,"hideCommandCode":false,"hideCommandResult":false,"iPythonMetadata":null,"streamStates":{},"datasetPreviewNameToCmdIdMap":{},"nuid":"9239ad5a-fb0c-4152-bf7a-d321b004f563"},{"version":"CommandV1","origId":2717149371605264,"guid":"5367d6a0-fe47-44d5-b3ab-028fa06c1b03","subtype":"command","commandType":"auto","position":12.75,"command":"maxKey = featuresWeight.max(lambda x:x[1])\nmaxKey","commandVersion":0,"state":"finished","results":{"type":"html","data":"<div class=\"ansiout\"><span class=\"ansired\">Out[</span><span class=\"ansired\">15</span><span class=\"ansired\">]: </span>(18904, 19413)\n</div>","arguments":{},"addedWidgets":{},"removedWidgets":[],"datasetInfos":[]},"errorSummary":"<span class=\"ansired\">TypeError</span>: &apos;tuple&apos; object is not callable","error":null,"workflows":[],"startTime":1499161270623,"submitTime":1499161098549,"finishTime":1499161270747,"collapsed":false,"bindings":{},"inputWidgets":{},"displayType":"table","width":"auto","height":"auto","xColumns":null,"yColumns":null,"pivotColumns":null,"pivotAggregation":null,"customPlotOptions":{},"commentThread":[],"commentsVisible":false,"parentHierarchy":[],"diffInserts":[],"diffDeletes":[],"globalVars":{},"latestUser":"amarildolikmeta@gmail.com","latestUserId":null,"commandTitle":"","showCommandTitle":false,"hideCommandCode":false,"hideCommandResult":false,"iPythonMetadata":null,"streamStates":{},"datasetPreviewNameToCmdIdMap":{},"nuid":"6eb7c22d-3403-4695-a32d-81daacd86e18"},{"version":"CommandV1","origId":2717149371605265,"guid":"ddedb8d9-d48e-47a2-a9c5-215b034353af","subtype":"command","commandType":"auto","position":13.75,"command":"itemFeatureWeightedSimilarity(\"15\",\"87\")","commandVersion":0,"state":"finished","results":{"type":"html","data":"<div class=\"ansiout\"><span class=\"ansired\">Out[</span><span class=\"ansired\">18</span><span class=\"ansired\">]: </span>0.14285714285714285\n</div>","arguments":{},"addedWidgets":{},"removedWidgets":[],"datasetInfos":[]},"errorSummary":"<span class=\"ansired\">NameError</span>: global name &apos;ratings1&apos; is not defined","error":null,"workflows":[],"startTime":1499161272421,"submitTime":1499161098563,"finishTime":1499161272444,"collapsed":false,"bindings":{},"inputWidgets":{},"displayType":"table","width":"auto","height":"auto","xColumns":null,"yColumns":null,"pivotColumns":null,"pivotAggregation":null,"customPlotOptions":{},"commentThread":[],"commentsVisible":false,"parentHierarchy":[],"diffInserts":[],"diffDeletes":[],"globalVars":{},"latestUser":"amarildolikmeta@gmail.com","latestUserId":null,"commandTitle":"","showCommandTitle":false,"hideCommandCode":false,"hideCommandResult":false,"iPythonMetadata":null,"streamStates":{},"datasetPreviewNameToCmdIdMap":{},"nuid":"ca2b764b-3ba6-40e4-ad4e-5c802ce37611"},{"version":"CommandV1","origId":3718471498079359,"guid":"5d1787aa-178a-4759-b915-c0ab453fb7a3","subtype":"command","commandType":"auto","position":27.0,"command":"","commandVersion":0,"state":"finished","results":null,"errorSummary":null,"error":null,"workflows":[],"startTime":0,"submitTime":0,"finishTime":0,"collapsed":false,"bindings":{},"inputWidgets":{},"displayType":"table","width":"auto","height":"auto","xColumns":null,"yColumns":null,"pivotColumns":null,"pivotAggregation":null,"customPlotOptions":{},"commentThread":[],"commentsVisible":false,"parentHierarchy":[],"diffInserts":[],"diffDeletes":[],"globalVars":{},"latestUser":"","latestUserId":null,"commandTitle":"","showCommandTitle":false,"hideCommandCode":false,"hideCommandResult":false,"iPythonMetadata":null,"streamStates":{},"datasetPreviewNameToCmdIdMap":{},"nuid":"0bfe3097-bd7f-4fc8-a98c-81d16ed3fc46"},{"version":"CommandV1","origId":3847477642681558,"guid":"75e88e7d-8515-4d58-997b-9ee9bd10973f","subtype":"command","commandType":"auto","position":20.5,"command":"def ContentFiltering(userId):\n  userId=str(userId)\n  seenItems = np.array(userSeenItems_dict[userId])\n  reccomendedList=[]\n  reccomendedItems=[]\n  for item in userRatingsList_dict[userId]:\n    similar=getSimilarItems(userId,item,seenItems)\n    for tup in similar:\n      if tup[0] not in seenItems and tup[0] not in reccomendedItems :\n        reccomendedItems.append(tup[0])\n        reccomendedList.append(tup)\n  reccomendedList = sorted(reccomendedList, key=lambda tup: tup[1],reverse=True)\n  reccomendedList=[ seq[0] for seq in reccomendedList ]\n  #reccomendedList=list(set(reccomendedList))\n  return [userId,reccomendedList[0:numberOfItemsToRecommend]]","commandVersion":0,"state":"finished","results":{"type":"html","data":"<div class=\"ansiout\"></div>","arguments":{},"addedWidgets":{},"removedWidgets":[],"datasetInfos":[]},"errorSummary":"Command skipped","error":null,"workflows":[],"startTime":1499161278579,"submitTime":1499161098643,"finishTime":1499161278619,"collapsed":false,"bindings":{},"inputWidgets":{},"displayType":"table","width":"auto","height":"auto","xColumns":null,"yColumns":null,"pivotColumns":null,"pivotAggregation":null,"customPlotOptions":{},"commentThread":[],"commentsVisible":false,"parentHierarchy":[],"diffInserts":[],"diffDeletes":[],"globalVars":{},"latestUser":"amarildolikmeta@gmail.com","latestUserId":null,"commandTitle":"","showCommandTitle":false,"hideCommandCode":false,"hideCommandResult":false,"iPythonMetadata":null,"streamStates":{},"datasetPreviewNameToCmdIdMap":{},"nuid":"03ce6004-b93f-4363-9b6e-62b30e7d7fa3"},{"version":"CommandV1","origId":3847477642681559,"guid":"4babdaa7-87e7-47f1-9004-60b9d6c7cf6e","subtype":"command","commandType":"auto","position":20.25,"command":"def getSimilarItems(user,item,seenItems):\n  rating=userRatings_dict[user][item]\n  similar=[]\n  for i in commonItems:\n    if i not in seenItems:\n      similarity=itemFeatureWeightedSimilarity(item,i)\n      rate=similarity*rating\n      if rate!=0:\n        similar.append((str(i),rate))\n  similar = sorted(similar, key=lambda tup: tup[1],reverse=True)\n  if len(similar)>10:\n    return similar[0:10]\n  else:\n    return similar","commandVersion":0,"state":"finished","results":{"type":"html","data":"<div class=\"ansiout\"></div>","arguments":{},"addedWidgets":{},"removedWidgets":[],"datasetInfos":[]},"errorSummary":"Command skipped","error":null,"workflows":[],"startTime":1499161278546,"submitTime":1499161098637,"finishTime":1499161278574,"collapsed":false,"bindings":{},"inputWidgets":{},"displayType":"table","width":"auto","height":"auto","xColumns":null,"yColumns":null,"pivotColumns":null,"pivotAggregation":null,"customPlotOptions":{},"commentThread":[],"commentsVisible":false,"parentHierarchy":[],"diffInserts":[],"diffDeletes":[],"globalVars":{},"latestUser":"amarildolikmeta@gmail.com","latestUserId":null,"commandTitle":"","showCommandTitle":false,"hideCommandCode":false,"hideCommandResult":false,"iPythonMetadata":null,"streamStates":{},"datasetPreviewNameToCmdIdMap":{},"nuid":"c30952d6-10fa-45fc-9512-9cc789051115"},{"version":"CommandV1","origId":3847477642681560,"guid":"81ac8178-d3f1-4acf-9dac-2e5524c633ac","subtype":"command","commandType":"auto","position":21.25,"command":"def Rec(userId):\n  a= ContentFiltering(userId)\n  b= CollaborativeItemFiltering(userId)\n  try:\n    c=a[1][2]\n    a[1]=a[1][0:2]\n    for i in xrange(len(b[1])):\n      if b[1][i] not in a[1] and b[1][i]!=c:\n        a[1].append(b[1][i])\n    a[1][numberOfItemsToRecommend-1]=c\n    a[1]=a[1][0:numberOfItemsToRecommend]\n    return a\n  except:\n    return a","commandVersion":0,"state":"finished","results":{"type":"html","data":"<div class=\"ansiout\"></div>","arguments":{},"addedWidgets":{},"removedWidgets":[],"datasetInfos":[]},"errorSummary":"Command skipped","error":null,"workflows":[],"startTime":1499161282242,"submitTime":1499161098653,"finishTime":1499161282281,"collapsed":false,"bindings":{},"inputWidgets":{},"displayType":"table","width":"auto","height":"auto","xColumns":null,"yColumns":null,"pivotColumns":null,"pivotAggregation":null,"customPlotOptions":{},"commentThread":[],"commentsVisible":false,"parentHierarchy":[],"diffInserts":[],"diffDeletes":[],"globalVars":{},"latestUser":"amarildolikmeta@gmail.com","latestUserId":null,"commandTitle":"","showCommandTitle":false,"hideCommandCode":false,"hideCommandResult":false,"iPythonMetadata":null,"streamStates":{},"datasetPreviewNameToCmdIdMap":{},"nuid":"b0c02e9d-5433-448e-b2cf-395c74096982"},{"version":"CommandV1","origId":3847477642681561,"guid":"a06581b5-92ab-4393-a24d-5d6317498dc7","subtype":"command","commandType":"auto","position":21.375,"command":"Rec(\"5\")","commandVersion":0,"state":"finished","results":{"type":"html","data":"<div class=\"ansiout\"><span class=\"ansired\">Out[</span><span class=\"ansired\">37</span><span class=\"ansired\">]: </span>[&apos;5&apos;, [&apos;1269&apos;, &apos;10&apos;, u&apos;37053&apos;, u&apos;33939&apos;, &apos;2762&apos;]]\n</div>","arguments":{},"addedWidgets":{},"removedWidgets":[],"datasetInfos":[]},"errorSummary":"Command skipped","error":null,"workflows":[],"startTime":1499161282286,"submitTime":1499161098658,"finishTime":1499161287445,"collapsed":false,"bindings":{},"inputWidgets":{},"displayType":"table","width":"auto","height":"auto","xColumns":null,"yColumns":null,"pivotColumns":null,"pivotAggregation":null,"customPlotOptions":{},"commentThread":[],"commentsVisible":false,"parentHierarchy":[],"diffInserts":[],"diffDeletes":[],"globalVars":{},"latestUser":"amarildolikmeta@gmail.com","latestUserId":null,"commandTitle":"","showCommandTitle":false,"hideCommandCode":false,"hideCommandResult":false,"iPythonMetadata":null,"streamStates":{},"datasetPreviewNameToCmdIdMap":{},"nuid":"3fad1125-9853-47da-b0b4-34e48ab500c8"}],"dashboards":[],"guid":"f4aec0d8-817f-4639-8878-1c75751e718d","globalVars":{},"iPythonMetadata":null,"inputWidgets":{}}