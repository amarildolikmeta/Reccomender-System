{"version":"NotebookV1","origId":726631496901523,"name":"Reccomandation","language":"python","commands":[{"version":"CommandV1","origId":726631496901525,"guid":"ec097a32-09cd-4edf-80a7-2ba931debc70","subtype":"command","commandType":"auto","position":1.0,"command":"numberOfItemsToRecommend=5","commandVersion":0,"state":"finished","results":{"type":"html","data":"<div class=\"ansiout\"></div>","arguments":{},"addedWidgets":{},"removedWidgets":[],"datasetInfos":[]},"errorSummary":null,"error":null,"workflows":[],"startTime":1497444101917,"submitTime":1497444064212,"finishTime":1497444102099,"collapsed":false,"bindings":{},"inputWidgets":{},"displayType":"table","width":"auto","height":"auto","xColumns":null,"yColumns":null,"pivotColumns":null,"pivotAggregation":null,"customPlotOptions":{},"commentThread":[],"commentsVisible":false,"parentHierarchy":[],"diffInserts":[],"diffDeletes":[],"globalVars":{},"latestUser":"amarildolikmeta@gmail.com","latestUserId":null,"commandTitle":"","showCommandTitle":false,"hideCommandCode":false,"hideCommandResult":false,"iPythonMetadata":null,"streamStates":{},"datasetPreviewNameToCmdIdMap":{},"nuid":"b3a49914-1cda-44b2-88bb-ec2cdc4eca3a"},{"version":"CommandV1","origId":726631496901552,"guid":"71704cf5-d766-486a-88fe-3ad252340768","subtype":"command","commandType":"auto","position":2.0,"command":"train=sqlContext.sql(\"SELECT * from train\")\ntrainRDD=train.rdd","commandVersion":0,"state":"finished","results":{"type":"html","data":"<div class=\"ansiout\"></div>","arguments":{},"addedWidgets":{},"removedWidgets":[],"datasetInfos":[]},"errorSummary":null,"error":null,"workflows":[],"startTime":1497444169242,"submitTime":1497444169223,"finishTime":1497444171468,"collapsed":false,"bindings":{},"inputWidgets":{},"displayType":"table","width":"auto","height":"auto","xColumns":null,"yColumns":null,"pivotColumns":null,"pivotAggregation":null,"customPlotOptions":{},"commentThread":[],"commentsVisible":false,"parentHierarchy":[],"diffInserts":[],"diffDeletes":[],"globalVars":{},"latestUser":"amarildolikmeta@gmail.com","latestUserId":null,"commandTitle":"","showCommandTitle":false,"hideCommandCode":false,"hideCommandResult":false,"iPythonMetadata":null,"streamStates":{},"datasetPreviewNameToCmdIdMap":{},"nuid":"ea2a4ca0-21e7-4c62-9492-221508e85b65"},{"version":"CommandV1","origId":726631496901553,"guid":"aa366596-3850-4dae-b058-401f9411b1fb","subtype":"command","commandType":"auto","position":3.0,"command":"testRDD=sqlContext.sql(\"Select * from target\").rdd.map(lambda x:x[0])\ntestList=testRDD.sortBy(lambda x:float(x))","commandVersion":0,"state":"finished","results":{"type":"html","data":"<div class=\"ansiout\"></div>","arguments":{},"addedWidgets":{},"removedWidgets":[],"datasetInfos":[]},"errorSummary":null,"error":null,"workflows":[],"startTime":1497444185653,"submitTime":1497444185634,"finishTime":1497444186027,"collapsed":false,"bindings":{},"inputWidgets":{},"displayType":"table","width":"auto","height":"auto","xColumns":null,"yColumns":null,"pivotColumns":null,"pivotAggregation":null,"customPlotOptions":{},"commentThread":[],"commentsVisible":false,"parentHierarchy":[],"diffInserts":[],"diffDeletes":[],"globalVars":{},"latestUser":"amarildolikmeta@gmail.com","latestUserId":null,"commandTitle":"","showCommandTitle":false,"hideCommandCode":false,"hideCommandResult":false,"iPythonMetadata":null,"streamStates":{},"datasetPreviewNameToCmdIdMap":{},"nuid":"636f045e-2cb3-4076-8378-a04b298f3b9a"},{"version":"CommandV1","origId":726631496901554,"guid":"0a3c690a-ea35-4dc8-9f66-2c0cc9122210","subtype":"command","commandType":"auto","position":4.0,"command":"userSeenItems = trainRDD.map(lambda x: (x[0], [x[1]])).reduceByKey(lambda x,y : x+y)\nuserSeenItems_dict = userSeenItems.collectAsMap()","commandVersion":0,"state":"finished","results":{"type":"html","data":"<div class=\"ansiout\"></div>","arguments":{},"addedWidgets":{},"removedWidgets":[],"datasetInfos":[]},"errorSummary":null,"error":null,"workflows":[],"startTime":1497444195462,"submitTime":1497444195446,"finishTime":1497444199896,"collapsed":false,"bindings":{},"inputWidgets":{},"displayType":"table","width":"auto","height":"auto","xColumns":null,"yColumns":null,"pivotColumns":null,"pivotAggregation":null,"customPlotOptions":{},"commentThread":[],"commentsVisible":false,"parentHierarchy":[],"diffInserts":[],"diffDeletes":[],"globalVars":{},"latestUser":"amarildolikmeta@gmail.com","latestUserId":null,"commandTitle":"","showCommandTitle":false,"hideCommandCode":false,"hideCommandResult":false,"iPythonMetadata":null,"streamStates":{},"datasetPreviewNameToCmdIdMap":{},"nuid":"d45e27bb-f510-4f63-b893-cc5da3d9f3c2"},{"version":"CommandV1","origId":726631496901555,"guid":"873091eb-4d04-4362-9d34-2200df74cfd0","subtype":"command","commandType":"auto","position":5.0,"command":"#ratings=trainRDD.sqlContext.sql(\"Select itemId ,sum(rating)/(count(rating)+5) as AvgRating from train group by itemId order by AvgRating desc\").rdd\nratings=trainRDD.map(lambda x:(x[1],(float(x[2]),1))).reduceByKey(lambda x,y:(x[0]+y[0],x[1]+y[1]))","commandVersion":0,"state":"finished","results":{"type":"html","data":"<div class=\"ansiout\"></div>","arguments":{},"addedWidgets":{},"removedWidgets":[],"datasetInfos":[]},"errorSummary":null,"error":null,"workflows":[],"startTime":1497445386964,"submitTime":1497445386952,"finishTime":1497445387036,"collapsed":false,"bindings":{},"inputWidgets":{},"displayType":"table","width":"auto","height":"auto","xColumns":null,"yColumns":null,"pivotColumns":null,"pivotAggregation":null,"customPlotOptions":{},"commentThread":[],"commentsVisible":false,"parentHierarchy":[],"diffInserts":[],"diffDeletes":[],"globalVars":{},"latestUser":"amarildolikmeta@gmail.com","latestUserId":null,"commandTitle":"","showCommandTitle":false,"hideCommandCode":false,"hideCommandResult":false,"iPythonMetadata":null,"streamStates":{},"datasetPreviewNameToCmdIdMap":{},"nuid":"bdf3459f-a196-4e91-926f-7c2ec77ab7ab"},{"version":"CommandV1","origId":726631496901556,"guid":"d0b97788-1fa6-47a1-8016-cddee9eeb36d","subtype":"command","commandType":"auto","position":6.0,"command":"AvgItemratings_dict=ratings.map(lambda x:(x[0],float(x[1]))).collectAsMap()","commandVersion":0,"state":"finished","results":{"type":"html","data":"<div class=\"ansiout\"></div>","arguments":{},"addedWidgets":{},"removedWidgets":[],"datasetInfos":[]},"errorSummary":null,"error":null,"workflows":[],"startTime":1497445357872,"submitTime":1497445357859,"finishTime":1497445358098,"collapsed":false,"bindings":{},"inputWidgets":{},"displayType":"table","width":"auto","height":"auto","xColumns":null,"yColumns":null,"pivotColumns":null,"pivotAggregation":null,"customPlotOptions":{},"commentThread":[],"commentsVisible":false,"parentHierarchy":[],"diffInserts":[],"diffDeletes":[],"globalVars":{},"latestUser":"amarildolikmeta@gmail.com","latestUserId":null,"commandTitle":"","showCommandTitle":false,"hideCommandCode":false,"hideCommandResult":false,"iPythonMetadata":null,"streamStates":{},"datasetPreviewNameToCmdIdMap":{},"nuid":"d204002f-5dbc-4fb2-939e-f1d921e6fa11"},{"version":"CommandV1","origId":726631496901557,"guid":"b330b679-5d84-4160-807d-4e0e4867a2bb","subtype":"command","commandType":"auto","position":5.5,"command":"ratings=ratings.map(lambda x:(x[0],x[1][0]/(x[1][1]+5)))\nratings.take(5)","commandVersion":0,"state":"finished","results":{"type":"html","data":"<div class=\"ansiout\"><span class=\"ansired\">Out[</span><span class=\"ansired\">31</span><span class=\"ansired\">]: </span>\n[(u&apos;11542&apos;, 3.1818181818181817),\n (u&apos;11543&apos;, 1.375),\n (u&apos;11540&apos;, 0.5),\n (u&apos;11541&apos;, 0.5),\n (u&apos;11546&apos;, 3.0)]\n</div>","arguments":{},"addedWidgets":{},"removedWidgets":[],"datasetInfos":[]},"errorSummary":null,"error":null,"workflows":[],"startTime":1497445390416,"submitTime":1497445390399,"finishTime":1497445392531,"collapsed":false,"bindings":{},"inputWidgets":{},"displayType":"table","width":"auto","height":"auto","xColumns":null,"yColumns":null,"pivotColumns":null,"pivotAggregation":null,"customPlotOptions":{},"commentThread":[],"commentsVisible":false,"parentHierarchy":[],"diffInserts":[],"diffDeletes":[],"globalVars":{},"latestUser":"amarildolikmeta@gmail.com","latestUserId":null,"commandTitle":"","showCommandTitle":false,"hideCommandCode":false,"hideCommandResult":false,"iPythonMetadata":null,"streamStates":{},"datasetPreviewNameToCmdIdMap":{},"nuid":"d322fed3-082b-4640-a1fe-595c3a0e4094"},{"version":"CommandV1","origId":726631496901559,"guid":"ba0fd506-eb52-4f81-be90-1819f7e663f6","subtype":"command","commandType":"auto","position":7.0,"command":"AvgItemratings_dict[\"15\"]","commandVersion":0,"state":"finished","results":{"type":"html","data":"<div class=\"ansiout\"><span class=\"ansired\">Out[</span><span class=\"ansired\">13</span><span class=\"ansired\">]: </span>1.6666666666666667\n</div>","arguments":{},"addedWidgets":{},"removedWidgets":[],"datasetInfos":[]},"errorSummary":null,"error":null,"workflows":[],"startTime":1497444843324,"submitTime":1497444843306,"finishTime":1497444843397,"collapsed":false,"bindings":{},"inputWidgets":{},"displayType":"table","width":"auto","height":"auto","xColumns":null,"yColumns":null,"pivotColumns":null,"pivotAggregation":null,"customPlotOptions":{},"commentThread":[],"commentsVisible":false,"parentHierarchy":[],"diffInserts":[],"diffDeletes":[],"globalVars":{},"latestUser":"amarildolikmeta@gmail.com","latestUserId":null,"commandTitle":"","showCommandTitle":false,"hideCommandCode":false,"hideCommandResult":false,"iPythonMetadata":null,"streamStates":{},"datasetPreviewNameToCmdIdMap":{},"nuid":"5f5aa41f-87ae-462d-b01d-01c115802281"},{"version":"CommandV1","origId":726631496901560,"guid":"8aa8c6af-02da-48b5-9b3c-2f430e07c73f","subtype":"command","commandType":"auto","position":8.0,"command":"ratings=ratings.map(lambda x:str(x[0])).collect()","commandVersion":0,"state":"finished","results":{"type":"html","data":"<div class=\"ansiout\"></div>","arguments":{},"addedWidgets":{},"removedWidgets":[],"datasetInfos":[]},"errorSummary":null,"error":null,"workflows":[],"startTime":1497445631907,"submitTime":1497445631895,"finishTime":1497445632131,"collapsed":false,"bindings":{},"inputWidgets":{},"displayType":"table","width":"auto","height":"auto","xColumns":null,"yColumns":null,"pivotColumns":null,"pivotAggregation":null,"customPlotOptions":{},"commentThread":[],"commentsVisible":false,"parentHierarchy":[],"diffInserts":[],"diffDeletes":[],"globalVars":{},"latestUser":"amarildolikmeta@gmail.com","latestUserId":null,"commandTitle":"","showCommandTitle":false,"hideCommandCode":false,"hideCommandResult":false,"iPythonMetadata":null,"streamStates":{},"datasetPreviewNameToCmdIdMap":{},"nuid":"11836122-97cd-45a7-8671-dedb42484fd7"},{"version":"CommandV1","origId":726631496901561,"guid":"9a811094-63f2-41d2-bde9-f7ebf5ae650e","subtype":"command","commandType":"auto","position":9.0,"command":"ratings=np.array(ratings)","commandVersion":0,"state":"finished","results":{"type":"html","data":"<div class=\"ansiout\"></div>","arguments":{},"addedWidgets":{},"removedWidgets":[],"datasetInfos":[]},"errorSummary":"<span class=\"ansired\">NameError</span>: name &apos;np&apos; is not defined","error":"<div class=\"ansiout\"><span class=\"ansired\">---------------------------------------------------------------------------</span>\n<span class=\"ansired\">NameError</span>                                 Traceback (most recent call last)\n<span class=\"ansigreen\">&lt;ipython-input-15-a5f3202d3cbc&gt;</span> in <span class=\"ansicyan\">&lt;module&gt;</span><span class=\"ansiblue\">()</span>\n<span class=\"ansigreen\">----&gt; 1</span><span class=\"ansiyellow\"> </span>ratings<span class=\"ansiyellow\">=</span>np<span class=\"ansiyellow\">.</span>array<span class=\"ansiyellow\">(</span>ratings<span class=\"ansiyellow\">)</span><span class=\"ansiyellow\"></span>\n\n<span class=\"ansired\">NameError</span>: name &apos;np&apos; is not defined</div>","workflows":[],"startTime":1497445635007,"submitTime":1497445634995,"finishTime":1497445635078,"collapsed":false,"bindings":{},"inputWidgets":{},"displayType":"table","width":"auto","height":"auto","xColumns":null,"yColumns":null,"pivotColumns":null,"pivotAggregation":null,"customPlotOptions":{},"commentThread":[],"commentsVisible":false,"parentHierarchy":[],"diffInserts":[],"diffDeletes":[],"globalVars":{},"latestUser":"amarildolikmeta@gmail.com","latestUserId":null,"commandTitle":"","showCommandTitle":false,"hideCommandCode":false,"hideCommandResult":false,"iPythonMetadata":null,"streamStates":{},"datasetPreviewNameToCmdIdMap":{},"nuid":"34f77037-9b6e-40fe-96be-e561489502da"},{"version":"CommandV1","origId":726631496901562,"guid":"f8d77c77-cbdb-4cd7-8fef-b524116907af","subtype":"command","commandType":"auto","position":10.0,"command":"averageGlobalRating=trainRDD.map(lambda x:float(x[2])).mean()\naverageGlobalRating","commandVersion":0,"state":"finished","results":{"type":"html","data":"<div class=\"ansiout\"><span class=\"ansired\">Out[</span><span class=\"ansired\">39</span><span class=\"ansired\">]: </span>6.81887639656998\n</div>","arguments":{},"addedWidgets":{},"removedWidgets":[],"datasetInfos":[]},"errorSummary":null,"error":null,"workflows":[],"startTime":1497445638539,"submitTime":1497445638527,"finishTime":1497445640954,"collapsed":false,"bindings":{},"inputWidgets":{},"displayType":"table","width":"auto","height":"auto","xColumns":null,"yColumns":null,"pivotColumns":null,"pivotAggregation":null,"customPlotOptions":{},"commentThread":[],"commentsVisible":false,"parentHierarchy":[],"diffInserts":[],"diffDeletes":[],"globalVars":{},"latestUser":"amarildolikmeta@gmail.com","latestUserId":null,"commandTitle":"","showCommandTitle":false,"hideCommandCode":false,"hideCommandResult":false,"iPythonMetadata":null,"streamStates":{},"datasetPreviewNameToCmdIdMap":{},"nuid":"3e155ef3-dd6a-45ae-b0db-007df8fcc3d6"},{"version":"CommandV1","origId":726631496901563,"guid":"30288988-84fa-475e-9050-b148852e482a","subtype":"command","commandType":"auto","position":0.5,"command":"import numpy as np\nimport pandas as pd \nfrom math import sqrt ","commandVersion":0,"state":"finished","results":{"type":"html","data":"<div class=\"ansiout\"></div>","arguments":{},"addedWidgets":{},"removedWidgets":[],"datasetInfos":[]},"errorSummary":null,"error":null,"workflows":[],"startTime":1497444891462,"submitTime":1497444891438,"finishTime":1497444891705,"collapsed":false,"bindings":{},"inputWidgets":{},"displayType":"table","width":"auto","height":"auto","xColumns":null,"yColumns":null,"pivotColumns":null,"pivotAggregation":null,"customPlotOptions":{},"commentThread":[],"commentsVisible":false,"parentHierarchy":[],"diffInserts":[],"diffDeletes":[],"globalVars":{},"latestUser":"amarildolikmeta@gmail.com","latestUserId":null,"commandTitle":"","showCommandTitle":false,"hideCommandCode":false,"hideCommandResult":false,"iPythonMetadata":null,"streamStates":{},"datasetPreviewNameToCmdIdMap":{},"nuid":"f2a7a0a8-7c20-4e45-9277-897723899673"},{"version":"CommandV1","origId":726631496901565,"guid":"0c69401e-e934-4e9a-b12b-8cddc6f7dd9f","subtype":"command","commandType":"auto","position":11.0,"command":"userRatings=trainRDD.map(lambda x:(x[0],[(x[1],int(x[2]))])).reduceByKey(lambda x,y:x+y)","commandVersion":0,"state":"finished","results":{"type":"html","data":"<div class=\"ansiout\"></div>","arguments":{},"addedWidgets":{},"removedWidgets":[],"datasetInfos":[]},"errorSummary":null,"error":null,"workflows":[],"startTime":1497445039826,"submitTime":1497445039811,"finishTime":1497445039899,"collapsed":false,"bindings":{},"inputWidgets":{},"displayType":"table","width":"auto","height":"auto","xColumns":null,"yColumns":null,"pivotColumns":null,"pivotAggregation":null,"customPlotOptions":{},"commentThread":[],"commentsVisible":false,"parentHierarchy":[],"diffInserts":[],"diffDeletes":[],"globalVars":{},"latestUser":"amarildolikmeta@gmail.com","latestUserId":null,"commandTitle":"","showCommandTitle":false,"hideCommandCode":false,"hideCommandResult":false,"iPythonMetadata":null,"streamStates":{},"datasetPreviewNameToCmdIdMap":{},"nuid":"cdd2779e-7bdc-498f-82e8-13b90f55e2e2"},{"version":"CommandV1","origId":726631496901566,"guid":"e6002645-869b-4bdc-98ec-c5a0b82d1174","subtype":"command","commandType":"auto","position":12.0,"command":"userRatings.take(5)","commandVersion":0,"state":"finished","results":{"type":"html","data":"<div class=\"ansiout\"><span class=\"ansired\">Out[</span><span class=\"ansired\">20</span><span class=\"ansired\">]: </span>\n[(u&apos;13357&apos;,\n  [(u&apos;8064&apos;, 7), (u&apos;11253&apos;, 9), (u&apos;11254&apos;, 6), (u&apos;25667&apos;, 7), (u&apos;34643&apos;, 5)]),\n (u&apos;4447&apos;, [(u&apos;3788&apos;, 7), (u&apos;6014&apos;, 7)]),\n (u&apos;11542&apos;, [(u&apos;418&apos;, 10), (u&apos;11021&apos;, 8), (u&apos;31910&apos;, 4), (u&apos;36163&apos;, 10)]),\n (u&apos;11543&apos;,\n  [(u&apos;9308&apos;, 10), (u&apos;21655&apos;, 4), (u&apos;23124&apos;, 7), (u&apos;23978&apos;, 7), (u&apos;35095&apos;, 5)]),\n (u&apos;11540&apos;,\n  [(u&apos;10696&apos;, 10),\n   (u&apos;12876&apos;, 10),\n   (u&apos;13752&apos;, 6),\n   (u&apos;21328&apos;, 5),\n   (u&apos;29005&apos;, 9)])]\n</div>","arguments":{},"addedWidgets":{},"removedWidgets":[],"datasetInfos":[]},"errorSummary":null,"error":null,"workflows":[],"startTime":1497445046992,"submitTime":1497445046976,"finishTime":1497445050314,"collapsed":false,"bindings":{},"inputWidgets":{},"displayType":"table","width":"auto","height":"auto","xColumns":null,"yColumns":null,"pivotColumns":null,"pivotAggregation":null,"customPlotOptions":{},"commentThread":[],"commentsVisible":false,"parentHierarchy":[],"diffInserts":[],"diffDeletes":[],"globalVars":{},"latestUser":"amarildolikmeta@gmail.com","latestUserId":null,"commandTitle":"","showCommandTitle":false,"hideCommandCode":false,"hideCommandResult":false,"iPythonMetadata":null,"streamStates":{},"datasetPreviewNameToCmdIdMap":{},"nuid":"e4f951c4-c38d-4fae-b7bd-0531a6f86c96"},{"version":"CommandV1","origId":726631496901567,"guid":"f375f878-47e6-4a9d-9bc1-257da3351016","subtype":"command","commandType":"auto","position":13.0,"command":"userRatings_dict=userRatings.collectAsMap()\nfor key in userRatings_dict:\n  userRatings_dict[key]=dict(userRatings_dict[key])\nuserRatings_dict[\"4446\"][\"14644\"]","commandVersion":0,"state":"finished","results":{"type":"html","data":"<div class=\"ansiout\"><span class=\"ansired\">Out[</span><span class=\"ansired\">21</span><span class=\"ansired\">]: </span>10\n</div>","arguments":{},"addedWidgets":{},"removedWidgets":[],"datasetInfos":[]},"errorSummary":null,"error":null,"workflows":[],"startTime":1497445083093,"submitTime":1497445083078,"finishTime":1497445083680,"collapsed":false,"bindings":{},"inputWidgets":{},"displayType":"table","width":"auto","height":"auto","xColumns":null,"yColumns":null,"pivotColumns":null,"pivotAggregation":null,"customPlotOptions":{},"commentThread":[],"commentsVisible":false,"parentHierarchy":[],"diffInserts":[],"diffDeletes":[],"globalVars":{},"latestUser":"amarildolikmeta@gmail.com","latestUserId":null,"commandTitle":"","showCommandTitle":false,"hideCommandCode":false,"hideCommandResult":false,"iPythonMetadata":null,"streamStates":{},"datasetPreviewNameToCmdIdMap":{},"nuid":"eee5c166-5604-455b-9bbc-8f3c855c3e3d"},{"version":"CommandV1","origId":726631496901568,"guid":"6c2cc126-a3a4-469a-871a-978fc84714b0","subtype":"command","commandType":"auto","position":14.0,"command":"itemList=trainRDD.map(lambda x:x[1]).distinct().collect()\nitemList[0:5]","commandVersion":0,"state":"finished","results":{"type":"html","data":"<div class=\"ansiout\"><span class=\"ansired\">Out[</span><span class=\"ansired\">23</span><span class=\"ansired\">]: </span>[u&apos;11542&apos;, u&apos;11543&apos;, u&apos;11540&apos;, u&apos;11541&apos;, u&apos;11546&apos;]\n</div>","arguments":{},"addedWidgets":{},"removedWidgets":[],"datasetInfos":[]},"errorSummary":"<span class=\"ansired\">TypeError</span>: &apos;PipelinedRDD&apos; object has no attribute &apos;__getitem__&apos;","error":"<div class=\"ansiout\"><span class=\"ansired\">---------------------------------------------------------------------------</span>\n<span class=\"ansired\">TypeError</span>                                 Traceback (most recent call last)\n<span class=\"ansigreen\">&lt;ipython-input-22-e6db62126dda&gt;</span> in <span class=\"ansicyan\">&lt;module&gt;</span><span class=\"ansiblue\">()</span>\n<span class=\"ansigreen\">      1</span> itemList<span class=\"ansiyellow\">=</span>trainRDD<span class=\"ansiyellow\">.</span>map<span class=\"ansiyellow\">(</span><span class=\"ansigreen\">lambda</span> x<span class=\"ansiyellow\">:</span>x<span class=\"ansiyellow\">[</span><span class=\"ansicyan\">1</span><span class=\"ansiyellow\">]</span><span class=\"ansiyellow\">)</span><span class=\"ansiyellow\">.</span>distinct<span class=\"ansiyellow\">(</span><span class=\"ansiyellow\">)</span><span class=\"ansiyellow\"></span>\n<span class=\"ansigreen\">----&gt; 2</span><span class=\"ansiyellow\"> </span>itemList<span class=\"ansiyellow\">[</span><span class=\"ansicyan\">0</span><span class=\"ansiyellow\">:</span><span class=\"ansicyan\">5</span><span class=\"ansiyellow\">]</span><span class=\"ansiyellow\"></span>\n\n<span class=\"ansired\">TypeError</span>: &apos;PipelinedRDD&apos; object has no attribute &apos;__getitem__&apos;</div>","workflows":[],"startTime":1497445153804,"submitTime":1497445153787,"finishTime":1497445155620,"collapsed":false,"bindings":{},"inputWidgets":{},"displayType":"table","width":"auto","height":"auto","xColumns":null,"yColumns":null,"pivotColumns":null,"pivotAggregation":null,"customPlotOptions":{},"commentThread":[],"commentsVisible":false,"parentHierarchy":[],"diffInserts":[],"diffDeletes":[],"globalVars":{},"latestUser":"amarildolikmeta@gmail.com","latestUserId":null,"commandTitle":"","showCommandTitle":false,"hideCommandCode":false,"hideCommandResult":false,"iPythonMetadata":null,"streamStates":{},"datasetPreviewNameToCmdIdMap":{},"nuid":"090ef3cf-241c-4dd1-9f8b-a2c6f417aec1"},{"version":"CommandV1","origId":726631496901569,"guid":"64c1a15d-d3ec-4b51-9df8-6e86c003dfae","subtype":"command","commandType":"auto","position":15.0,"command":"def recommendTopRated(user_id, removeSeen=1):\n    recommendedList = ratings\n    if(removeSeen):\n      seenItems = np.array(userSeenItems_dict[user_id])\n      unseen_mask = np.in1d(recommendedList, seenItems, invert=True)\n      recommendedList = recommendedList[unseen_mask]      \n    return [user_id,recommendedList[0:numberOfItemsToRecommend].tolist()]","commandVersion":0,"state":"finished","results":{"type":"html","data":"<div class=\"ansiout\"></div>","arguments":{},"addedWidgets":{},"removedWidgets":[],"datasetInfos":[]},"errorSummary":null,"error":null,"workflows":[],"startTime":1497445748786,"submitTime":1497445748771,"finishTime":1497445748833,"collapsed":false,"bindings":{},"inputWidgets":{},"displayType":"table","width":"auto","height":"auto","xColumns":null,"yColumns":null,"pivotColumns":null,"pivotAggregation":null,"customPlotOptions":{},"commentThread":[],"commentsVisible":false,"parentHierarchy":[],"diffInserts":[],"diffDeletes":[],"globalVars":{},"latestUser":"amarildolikmeta@gmail.com","latestUserId":null,"commandTitle":"","showCommandTitle":false,"hideCommandCode":false,"hideCommandResult":false,"iPythonMetadata":null,"streamStates":{},"datasetPreviewNameToCmdIdMap":{},"nuid":"aabad2ac-8141-4962-bdd6-bf30654507b6"},{"version":"CommandV1","origId":726631496901570,"guid":"98889281-499c-4bdc-8bb4-4e89de31d965","subtype":"command","commandType":"auto","position":16.0,"command":"recommendTopRated(\"4\")","commandVersion":0,"state":"finished","results":{"type":"html","data":"<div class=\"ansiout\"><span class=\"ansired\">Out[</span><span class=\"ansired\">41</span><span class=\"ansired\">]: </span>[&apos;4&apos;, [&apos;33475&apos;, &apos;33173&apos;, &apos;15743&apos;, &apos;32347&apos;, &apos;1076&apos;]]\n</div>","arguments":{},"addedWidgets":{},"removedWidgets":[],"datasetInfos":[]},"errorSummary":null,"error":null,"workflows":[],"startTime":1497445754208,"submitTime":1497445754197,"finishTime":1497445754284,"collapsed":false,"bindings":{},"inputWidgets":{},"displayType":"table","width":"auto","height":"auto","xColumns":null,"yColumns":null,"pivotColumns":null,"pivotAggregation":null,"customPlotOptions":{},"commentThread":[],"commentsVisible":false,"parentHierarchy":[],"diffInserts":[],"diffDeletes":[],"globalVars":{},"latestUser":"amarildolikmeta@gmail.com","latestUserId":null,"commandTitle":"","showCommandTitle":false,"hideCommandCode":false,"hideCommandResult":false,"iPythonMetadata":null,"streamStates":{},"datasetPreviewNameToCmdIdMap":{},"nuid":"472b9d7a-935b-46c2-8009-3b603c9f66f9"},{"version":"CommandV1","origId":726631496901571,"guid":"99d693df-d027-4ffe-840e-75aaebbddd08","subtype":"command","commandType":"auto","position":17.0,"command":"features=sqlContext.sql(\"Select * from icm \").rdd.map(lambda x:(x[0],x[1]))\nfeatures.take(10)","commandVersion":0,"state":"finished","results":{"type":"html","data":"<div class=\"ansiout\"><span class=\"ansired\">Out[</span><span class=\"ansired\">42</span><span class=\"ansired\">]: </span>\n[(2135, 1),\n (2303, 1),\n (6292, 1),\n (12395, 1),\n (24520, 1),\n (25297, 1),\n (32548, 1),\n (34303, 1),\n (36141, 1),\n (11812, 2)]\n</div>","arguments":{},"addedWidgets":{},"removedWidgets":[],"datasetInfos":[]},"errorSummary":null,"error":null,"workflows":[],"startTime":1497445801697,"submitTime":1497445801685,"finishTime":1497445802626,"collapsed":false,"bindings":{},"inputWidgets":{},"displayType":"table","width":"auto","height":"auto","xColumns":null,"yColumns":null,"pivotColumns":null,"pivotAggregation":null,"customPlotOptions":{},"commentThread":[],"commentsVisible":false,"parentHierarchy":[],"diffInserts":[],"diffDeletes":[],"globalVars":{},"latestUser":"amarildolikmeta@gmail.com","latestUserId":null,"commandTitle":"","showCommandTitle":false,"hideCommandCode":false,"hideCommandResult":false,"iPythonMetadata":null,"streamStates":{},"datasetPreviewNameToCmdIdMap":{},"nuid":"b4170fbe-f5a8-466b-9775-54733ffc7cfb"},{"version":"CommandV1","origId":726631496901572,"guid":"b8104819-7353-4da5-956b-75e5b20b2aa7","subtype":"command","commandType":"auto","position":7.5,"command":"ratings=ratings.sortBy(lambda x:float(x[1]),ascending=False)","commandVersion":0,"state":"finished","results":{"type":"html","data":"<div class=\"ansiout\"></div>","arguments":{},"addedWidgets":{},"removedWidgets":[],"datasetInfos":[]},"errorSummary":"<span class=\"ansired\">TypeError</span>: sortBy() got an unexpected keyword argument &apos;reverse&apos;","error":"<div class=\"ansiout\"><span class=\"ansired\">---------------------------------------------------------------------------</span>\n<span class=\"ansired\">TypeError</span>                                 Traceback (most recent call last)\n<span class=\"ansigreen\">&lt;ipython-input-32-d761603cfab6&gt;</span> in <span class=\"ansicyan\">&lt;module&gt;</span><span class=\"ansiblue\">()</span>\n<span class=\"ansigreen\">----&gt; 1</span><span class=\"ansiyellow\"> </span>ratings<span class=\"ansiyellow\">.</span>sortBy<span class=\"ansiyellow\">(</span><span class=\"ansigreen\">lambda</span> x<span class=\"ansiyellow\">:</span>float<span class=\"ansiyellow\">(</span>x<span class=\"ansiyellow\">[</span><span class=\"ansicyan\">1</span><span class=\"ansiyellow\">]</span><span class=\"ansiyellow\">)</span><span class=\"ansiyellow\">,</span>reverse<span class=\"ansiyellow\">=</span>True<span class=\"ansiyellow\">)</span><span class=\"ansiyellow\"></span>\n\n<span class=\"ansired\">TypeError</span>: sortBy() got an unexpected keyword argument &apos;reverse&apos;</div>","workflows":[],"startTime":1497445623608,"submitTime":1497445623596,"finishTime":1497445623681,"collapsed":false,"bindings":{},"inputWidgets":{},"displayType":"table","width":"auto","height":"auto","xColumns":null,"yColumns":null,"pivotColumns":null,"pivotAggregation":null,"customPlotOptions":{},"commentThread":[],"commentsVisible":false,"parentHierarchy":[],"diffInserts":[],"diffDeletes":[],"globalVars":{},"latestUser":"amarildolikmeta@gmail.com","latestUserId":null,"commandTitle":"","showCommandTitle":false,"hideCommandCode":false,"hideCommandResult":false,"iPythonMetadata":null,"streamStates":{},"datasetPreviewNameToCmdIdMap":{},"nuid":"38ac6e57-e6f2-4db4-af8e-15ec22c61e5c"},{"version":"CommandV1","origId":726631496901573,"guid":"573d7f08-35ea-4601-a433-6c04004db739","subtype":"command","commandType":"auto","position":7.75,"command":"ratings.take(5)","commandVersion":0,"state":"finished","results":{"type":"html","data":"<div class=\"ansiout\"><span class=\"ansired\">Out[</span><span class=\"ansired\">36</span><span class=\"ansired\">]: </span>\n[(u&apos;33475&apos;, 9.116883116883116),\n (u&apos;33173&apos;, 9.023076923076923),\n (u&apos;15743&apos;, 8.725),\n (u&apos;32347&apos;, 8.710144927536232),\n (u&apos;1076&apos;, 8.709677419354838)]\n</div>","arguments":{},"addedWidgets":{},"removedWidgets":[],"datasetInfos":[]},"errorSummary":null,"error":null,"workflows":[],"startTime":1497445625799,"submitTime":1497445625781,"finishTime":1497445626032,"collapsed":false,"bindings":{},"inputWidgets":{},"displayType":"table","width":"auto","height":"auto","xColumns":null,"yColumns":null,"pivotColumns":null,"pivotAggregation":null,"customPlotOptions":{},"commentThread":[],"commentsVisible":false,"parentHierarchy":[],"diffInserts":[],"diffDeletes":[],"globalVars":{},"latestUser":"amarildolikmeta@gmail.com","latestUserId":null,"commandTitle":"","showCommandTitle":false,"hideCommandCode":false,"hideCommandResult":false,"iPythonMetadata":null,"streamStates":{},"datasetPreviewNameToCmdIdMap":{},"nuid":"07c0767a-5556-403c-8048-b6d4ccf9273d"},{"version":"CommandV1","origId":726631496901574,"guid":"60095cad-f642-4bd0-8866-59c207474cc3","subtype":"command","commandType":"auto","position":18.0,"command":"features_dict=features.map(lambda x:(str(x[0]),[x[1]])).reduceByKey(lambda x,y:x+y).collectAsMap() \nfeatures_dict[\"2135\"] #features of item 2135","commandVersion":0,"state":"finished","results":{"type":"html","data":"<div class=\"ansiout\"><span class=\"ansired\">Out[</span><span class=\"ansired\">43</span><span class=\"ansired\">]: </span>[1, 3250, 4715, 5786, 6524, 8317]\n</div>","arguments":{},"addedWidgets":{},"removedWidgets":[],"datasetInfos":[]},"errorSummary":null,"error":null,"workflows":[],"startTime":1497445813678,"submitTime":1497445813662,"finishTime":1497445816214,"collapsed":false,"bindings":{},"inputWidgets":{},"displayType":"table","width":"auto","height":"auto","xColumns":null,"yColumns":null,"pivotColumns":null,"pivotAggregation":null,"customPlotOptions":{},"commentThread":[],"commentsVisible":false,"parentHierarchy":[],"diffInserts":[],"diffDeletes":[],"globalVars":{},"latestUser":"amarildolikmeta@gmail.com","latestUserId":null,"commandTitle":"","showCommandTitle":false,"hideCommandCode":false,"hideCommandResult":false,"iPythonMetadata":null,"streamStates":{},"datasetPreviewNameToCmdIdMap":{},"nuid":"29e23241-ae70-4ac5-a51e-0207a627ed3a"},{"version":"CommandV1","origId":726631496901575,"guid":"4792e036-4027-40d8-a8ea-5266fa0b47a0","subtype":"command","commandType":"auto","position":19.0,"command":"from scipy import spatial\nfrom math import sqrt\ndef itemSimilarity(item1,item2):\n  try :\n    featuresItems1=set(features_dict[item1])\n    featuresItems2=set(features_dict[item2])\n    numerator=len(featuresItems1&featuresItems2)\n    shrink=7\n    sum1=sqrt(len(featuresItems1))\n    sum2=sqrt(len(featuresItems2))\n    #return 1-  spatial.distance.cosine(features1, features2)\n    return numerator/((sum1*sum2)+shrink)\n  except:\n    return 0","commandVersion":0,"state":"finished","results":{"type":"html","data":"<div class=\"ansiout\"></div>","arguments":{},"addedWidgets":{},"removedWidgets":[],"datasetInfos":[]},"errorSummary":null,"error":null,"workflows":[],"startTime":1497447167524,"submitTime":1497447167513,"finishTime":1497447167566,"collapsed":false,"bindings":{},"inputWidgets":{},"displayType":"table","width":"auto","height":"auto","xColumns":null,"yColumns":null,"pivotColumns":null,"pivotAggregation":null,"customPlotOptions":{},"commentThread":[],"commentsVisible":false,"parentHierarchy":[],"diffInserts":[],"diffDeletes":[],"globalVars":{},"latestUser":"amarildolikmeta@gmail.com","latestUserId":null,"commandTitle":"","showCommandTitle":false,"hideCommandCode":false,"hideCommandResult":false,"iPythonMetadata":null,"streamStates":{},"datasetPreviewNameToCmdIdMap":{},"nuid":"07e33bbb-70ec-4e0b-9d1d-1ee5875475d6"},{"version":"CommandV1","origId":726631496901576,"guid":"1435fdaa-4eba-4f57-98af-9e1110cceab3","subtype":"command","commandType":"auto","position":20.0,"command":"itemSimilarity(\"15\",\"17\")","commandVersion":0,"state":"finished","results":{"type":"html","data":"<div class=\"ansiout\"><span class=\"ansired\">Out[</span><span class=\"ansired\">64</span><span class=\"ansired\">]: </span>0.0\n</div>","arguments":{},"addedWidgets":{},"removedWidgets":[],"datasetInfos":[]},"errorSummary":null,"error":null,"workflows":[],"startTime":1497446598093,"submitTime":1497446598084,"finishTime":1497446598132,"collapsed":false,"bindings":{},"inputWidgets":{},"displayType":"table","width":"auto","height":"auto","xColumns":null,"yColumns":null,"pivotColumns":null,"pivotAggregation":null,"customPlotOptions":{},"commentThread":[],"commentsVisible":false,"parentHierarchy":[],"diffInserts":[],"diffDeletes":[],"globalVars":{},"latestUser":"amarildolikmeta@gmail.com","latestUserId":null,"commandTitle":"","showCommandTitle":false,"hideCommandCode":false,"hideCommandResult":false,"iPythonMetadata":null,"streamStates":{},"datasetPreviewNameToCmdIdMap":{},"nuid":"35aeda66-d461-4d77-a04f-0007ad6f62ba"},{"version":"CommandV1","origId":726631496901577,"guid":"4f21cacd-86c0-4cfe-8eca-f0ef454c9ec0","subtype":"command","commandType":"auto","position":21.0,"command":"userRatingsList_dict=userRatings.collectAsMap()\nuserRatingsList_dict[\"15\"]","commandVersion":0,"state":"finished","results":{"type":"html","data":"<div class=\"ansiout\"><span class=\"ansired\">Out[</span><span class=\"ansired\">46</span><span class=\"ansired\">]: </span>[(u&apos;1686&apos;, 9), (u&apos;4949&apos;, 7), (u&apos;13298&apos;, 8), (u&apos;25363&apos;, 9), (u&apos;33993&apos;, 7)]\n</div>","arguments":{},"addedWidgets":{},"removedWidgets":[],"datasetInfos":[]},"errorSummary":null,"error":null,"workflows":[],"startTime":1497446114700,"submitTime":1497446114684,"finishTime":1497446115283,"collapsed":false,"bindings":{},"inputWidgets":{},"displayType":"table","width":"auto","height":"auto","xColumns":null,"yColumns":null,"pivotColumns":null,"pivotAggregation":null,"customPlotOptions":{},"commentThread":[],"commentsVisible":false,"parentHierarchy":[],"diffInserts":[],"diffDeletes":[],"globalVars":{},"latestUser":"amarildolikmeta@gmail.com","latestUserId":null,"commandTitle":"","showCommandTitle":false,"hideCommandCode":false,"hideCommandResult":false,"iPythonMetadata":null,"streamStates":{},"datasetPreviewNameToCmdIdMap":{},"nuid":"ff239c2c-064f-498b-953e-32b39dc57291"},{"version":"CommandV1","origId":726631496901578,"guid":"bd90e3e7-61b0-4fc4-ae8b-089702a15bbf","subtype":"command","commandType":"auto","position":22.0,"command":"for key in userRatingsList_dict:\n  userRatingsList_dict[key]=sorted(userRatingsList_dict[key],key=lambda tup: tup[1],reverse=True)\n  userRatingsList_dict[key]=[ seq[0] for seq in userRatingsList_dict[key] ]\nuserRatingsList_dict[\"15\"]  #OrderFavoriteItemsForEachUser","commandVersion":0,"state":"finished","results":{"type":"html","data":"<div class=\"ansiout\"><span class=\"ansired\">Out[</span><span class=\"ansired\">47</span><span class=\"ansired\">]: </span>[u&apos;1686&apos;, u&apos;25363&apos;, u&apos;13298&apos;, u&apos;4949&apos;, u&apos;33993&apos;]\n</div>","arguments":{},"addedWidgets":{},"removedWidgets":[],"datasetInfos":[]},"errorSummary":null,"error":null,"workflows":[],"startTime":1497446132022,"submitTime":1497446132004,"finishTime":1497446132196,"collapsed":false,"bindings":{},"inputWidgets":{},"displayType":"table","width":"auto","height":"auto","xColumns":null,"yColumns":null,"pivotColumns":null,"pivotAggregation":null,"customPlotOptions":{},"commentThread":[],"commentsVisible":false,"parentHierarchy":[],"diffInserts":[],"diffDeletes":[],"globalVars":{},"latestUser":"amarildolikmeta@gmail.com","latestUserId":null,"commandTitle":"","showCommandTitle":false,"hideCommandCode":false,"hideCommandResult":false,"iPythonMetadata":null,"streamStates":{},"datasetPreviewNameToCmdIdMap":{},"nuid":"747ada0d-9ae4-46fc-826b-1c9dfdecdaa8"},{"version":"CommandV1","origId":726631496901579,"guid":"6fab936f-e27a-406d-aac5-ec620086616a","subtype":"command","commandType":"auto","position":23.0,"command":"def getSimilarItems(user,item,seenItems):\n  rating=userRatings_dict[user][item]\n  similar=[]\n  for i in featuredItemsList:\n    if i not in seenItems:\n      similarity=itemSimilarity(item,i)\n      rate=similarity*rating\n      if rate!=0:\n        similar.append((str(i),rate))\n  similar = sorted(similar, key=lambda tup: tup[1],reverse=True)\n  if len(similar)>10:\n    return similar[0:10]\n  else:\n    return similar","commandVersion":0,"state":"finished","results":{"type":"html","data":"<div class=\"ansiout\"></div>","arguments":{},"addedWidgets":{},"removedWidgets":[],"datasetInfos":[]},"errorSummary":null,"error":null,"workflows":[],"startTime":1497447324554,"submitTime":1497447324542,"finishTime":1497447324636,"collapsed":false,"bindings":{},"inputWidgets":{},"displayType":"table","width":"auto","height":"auto","xColumns":null,"yColumns":null,"pivotColumns":null,"pivotAggregation":null,"customPlotOptions":{},"commentThread":[],"commentsVisible":false,"parentHierarchy":[],"diffInserts":[],"diffDeletes":[],"globalVars":{},"latestUser":"amarildolikmeta@gmail.com","latestUserId":null,"commandTitle":"","showCommandTitle":false,"hideCommandCode":false,"hideCommandResult":false,"iPythonMetadata":null,"streamStates":{},"datasetPreviewNameToCmdIdMap":{},"nuid":"037f65aa-81fa-46b3-b6f9-43543e9084d7"},{"version":"CommandV1","origId":726631496901580,"guid":"b6904910-6839-42ba-8b5c-434fc29819c5","subtype":"command","commandType":"auto","position":24.0,"command":"def ContentFiltering(userId):\n  userId=str(userId)\n  seenItems = np.array(userSeenItems_dict[userId])\n  print seenItems\n  reccomendedList=[]\n  reccomendedItems=[]\n  for item in seenItems:\n    similar=getSimilarItems(userId,item,seenItems)\n    for tup in similar:\n      if tup[0] not in seenItems and tup[0] not in reccomendedItems:\n        reccomendedItems.append(tup[0])\n        reccomendedList.append(tup)\n  reccomendedList = sorted(reccomendedList, key=lambda tup: tup[1],reverse=True)\n  reccomendedList=[ seq[0] for seq in reccomendedList ]\n  #reccomendedList=list(set(reccomendedList))\n  return [userId,reccomendedList[0:numberOfItemsToRecommend]]","commandVersion":0,"state":"finished","results":{"type":"html","data":"<div class=\"ansiout\"></div>","arguments":{},"addedWidgets":{},"removedWidgets":[],"datasetInfos":[]},"errorSummary":null,"error":null,"workflows":[],"startTime":1497447343772,"submitTime":1497447343763,"finishTime":1497447343845,"collapsed":false,"bindings":{},"inputWidgets":{},"displayType":"table","width":"auto","height":"auto","xColumns":null,"yColumns":null,"pivotColumns":null,"pivotAggregation":null,"customPlotOptions":{},"commentThread":[],"commentsVisible":false,"parentHierarchy":[],"diffInserts":[],"diffDeletes":[],"globalVars":{},"latestUser":"amarildolikmeta@gmail.com","latestUserId":null,"commandTitle":"","showCommandTitle":false,"hideCommandCode":false,"hideCommandResult":false,"iPythonMetadata":null,"streamStates":{},"datasetPreviewNameToCmdIdMap":{},"nuid":"19f331f5-2e9a-4e21-859d-5196fb7b0063"},{"version":"CommandV1","origId":726631496901581,"guid":"961943b5-da99-44cf-8492-acef5ae1f9b0","subtype":"command","commandType":"auto","position":25.0,"command":"ContentFiltering(987)","commandVersion":0,"state":"finished","results":{"type":"html","data":"<div class=\"ansiout\">[u&apos;26726&apos;]\n<span class=\"ansired\">Out[</span><span class=\"ansired\">84</span><span class=\"ansired\">]: </span>[&apos;987&apos;, [&apos;30339&apos;, &apos;8648&apos;, &apos;13215&apos;, &apos;18955&apos;, &apos;25367&apos;]]\n</div>","arguments":{},"addedWidgets":{},"removedWidgets":[],"datasetInfos":[]},"errorSummary":"<span class=\"ansired\">NameError</span>: global name &apos;featuredItemsList&apos; is not defined","error":"<div class=\"ansiout\"><span class=\"ansired\">---------------------------------------------------------------------------</span>\n<span class=\"ansired\">NameError</span>                                 Traceback (most recent call last)\n<span class=\"ansigreen\">&lt;ipython-input-50-eabe0421ff7e&gt;</span> in <span class=\"ansicyan\">&lt;module&gt;</span><span class=\"ansiblue\">()</span>\n<span class=\"ansigreen\">----&gt; 1</span><span class=\"ansiyellow\"> </span>ContentFiltering<span class=\"ansiyellow\">(</span><span class=\"ansicyan\">987</span><span class=\"ansiyellow\">)</span><span class=\"ansiyellow\"></span>\n\n<span class=\"ansigreen\">&lt;ipython-input-49-7b5af3398ce2&gt;</span> in <span class=\"ansicyan\">ContentFiltering</span><span class=\"ansiblue\">(userId)</span>\n<span class=\"ansigreen\">      5</span>   reccomendedItems<span class=\"ansiyellow\">=</span><span class=\"ansiyellow\">[</span><span class=\"ansiyellow\">]</span><span class=\"ansiyellow\"></span>\n<span class=\"ansigreen\">      6</span>   <span class=\"ansigreen\">for</span> item <span class=\"ansigreen\">in</span> userRatingsList_dict<span class=\"ansiyellow\">[</span>userId<span class=\"ansiyellow\">]</span><span class=\"ansiyellow\">:</span><span class=\"ansiyellow\"></span>\n<span class=\"ansigreen\">----&gt; 7</span><span class=\"ansiyellow\">     </span>similar<span class=\"ansiyellow\">=</span>getSimilarItems<span class=\"ansiyellow\">(</span>userId<span class=\"ansiyellow\">,</span>item<span class=\"ansiyellow\">,</span>seenItems<span class=\"ansiyellow\">)</span><span class=\"ansiyellow\"></span>\n<span class=\"ansigreen\">      8</span>     <span class=\"ansigreen\">for</span> tup <span class=\"ansigreen\">in</span> similar<span class=\"ansiyellow\">:</span><span class=\"ansiyellow\"></span>\n<span class=\"ansigreen\">      9</span>       <span class=\"ansigreen\">if</span> tup<span class=\"ansiyellow\">[</span><span class=\"ansicyan\">0</span><span class=\"ansiyellow\">]</span> <span class=\"ansigreen\">not</span> <span class=\"ansigreen\">in</span> seenItems <span class=\"ansigreen\">and</span> tup<span class=\"ansiyellow\">[</span><span class=\"ansicyan\">0</span><span class=\"ansiyellow\">]</span> <span class=\"ansigreen\">not</span> <span class=\"ansigreen\">in</span> reccomendedItems<span class=\"ansiyellow\">:</span><span class=\"ansiyellow\"></span>\n\n<span class=\"ansigreen\">&lt;ipython-input-48-6a6952d3ea4f&gt;</span> in <span class=\"ansicyan\">getSimilarItems</span><span class=\"ansiblue\">(user, item, seenItems)</span>\n<span class=\"ansigreen\">      2</span>   rating<span class=\"ansiyellow\">=</span>userRatings_dict<span class=\"ansiyellow\">[</span>user<span class=\"ansiyellow\">]</span><span class=\"ansiyellow\">[</span>item<span class=\"ansiyellow\">]</span><span class=\"ansiyellow\"></span>\n<span class=\"ansigreen\">      3</span>   similar<span class=\"ansiyellow\">=</span><span class=\"ansiyellow\">[</span><span class=\"ansiyellow\">]</span><span class=\"ansiyellow\"></span>\n<span class=\"ansigreen\">----&gt; 4</span><span class=\"ansiyellow\">   </span><span class=\"ansigreen\">for</span> i <span class=\"ansigreen\">in</span> featuredItemsList<span class=\"ansiyellow\">:</span><span class=\"ansiyellow\"></span>\n<span class=\"ansigreen\">      5</span>     <span class=\"ansigreen\">if</span> i <span class=\"ansigreen\">not</span> <span class=\"ansigreen\">in</span> seenItems<span class=\"ansiyellow\">:</span><span class=\"ansiyellow\"></span>\n<span class=\"ansigreen\">      6</span>       similarity<span class=\"ansiyellow\">=</span>itemSimilarity<span class=\"ansiyellow\">(</span>item<span class=\"ansiyellow\">,</span>i<span class=\"ansiyellow\">)</span><span class=\"ansiyellow\"></span>\n\n<span class=\"ansired\">NameError</span>: global name &apos;featuredItemsList&apos; is not defined</div>","workflows":[],"startTime":1497447357401,"submitTime":1497447357383,"finishTime":1497447357948,"collapsed":false,"bindings":{},"inputWidgets":{},"displayType":"table","width":"auto","height":"auto","xColumns":null,"yColumns":null,"pivotColumns":null,"pivotAggregation":null,"customPlotOptions":{},"commentThread":[],"commentsVisible":false,"parentHierarchy":[],"diffInserts":[],"diffDeletes":[],"globalVars":{},"latestUser":"amarildolikmeta@gmail.com","latestUserId":null,"commandTitle":"","showCommandTitle":false,"hideCommandCode":false,"hideCommandResult":false,"iPythonMetadata":null,"streamStates":{},"datasetPreviewNameToCmdIdMap":{},"nuid":"bc6093f8-17e6-4fe8-a42c-bf0171aeb9cc"},{"version":"CommandV1","origId":726631496901582,"guid":"012db3c3-63a3-43e4-a754-8001e6508f7f","subtype":"command","commandType":"auto","position":26.0,"command":"recomendationsContent=sc.parallelize(testList.toLocalIterator()).map(ContentFiltering).collect()","commandVersion":0,"state":"error","results":{"type":"html","data":"<div class=\"ansiout\"></div>","arguments":{},"addedWidgets":{},"removedWidgets":[],"datasetInfos":[]},"errorSummary":"Cancelled","error":null,"workflows":[],"startTime":1497447422372,"submitTime":1497447422372,"finishTime":1497447426291,"collapsed":false,"bindings":{},"inputWidgets":{},"displayType":"table","width":"auto","height":"auto","xColumns":null,"yColumns":null,"pivotColumns":null,"pivotAggregation":null,"customPlotOptions":{},"commentThread":[],"commentsVisible":false,"parentHierarchy":[],"diffInserts":[],"diffDeletes":[],"globalVars":{},"latestUser":"amarildolikmeta@gmail.com","latestUserId":null,"commandTitle":"","showCommandTitle":false,"hideCommandCode":false,"hideCommandResult":false,"iPythonMetadata":null,"streamStates":{},"datasetPreviewNameToCmdIdMap":{},"nuid":"c741150c-c776-4442-b1b5-072b1acd3a14"},{"version":"CommandV1","origId":726631496901583,"guid":"67120d16-14e7-4cc1-aa9e-fd0e39917be4","subtype":"command","commandType":"auto","position":20.5,"command":"featuredItems=features.map(lambda x:str(x[0])).distinct()\nfeaturedItemsList=featuredItems.collect()\nfeaturedItemsList[0:10]","commandVersion":0,"state":"finished","results":{"type":"html","data":"<div class=\"ansiout\"><span class=\"ansired\">Out[</span><span class=\"ansired\">79</span><span class=\"ansired\">]: </span>\n[&apos;11542&apos;,\n &apos;11543&apos;,\n &apos;11540&apos;,\n &apos;11541&apos;,\n &apos;11546&apos;,\n &apos;11547&apos;,\n &apos;11544&apos;,\n &apos;11545&apos;,\n &apos;11548&apos;,\n &apos;11549&apos;]\n</div>","arguments":{},"addedWidgets":{},"removedWidgets":[],"datasetInfos":[]},"errorSummary":null,"error":null,"workflows":[],"startTime":1497447296548,"submitTime":1497447296531,"finishTime":1497447299471,"collapsed":false,"bindings":{},"inputWidgets":{},"displayType":"table","width":"auto","height":"auto","xColumns":null,"yColumns":null,"pivotColumns":null,"pivotAggregation":null,"customPlotOptions":{},"commentThread":[],"commentsVisible":false,"parentHierarchy":[],"diffInserts":[],"diffDeletes":[],"globalVars":{},"latestUser":"amarildolikmeta@gmail.com","latestUserId":null,"commandTitle":"","showCommandTitle":false,"hideCommandCode":false,"hideCommandResult":false,"iPythonMetadata":null,"streamStates":{},"datasetPreviewNameToCmdIdMap":{},"nuid":"173d1ef5-fd49-4883-ac5a-9074de2afc86"},{"version":"CommandV1","origId":726631496901589,"guid":"2cb52188-e6a5-46c3-b6dd-f6bdcffa013b","subtype":"command","commandType":"auto","position":27.0,"command":"recomendations=recomendationsContent\nusers=[]\nrecs=[]\n\nfor i in xrange(len(recomendations)):\n  try:\n    users.append([recomendations[i][0],str(recomendations[i][1][0])+\" \"+str(recomendations[i][1][1])+\" \"+str(recomendations[i][1][2])+\" \"+str(recomendations[i][1][3])+\" \"+str(recomendations[i][1][4])])\n  except:\n    recomendations[i][1]=recomendations[i][1]+recommendTopRated(recomendations[i][0])[1]\n    recomendations[i][1]=recomendations[i][1][0:5]\n    print(recomendations[i][1])\n  recs.append(recomendations[i][1])","commandVersion":0,"state":"error","results":{"type":"html","data":"<div class=\"ansiout\"></div>","arguments":{},"addedWidgets":{},"removedWidgets":[],"datasetInfos":[]},"errorSummary":"<span class=\"ansired\">NameError</span>: name &apos;recomendationsContent&apos; is not defined","error":"<div class=\"ansiout\"><span class=\"ansired\">---------------------------------------------------------------------------</span>\n<span class=\"ansired\">NameError</span>                                 Traceback (most recent call last)\n<span class=\"ansigreen\">&lt;ipython-input-86-979a4abf634e&gt;</span> in <span class=\"ansicyan\">&lt;module&gt;</span><span class=\"ansiblue\">()</span>\n<span class=\"ansigreen\">----&gt; 1</span><span class=\"ansiyellow\"> </span>recomendations<span class=\"ansiyellow\">=</span>recomendationsContent<span class=\"ansiyellow\"></span>\n<span class=\"ansigreen\">      2</span> users<span class=\"ansiyellow\">=</span><span class=\"ansiyellow\">[</span><span class=\"ansiyellow\">]</span><span class=\"ansiyellow\"></span>\n<span class=\"ansigreen\">      3</span> recs<span class=\"ansiyellow\">=</span><span class=\"ansiyellow\">[</span><span class=\"ansiyellow\">]</span><span class=\"ansiyellow\"></span>\n<span class=\"ansigreen\">      4</span> <span class=\"ansiyellow\"></span>\n<span class=\"ansigreen\">      5</span> <span class=\"ansigreen\">for</span> i <span class=\"ansigreen\">in</span> xrange<span class=\"ansiyellow\">(</span>len<span class=\"ansiyellow\">(</span>recomendations<span class=\"ansiyellow\">)</span><span class=\"ansiyellow\">)</span><span class=\"ansiyellow\">:</span><span class=\"ansiyellow\"></span>\n\n<span class=\"ansired\">NameError</span>: name &apos;recomendationsContent&apos; is not defined</div>","workflows":[],"startTime":1497447457771,"submitTime":1497447457771,"finishTime":1497447457945,"collapsed":false,"bindings":{},"inputWidgets":{},"displayType":"table","width":"auto","height":"auto","xColumns":null,"yColumns":null,"pivotColumns":null,"pivotAggregation":null,"customPlotOptions":{},"commentThread":[],"commentsVisible":false,"parentHierarchy":[],"diffInserts":[],"diffDeletes":[],"globalVars":{},"latestUser":"amarildolikmeta@gmail.com","latestUserId":null,"commandTitle":"","showCommandTitle":false,"hideCommandCode":false,"hideCommandResult":false,"iPythonMetadata":null,"streamStates":{},"datasetPreviewNameToCmdIdMap":{},"nuid":"5879e0de-c051-41df-91af-8d7393c31b50"},{"version":"CommandV1","origId":726631496901590,"guid":"b82bf2c3-466d-4ffb-92da-8d0213d954a6","subtype":"command","commandType":"auto","position":28.0,"command":"","commandVersion":0,"state":"finished","results":null,"errorSummary":null,"error":null,"workflows":[],"startTime":0,"submitTime":0,"finishTime":0,"collapsed":false,"bindings":{},"inputWidgets":{},"displayType":"table","width":"auto","height":"auto","xColumns":null,"yColumns":null,"pivotColumns":null,"pivotAggregation":null,"customPlotOptions":{},"commentThread":[],"commentsVisible":false,"parentHierarchy":[],"diffInserts":[],"diffDeletes":[],"globalVars":{},"latestUser":"","latestUserId":null,"commandTitle":"","showCommandTitle":false,"hideCommandCode":false,"hideCommandResult":false,"iPythonMetadata":null,"streamStates":{},"datasetPreviewNameToCmdIdMap":{},"nuid":"a55d1b3f-432e-4e09-b7ef-c35b49132380"}],"dashboards":[],"guid":"8aabb4e9-aff3-4a1c-a45c-26bd2aa1187d","globalVars":{},"iPythonMetadata":null,"inputWidgets":{}}