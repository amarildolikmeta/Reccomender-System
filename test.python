{"version":"NotebookV1","origId":1564474118230699,"name":"test","language":"python","commands":[{"version":"CommandV1","origId":416077177050655,"guid":"a022a8a6-d711-411f-a65b-44e092cb2483","subtype":"command","commandType":"auto","position":32.875,"command":"itemBias_sortedRatings=np.array(itemBias_sorted.map(lambda x:x[1]).collect())","commandVersion":0,"state":"error","results":null,"errorSummary":"Command skipped","error":null,"workflows":[],"startTime":1494837701474,"submitTime":1494837701474,"finishTime":1494837761594,"collapsed":false,"bindings":{},"inputWidgets":{},"displayType":"table","width":"auto","height":"auto","xColumns":null,"yColumns":null,"pivotColumns":null,"pivotAggregation":null,"customPlotOptions":{},"commentThread":[],"commentsVisible":false,"parentHierarchy":[],"diffInserts":[],"diffDeletes":[],"globalVars":{},"latestUser":"amarildolikmeta@gmail.com","latestUserId":null,"commandTitle":"","showCommandTitle":false,"hideCommandCode":false,"hideCommandResult":false,"iPythonMetadata":null,"streamStates":{},"datasetPreviewNameToCmdIdMap":{},"nuid":"fd7f54db-ec68-477f-ba72-3c30ae4a4c70"},{"version":"CommandV1","origId":416077177050656,"guid":"af51cc8e-0972-4c66-82ce-200a511924e6","subtype":"command","commandType":"auto","position":35.5,"command":"user_bias_dict=userBias_sorted.collectAsMap()\ntype(user_bias_dict)","commandVersion":0,"state":"error","results":null,"errorSummary":"Command skipped","error":null,"workflows":[],"startTime":1494837701720,"submitTime":1494837701720,"finishTime":1494837761599,"collapsed":false,"bindings":{},"inputWidgets":{},"displayType":"table","width":"auto","height":"auto","xColumns":null,"yColumns":null,"pivotColumns":null,"pivotAggregation":null,"customPlotOptions":{},"commentThread":[],"commentsVisible":false,"parentHierarchy":[],"diffInserts":[],"diffDeletes":[],"globalVars":{},"latestUser":"amarildolikmeta@gmail.com","latestUserId":null,"commandTitle":"","showCommandTitle":false,"hideCommandCode":false,"hideCommandResult":false,"iPythonMetadata":null,"streamStates":{},"datasetPreviewNameToCmdIdMap":{},"nuid":"8cfe0d12-f592-433f-baed-687544a66706"},{"version":"CommandV1","origId":416077177050657,"guid":"4a9a2280-9a23-4a1f-ba47-4db7bc0acf25","subtype":"command","commandType":"auto","position":15.125,"command":"recommendTopPopRDDfree(\"42\")","commandVersion":0,"state":"finished","results":{"type":"html","data":"<div class=\"ansiout\">/usr/lib/python2.7/dist-packages/numpy/lib/arraysetops.py:349: UnicodeWarning: Unicode unequal comparison failed to convert both arguments to Unicode - interpreting them as being unequal\n  mask &amp;= (ar1 != a)\n<span class=\"ansired\">Out[</span><span class=\"ansired\">20</span><span class=\"ansired\">]: </span>[&apos;42&apos;, array([24639, 31992, 33562, 33173, 28199])]\n</div>","arguments":{},"addedWidgets":{},"removedWidgets":[],"datasetInfos":[]},"errorSummary":"<span class=\"ansired\">NameError</span>: global name &apos;userSeenItems_dict&apos; is not defined","error":null,"workflows":[],"startTime":1494837721308,"submitTime":1494837700068,"finishTime":1494837721332,"collapsed":false,"bindings":{},"inputWidgets":{},"displayType":"table","width":"auto","height":"auto","xColumns":null,"yColumns":null,"pivotColumns":null,"pivotAggregation":null,"customPlotOptions":{},"commentThread":[],"commentsVisible":false,"parentHierarchy":[],"diffInserts":[],"diffDeletes":[],"globalVars":{},"latestUser":"amarildolikmeta@gmail.com","latestUserId":null,"commandTitle":"","showCommandTitle":false,"hideCommandCode":false,"hideCommandResult":false,"iPythonMetadata":null,"streamStates":{},"datasetPreviewNameToCmdIdMap":{},"nuid":"3d9a89d1-8b83-47bc-8409-c9c06a4346fe"},{"version":"CommandV1","origId":416077177050658,"guid":"b2064f7d-9dde-4d9f-8bb3-0c5ead7178f2","subtype":"command","commandType":"auto","position":35.75,"command":"print(user_bias_dict[\"42\"])","commandVersion":0,"state":"error","results":null,"errorSummary":"Command skipped","error":null,"workflows":[],"startTime":1494837701756,"submitTime":1494837701756,"finishTime":1494837761600,"collapsed":false,"bindings":{},"inputWidgets":{},"displayType":"table","width":"auto","height":"auto","xColumns":null,"yColumns":null,"pivotColumns":null,"pivotAggregation":null,"customPlotOptions":{},"commentThread":[],"commentsVisible":false,"parentHierarchy":[],"diffInserts":[],"diffDeletes":[],"globalVars":{},"latestUser":"amarildolikmeta@gmail.com","latestUserId":null,"commandTitle":"","showCommandTitle":false,"hideCommandCode":false,"hideCommandResult":false,"iPythonMetadata":null,"streamStates":{},"datasetPreviewNameToCmdIdMap":{},"nuid":"755297a2-edbc-4546-987a-79897774668e"},{"version":"CommandV1","origId":416077177050659,"guid":"f9bc71dc-6d8d-4c9d-9471-9c10f2dd0473","subtype":"command","commandType":"auto","position":37.0,"command":"recomendationsGlobalEffects=sc.parallelize(testList.toLocalIterator()).map(recommendGlobalEffects).collect()","commandVersion":0,"state":"error","results":null,"errorSummary":"Command skipped","error":null,"workflows":[],"startTime":1494837701867,"submitTime":1494837701867,"finishTime":1494837761602,"collapsed":false,"bindings":{},"inputWidgets":{},"displayType":"table","width":"auto","height":"auto","xColumns":null,"yColumns":null,"pivotColumns":null,"pivotAggregation":null,"customPlotOptions":{},"commentThread":[],"commentsVisible":false,"parentHierarchy":[],"diffInserts":[],"diffDeletes":[],"globalVars":{},"latestUser":"amarildolikmeta@gmail.com","latestUserId":null,"commandTitle":"","showCommandTitle":false,"hideCommandCode":false,"hideCommandResult":false,"iPythonMetadata":null,"streamStates":{},"datasetPreviewNameToCmdIdMap":{},"nuid":"41cc1100-b150-4ee1-99c2-2885c16abf1a"},{"version":"CommandV1","origId":416077177050660,"guid":"33eff8d0-5832-4a33-9fff-f892fefbaa03","subtype":"command","commandType":"auto","position":36.5,"command":"recommendGlobalEffects(\"45\", removeSeen=1)","commandVersion":0,"state":"error","results":null,"errorSummary":"Command skipped","error":null,"workflows":[],"startTime":1494837701831,"submitTime":1494837701831,"finishTime":1494837761602,"collapsed":false,"bindings":{},"inputWidgets":{},"displayType":"table","width":"auto","height":"auto","xColumns":null,"yColumns":null,"pivotColumns":null,"pivotAggregation":null,"customPlotOptions":{},"commentThread":[],"commentsVisible":false,"parentHierarchy":[],"diffInserts":[],"diffDeletes":[],"globalVars":{},"latestUser":"amarildolikmeta@gmail.com","latestUserId":null,"commandTitle":"","showCommandTitle":false,"hideCommandCode":false,"hideCommandResult":false,"iPythonMetadata":null,"streamStates":{},"datasetPreviewNameToCmdIdMap":{},"nuid":"67e34df9-d66f-40cb-8a82-aa93c50f4118"},{"version":"CommandV1","origId":416077177050715,"guid":"a61a89af-793c-4cf5-8339-919447212237","subtype":"command","commandType":"auto","position":32.9375,"command":"print(itemBias_sortedRatings[-25:\n                            ])","commandVersion":0,"state":"error","results":null,"errorSummary":"Command skipped","error":null,"workflows":[],"startTime":1494837701515,"submitTime":1494837701515,"finishTime":1494837761595,"collapsed":false,"bindings":{},"inputWidgets":{},"displayType":"table","width":"auto","height":"auto","xColumns":null,"yColumns":null,"pivotColumns":null,"pivotAggregation":null,"customPlotOptions":{},"commentThread":[],"commentsVisible":false,"parentHierarchy":[],"diffInserts":[],"diffDeletes":[],"globalVars":{},"latestUser":"amarildolikmeta@gmail.com","latestUserId":null,"commandTitle":"","showCommandTitle":false,"hideCommandCode":false,"hideCommandResult":false,"iPythonMetadata":null,"streamStates":{},"datasetPreviewNameToCmdIdMap":{},"nuid":"fd051d72-2c6a-4c83-8c35-4ada1a6288aa"},{"version":"CommandV1","origId":416077177050716,"guid":"3446f95b-a369-4640-a533-78b3c7596073","subtype":"command","commandType":"auto","position":38.0,"command":"def getRecList(recomandations):\n  \n  users=[]\n  recs=[]\n  for i in xrange(len(recomendations)):\n    users.append([recomendations[i][0],str(recomendations[i][1][0])+\" \"+str(recomendations[i][1][1])+\" \"+str(recomendations[i][1][2])+\" \"+str(recomendations[i][1][3])+\" \"+str(recomendations[i][1][4])])\n    recs.append(recomendations[i][1])","commandVersion":0,"state":"error","results":null,"errorSummary":"Command skipped","error":null,"workflows":[],"startTime":1494837701909,"submitTime":1494837701909,"finishTime":1494837761603,"collapsed":false,"bindings":{},"inputWidgets":{},"displayType":"table","width":"auto","height":"auto","xColumns":null,"yColumns":null,"pivotColumns":null,"pivotAggregation":null,"customPlotOptions":{},"commentThread":[],"commentsVisible":false,"parentHierarchy":[],"diffInserts":[],"diffDeletes":[],"globalVars":{},"latestUser":"amarildolikmeta@gmail.com","latestUserId":null,"commandTitle":"","showCommandTitle":false,"hideCommandCode":false,"hideCommandResult":false,"iPythonMetadata":null,"streamStates":{},"datasetPreviewNameToCmdIdMap":{},"nuid":"2e514c1a-e739-4365-831a-441bfd235546"},{"version":"CommandV1","origId":416077177050717,"guid":"2a6b7170-fcc1-4eb1-ba05-b7f466b86c47","subtype":"command","commandType":"auto","position":39.0,"command":"\ndf=pd.DataFrame(data=users  # values\n                      # 1st column as index\n                \n                    )\ndisplay(sqlContext.createDataFrame(df))","commandVersion":0,"state":"error","results":null,"errorSummary":"Command skipped","error":null,"workflows":[],"startTime":1494837701970,"submitTime":1494837701970,"finishTime":1494837761605,"collapsed":false,"bindings":{},"inputWidgets":{},"displayType":"table","width":"auto","height":"auto","xColumns":null,"yColumns":null,"pivotColumns":null,"pivotAggregation":null,"customPlotOptions":{},"commentThread":[],"commentsVisible":false,"parentHierarchy":[],"diffInserts":[],"diffDeletes":[],"globalVars":{},"latestUser":"amarildolikmeta@gmail.com","latestUserId":null,"commandTitle":"","showCommandTitle":false,"hideCommandCode":false,"hideCommandResult":false,"iPythonMetadata":null,"streamStates":{},"datasetPreviewNameToCmdIdMap":{},"nuid":"6a8ccf79-fc89-48a4-b6ef-401200a4b211"},{"version":"CommandV1","origId":416077177050718,"guid":"cab8eb46-a74b-4233-af18-56b365348783","subtype":"command","commandType":"auto","position":40.0,"command":"unbiasedDF=trainRDD_unbiased.toDF()\nunbiasedDF.show(10)","commandVersion":0,"state":"error","results":null,"errorSummary":"Command skipped","error":null,"workflows":[],"startTime":1494837702001,"submitTime":1494837702001,"finishTime":1494837761606,"collapsed":false,"bindings":{},"inputWidgets":{},"displayType":"table","width":"auto","height":"auto","xColumns":null,"yColumns":null,"pivotColumns":null,"pivotAggregation":null,"customPlotOptions":{},"commentThread":[],"commentsVisible":false,"parentHierarchy":[],"diffInserts":[],"diffDeletes":[],"globalVars":{},"latestUser":"amarildolikmeta@gmail.com","latestUserId":null,"commandTitle":"","showCommandTitle":false,"hideCommandCode":false,"hideCommandResult":false,"iPythonMetadata":null,"streamStates":{},"datasetPreviewNameToCmdIdMap":{},"nuid":"8b09e051-e3dc-43b1-8e12-bc6e3ede13cd"},{"version":"CommandV1","origId":416077177050719,"guid":"2cbc03bb-3bd4-409a-ac20-c065aa98e1b1","subtype":"command","commandType":"auto","position":38.5,"command":"recomendations=recomendationsGlobalEffects\nusers=[]\nrecs=[]\nfor i in xrange(len(recomendations)):\n  users.append([recomendations[i][0],str(recomendations[i][1][0])+\" \"+str(recomendations[i][1][1])+\" \"+str(recomendations[i][1][2])+\" \"+str(recomendations[i][1][3])+\" \"+str(recomendations[i][1][4])])\n  recs.append(recomendations[i][1])","commandVersion":0,"state":"error","results":null,"errorSummary":"Command skipped","error":null,"workflows":[],"startTime":1494837701939,"submitTime":1494837701939,"finishTime":1494837761604,"collapsed":false,"bindings":{},"inputWidgets":{},"displayType":"table","width":"auto","height":"auto","xColumns":null,"yColumns":null,"pivotColumns":null,"pivotAggregation":null,"customPlotOptions":{},"commentThread":[],"commentsVisible":false,"parentHierarchy":[],"diffInserts":[],"diffDeletes":[],"globalVars":{},"latestUser":"amarildolikmeta@gmail.com","latestUserId":null,"commandTitle":"","showCommandTitle":false,"hideCommandCode":false,"hideCommandResult":false,"iPythonMetadata":null,"streamStates":{},"datasetPreviewNameToCmdIdMap":{},"nuid":"1acd6515-33d6-4877-9623-f23bc17fb457"},{"version":"CommandV1","origId":416077177050720,"guid":"800cd604-c628-4617-bfc3-1ebb371f4ab6","subtype":"command","commandType":"auto","position":41.0,"command":"unbiasedDF = unbiasedDF.withColumnRenamed(\"_1\", \"userId\").withColumnRenamed(\"_2\", \"itemId\").withColumnRenamed(\"_3\", \"rating\")\nunbiasedDF.registerTempTable(\"temp_unbiased\")","commandVersion":0,"state":"error","results":null,"errorSummary":"Command skipped","error":null,"workflows":[],"startTime":1494837702032,"submitTime":1494837702032,"finishTime":1494837761607,"collapsed":false,"bindings":{},"inputWidgets":{},"displayType":"table","width":"auto","height":"auto","xColumns":null,"yColumns":null,"pivotColumns":null,"pivotAggregation":null,"customPlotOptions":{},"commentThread":[],"commentsVisible":false,"parentHierarchy":[],"diffInserts":[],"diffDeletes":[],"globalVars":{},"latestUser":"amarildolikmeta@gmail.com","latestUserId":null,"commandTitle":"","showCommandTitle":false,"hideCommandCode":false,"hideCommandResult":false,"iPythonMetadata":null,"streamStates":{},"datasetPreviewNameToCmdIdMap":{},"nuid":"af838fef-cee7-4b3b-a12f-ce71154ef505"},{"version":"CommandV1","origId":416077177050721,"guid":"485d5d17-28d1-4c6e-9740-c23b719e54d0","subtype":"command","commandType":"auto","position":42.0,"command":"itemBiasRDD=sqlContext.sql(\"Select itemId ,sum(rating)/(count(rating)+5) as itemBias from temp_unbiased group by itemId order by itemBias desc\").rdd\nitemBiasRDD.take(10)","commandVersion":0,"state":"error","results":null,"errorSummary":"Command skipped","error":null,"workflows":[],"startTime":1494837702063,"submitTime":1494837702063,"finishTime":1494837761608,"collapsed":false,"bindings":{},"inputWidgets":{},"displayType":"table","width":"auto","height":"auto","xColumns":null,"yColumns":null,"pivotColumns":null,"pivotAggregation":null,"customPlotOptions":{},"commentThread":[],"commentsVisible":false,"parentHierarchy":[],"diffInserts":[],"diffDeletes":[],"globalVars":{},"latestUser":"amarildolikmeta@gmail.com","latestUserId":null,"commandTitle":"","showCommandTitle":false,"hideCommandCode":false,"hideCommandResult":false,"iPythonMetadata":null,"streamStates":{},"datasetPreviewNameToCmdIdMap":{},"nuid":"35ec85f6-287a-4f04-80b8-9f8282482fb6"},{"version":"CommandV1","origId":416077177050723,"guid":"f1c480c9-c496-4174-b118-172f3efc46f8","subtype":"command","commandType":"auto","position":43.0,"command":"itemBiasDict=itemBiasRDD.collectAsMap()\nitemBiasDict[\"33475\"]","commandVersion":0,"state":"error","results":null,"errorSummary":"Command skipped","error":null,"workflows":[],"startTime":1494837702125,"submitTime":1494837702125,"finishTime":1494837761610,"collapsed":false,"bindings":{},"inputWidgets":{},"displayType":"table","width":"auto","height":"auto","xColumns":null,"yColumns":null,"pivotColumns":null,"pivotAggregation":null,"customPlotOptions":{},"commentThread":[],"commentsVisible":false,"parentHierarchy":[],"diffInserts":[],"diffDeletes":[],"globalVars":{},"latestUser":"amarildolikmeta@gmail.com","latestUserId":null,"commandTitle":"","showCommandTitle":false,"hideCommandCode":false,"hideCommandResult":false,"iPythonMetadata":null,"streamStates":{},"datasetPreviewNameToCmdIdMap":{},"nuid":"33840dcd-046f-4563-9984-b6f38bf41b1a"},{"version":"CommandV1","origId":416077177050724,"guid":"223c576c-be04-464c-b06a-4c6d0fdc9da5","subtype":"command","commandType":"auto","position":44.0,"command":"trainRDD_unbiased2=trainRDD_unbiased.map(lambda x:(x[0],x[1],float(x[2])-float(itemBiasDict[x[1]])))\ntrainRDD_unbiased2.take(10)","commandVersion":0,"state":"error","results":null,"errorSummary":"Command skipped","error":null,"workflows":[],"startTime":1494837702177,"submitTime":1494837702177,"finishTime":1494837761611,"collapsed":false,"bindings":{},"inputWidgets":{},"displayType":"table","width":"auto","height":"auto","xColumns":null,"yColumns":null,"pivotColumns":null,"pivotAggregation":null,"customPlotOptions":{},"commentThread":[],"commentsVisible":false,"parentHierarchy":[],"diffInserts":[],"diffDeletes":[],"globalVars":{},"latestUser":"amarildolikmeta@gmail.com","latestUserId":null,"commandTitle":"","showCommandTitle":false,"hideCommandCode":false,"hideCommandResult":false,"iPythonMetadata":null,"streamStates":{},"datasetPreviewNameToCmdIdMap":{},"nuid":"f0792694-01fb-453e-b519-4cc2150351f9"},{"version":"CommandV1","origId":416077177050725,"guid":"070253e5-1d89-4c1a-8f64-8a20d71583b8","subtype":"command","commandType":"auto","position":45.0,"command":"unbiasedDF2=trainRDD_unbiased2.toDF()\nunbiasedDF2 = unbiasedDF2.withColumnRenamed(\"_1\", \"userId\").withColumnRenamed(\"_2\", \"itemId\").withColumnRenamed(\"_3\", \"rating\")\nunbiasedDF2.registerTempTable(\"temp_unbiased2\")","commandVersion":0,"state":"error","results":null,"errorSummary":"Command skipped","error":null,"workflows":[],"startTime":1494837702208,"submitTime":1494837702208,"finishTime":1494837761611,"collapsed":false,"bindings":{},"inputWidgets":{},"displayType":"table","width":"auto","height":"auto","xColumns":null,"yColumns":null,"pivotColumns":null,"pivotAggregation":null,"customPlotOptions":{},"commentThread":[],"commentsVisible":false,"parentHierarchy":[],"diffInserts":[],"diffDeletes":[],"globalVars":{},"latestUser":"amarildolikmeta@gmail.com","latestUserId":null,"commandTitle":"","showCommandTitle":false,"hideCommandCode":false,"hideCommandResult":false,"iPythonMetadata":null,"streamStates":{},"datasetPreviewNameToCmdIdMap":{},"nuid":"a0dd4c93-d63b-43fa-b1e7-2ef7db785d7c"},{"version":"CommandV1","origId":416077177050726,"guid":"eae225a6-5dbd-4ed7-bb67-84d7a141c532","subtype":"command","commandType":"auto","position":46.0,"command":"userBiasRDD=sqlContext.sql(\"Select userId ,sum(rating)/(count(rating)+5) as userBias from temp_unbiased2 group by userId order by userBias desc\").rdd\nuserBiasRDD.take(10)","commandVersion":0,"state":"error","results":null,"errorSummary":"Command skipped","error":null,"workflows":[],"startTime":1494837702238,"submitTime":1494837702238,"finishTime":1494837761612,"collapsed":false,"bindings":{},"inputWidgets":{},"displayType":"table","width":"auto","height":"auto","xColumns":null,"yColumns":null,"pivotColumns":null,"pivotAggregation":null,"customPlotOptions":{},"commentThread":[],"commentsVisible":false,"parentHierarchy":[],"diffInserts":[],"diffDeletes":[],"globalVars":{},"latestUser":"amarildolikmeta@gmail.com","latestUserId":null,"commandTitle":"","showCommandTitle":false,"hideCommandCode":false,"hideCommandResult":false,"iPythonMetadata":null,"streamStates":{},"datasetPreviewNameToCmdIdMap":{},"nuid":"5408aa18-6107-4173-9c08-61d8b7ae0df5"},{"version":"CommandV1","origId":416077177050727,"guid":"44b08e75-ae32-4d14-b82b-e5cca878a268","subtype":"command","commandType":"auto","position":47.0,"command":"def recommendGlobalEffectsBetter(user_id, removeSeen=1):\n    recommendedList = []\n    userBias=user_bias_dict[user_id]\n    if(removeSeen):\n      seenItems = np.array(userSeenItems_dict[user_id])\n      for i in xrange(len(itemBias_sortedIDs)):\n        if itemBias_sortedIDs[i] not in seenItems:\n          itemBias=itemBiasDict[str(itemBias_sortedIDs[i])]\n          rating=avgRating+float(userBias)+float(itemBias)\n          recommendedList.append((itemBias_sortedIDs[i],rating))\n     \n      recommendedList = sorted(recommendedList, key=lambda tup: tup[1],reverse=True)   \n     \n      recommendedList=[ seq[0] for seq in recommendedList[0:numberOfItemsToRecommend] ]\n    return [user_id,recommendedList[0:numberOfItemsToRecommend]]","commandVersion":0,"state":"error","results":null,"errorSummary":"Command skipped","error":null,"workflows":[],"startTime":1494837702375,"submitTime":1494837702375,"finishTime":1494837761616,"collapsed":false,"bindings":{},"inputWidgets":{},"displayType":"table","width":"auto","height":"auto","xColumns":null,"yColumns":null,"pivotColumns":null,"pivotAggregation":null,"customPlotOptions":{},"commentThread":[],"commentsVisible":false,"parentHierarchy":[],"diffInserts":[],"diffDeletes":[],"globalVars":{},"latestUser":"amarildolikmeta@gmail.com","latestUserId":null,"commandTitle":"","showCommandTitle":false,"hideCommandCode":false,"hideCommandResult":false,"iPythonMetadata":null,"streamStates":{},"datasetPreviewNameToCmdIdMap":{},"nuid":"e0673024-76fb-4088-9751-70beeec4d578"},{"version":"CommandV1","origId":416077177050728,"guid":"8388285e-d72c-47ed-acb4-424782ab44d1","subtype":"command","commandType":"auto","position":46.5,"command":"user_bias_dict=userBiasRDD.collectAsMap()","commandVersion":0,"state":"error","results":null,"errorSummary":"Command skipped","error":null,"workflows":[],"startTime":1494837702300,"submitTime":1494837702300,"finishTime":1494837761614,"collapsed":false,"bindings":{},"inputWidgets":{},"displayType":"table","width":"auto","height":"auto","xColumns":null,"yColumns":null,"pivotColumns":null,"pivotAggregation":null,"customPlotOptions":{},"commentThread":[],"commentsVisible":false,"parentHierarchy":[],"diffInserts":[],"diffDeletes":[],"globalVars":{},"latestUser":"amarildolikmeta@gmail.com","latestUserId":null,"commandTitle":"","showCommandTitle":false,"hideCommandCode":false,"hideCommandResult":false,"iPythonMetadata":null,"streamStates":{},"datasetPreviewNameToCmdIdMap":{},"nuid":"c04dc91e-e8e6-4f76-afa0-845880b8a721"},{"version":"CommandV1","origId":416077177050729,"guid":"3db3c25d-61dc-4a02-88a5-7d295b1dfcc2","subtype":"command","commandType":"auto","position":48.0,"command":"recomendationsGlobalEffectsBetter=sc.parallelize(testList.toLocalIterator()).map(recommendGlobalEffectsBetter).collect()","commandVersion":0,"state":"error","results":null,"errorSummary":"Command skipped","error":null,"workflows":[],"startTime":1494837702496,"submitTime":1494837702496,"finishTime":1494837761619,"collapsed":false,"bindings":{},"inputWidgets":{},"displayType":"table","width":"auto","height":"auto","xColumns":null,"yColumns":null,"pivotColumns":null,"pivotAggregation":null,"customPlotOptions":{},"commentThread":[],"commentsVisible":false,"parentHierarchy":[],"diffInserts":[],"diffDeletes":[],"globalVars":{},"latestUser":"amarildolikmeta@gmail.com","latestUserId":null,"commandTitle":"","showCommandTitle":false,"hideCommandCode":false,"hideCommandResult":false,"iPythonMetadata":null,"streamStates":{},"datasetPreviewNameToCmdIdMap":{},"nuid":"8d2eaa99-5d2e-4da8-b528-1b23a7bba571"},{"version":"CommandV1","origId":416077177050730,"guid":"c2b00cce-4829-4b49-b022-98881311c87e","subtype":"command","commandType":"auto","position":49.0,"command":"recomendations=recomendationsGlobalEffectsBetter\nusers=[]\nrecs=[]\nfor i in xrange(len(recomendations)):\n  users.append([recomendations[i][0],str(recomendations[i][1][0])+\" \"+str(recomendations[i][1][1])+\" \"+str(recomendations[i][1][2])+\" \"+str(recomendations[i][1][3])+\" \"+str(recomendations[i][1][4])])\n  recs.append(recomendations[i][1])","commandVersion":0,"state":"error","results":null,"errorSummary":"Command skipped","error":null,"workflows":[],"startTime":1494837702538,"submitTime":1494837702538,"finishTime":1494837761620,"collapsed":false,"bindings":{},"inputWidgets":{},"displayType":"table","width":"auto","height":"auto","xColumns":null,"yColumns":null,"pivotColumns":null,"pivotAggregation":null,"customPlotOptions":{},"commentThread":[],"commentsVisible":false,"parentHierarchy":[],"diffInserts":[],"diffDeletes":[],"globalVars":{},"latestUser":"amarildolikmeta@gmail.com","latestUserId":null,"commandTitle":"","showCommandTitle":false,"hideCommandCode":false,"hideCommandResult":false,"iPythonMetadata":null,"streamStates":{},"datasetPreviewNameToCmdIdMap":{},"nuid":"1b33019c-61ee-4cdb-814e-a894b3ccec09"},{"version":"CommandV1","origId":416077177050731,"guid":"38f7470a-1f55-424e-8d87-11776ea78cb6","subtype":"command","commandType":"auto","position":47.5,"command":"recommendGlobalEffectsBetter(\"43\")","commandVersion":0,"state":"error","results":null,"errorSummary":"Command skipped","error":null,"workflows":[],"startTime":1494837702436,"submitTime":1494837702436,"finishTime":1494837761617,"collapsed":false,"bindings":{},"inputWidgets":{},"displayType":"table","width":"auto","height":"auto","xColumns":null,"yColumns":null,"pivotColumns":null,"pivotAggregation":null,"customPlotOptions":{},"commentThread":[],"commentsVisible":false,"parentHierarchy":[],"diffInserts":[],"diffDeletes":[],"globalVars":{},"latestUser":"amarildolikmeta@gmail.com","latestUserId":null,"commandTitle":"","showCommandTitle":false,"hideCommandCode":false,"hideCommandResult":false,"iPythonMetadata":null,"streamStates":{},"datasetPreviewNameToCmdIdMap":{},"nuid":"f154761d-b122-4a08-85e4-d03bb2bfdaf6"},{"version":"CommandV1","origId":416077177050732,"guid":"e8853f8e-3331-4ac1-ae88-98981c59c0b8","subtype":"command","commandType":"auto","position":50.0,"command":"df=pd.DataFrame(data=users,  # values\n                      # 1st column as index\n                columns=[\"userId\",\"RecommendedItemsIds\"]\n                    )\n\ndf=sqlContext.createDataFrame(df)\ndf=df.orderBy(\"userId\")\ndisplay(df)","commandVersion":0,"state":"error","results":null,"errorSummary":"Command skipped","error":null,"workflows":[],"startTime":1494837702588,"submitTime":1494837702588,"finishTime":1494837761621,"collapsed":false,"bindings":{},"inputWidgets":{},"displayType":"table","width":"auto","height":"auto","xColumns":null,"yColumns":null,"pivotColumns":null,"pivotAggregation":null,"customPlotOptions":{},"commentThread":[],"commentsVisible":false,"parentHierarchy":[],"diffInserts":[],"diffDeletes":[],"globalVars":{},"latestUser":"amarildolikmeta@gmail.com","latestUserId":null,"commandTitle":"","showCommandTitle":false,"hideCommandCode":false,"hideCommandResult":false,"iPythonMetadata":null,"streamStates":{},"datasetPreviewNameToCmdIdMap":{},"nuid":"513c1abb-18c7-48ff-b7f4-246602d19151"},{"version":"CommandV1","origId":416077177050733,"guid":"a41ef3b3-5b05-4877-8073-6620e12e5f4d","subtype":"command","commandType":"auto","position":51.0,"command":"df.count()","commandVersion":0,"state":"error","results":null,"errorSummary":"Command skipped","error":null,"workflows":[],"startTime":1494837702619,"submitTime":1494837702619,"finishTime":1494837761622,"collapsed":false,"bindings":{},"inputWidgets":{},"displayType":"table","width":"auto","height":"auto","xColumns":null,"yColumns":null,"pivotColumns":null,"pivotAggregation":null,"customPlotOptions":{},"commentThread":[],"commentsVisible":false,"parentHierarchy":[],"diffInserts":[],"diffDeletes":[],"globalVars":{},"latestUser":"amarildolikmeta@gmail.com","latestUserId":null,"commandTitle":"","showCommandTitle":false,"hideCommandCode":false,"hideCommandResult":false,"iPythonMetadata":null,"streamStates":{},"datasetPreviewNameToCmdIdMap":{},"nuid":"3027f778-df39-4af8-9391-82d0a380258c"},{"version":"CommandV1","origId":416077177050734,"guid":"ac99ee67-00f3-4fa6-a585-28d451f8c743","subtype":"command","commandType":"auto","position":28.5,"command":"itemBias.count()","commandVersion":0,"state":"error","results":null,"errorSummary":"Command skipped","error":null,"workflows":[],"startTime":1494837701183,"submitTime":1494837701183,"finishTime":1494837761588,"collapsed":false,"bindings":{},"inputWidgets":{},"displayType":"table","width":"auto","height":"auto","xColumns":null,"yColumns":null,"pivotColumns":null,"pivotAggregation":null,"customPlotOptions":{},"commentThread":[],"commentsVisible":false,"parentHierarchy":[],"diffInserts":[],"diffDeletes":[],"globalVars":{},"latestUser":"amarildolikmeta@gmail.com","latestUserId":null,"commandTitle":"","showCommandTitle":false,"hideCommandCode":false,"hideCommandResult":false,"iPythonMetadata":null,"streamStates":{},"datasetPreviewNameToCmdIdMap":{},"nuid":"f4807559-1696-4f07-bb9b-cea9d4e5db93"},{"version":"CommandV1","origId":416077177050735,"guid":"b969c8cf-df24-47e2-9e1a-f99314c1324e","subtype":"command","commandType":"auto","position":42.5,"command":"itemBias.count()","commandVersion":0,"state":"error","results":null,"errorSummary":"Command skipped","error":null,"workflows":[],"startTime":1494837702094,"submitTime":1494837702094,"finishTime":1494837761609,"collapsed":false,"bindings":{},"inputWidgets":{},"displayType":"table","width":"auto","height":"auto","xColumns":null,"yColumns":null,"pivotColumns":null,"pivotAggregation":null,"customPlotOptions":{},"commentThread":[],"commentsVisible":false,"parentHierarchy":[],"diffInserts":[],"diffDeletes":[],"globalVars":{},"latestUser":"amarildolikmeta@gmail.com","latestUserId":null,"commandTitle":"","showCommandTitle":false,"hideCommandCode":false,"hideCommandResult":false,"iPythonMetadata":null,"streamStates":{},"datasetPreviewNameToCmdIdMap":{},"nuid":"18b78e3f-f486-4541-bb27-fade69cec036"},{"version":"CommandV1","origId":416077177050736,"guid":"0dea281a-fa88-4285-97a1-094578877846","subtype":"command","commandType":"auto","position":46.25,"command":"userBiasRDD.count()","commandVersion":0,"state":"error","results":null,"errorSummary":"Command skipped","error":null,"workflows":[],"startTime":1494837702269,"submitTime":1494837702269,"finishTime":1494837761613,"collapsed":false,"bindings":{},"inputWidgets":{},"displayType":"table","width":"auto","height":"auto","xColumns":null,"yColumns":null,"pivotColumns":null,"pivotAggregation":null,"customPlotOptions":{},"commentThread":[],"commentsVisible":false,"parentHierarchy":[],"diffInserts":[],"diffDeletes":[],"globalVars":{},"latestUser":"amarildolikmeta@gmail.com","latestUserId":null,"commandTitle":"","showCommandTitle":false,"hideCommandCode":false,"hideCommandResult":false,"iPythonMetadata":null,"streamStates":{},"datasetPreviewNameToCmdIdMap":{},"nuid":"a9858f53-287d-4fe0-96fa-534b787ba4e1"},{"version":"CommandV1","origId":416077177050737,"guid":"d4bdbe33-8ca1-4414-a3d7-e081786df57b","subtype":"command","commandType":"auto","position":46.75,"command":"user_bias_dict[\"10804\"]","commandVersion":0,"state":"error","results":null,"errorSummary":"Command skipped","error":null,"workflows":[],"startTime":1494837702332,"submitTime":1494837702332,"finishTime":1494837761615,"collapsed":false,"bindings":{},"inputWidgets":{},"displayType":"table","width":"auto","height":"auto","xColumns":null,"yColumns":null,"pivotColumns":null,"pivotAggregation":null,"customPlotOptions":{},"commentThread":[],"commentsVisible":false,"parentHierarchy":[],"diffInserts":[],"diffDeletes":[],"globalVars":{},"latestUser":"amarildolikmeta@gmail.com","latestUserId":null,"commandTitle":"","showCommandTitle":false,"hideCommandCode":false,"hideCommandResult":false,"iPythonMetadata":null,"streamStates":{},"datasetPreviewNameToCmdIdMap":{},"nuid":"1ac5ae60-2ba9-4f42-9c42-2facad40fd2c"},{"version":"CommandV1","origId":416077177050738,"guid":"532fdf78-972c-4c3f-93d1-c8fac7f62caf","subtype":"command","commandType":"auto","position":47.25,"command":"avgRating","commandVersion":0,"state":"error","results":null,"errorSummary":"Command skipped","error":null,"workflows":[],"startTime":1494837702405,"submitTime":1494837702405,"finishTime":1494837761617,"collapsed":false,"bindings":{},"inputWidgets":{},"displayType":"table","width":"auto","height":"auto","xColumns":null,"yColumns":null,"pivotColumns":null,"pivotAggregation":null,"customPlotOptions":{},"commentThread":[],"commentsVisible":false,"parentHierarchy":[],"diffInserts":[],"diffDeletes":[],"globalVars":{},"latestUser":"amarildolikmeta@gmail.com","latestUserId":null,"commandTitle":"","showCommandTitle":false,"hideCommandCode":false,"hideCommandResult":false,"iPythonMetadata":null,"streamStates":{},"datasetPreviewNameToCmdIdMap":{},"nuid":"1d8e0013-713c-48c0-8eed-ee6270429af3"},{"version":"CommandV1","origId":416077177050739,"guid":"59fd7ae5-9942-4c57-8779-0786982808b1","subtype":"command","commandType":"auto","position":52.0,"command":"print \"a\"","commandVersion":0,"state":"error","results":null,"errorSummary":"Command skipped","error":null,"workflows":[],"startTime":1494837702648,"submitTime":1494837702648,"finishTime":1494837761622,"collapsed":false,"bindings":{},"inputWidgets":{},"displayType":"table","width":"auto","height":"auto","xColumns":null,"yColumns":null,"pivotColumns":null,"pivotAggregation":null,"customPlotOptions":{},"commentThread":[],"commentsVisible":false,"parentHierarchy":[],"diffInserts":[],"diffDeletes":[],"globalVars":{},"latestUser":"amarildolikmeta@gmail.com","latestUserId":null,"commandTitle":"","showCommandTitle":false,"hideCommandCode":false,"hideCommandResult":false,"iPythonMetadata":null,"streamStates":{},"datasetPreviewNameToCmdIdMap":{},"nuid":"ea5c2ecc-2651-41f1-9506-20899eca6b3b"},{"version":"CommandV1","origId":416077177050740,"guid":"6beae6a7-7fd3-4762-975e-d2594435cb86","subtype":"command","commandType":"auto","position":49.5,"command":"","commandVersion":0,"state":"finished","results":null,"errorSummary":null,"error":null,"workflows":[],"startTime":0,"submitTime":0,"finishTime":0,"collapsed":false,"bindings":{},"inputWidgets":{},"displayType":"table","width":"auto","height":"auto","xColumns":null,"yColumns":null,"pivotColumns":null,"pivotAggregation":null,"customPlotOptions":{},"commentThread":[],"commentsVisible":false,"parentHierarchy":[],"diffInserts":[],"diffDeletes":[],"globalVars":{},"latestUser":"","latestUserId":null,"commandTitle":"","showCommandTitle":false,"hideCommandCode":false,"hideCommandResult":false,"iPythonMetadata":null,"streamStates":{},"datasetPreviewNameToCmdIdMap":{},"nuid":"49634b10-941b-43b9-9eba-942f102c8744"},{"version":"CommandV1","origId":416077177050741,"guid":"13c97f01-85ab-478d-a63a-5a6f3b3679c6","subtype":"command","commandType":"auto","position":47.75,"command":"testList.sortBy(lambda x: x).take(10)","commandVersion":0,"state":"error","results":null,"errorSummary":"Command skipped","error":null,"workflows":[],"startTime":1494837702466,"submitTime":1494837702466,"finishTime":1494837761618,"collapsed":false,"bindings":{},"inputWidgets":{},"displayType":"table","width":"auto","height":"auto","xColumns":null,"yColumns":null,"pivotColumns":null,"pivotAggregation":null,"customPlotOptions":{},"commentThread":[],"commentsVisible":false,"parentHierarchy":[],"diffInserts":[],"diffDeletes":[],"globalVars":{},"latestUser":"amarildolikmeta@gmail.com","latestUserId":null,"commandTitle":"","showCommandTitle":false,"hideCommandCode":false,"hideCommandResult":false,"iPythonMetadata":null,"streamStates":{},"datasetPreviewNameToCmdIdMap":{},"nuid":"23fa232e-c28d-4a0c-b36a-9140609af995"},{"version":"CommandV1","origId":1064934888031965,"guid":"ca5e2fe8-0eb9-4ac9-aea9-c1c70f0d41a0","subtype":"command","commandType":"auto","position":55.0,"command":"userRatings.take(5)","commandVersion":0,"state":"error","results":null,"errorSummary":"Command skipped","error":null,"workflows":[],"startTime":1494837702742,"submitTime":1494837702742,"finishTime":1494837761625,"collapsed":false,"bindings":{},"inputWidgets":{},"displayType":"table","width":"auto","height":"auto","xColumns":null,"yColumns":null,"pivotColumns":null,"pivotAggregation":null,"customPlotOptions":{},"commentThread":[],"commentsVisible":false,"parentHierarchy":[],"diffInserts":[],"diffDeletes":[],"globalVars":{},"latestUser":"amarildolikmeta@gmail.com","latestUserId":null,"commandTitle":"","showCommandTitle":false,"hideCommandCode":false,"hideCommandResult":false,"iPythonMetadata":null,"streamStates":{},"datasetPreviewNameToCmdIdMap":{},"nuid":"d69b0d5b-a6d6-4e4d-addf-a7ffd5608d25"},{"version":"CommandV1","origId":1064934888031966,"guid":"9481a798-fc2e-48fd-bcee-9f05e4092631","subtype":"command","commandType":"auto","position":56.0,"command":"userRatings_dict=userRatings.collectAsMap()","commandVersion":0,"state":"error","results":null,"errorSummary":"Command skipped","error":null,"workflows":[],"startTime":1494837702773,"submitTime":1494837702773,"finishTime":1494837761626,"collapsed":false,"bindings":{},"inputWidgets":{},"displayType":"table","width":"auto","height":"auto","xColumns":null,"yColumns":null,"pivotColumns":null,"pivotAggregation":null,"customPlotOptions":{},"commentThread":[],"commentsVisible":false,"parentHierarchy":[],"diffInserts":[],"diffDeletes":[],"globalVars":{},"latestUser":"amarildolikmeta@gmail.com","latestUserId":null,"commandTitle":"","showCommandTitle":false,"hideCommandCode":false,"hideCommandResult":false,"iPythonMetadata":null,"streamStates":{},"datasetPreviewNameToCmdIdMap":{},"nuid":"1964812c-985e-4712-ad54-f1390223028b"},{"version":"CommandV1","origId":1064934888031967,"guid":"64f7cc87-9fca-43fa-b9c5-e7801513c3fa","subtype":"command","commandType":"auto","position":57.0,"command":"userRatings_dict[\"4446\"]","commandVersion":0,"state":"error","results":null,"errorSummary":"Command skipped","error":null,"workflows":[],"startTime":1494837702801,"submitTime":1494837702801,"finishTime":1494837761627,"collapsed":false,"bindings":{},"inputWidgets":{},"displayType":"table","width":"auto","height":"auto","xColumns":null,"yColumns":null,"pivotColumns":null,"pivotAggregation":null,"customPlotOptions":{},"commentThread":[],"commentsVisible":false,"parentHierarchy":[],"diffInserts":[],"diffDeletes":[],"globalVars":{},"latestUser":"amarildolikmeta@gmail.com","latestUserId":null,"commandTitle":"","showCommandTitle":false,"hideCommandCode":false,"hideCommandResult":false,"iPythonMetadata":null,"streamStates":{},"datasetPreviewNameToCmdIdMap":{},"nuid":"fa402663-663d-41cb-ab0f-46da916eb402"},{"version":"CommandV1","origId":1064934888031968,"guid":"dde9299d-9ef8-4cf8-a75e-c62fa7796c5e","subtype":"command","commandType":"auto","position":58.0,"command":"for key in userRatings_dict:\n  userRatings_dict[key]=dict(userRatings_dict[key])\nuserRatings_dict[\"4446\"][\"14644\"]","commandVersion":0,"state":"error","results":null,"errorSummary":"Command skipped","error":null,"workflows":[],"startTime":1494837702832,"submitTime":1494837702832,"finishTime":1494837761627,"collapsed":false,"bindings":{},"inputWidgets":{},"displayType":"table","width":"auto","height":"auto","xColumns":null,"yColumns":null,"pivotColumns":null,"pivotAggregation":null,"customPlotOptions":{},"commentThread":[],"commentsVisible":false,"parentHierarchy":[],"diffInserts":[],"diffDeletes":[],"globalVars":{},"latestUser":"amarildolikmeta@gmail.com","latestUserId":null,"commandTitle":"","showCommandTitle":false,"hideCommandCode":false,"hideCommandResult":false,"iPythonMetadata":null,"streamStates":{},"datasetPreviewNameToCmdIdMap":{},"nuid":"dfa442cf-ce0c-496e-a8da-b6b9691c9e8a"},{"version":"CommandV1","origId":1064934888031969,"guid":"7e48876f-b652-46d9-a18c-07d4500532f8","subtype":"command","commandType":"auto","position":59.0,"command":"from math import sqrt\ndef userSimilarity(user1,user2):\n  seenItems1=set(userSeenItems_dict[user1])\n  seenItems2=set(userSeenItems_dict[user2])\n  totalItems=seenItems1&seenItems2\n  ratings1=np.zeros(len(totalItems))\n  ratings2=np.zeros(len(totalItems))\n  totalItems=list(totalItems)\n  for i in xrange(len(totalItems)):\n    try:\n      ratings1[i]=float(userRatings_dict[user1][str(totalItems[i])])\n    except:\n      ratings1[i]=float(meanItemRatings[str(totalItems[i])])\n    try:\n      ratings2[i]=float(userRatings_dict[user2][str(totalItems[i])])\n    except:\n      ratings2[i]=float(meanItemRatings[str(totalItems[i])])  \n  number_of_ratings=len(totalItems)\n  person1_preferences_sum=sum(ratings1)\n  person2_preferences_sum=sum(ratings2)\n  person1_square_preferences_sum=sum([pow(item,2) for item in ratings1 ])\n  person2_square_preferences_sum=sum([pow(item,2) for item in ratings2 ])\n  product_sum_of_both_users=sum([ratings1[i] * ratings2[i] for i in xrange(len(ratings1))])\n   # Calculate the pearson score\n  numerator_value = product_sum_of_both_users - (person1_preferences_sum*person2_preferences_sum/number_of_ratings)\n  denominator_value = sqrt((person1_square_preferences_sum - pow(person1_preferences_sum,2)/number_of_ratings) * (person2_square_preferences_sum -pow(person2_preferences_sum,2)/number_of_ratings))\n\n  if denominator_value == 0:\n      return 0\n  else:\n      r = numerator_value / denominator_value\n      return r\n  \n","commandVersion":0,"state":"error","results":null,"errorSummary":"Command skipped","error":null,"workflows":[],"startTime":1494837702949,"submitTime":1494837702949,"finishTime":1494837761631,"collapsed":false,"bindings":{},"inputWidgets":{},"displayType":"table","width":"auto","height":"auto","xColumns":null,"yColumns":null,"pivotColumns":null,"pivotAggregation":null,"customPlotOptions":{},"commentThread":[],"commentsVisible":false,"parentHierarchy":[],"diffInserts":[],"diffDeletes":[],"globalVars":{},"latestUser":"amarildolikmeta@gmail.com","latestUserId":null,"commandTitle":"","showCommandTitle":false,"hideCommandCode":false,"hideCommandResult":false,"iPythonMetadata":null,"streamStates":{},"datasetPreviewNameToCmdIdMap":{},"nuid":"6c61af40-1141-4d6e-80eb-cdf0fed4a10d"},{"version":"CommandV1","origId":1064934888031970,"guid":"765ebf60-1e31-426b-ba4e-8965d05eddc7","subtype":"command","commandType":"auto","position":58.5,"command":"userRatings_dict[\"4446\"][\"1\"]","commandVersion":0,"state":"error","results":null,"errorSummary":"Command skipped","error":null,"workflows":[],"startTime":1494837702860,"submitTime":1494837702860,"finishTime":1494837761628,"collapsed":false,"bindings":{},"inputWidgets":{},"displayType":"table","width":"auto","height":"auto","xColumns":null,"yColumns":null,"pivotColumns":null,"pivotAggregation":null,"customPlotOptions":{},"commentThread":[],"commentsVisible":false,"parentHierarchy":[],"diffInserts":[],"diffDeletes":[],"globalVars":{},"latestUser":"amarildolikmeta@gmail.com","latestUserId":null,"commandTitle":"","showCommandTitle":false,"hideCommandCode":false,"hideCommandResult":false,"iPythonMetadata":null,"streamStates":{},"datasetPreviewNameToCmdIdMap":{},"nuid":"13efbac7-48c7-4253-bb7c-9c6ceef81747"},{"version":"CommandV1","origId":1064934888031972,"guid":"a7a3b932-c1e6-41e1-a5c0-365abf35662c","subtype":"command","commandType":"auto","position":58.75,"command":"itemRatings=sqlContext.sql(\"Select itemId ,sum(rating)/(count(rating)+5) as AvgRating from train group by itemId order by AvgRating desc\").rdd\nmeanItemRatings=itemRatings.map(lambda x:(x[0],float(x[1]))).collectAsMap()","commandVersion":0,"state":"error","results":null,"errorSummary":"Command skipped","error":null,"workflows":[],"startTime":1494837702890,"submitTime":1494837702890,"finishTime":1494837761629,"collapsed":false,"bindings":{},"inputWidgets":{},"displayType":"table","width":"auto","height":"auto","xColumns":null,"yColumns":null,"pivotColumns":null,"pivotAggregation":null,"customPlotOptions":{},"commentThread":[],"commentsVisible":false,"parentHierarchy":[],"diffInserts":[],"diffDeletes":[],"globalVars":{},"latestUser":"amarildolikmeta@gmail.com","latestUserId":null,"commandTitle":"","showCommandTitle":false,"hideCommandCode":false,"hideCommandResult":false,"iPythonMetadata":null,"streamStates":{},"datasetPreviewNameToCmdIdMap":{},"nuid":"8cd74ef4-e7b9-40b6-aaf1-73d0bafbf0ca"},{"version":"CommandV1","origId":1064934888031974,"guid":"e75a9449-6396-4a28-8c9f-4694ce22f121","subtype":"command","commandType":"auto","position":60.0,"command":"userSimilarity(\"87\",\"74\")","commandVersion":0,"state":"error","results":null,"errorSummary":"Command skipped","error":null,"workflows":[],"startTime":1494837703008,"submitTime":1494837703008,"finishTime":1494837761633,"collapsed":false,"bindings":{},"inputWidgets":{},"displayType":"table","width":"auto","height":"auto","xColumns":null,"yColumns":null,"pivotColumns":null,"pivotAggregation":null,"customPlotOptions":{},"commentThread":[],"commentsVisible":false,"parentHierarchy":[],"diffInserts":[],"diffDeletes":[],"globalVars":{},"latestUser":"amarildolikmeta@gmail.com","latestUserId":null,"commandTitle":"","showCommandTitle":false,"hideCommandCode":false,"hideCommandResult":false,"iPythonMetadata":null,"streamStates":{},"datasetPreviewNameToCmdIdMap":{},"nuid":"a71d8e33-10e3-48bc-9ce4-e6689a87a0a9"},{"version":"CommandV1","origId":1064934888031975,"guid":"7a85a445-79f5-4ba2-b7ea-3314f62805ef","subtype":"command","commandType":"auto","position":61.0,"command":"HighestRatedItemsUser=sqlContext.sql(\"Select * from train where rating>=8 order By rating desc\").rdd\nHighRated_dict=HighestRatedItemsUser.map(lambda x :(x[0],[x[1]])).reduceByKey(lambda x,y:x+y).collectAsMap()\n","commandVersion":0,"state":"error","results":null,"errorSummary":"Command skipped","error":null,"workflows":[],"startTime":1494837703038,"submitTime":1494837703038,"finishTime":1494837761634,"collapsed":false,"bindings":{},"inputWidgets":{},"displayType":"table","width":"auto","height":"auto","xColumns":null,"yColumns":null,"pivotColumns":null,"pivotAggregation":null,"customPlotOptions":{},"commentThread":[],"commentsVisible":false,"parentHierarchy":[],"diffInserts":[],"diffDeletes":[],"globalVars":{},"latestUser":"amarildolikmeta@gmail.com","latestUserId":null,"commandTitle":"","showCommandTitle":false,"hideCommandCode":false,"hideCommandResult":false,"iPythonMetadata":null,"streamStates":{},"datasetPreviewNameToCmdIdMap":{},"nuid":"60a1d1b3-8f17-48ec-94a0-54ec2f7a92e7"},{"version":"CommandV1","origId":1064934888031976,"guid":"1ba94599-e4b9-415d-9b50-40cd6b680bcf","subtype":"command","commandType":"auto","position":58.875,"command":"itemPopularity_id.max()","commandVersion":0,"state":"error","results":null,"errorSummary":"Command skipped","error":null,"workflows":[],"startTime":1494837702919,"submitTime":1494837702919,"finishTime":1494837761630,"collapsed":false,"bindings":{},"inputWidgets":{},"displayType":"table","width":"auto","height":"auto","xColumns":null,"yColumns":null,"pivotColumns":null,"pivotAggregation":null,"customPlotOptions":{},"commentThread":[],"commentsVisible":false,"parentHierarchy":[],"diffInserts":[],"diffDeletes":[],"globalVars":{},"latestUser":"amarildolikmeta@gmail.com","latestUserId":null,"commandTitle":"","showCommandTitle":false,"hideCommandCode":false,"hideCommandResult":false,"iPythonMetadata":null,"streamStates":{},"datasetPreviewNameToCmdIdMap":{},"nuid":"a5f948ed-9d3f-4579-8eb0-768ab9b9b5c0"},{"version":"CommandV1","origId":1064934888031977,"guid":"2e545ee7-03f9-4677-be4a-82b8b9c8ab46","subtype":"command","commandType":"auto","position":62.0,"command":"def RecommendFromSimilars(userId, removeSeen=True):\n  if numRatings_dict[userId]<3:\n    return recommendTopRated(userId)\n  seenItems=seenItems = np.array(userSeenItems_dict[userId])\n  similarities=[]\n  reccomendedList=[]\n  for i in xrange(len(UserIds)):\n    if UserIds[i]!=userId or numRatings_dict[UserIds[i]]<3:\n      similarities.append((UserIds[i],userSimilarity(userId,UserIds[i])))\n  similarities = sorted(similarities, key=lambda tup: tup[1],reverse=True)   \n  similarities=[ seq[0] for seq in similarities ]\n  count=0\n  for i in xrange(len(similarities)):\n    for item in HighRated_dict[similarities[i]]:\n      if item not in seenItems:\n        reccomendedList.append(item)\n        count=count+1\n        if count==numberOfItemsToRecommend:\n          return [userId,reccomendedList[0:numberOfItemsToRecommend]]\n       ","commandVersion":0,"state":"error","results":null,"errorSummary":"Command skipped","error":null,"workflows":[],"startTime":1494837703457,"submitTime":1494837703457,"finishTime":1494837761639,"collapsed":false,"bindings":{},"inputWidgets":{},"displayType":"table","width":"auto","height":"auto","xColumns":null,"yColumns":null,"pivotColumns":null,"pivotAggregation":null,"customPlotOptions":{},"commentThread":[],"commentsVisible":false,"parentHierarchy":[],"diffInserts":[],"diffDeletes":[],"globalVars":{},"latestUser":"amarildolikmeta@gmail.com","latestUserId":null,"commandTitle":"","showCommandTitle":false,"hideCommandCode":false,"hideCommandResult":false,"iPythonMetadata":null,"streamStates":{},"datasetPreviewNameToCmdIdMap":{},"nuid":"5e498e5e-967e-4545-9cc1-860edaab5ff9"},{"version":"CommandV1","origId":1064934888031978,"guid":"64ce77b2-189e-48fb-b1fd-cd55223f4eac","subtype":"command","commandType":"auto","position":61.5,"command":"HighRated_dict[\"4\"]","commandVersion":0,"state":"error","results":null,"errorSummary":"Command skipped","error":null,"workflows":[],"startTime":1494837703069,"submitTime":1494837703069,"finishTime":1494837761635,"collapsed":false,"bindings":{},"inputWidgets":{},"displayType":"table","width":"auto","height":"auto","xColumns":null,"yColumns":null,"pivotColumns":null,"pivotAggregation":null,"customPlotOptions":{},"commentThread":[],"commentsVisible":false,"parentHierarchy":[],"diffInserts":[],"diffDeletes":[],"globalVars":{},"latestUser":"amarildolikmeta@gmail.com","latestUserId":null,"commandTitle":"","showCommandTitle":false,"hideCommandCode":false,"hideCommandResult":false,"iPythonMetadata":null,"streamStates":{},"datasetPreviewNameToCmdIdMap":{},"nuid":"00aa6dc4-cdab-4ca4-97d9-54c67dfca0f7"},{"version":"CommandV1","origId":1064934888031979,"guid":"5b241443-0c81-4560-9fbc-63bc72de1229","subtype":"command","commandType":"auto","position":61.75,"command":"UserIds=sqlContext.sql(\"Select distinct userId from train order by int(userId) \").rdd.map(lambda x:x[0]).collect()","commandVersion":0,"state":"error","results":null,"errorSummary":"Command skipped","error":null,"workflows":[],"startTime":1494837703115,"submitTime":1494837703115,"finishTime":1494837761635,"collapsed":false,"bindings":{},"inputWidgets":{},"displayType":"table","width":"auto","height":"auto","xColumns":null,"yColumns":null,"pivotColumns":null,"pivotAggregation":null,"customPlotOptions":{},"commentThread":[],"commentsVisible":false,"parentHierarchy":[],"diffInserts":[],"diffDeletes":[],"globalVars":{},"latestUser":"amarildolikmeta@gmail.com","latestUserId":null,"commandTitle":"","showCommandTitle":false,"hideCommandCode":false,"hideCommandResult":false,"iPythonMetadata":null,"streamStates":{},"datasetPreviewNameToCmdIdMap":{},"nuid":"6fb4cbff-ec1f-442b-ad42-ec4fc06d0cb9"},{"version":"CommandV1","origId":1064934888031981,"guid":"0b3e515f-0939-41a9-b731-a8ae060c11a8","subtype":"command","commandType":"auto","position":61.875,"command":"numRatings_dict=sqlContext.sql(\"Select  userId,count(rating) as numRatings from train group by userId  \").rdd.map(lambda x:(x[0],int(x[1]))).collectAsMap()","commandVersion":0,"state":"error","results":null,"errorSummary":"Command skipped","error":null,"workflows":[],"startTime":1494837703175,"submitTime":1494837703175,"finishTime":1494837761637,"collapsed":false,"bindings":{},"inputWidgets":{},"displayType":"table","width":"auto","height":"auto","xColumns":null,"yColumns":null,"pivotColumns":null,"pivotAggregation":null,"customPlotOptions":{},"commentThread":[],"commentsVisible":false,"parentHierarchy":[],"diffInserts":[],"diffDeletes":[],"globalVars":{},"latestUser":"amarildolikmeta@gmail.com","latestUserId":null,"commandTitle":"","showCommandTitle":false,"hideCommandCode":false,"hideCommandResult":false,"iPythonMetadata":null,"streamStates":{},"datasetPreviewNameToCmdIdMap":{},"nuid":"0caf12e8-6ce4-4461-a7b2-9dcf280db78f"},{"version":"CommandV1","origId":1064934888031982,"guid":"c864a802-9ab3-4cad-9ce3-92aeccc2168c","subtype":"command","commandType":"auto","position":61.9375,"command":"numRatings_dict[\"5\"]","commandVersion":0,"state":"error","results":null,"errorSummary":"Command skipped","error":null,"workflows":[],"startTime":1494837703211,"submitTime":1494837703211,"finishTime":1494837761638,"collapsed":false,"bindings":{},"inputWidgets":{},"displayType":"table","width":"auto","height":"auto","xColumns":null,"yColumns":null,"pivotColumns":null,"pivotAggregation":null,"customPlotOptions":{},"commentThread":[],"commentsVisible":false,"parentHierarchy":[],"diffInserts":[],"diffDeletes":[],"globalVars":{},"latestUser":"amarildolikmeta@gmail.com","latestUserId":null,"commandTitle":"","showCommandTitle":false,"hideCommandCode":false,"hideCommandResult":false,"iPythonMetadata":null,"streamStates":{},"datasetPreviewNameToCmdIdMap":{},"nuid":"1e5bda46-f2d6-4ccd-bc6e-e510948cf082"},{"version":"CommandV1","origId":1064934888031983,"guid":"73d156f9-3ec3-4aeb-84a0-c0a6344bdb2b","subtype":"command","commandType":"auto","position":63.0,"command":"RecommendFromSimilars(\"147\")","commandVersion":0,"state":"error","results":null,"errorSummary":"Command skipped","error":null,"workflows":[],"startTime":1494837703487,"submitTime":1494837703487,"finishTime":1494837761640,"collapsed":false,"bindings":{},"inputWidgets":{},"displayType":"table","width":"auto","height":"auto","xColumns":null,"yColumns":null,"pivotColumns":null,"pivotAggregation":null,"customPlotOptions":{},"commentThread":[],"commentsVisible":false,"parentHierarchy":[],"diffInserts":[],"diffDeletes":[],"globalVars":{},"latestUser":"amarildolikmeta@gmail.com","latestUserId":null,"commandTitle":"","showCommandTitle":false,"hideCommandCode":false,"hideCommandResult":false,"iPythonMetadata":null,"streamStates":{},"datasetPreviewNameToCmdIdMap":{},"nuid":"22fe8502-970b-4602-8068-c615d1b755d5"},{"version":"CommandV1","origId":1064934888031984,"guid":"53685f7e-2f6d-4961-825b-6843412fc55c","subtype":"command","commandType":"auto","position":64.0,"command":"recomendations=recomendationsSimilarity\nusers=[]\nrecs=[]\nfor i in xrange(len(recomendations)):\n  users.append([recomendations[i][0],str(recomendations[i][1][0])+\" \"+str(recomendations[i][1][1])+\" \"+str(recomendations[i][1][2])+\" \"+str(recomendations[i][1][3])+\" \"+str(recomendations[i][1][4])])\n  recs.append(recomendations[i][1])","commandVersion":0,"state":"error","results":null,"errorSummary":"Command skipped","error":null,"workflows":[],"startTime":1494837703560,"submitTime":1494837703560,"finishTime":1494837761642,"collapsed":false,"bindings":{},"inputWidgets":{},"displayType":"table","width":"auto","height":"auto","xColumns":null,"yColumns":null,"pivotColumns":null,"pivotAggregation":null,"customPlotOptions":{},"commentThread":[],"commentsVisible":false,"parentHierarchy":[],"diffInserts":[],"diffDeletes":[],"globalVars":{},"latestUser":"amarildolikmeta@gmail.com","latestUserId":null,"commandTitle":"","showCommandTitle":false,"hideCommandCode":false,"hideCommandResult":false,"iPythonMetadata":null,"streamStates":{},"datasetPreviewNameToCmdIdMap":{},"nuid":"c1f542d8-a24d-435d-bdeb-bd9aeb619d76"},{"version":"CommandV1","origId":1064934888031985,"guid":"3b1906ee-b208-4b41-9a1e-e8421f01e173","subtype":"command","commandType":"auto","position":63.5,"command":"recomendationsSimilarity=sc.parallelize(testList.toLocalIterator()).map(RecommendFromSimilars).collect()","commandVersion":0,"state":"error","results":null,"errorSummary":"Command skipped","error":null,"workflows":[],"startTime":1494837703515,"submitTime":1494837703515,"finishTime":1494837761641,"collapsed":false,"bindings":{},"inputWidgets":{},"displayType":"table","width":"auto","height":"auto","xColumns":null,"yColumns":null,"pivotColumns":null,"pivotAggregation":null,"customPlotOptions":{},"commentThread":[],"commentsVisible":false,"parentHierarchy":[],"diffInserts":[],"diffDeletes":[],"globalVars":{},"latestUser":"amarildolikmeta@gmail.com","latestUserId":null,"commandTitle":"","showCommandTitle":false,"hideCommandCode":false,"hideCommandResult":false,"iPythonMetadata":null,"streamStates":{},"datasetPreviewNameToCmdIdMap":{},"nuid":"2d8346b3-d2a5-42a2-ac8a-9b6f80ab6578"},{"version":"CommandV1","origId":1064934888031986,"guid":"a8d1c91f-0419-4452-9361-0eee2bd0d574","subtype":"command","commandType":"auto","position":59.5,"command":"userSeenItems_dict[\"85\"]","commandVersion":0,"state":"error","results":null,"errorSummary":"Command skipped","error":null,"workflows":[],"startTime":1494837702979,"submitTime":1494837702979,"finishTime":1494837761632,"collapsed":false,"bindings":{},"inputWidgets":{},"displayType":"table","width":"auto","height":"auto","xColumns":null,"yColumns":null,"pivotColumns":null,"pivotAggregation":null,"customPlotOptions":{},"commentThread":[],"commentsVisible":false,"parentHierarchy":[],"diffInserts":[],"diffDeletes":[],"globalVars":{},"latestUser":"amarildolikmeta@gmail.com","latestUserId":null,"commandTitle":"","showCommandTitle":false,"hideCommandCode":false,"hideCommandResult":false,"iPythonMetadata":null,"streamStates":{},"datasetPreviewNameToCmdIdMap":{},"nuid":"1e6a534b-9162-4001-9e92-1e3b80aba381"},{"version":"CommandV1","origId":1064934888031987,"guid":"b4f2f6fe-ea33-4174-af66-e59150a9b859","subtype":"command","commandType":"auto","position":65.0,"command":"df=pd.DataFrame(data=users  # values\n                      # 1st column as index\n                    )\ndisplay(sqlContext.createDataFrame(df))","commandVersion":0,"state":"error","results":null,"errorSummary":"Command skipped","error":null,"workflows":[],"startTime":1494837703584,"submitTime":1494837703584,"finishTime":1494837761643,"collapsed":false,"bindings":{},"inputWidgets":{},"displayType":"table","width":"auto","height":"auto","xColumns":null,"yColumns":null,"pivotColumns":null,"pivotAggregation":null,"customPlotOptions":{},"commentThread":[],"commentsVisible":false,"parentHierarchy":[],"diffInserts":[],"diffDeletes":[],"globalVars":{},"latestUser":"amarildolikmeta@gmail.com","latestUserId":null,"commandTitle":"","showCommandTitle":false,"hideCommandCode":false,"hideCommandResult":false,"iPythonMetadata":null,"streamStates":{},"datasetPreviewNameToCmdIdMap":{},"nuid":"c2b7e3b6-f41c-4024-a368-98e7edc47b13"},{"version":"CommandV1","origId":1064934888031988,"guid":"d43f1aea-ec2b-434b-9507-368e2f673884","subtype":"command","commandType":"auto","position":66.0,"command":"","commandVersion":0,"state":"finished","results":null,"errorSummary":null,"error":null,"workflows":[],"startTime":0,"submitTime":0,"finishTime":0,"collapsed":false,"bindings":{},"inputWidgets":{},"displayType":"table","width":"auto","height":"auto","xColumns":null,"yColumns":null,"pivotColumns":null,"pivotAggregation":null,"customPlotOptions":{},"commentThread":[],"commentsVisible":false,"parentHierarchy":[],"diffInserts":[],"diffDeletes":[],"globalVars":{},"latestUser":"","latestUserId":null,"commandTitle":"","showCommandTitle":false,"hideCommandCode":false,"hideCommandResult":false,"iPythonMetadata":null,"streamStates":{},"datasetPreviewNameToCmdIdMap":{},"nuid":"33b8385c-d03f-4b12-ab33-855ad497a3e4"},{"version":"CommandV1","origId":1064934888031990,"guid":"dca914b8-7212-452b-b887-0d8107a0ea1c","subtype":"command","commandType":"auto","position":61.625,"command":"","commandVersion":0,"state":"finished","results":null,"errorSummary":null,"error":null,"workflows":[],"startTime":0,"submitTime":0,"finishTime":0,"collapsed":false,"bindings":{},"inputWidgets":{},"displayType":"table","width":"auto","height":"auto","xColumns":null,"yColumns":null,"pivotColumns":null,"pivotAggregation":null,"customPlotOptions":{},"commentThread":[],"commentsVisible":false,"parentHierarchy":[],"diffInserts":[],"diffDeletes":[],"globalVars":{},"latestUser":"","latestUserId":null,"commandTitle":"","showCommandTitle":false,"hideCommandCode":false,"hideCommandResult":false,"iPythonMetadata":null,"streamStates":{},"datasetPreviewNameToCmdIdMap":{},"nuid":"edf5fa7c-75b3-4bb5-bd41-56f79eeebea0"},{"version":"CommandV1","origId":1064934888031992,"guid":"3c5875d1-55f3-4109-a99d-dfc764fa3ddd","subtype":"command","commandType":"auto","position":61.8125,"command":"for i in xrange(len(UserIds)):\n  try:\n    HighRated_dict[UserIds[i]]\n  except KeyError:\n    HighRated_dict[UserIds[i]]=[]\n","commandVersion":0,"state":"error","results":null,"errorSummary":"Command skipped","error":null,"workflows":[],"startTime":1494837703144,"submitTime":1494837703144,"finishTime":1494837761636,"collapsed":false,"bindings":{},"inputWidgets":{},"displayType":"table","width":"auto","height":"auto","xColumns":null,"yColumns":null,"pivotColumns":null,"pivotAggregation":null,"customPlotOptions":{},"commentThread":[],"commentsVisible":false,"parentHierarchy":[],"diffInserts":[],"diffDeletes":[],"globalVars":{},"latestUser":"amarildolikmeta@gmail.com","latestUserId":null,"commandTitle":"","showCommandTitle":false,"hideCommandCode":false,"hideCommandResult":false,"iPythonMetadata":null,"streamStates":{},"datasetPreviewNameToCmdIdMap":{},"nuid":"173d9ee3-3dee-4f6f-b8fd-b7b254e76ab7"},{"version":"CommandV1","origId":1564474118230701,"guid":"ac5611b4-0a4a-421b-8f96-e507e35e08d6","subtype":"command","commandType":"auto","position":1.0,"command":"import numpy as np\nimport pandas as pd","commandVersion":0,"state":"finished","results":{"type":"html","data":"<div class=\"ansiout\"></div>","arguments":{},"addedWidgets":{},"removedWidgets":[],"datasetInfos":[]},"errorSummary":null,"error":null,"workflows":[],"startTime":1494837703906,"submitTime":1494837699097,"finishTime":1494837703933,"collapsed":false,"bindings":{},"inputWidgets":{},"displayType":"table","width":"auto","height":"auto","xColumns":null,"yColumns":null,"pivotColumns":null,"pivotAggregation":null,"customPlotOptions":{},"commentThread":[],"commentsVisible":false,"parentHierarchy":[],"diffInserts":[],"diffDeletes":[],"globalVars":{},"latestUser":"amarildolikmeta@gmail.com","latestUserId":null,"commandTitle":"","showCommandTitle":false,"hideCommandCode":false,"hideCommandResult":false,"iPythonMetadata":null,"streamStates":{},"datasetPreviewNameToCmdIdMap":{},"nuid":"7e262392-a1b9-49f6-aa8b-58b6f34aa2bf"},{"version":"CommandV1","origId":1564474118230702,"guid":"05a447c0-722f-4a7f-b764-3b6f46e40f0d","subtype":"command","commandType":"auto","position":2.0,"command":"train=sqlContext.sql(\"SELECT * from train\")\ntrainRDD=train.rdd\ntest=sqlContext.sql(\"Select * from target\").rdd.map(lambda x:int(x[0]))","commandVersion":0,"state":"finished","results":{"type":"html","data":"<div class=\"ansiout\"></div>","arguments":{},"addedWidgets":{},"removedWidgets":[],"datasetInfos":[]},"errorSummary":"<span class=\"ansired\">NameError</span>: name &apos;average&apos; is not defined","error":null,"workflows":[],"startTime":1494837703941,"submitTime":1494837699099,"finishTime":1494837704165,"collapsed":false,"bindings":{},"inputWidgets":{},"displayType":"table","width":"auto","height":"auto","xColumns":null,"yColumns":null,"pivotColumns":null,"pivotAggregation":null,"customPlotOptions":{},"commentThread":[],"commentsVisible":false,"parentHierarchy":[],"diffInserts":[],"diffDeletes":[],"globalVars":{},"latestUser":"amarildolikmeta@gmail.com","latestUserId":null,"commandTitle":"","showCommandTitle":false,"hideCommandCode":false,"hideCommandResult":false,"iPythonMetadata":null,"streamStates":{},"datasetPreviewNameToCmdIdMap":{},"nuid":"1656896f-910e-420d-b44e-a1f37ee5d9a0"},{"version":"CommandV1","origId":1564474118230703,"guid":"c86f5c55-5db2-4093-8ade-81084f1afc1f","subtype":"command","commandType":"auto","position":3.0,"command":"trainRDD.take(10)","commandVersion":0,"state":"finished","results":{"type":"html","data":"<div class=\"ansiout\"><span class=\"ansired\">Out[</span><span class=\"ansired\">4</span><span class=\"ansired\">]: </span>\n[Row(userId=u&apos;2738&apos;, itemId=u&apos;1&apos;, rating=u&apos;1&apos;),\n Row(userId=u&apos;4716&apos;, itemId=u&apos;1&apos;, rating=u&apos;4&apos;),\n Row(userId=u&apos;13298&apos;, itemId=u&apos;1&apos;, rating=u&apos;8&apos;),\n Row(userId=u&apos;15122&apos;, itemId=u&apos;1&apos;, rating=u&apos;4&apos;),\n Row(userId=u&apos;11326&apos;, itemId=u&apos;2&apos;, rating=u&apos;5&apos;),\n Row(userId=u&apos;3406&apos;, itemId=u&apos;3&apos;, rating=u&apos;4&apos;),\n Row(userId=u&apos;3906&apos;, itemId=u&apos;3&apos;, rating=u&apos;10&apos;),\n Row(userId=u&apos;6345&apos;, itemId=u&apos;3&apos;, rating=u&apos;6&apos;),\n Row(userId=u&apos;7393&apos;, itemId=u&apos;3&apos;, rating=u&apos;8&apos;),\n Row(userId=u&apos;815&apos;, itemId=u&apos;4&apos;, rating=u&apos;8&apos;)]\n</div>","arguments":{},"addedWidgets":{},"removedWidgets":[],"datasetInfos":[]},"errorSummary":"Command skipped","error":null,"workflows":[],"startTime":1494837704182,"submitTime":1494837699156,"finishTime":1494837704910,"collapsed":false,"bindings":{},"inputWidgets":{},"displayType":"lineChart","width":"660","height":"auto","xColumns":["userId"],"yColumns":["num_ratings"],"pivotColumns":[],"pivotAggregation":"sum","customPlotOptions":{"scatterPlot":[{"key":"loess","value":false},{"key":"bandwidth","value":"0.3"}],"lineChart":[]},"commentThread":[],"commentsVisible":false,"parentHierarchy":[],"diffInserts":[],"diffDeletes":[],"globalVars":{},"latestUser":"amarildolikmeta@gmail.com","latestUserId":null,"commandTitle":"","showCommandTitle":false,"hideCommandCode":false,"hideCommandResult":false,"iPythonMetadata":null,"streamStates":{},"datasetPreviewNameToCmdIdMap":{},"nuid":"c3be6c70-2eb8-4f04-967a-e53c62140e33"},{"version":"CommandV1","origId":1653366872393518,"guid":"4ecca1fa-af6f-41e2-8c7b-4bbf57801192","subtype":"command","commandType":"auto","position":4.0,"command":"itemPopularity =trainRDD.map(lambda x: (int(x[1]), 1 ))\nitemPopularity.take(10)","commandVersion":0,"state":"finished","results":{"type":"html","data":"<div class=\"ansiout\"><span class=\"ansired\">Out[</span><span class=\"ansired\">5</span><span class=\"ansired\">]: </span>\n[(1, 1),\n (1, 1),\n (1, 1),\n (1, 1),\n (2, 1),\n (3, 1),\n (3, 1),\n (3, 1),\n (3, 1),\n (4, 1)]\n</div>","arguments":{},"addedWidgets":{},"removedWidgets":[],"datasetInfos":[]},"errorSummary":"Command skipped","error":null,"workflows":[],"startTime":1494837704917,"submitTime":1494837699213,"finishTime":1494837705190,"collapsed":false,"bindings":{},"inputWidgets":{},"displayType":"table","width":"auto","height":"auto","xColumns":null,"yColumns":null,"pivotColumns":null,"pivotAggregation":null,"customPlotOptions":{},"commentThread":[],"commentsVisible":false,"parentHierarchy":[],"diffInserts":[],"diffDeletes":[],"globalVars":{},"latestUser":"amarildolikmeta@gmail.com","latestUserId":null,"commandTitle":"","showCommandTitle":false,"hideCommandCode":false,"hideCommandResult":false,"iPythonMetadata":null,"streamStates":{},"datasetPreviewNameToCmdIdMap":{},"nuid":"1700914d-3e2a-4b69-bd76-ca460d33877a"},{"version":"CommandV1","origId":1653366872393519,"guid":"854e5e61-c3eb-451c-b9ec-376b6692bf32","subtype":"command","commandType":"auto","position":5.0,"command":"itemPopularity = itemPopularity.reduceByKey(lambda x,y :x+y)\nitemPopularity.take(10)                 ","commandVersion":0,"state":"finished","results":{"type":"html","data":"<div class=\"ansiout\"><span class=\"ansired\">Out[</span><span class=\"ansired\">6</span><span class=\"ansired\">]: </span>\n[(32768, 1),\n (2, 1),\n (4, 36),\n (6, 7),\n (8, 1),\n (10, 7),\n (12, 52),\n (32770, 2),\n (14, 1),\n (16, 1)]\n</div>","arguments":{},"addedWidgets":{},"removedWidgets":[],"datasetInfos":[]},"errorSummary":"Command skipped","error":null,"workflows":[],"startTime":1494837705195,"submitTime":1494837699284,"finishTime":1494837706404,"collapsed":false,"bindings":{},"inputWidgets":{},"displayType":"table","width":"auto","height":"auto","xColumns":null,"yColumns":null,"pivotColumns":null,"pivotAggregation":null,"customPlotOptions":{},"commentThread":[],"commentsVisible":false,"parentHierarchy":[],"diffInserts":[],"diffDeletes":[],"globalVars":{},"latestUser":"amarildolikmeta@gmail.com","latestUserId":null,"commandTitle":"","showCommandTitle":false,"hideCommandCode":false,"hideCommandResult":false,"iPythonMetadata":null,"streamStates":{},"datasetPreviewNameToCmdIdMap":{},"nuid":"1a928f3b-cce6-4639-a6b1-72f94fd58d0c"},{"version":"CommandV1","origId":3057526854304820,"guid":"eab97c23-d4a6-489b-9d2c-f373f1017a4d","subtype":"command","commandType":"auto","position":8.0,"command":"itemPopularity_sorted.take(10)","commandVersion":0,"state":"finished","results":{"type":"html","data":"<div class=\"ansiout\"><span class=\"ansired\">Out[</span><span class=\"ansired\">10</span><span class=\"ansired\">]: </span>\n[(24639, 134),\n (31992, 131),\n (33562, 127),\n (33173, 125),\n (28199, 123),\n (19127, 116),\n (25694, 115),\n (18200, 113),\n (6627, 113),\n (22029, 113)]\n</div>","arguments":{},"addedWidgets":{},"removedWidgets":[],"datasetInfos":[]},"errorSummary":"Command skipped","error":null,"workflows":[],"startTime":1494837708294,"submitTime":1494837699511,"finishTime":1494837708467,"collapsed":false,"bindings":{},"inputWidgets":{},"displayType":"table","width":"auto","height":"auto","xColumns":null,"yColumns":null,"pivotColumns":null,"pivotAggregation":null,"customPlotOptions":{},"commentThread":[],"commentsVisible":false,"parentHierarchy":[],"diffInserts":[],"diffDeletes":[],"globalVars":{},"latestUser":"amarildolikmeta@gmail.com","latestUserId":null,"commandTitle":"","showCommandTitle":false,"hideCommandCode":false,"hideCommandResult":false,"iPythonMetadata":null,"streamStates":{},"datasetPreviewNameToCmdIdMap":{},"nuid":"e25ffc99-a196-4fbc-8cc2-14bd4b3e1da9"},{"version":"CommandV1","origId":3057526854304822,"guid":"c5c58c31-011a-446b-86f4-f3979e4f4337","subtype":"command","commandType":"auto","position":9.0,"command":"\nuserSeenItems = trainRDD.map(lambda x: (x[0], [x[1]])).reduceByKey(lambda x,y : x+y)\nuserSeenItems_dict = userSeenItems.collectAsMap()","commandVersion":0,"state":"finished","results":{"type":"html","data":"<div class=\"ansiout\"></div>","arguments":{},"addedWidgets":{},"removedWidgets":[],"datasetInfos":[]},"errorSummary":"<span class=\"ansired\">NameError</span>: name &apos;testRDD&apos; is not defined","error":null,"workflows":[],"startTime":1494837708472,"submitTime":1494837699567,"finishTime":1494837710592,"collapsed":false,"bindings":{},"inputWidgets":{},"displayType":"table","width":"auto","height":"auto","xColumns":null,"yColumns":null,"pivotColumns":null,"pivotAggregation":null,"customPlotOptions":{},"commentThread":[],"commentsVisible":false,"parentHierarchy":[],"diffInserts":[],"diffDeletes":[],"globalVars":{},"latestUser":"amarildolikmeta@gmail.com","latestUserId":null,"commandTitle":"","showCommandTitle":false,"hideCommandCode":false,"hideCommandResult":false,"iPythonMetadata":null,"streamStates":{},"datasetPreviewNameToCmdIdMap":{},"nuid":"75de3136-b978-4ffe-8ce2-5903f7a6f206"},{"version":"CommandV1","origId":3057526854304824,"guid":"16752ce4-9002-4c84-88a2-6a4972bf3cb5","subtype":"command","commandType":"auto","position":11.0,"command":"import numpy as np\n\nitemPopularity_id = np.array(itemPopularity.map(lambda x: x[0]).collect())\nitemPopularity_ranking = np.argsort(itemPopularity.map(lambda x: x[1]).collect())[::-1]\n\nitemPopularity_ordered = itemPopularity_id[itemPopularity_ranking]\nitemPopularity_ordered","commandVersion":0,"state":"finished","results":{"type":"html","data":"<div class=\"ansiout\"><span class=\"ansired\">Out[</span><span class=\"ansired\">13</span><span class=\"ansired\">]: </span>array([24639, 31992, 33562, ..., 20800, 20798, 32768])\n</div>","arguments":{},"addedWidgets":{},"removedWidgets":[],"datasetInfos":[]},"errorSummary":"Command skipped","error":null,"workflows":[],"startTime":1494837710675,"submitTime":1494837699681,"finishTime":1494837710898,"collapsed":false,"bindings":{},"inputWidgets":{},"displayType":"table","width":"auto","height":"auto","xColumns":null,"yColumns":null,"pivotColumns":null,"pivotAggregation":null,"customPlotOptions":{},"commentThread":[],"commentsVisible":false,"parentHierarchy":[],"diffInserts":[],"diffDeletes":[],"globalVars":{},"latestUser":"amarildolikmeta@gmail.com","latestUserId":null,"commandTitle":"","showCommandTitle":false,"hideCommandCode":false,"hideCommandResult":false,"iPythonMetadata":null,"streamStates":{},"datasetPreviewNameToCmdIdMap":{},"nuid":"fada2c73-4def-4190-a3d6-0d977ecf94ca"},{"version":"CommandV1","origId":3057526854304825,"guid":"5ee512f2-5e06-44da-aca7-de08a289f78a","subtype":"command","commandType":"auto","position":12.0,"command":"numberOfItemsToRecommend = 5;\n\ndef recommendTopPopRDDfree(user_id, removeSeen=1):\n    recommendedList = itemPopularity_ordered\n    if(removeSeen):\n      seenItems = np.array(userSeenItems_dict[user_id])\n\n    \n      unseen_mask = np.in1d(recommendedList, seenItems, invert=True)\n        \n      recommendedList = recommendedList[unseen_mask]       \n    \n    return [user_id,recommendedList[0:numberOfItemsToRecommend]]\n","commandVersion":0,"state":"finished","results":{"type":"html","data":"<div class=\"ansiout\"></div>","arguments":{},"addedWidgets":{},"removedWidgets":[],"datasetInfos":[]},"errorSummary":"<span class=\"ansired\">NameError</span>: name &apos;false&apos; is not defined","error":null,"workflows":[],"startTime":1494837710903,"submitTime":1494837699737,"finishTime":1494837710975,"collapsed":false,"bindings":{},"inputWidgets":{},"displayType":"table","width":"auto","height":"auto","xColumns":null,"yColumns":null,"pivotColumns":null,"pivotAggregation":null,"customPlotOptions":{},"commentThread":[],"commentsVisible":false,"parentHierarchy":[],"diffInserts":[],"diffDeletes":[],"globalVars":{},"latestUser":"amarildolikmeta@gmail.com","latestUserId":null,"commandTitle":"","showCommandTitle":false,"hideCommandCode":false,"hideCommandResult":false,"iPythonMetadata":null,"streamStates":{},"datasetPreviewNameToCmdIdMap":{},"nuid":"996ef8b1-b64d-43f0-a8a8-70e294b6fa4d"},{"version":"CommandV1","origId":3057526854304826,"guid":"ba81f53e-76b9-4af7-bde8-7ef7d3a292db","subtype":"command","commandType":"auto","position":13.0,"command":"userList = trainRDD.map(lambda x: x[0])\nuserList_distinct = userList.distinct()","commandVersion":0,"state":"finished","results":{"type":"html","data":"<div class=\"ansiout\"></div>","arguments":{},"addedWidgets":{},"removedWidgets":[],"datasetInfos":[]},"errorSummary":"Command skipped","error":null,"workflows":[],"startTime":1494837710979,"submitTime":1494837699791,"finishTime":1494837711053,"collapsed":false,"bindings":{},"inputWidgets":{},"displayType":"table","width":"auto","height":"auto","xColumns":null,"yColumns":null,"pivotColumns":null,"pivotAggregation":null,"customPlotOptions":{},"commentThread":[],"commentsVisible":false,"parentHierarchy":[],"diffInserts":[],"diffDeletes":[],"globalVars":{},"latestUser":"amarildolikmeta@gmail.com","latestUserId":null,"commandTitle":"","showCommandTitle":false,"hideCommandCode":false,"hideCommandResult":false,"iPythonMetadata":null,"streamStates":{},"datasetPreviewNameToCmdIdMap":{},"nuid":"0004f2a1-40f4-4fd5-8af2-351dc913670c"},{"version":"CommandV1","origId":3057526854304833,"guid":"11921677-e010-4938-8b55-32078f4a9bc6","subtype":"command","commandType":"auto","position":20.0,"command":"df=pd.DataFrame(data=users  # values\n                      # 1st column as index\n                    )\ndisplay(sqlContext.createDataFrame(df))","commandVersion":0,"state":"finished","results":{"type":"table","data":[["4","24639 31992 33562 33173 28199"],["5","24639 31992 33562 33173 28199"],["8","24639 31992 33562 33173 28199"],["9","24639 31992 33562 33173 28199"],["13","24639 31992 33562 33173 28199"],["18","24639 31992 33562 33173 28199"],["19","24639 31992 33562 33173 28199"],["23","24639 31992 33562 33173 28199"],["26","24639 31992 33562 33173 28199"],["29","24639 31992 33562 33173 28199"],["31","24639 31992 33562 33173 28199"],["32","24639 31992 33562 33173 28199"],["33","24639 31992 33562 33173 28199"],["35","24639 31992 33562 33173 28199"],["37","24639 31992 33562 33173 28199"],["51","24639 31992 33562 33173 28199"],["52","24639 31992 33562 33173 28199"],["53","24639 31992 33562 33173 28199"],["54","24639 31992 33562 33173 28199"],["61","24639 31992 33562 33173 28199"],["64","24639 31992 33562 33173 28199"],["69","24639 31992 33562 33173 28199"],["76","24639 31992 33562 33173 28199"],["78","24639 31992 33562 33173 28199"],["79","24639 31992 33562 33173 28199"],["85","24639 31992 33562 33173 28199"],["89","24639 31992 33562 33173 28199"],["92","24639 31992 33562 33173 28199"],["93","24639 31992 33562 33173 28199"],["95","24639 31992 33562 33173 28199"],["100","24639 31992 33562 33173 28199"],["104","24639 31992 33562 33173 28199"],["105","24639 31992 33562 33173 28199"],["109","24639 31992 33562 33173 28199"],["110","24639 31992 33562 33173 28199"],["111","24639 31992 33562 33173 28199"],["112","24639 31992 33562 33173 28199"],["122","24639 31992 33562 33173 28199"],["126","24639 31992 33562 33173 28199"],["131","24639 31992 33562 33173 28199"],["132","24639 31992 33562 33173 28199"],["136","24639 31992 33562 33173 28199"],["140","24639 31992 33562 33173 28199"],["144","24639 31992 33562 33173 28199"],["145","24639 31992 33562 33173 28199"],["146","24639 31992 33562 33173 28199"],["151","24639 31992 33562 33173 28199"],["152","24639 31992 33562 33173 28199"],["155","24639 31992 33562 33173 28199"],["156","24639 31992 33562 33173 28199"],["160","24639 31992 33562 33173 28199"],["162","24639 31992 33562 33173 28199"],["164","24639 31992 33562 33173 28199"],["165","24639 31992 33562 33173 28199"],["166","24639 31992 33562 33173 28199"],["169","24639 31992 33562 33173 28199"],["173","24639 31992 33562 33173 28199"],["179","24639 31992 33562 33173 28199"],["184","24639 31992 33562 33173 28199"],["185","24639 31992 33562 33173 28199"],["186","24639 31992 33562 33173 28199"],["187","24639 31992 33562 33173 28199"],["189","24639 31992 33562 33173 28199"],["190","24639 31992 33562 33173 28199"],["191","24639 31992 33562 33173 28199"],["197","24639 31992 33562 33173 28199"],["205","24639 31992 33562 33173 28199"],["208","24639 31992 33562 33173 28199"],["209","24639 31992 33562 33173 28199"],["217","24639 31992 33562 33173 28199"],["218","24639 31992 33562 33173 28199"],["222","24639 31992 33562 33173 28199"],["223","24639 31992 33562 33173 28199"],["234","24639 31992 33562 33173 28199"],["240","24639 31992 33562 33173 28199"],["246","24639 31992 33562 33173 28199"],["247","24639 31992 33562 33173 28199"],["250","24639 31992 33562 33173 28199"],["257","24639 31992 33562 33173 28199"],["258","24639 31992 33562 33173 28199"],["268","24639 31992 33562 33173 28199"],["269","24639 31992 33562 33173 28199"],["270","24639 31992 33562 33173 28199"],["274","24639 31992 33562 33173 28199"],["278","24639 31992 33562 33173 28199"],["281","24639 31992 33562 33173 28199"],["288","24639 31992 33562 33173 28199"],["294","24639 31992 33562 33173 28199"],["296","24639 31992 33562 33173 28199"],["299","24639 31992 33562 33173 28199"],["301","24639 31992 33562 33173 28199"],["308","24639 31992 33562 33173 28199"],["310","24639 31992 33562 33173 28199"],["312","24639 31992 33562 33173 28199"],["314","24639 31992 33562 33173 28199"],["318","24639 31992 33562 33173 28199"],["321","24639 31992 33562 33173 28199"],["326","24639 31992 33562 33173 28199"],["327","24639 31992 33562 33173 28199"],["333","24639 31992 33562 33173 28199"],["336","24639 31992 33562 33173 28199"],["337","24639 31992 33562 33173 28199"],["339","24639 31992 33562 33173 28199"],["344","24639 31992 33562 33173 28199"],["350","24639 31992 33562 33173 28199"],["353","24639 31992 33562 33173 28199"],["355","24639 31992 33562 33173 28199"],["359","24639 31992 33562 33173 28199"],["361","24639 31992 33562 33173 28199"],["364","24639 31992 33562 33173 28199"],["365","24639 31992 33562 33173 28199"],["374","24639 31992 33562 33173 28199"],["375","24639 31992 33562 33173 28199"],["376","24639 31992 33562 33173 28199"],["378","24639 31992 33562 33173 28199"],["379","24639 31992 33562 33173 28199"],["380","24639 31992 33562 33173 28199"],["383","24639 31992 33562 33173 28199"],["385","24639 31992 33562 33173 28199"],["388","24639 31992 33562 33173 28199"],["390","24639 31992 33562 33173 28199"],["393","24639 31992 33562 33173 28199"],["399","24639 31992 33562 33173 28199"],["401","24639 31992 33562 33173 28199"],["405","24639 31992 33562 33173 28199"],["412","24639 31992 33562 33173 28199"],["413","24639 31992 33562 33173 28199"],["415","24639 31992 33562 33173 28199"],["418","24639 31992 33562 33173 28199"],["431","24639 31992 33562 33173 28199"],["433","24639 31992 33562 33173 28199"],["441","24639 31992 33562 33173 28199"],["443","24639 31992 33562 33173 28199"],["445","24639 31992 33562 33173 28199"],["449","24639 31992 33562 33173 28199"],["456","24639 31992 33562 33173 28199"],["458","24639 31992 33562 33173 28199"],["459","24639 31992 33562 33173 28199"],["463","24639 31992 33562 33173 28199"],["466","24639 31992 33562 33173 28199"],["477","24639 31992 33562 33173 28199"],["478","24639 31992 33562 33173 28199"],["481","24639 31992 33562 33173 28199"],["487","24639 31992 33562 33173 28199"],["488","24639 31992 33562 33173 28199"],["491","24639 31992 33562 33173 28199"],["494","24639 31992 33562 33173 28199"],["503","24639 31992 33562 33173 28199"],["504","24639 31992 33562 33173 28199"],["508","24639 31992 33562 33173 28199"],["509","24639 31992 33562 33173 28199"],["510","24639 31992 33562 33173 28199"],["511","24639 31992 33562 33173 28199"],["516","24639 31992 33562 33173 28199"],["524","24639 31992 33562 33173 28199"],["527","24639 31992 33562 33173 28199"],["531","24639 31992 33562 33173 28199"],["532","24639 31992 33562 33173 28199"],["541","24639 31992 33562 33173 28199"],["542","24639 31992 33562 33173 28199"],["543","24639 31992 33562 33173 28199"],["549","24639 31992 33562 33173 28199"],["551","24639 31992 33562 33173 28199"],["559","24639 31992 33562 33173 28199"],["565","24639 31992 33562 33173 28199"],["568","24639 31992 33562 33173 28199"],["569","24639 31992 33562 33173 28199"],["572","24639 31992 33562 33173 28199"],["582","24639 31992 33562 33173 28199"],["589","24639 31992 33562 33173 28199"],["590","24639 31992 33562 33173 28199"],["592","24639 31992 33562 33173 28199"],["595","24639 31992 33562 33173 28199"],["599","24639 31992 33562 33173 28199"],["600","24639 31992 33562 33173 28199"],["603","24639 31992 33562 33173 28199"],["605","24639 31992 33562 33173 28199"],["606","24639 31992 33562 33173 28199"],["615","24639 31992 33562 33173 28199"],["616","24639 31992 33562 33173 28199"],["617","24639 31992 33562 33173 28199"],["621","24639 31992 33562 33173 28199"],["632","24639 31992 33562 33173 28199"],["643","24639 31992 33562 33173 28199"],["646","24639 31992 33562 33173 28199"],["651","24639 31992 33562 33173 28199"],["652","24639 31992 33562 33173 28199"],["653","24639 31992 33562 33173 28199"],["654","24639 31992 33562 33173 28199"],["658","24639 31992 33562 33173 28199"],["659","24639 31992 33562 33173 28199"],["663","24639 31992 33562 33173 28199"],["665","24639 31992 33562 33173 28199"],["673","24639 31992 33562 33173 28199"],["675","24639 31992 33562 33173 28199"],["680","24639 31992 33562 33173 28199"],["681","24639 31992 33562 33173 28199"],["684","24639 31992 33562 33173 28199"],["691","24639 31992 33562 33173 28199"],["696","24639 31992 33562 33173 28199"],["700","24639 31992 33562 33173 28199"],["705","24639 31992 33562 33173 28199"],["706","24639 31992 33562 33173 28199"],["710","24639 31992 33562 33173 28199"],["712","24639 31992 33562 33173 28199"],["713","24639 31992 33562 33173 28199"],["715","24639 31992 33562 33173 28199"],["717","24639 31992 33562 33173 28199"],["722","24639 31992 33562 33173 28199"],["725","24639 31992 33562 33173 28199"],["729","24639 31992 33562 33173 28199"],["733","24639 31992 33562 33173 28199"],["739","24639 31992 33562 33173 28199"],["741","24639 31992 33562 33173 28199"],["744","24639 31992 33562 33173 28199"],["747","24639 31992 33562 33173 28199"],["750","24639 31992 33562 33173 28199"],["757","24639 31992 33562 33173 28199"],["759","24639 31992 33562 33173 28199"],["761","24639 31992 33562 33173 28199"],["773","24639 31992 33562 33173 28199"],["777","24639 31992 33562 33173 28199"],["780","24639 31992 33562 33173 28199"],["782","24639 31992 33562 33173 28199"],["784","24639 31992 33562 33173 28199"],["787","24639 31992 33562 33173 28199"],["788","24639 31992 33562 33173 28199"],["789","24639 31992 33562 33173 28199"],["791","24639 31992 33562 33173 28199"],["792","24639 31992 33562 33173 28199"],["796","24639 31992 33562 33173 28199"],["801","24639 31992 33562 33173 28199"],["806","24639 31992 33562 33173 28199"],["808","24639 31992 33562 33173 28199"],["810","24639 31992 33562 33173 28199"],["813","24639 31992 33562 33173 28199"],["816","24639 31992 33562 33173 28199"],["820","24639 31992 33562 33173 28199"],["826","24639 31992 33562 33173 28199"],["827","31992 33562 33173 28199 19127"],["828","24639 31992 33562 33173 28199"],["831","24639 31992 33562 33173 28199"],["833","24639 31992 33562 33173 28199"],["834","24639 31992 33562 33173 28199"],["835","24639 31992 33562 33173 28199"],["839","24639 31992 33562 33173 28199"],["850","24639 31992 33562 33173 28199"],["852","24639 31992 33562 33173 28199"],["853","24639 31992 33562 33173 28199"],["854","24639 31992 33562 33173 28199"],["857","24639 31992 33562 33173 28199"],["862","24639 31992 33562 33173 28199"],["867","24639 31992 33562 33173 28199"],["869","24639 31992 33562 33173 28199"],["873","24639 31992 33562 33173 28199"],["874","24639 31992 33562 33173 28199"],["879","24639 31992 33562 33173 28199"],["883","24639 31992 33562 33173 28199"],["884","24639 31992 33562 33173 28199"],["886","24639 31992 33562 33173 28199"],["888","24639 31992 33562 33173 28199"],["890","24639 31992 33562 33173 28199"],["899","24639 31992 33562 33173 28199"],["900","24639 31992 33562 33173 28199"],["905","24639 31992 33562 33173 28199"],["907","24639 31992 33562 33173 28199"],["908","24639 31992 33562 33173 28199"],["909","24639 31992 33562 33173 28199"],["916","24639 31992 33562 33173 28199"],["919","24639 31992 33562 33173 28199"],["926","24639 31992 33562 33173 28199"],["927","24639 31992 33562 33173 28199"],["929","24639 31992 33562 33173 28199"],["937","24639 31992 33562 33173 28199"],["942","24639 31992 33562 33173 28199"],["944","24639 31992 33562 33173 28199"],["946","24639 31992 33562 33173 28199"],["947","24639 31992 33562 33173 28199"],["949","24639 31992 33562 33173 28199"],["956","24639 31992 33562 33173 28199"],["958","24639 31992 33562 33173 28199"],["961","24639 31992 33562 33173 28199"],["968","24639 31992 33562 33173 28199"],["969","24639 31992 33562 33173 28199"],["972","24639 31992 33562 33173 28199"],["977","24639 31992 33562 33173 28199"],["978","24639 31992 33562 33173 28199"],["979","24639 31992 33562 33173 28199"],["982","24639 31992 33562 33173 28199"],["983","24639 31992 33562 33173 28199"],["987","24639 31992 33562 33173 28199"],["990","24639 31992 33562 33173 28199"],["1005","24639 31992 33562 33173 28199"],["1010","24639 31992 33562 33173 28199"],["1011","24639 31992 33562 33173 28199"],["1014","24639 31992 33562 33173 28199"],["1016","24639 31992 33562 33173 28199"],["1017","24639 31992 33562 33173 28199"],["1033","24639 31992 33562 33173 28199"],["1043","24639 31992 33562 33173 28199"],["1044","24639 31992 33562 33173 28199"],["1046","24639 31992 33562 33173 28199"],["1055","24639 31992 33562 33173 28199"],["1060","24639 31992 33562 33173 28199"],["1061","24639 31992 33562 33173 28199"],["1067","24639 31992 33562 33173 28199"],["1068","24639 31992 33562 33173 28199"],["1076","24639 31992 33562 33173 28199"],["1077","24639 31992 33562 33173 28199"],["1084","24639 31992 33562 33173 28199"],["1097","24639 31992 33562 33173 28199"],["1102","24639 31992 33562 33173 28199"],["1107","24639 31992 33562 33173 28199"],["1110","24639 31992 33562 33173 28199"],["1112","24639 31992 33562 33173 28199"],["1113","24639 31992 33562 33173 28199"],["1114","24639 31992 33562 33173 28199"],["1117","24639 31992 33562 33173 28199"],["1118","24639 31992 33562 33173 28199"],["1121","24639 31992 33562 33173 28199"],["1122","24639 31992 33562 33173 28199"],["1128","24639 31992 33562 33173 28199"],["1135","24639 31992 33562 33173 28199"],["1136","24639 31992 33562 33173 28199"],["1137","24639 31992 33562 33173 28199"],["1144","24639 31992 33562 33173 28199"],["1145","24639 31992 33562 33173 28199"],["1146","24639 31992 33562 33173 28199"],["1148","24639 31992 33562 33173 28199"],["1151","24639 31992 33562 33173 28199"],["1152","24639 31992 33562 33173 28199"],["1157","24639 31992 33562 33173 28199"],["1159","24639 31992 33562 33173 28199"],["1161","24639 31992 33562 33173 28199"],["1163","24639 31992 33562 33173 28199"],["1165","24639 31992 33562 33173 28199"],["1173","24639 31992 33562 33173 28199"],["1175","24639 31992 33562 33173 28199"],["1177","24639 31992 33562 33173 28199"],["1178","24639 31992 33562 33173 28199"],["1180","24639 31992 33562 33173 28199"],["1181","24639 31992 33562 33173 28199"],["1184","24639 31992 33562 33173 28199"],["1189","24639 31992 33562 33173 28199"],["1190","24639 31992 33562 33173 28199"],["1193","24639 31992 33562 33173 28199"],["1201","24639 31992 33562 33173 28199"],["1204","24639 31992 33562 33173 28199"],["1205","24639 31992 33562 33173 28199"],["1218","24639 31992 33562 33173 28199"],["1222","24639 31992 33562 33173 28199"],["1224","24639 31992 33562 33173 28199"],["1229","24639 31992 33562 33173 28199"],["1233","24639 31992 33562 33173 28199"],["1235","24639 31992 33562 33173 28199"],["1236","24639 31992 33562 33173 28199"],["1238","24639 31992 33562 33173 28199"],["1240","24639 31992 33562 33173 28199"],["1249","24639 31992 33562 33173 28199"],["1256","24639 31992 33562 33173 28199"],["1263","24639 31992 33562 33173 28199"],["1264","24639 31992 33562 33173 28199"],["1279","24639 31992 33562 33173 28199"],["1280","24639 31992 33562 33173 28199"],["1282","24639 31992 33562 33173 28199"],["1289","24639 31992 33562 33173 28199"],["1291","24639 31992 33562 33173 28199"],["1292","24639 31992 33562 33173 28199"],["1297","24639 31992 33562 33173 28199"],["1298","24639 31992 33562 33173 28199"],["1314","24639 31992 33562 33173 28199"],["1316","24639 31992 33562 33173 28199"],["1322","24639 31992 33562 33173 28199"],["1327","24639 31992 33562 33173 28199"],["1333","24639 31992 33562 33173 28199"],["1334","24639 31992 33562 33173 28199"],["1335","24639 31992 33562 33173 28199"],["1336","24639 31992 33562 33173 28199"],["1343","24639 31992 33562 33173 28199"],["1345","24639 31992 33562 33173 28199"],["1346","24639 31992 33562 33173 28199"],["1348","24639 31992 33562 33173 28199"],["1356","24639 31992 33562 33173 28199"],["1361","24639 31992 33562 33173 28199"],["1365","24639 31992 33562 33173 28199"],["1373","24639 31992 33562 33173 28199"],["1378","24639 31992 33562 33173 28199"],["1379","24639 31992 33562 33173 28199"],["1387","24639 31992 33562 33173 28199"],["1391","24639 31992 33562 33173 28199"],["1405","24639 31992 33562 33173 28199"],["1406","24639 31992 33562 33173 28199"],["1408","24639 31992 33562 33173 28199"],["1416","24639 31992 33562 33173 28199"],["1417","24639 31992 33562 33173 28199"],["1418","24639 31992 33562 33173 28199"],["1420","24639 31992 33562 33173 28199"],["1423","24639 31992 33562 33173 28199"],["1426","24639 31992 33562 33173 28199"],["1428","24639 31992 33562 33173 28199"],["1431","24639 31992 33562 33173 28199"],["1433","24639 31992 33562 33173 28199"],["1436","24639 31992 33562 33173 28199"],["1438","24639 31992 33562 33173 28199"],["1444","24639 31992 33562 33173 28199"],["1445","24639 31992 33562 33173 28199"],["1447","24639 31992 33562 33173 28199"],["1452","24639 31992 33562 33173 28199"],["1453","24639 31992 33562 33173 28199"],["1463","24639 31992 33562 33173 28199"],["1470","24639 31992 33562 33173 28199"],["1473","24639 31992 33562 33173 28199"],["1474","24639 31992 33562 33173 28199"],["1476","24639 31992 33562 33173 28199"],["1481","24639 31992 33562 33173 28199"],["1484","24639 31992 33562 33173 28199"],["1486","24639 31992 33562 33173 28199"],["1487","24639 31992 33562 33173 28199"],["1493","24639 31992 33562 33173 28199"],["1501","24639 31992 33562 33173 28199"],["1502","24639 31992 33562 33173 28199"],["1503","24639 31992 33562 33173 28199"],["1506","24639 31992 33562 33173 28199"],["1508","24639 31992 33562 33173 28199"],["1509","24639 31992 33562 33173 28199"],["1510","24639 31992 33562 33173 28199"],["1511","24639 31992 33562 33173 28199"],["1516","24639 31992 33562 33173 28199"],["1527","24639 31992 33562 33173 28199"],["1528","24639 31992 33562 33173 28199"],["1538","24639 31992 33562 33173 28199"],["1547","24639 31992 33562 33173 28199"],["1551","24639 31992 33562 33173 28199"],["1555","24639 31992 33562 33173 28199"],["1560","24639 31992 33562 33173 28199"],["1564","24639 31992 33562 33173 28199"],["1572","24639 31992 33562 33173 28199"],["1576","24639 31992 33562 33173 28199"],["1577","24639 31992 33562 33173 28199"],["1578","24639 31992 33562 33173 28199"],["1587","24639 31992 33562 33173 28199"],["1588","24639 31992 33562 33173 28199"],["1606","24639 31992 33562 33173 28199"],["1607","24639 31992 33562 33173 28199"],["1617","24639 31992 33562 33173 28199"],["1620","24639 31992 33562 33173 28199"],["1624","24639 31992 33562 33173 28199"],["1626","24639 31992 33562 33173 28199"],["1627","24639 31992 33562 33173 28199"],["1635","24639 31992 33562 33173 28199"],["1636","24639 31992 33562 33173 28199"],["1637","24639 31992 33562 33173 28199"],["1638","24639 31992 33562 33173 28199"],["1641","24639 31992 33562 33173 28199"],["1642","24639 31992 33562 33173 28199"],["1643","24639 31992 33562 33173 28199"],["1644","24639 31992 33562 33173 28199"],["1645","24639 31992 33562 33173 28199"],["1647","24639 31992 33562 33173 28199"],["1648","24639 31992 33562 33173 28199"],["1649","24639 31992 33562 33173 28199"],["1657","24639 31992 33562 33173 28199"],["1658","24639 31992 33562 33173 28199"],["1661","24639 31992 33562 33173 28199"],["1663","24639 31992 33562 33173 28199"],["1664","24639 31992 33562 33173 28199"],["1667","24639 31992 33562 33173 28199"],["1670","24639 31992 33562 33173 28199"],["1675","24639 31992 33562 33173 28199"],["1681","24639 31992 33562 33173 28199"],["1684","24639 31992 33562 33173 28199"],["1685","24639 31992 33562 33173 28199"],["1686","24639 31992 33562 33173 28199"],["1693","24639 31992 33562 33173 28199"],["1696","24639 31992 33562 33173 28199"],["1699","24639 31992 33562 33173 28199"],["1707","24639 31992 33562 33173 28199"],["1713","24639 31992 33562 33173 28199"],["1719","24639 31992 33562 33173 28199"],["1723","24639 31992 33562 33173 28199"],["1726","24639 31992 33562 33173 28199"],["1727","24639 31992 33562 33173 28199"],["1728","24639 31992 33562 33173 28199"],["1734","24639 31992 33562 33173 28199"],["1739","24639 31992 33562 33173 28199"],["1740","24639 31992 33562 33173 28199"],["1750","24639 31992 33562 33173 28199"],["1756","24639 31992 33562 33173 28199"],["1757","24639 31992 33562 33173 28199"],["1760","24639 31992 33562 33173 28199"],["1761","24639 31992 33562 33173 28199"],["1764","24639 31992 33562 33173 28199"],["1765","24639 31992 33562 33173 28199"],["1766","24639 31992 33562 33173 28199"],["1767","24639 31992 33562 33173 28199"],["1768","24639 31992 33562 33173 28199"],["1773","24639 31992 33562 33173 28199"],["1782","24639 31992 33562 33173 28199"],["1785","24639 31992 33562 33173 28199"],["1786","24639 31992 33562 33173 28199"],["1787","24639 31992 33562 33173 28199"],["1788","24639 31992 33562 33173 28199"],["1789","24639 31992 33562 33173 28199"],["1792","24639 31992 33562 33173 28199"],["1796","24639 31992 33562 33173 28199"],["1800","24639 31992 33562 33173 28199"],["1803","24639 31992 33562 33173 28199"],["1804","24639 31992 33562 33173 28199"],["1805","24639 31992 33562 33173 28199"],["1806","24639 31992 33562 33173 28199"],["1807","24639 31992 33562 33173 28199"],["1808","24639 31992 33562 33173 28199"],["1812","24639 31992 33562 33173 28199"],["1813","24639 31992 33562 33173 28199"],["1816","24639 31992 33562 33173 28199"],["1818","24639 31992 33562 33173 28199"],["1820","24639 31992 33562 33173 28199"],["1823","24639 31992 33562 33173 28199"],["1827","24639 31992 33562 33173 28199"],["1829","24639 31992 33562 33173 28199"],["1833","24639 31992 33562 33173 28199"],["1845","24639 31992 33562 33173 28199"],["1857","24639 31992 33562 33173 28199"],["1858","24639 31992 33562 33173 28199"],["1862","24639 31992 33562 33173 28199"],["1866","24639 31992 33562 33173 28199"],["1874","24639 31992 33562 33173 28199"],["1875","24639 31992 33562 33173 28199"],["1876","24639 31992 33562 33173 28199"],["1879","24639 31992 33562 33173 28199"],["1881","24639 31992 33562 33173 28199"],["1883","24639 31992 33562 33173 28199"],["1885","24639 31992 33562 33173 28199"],["1888","24639 31992 33562 33173 28199"],["1898","24639 31992 33562 33173 28199"],["1899","24639 31992 33562 33173 28199"],["1900","24639 31992 33562 33173 28199"],["1901","24639 31992 33562 33173 28199"],["1906","24639 31992 33562 33173 28199"],["1910","24639 31992 33562 33173 28199"],["1911","24639 31992 33562 33173 28199"],["1918","24639 31992 33562 33173 28199"],["1919","24639 31992 33562 33173 28199"],["1920","24639 31992 33562 33173 28199"],["1933","24639 31992 33562 33173 28199"],["1935","24639 31992 33562 33173 28199"],["1936","24639 31992 33562 33173 28199"],["1938","24639 31992 33562 33173 28199"],["1940","24639 31992 33562 33173 28199"],["1941","24639 31992 33562 33173 28199"],["1943","24639 31992 33562 33173 28199"],["1944","24639 31992 33562 33173 28199"],["1945","24639 31992 33562 33173 28199"],["1947","24639 31992 33562 33173 28199"],["1948","24639 31992 33562 33173 28199"],["1950","24639 31992 33562 33173 28199"],["1952","24639 31992 33562 33173 28199"],["1954","24639 31992 33562 33173 28199"],["1955","24639 31992 33562 33173 28199"],["1956","24639 31992 33562 33173 28199"],["1957","24639 31992 33562 33173 28199"],["1963","24639 31992 33173 28199 19127"],["1964","24639 31992 33562 33173 28199"],["1976","24639 31992 33562 33173 28199"],["1977","24639 31992 33562 33173 28199"],["1978","24639 31992 33562 33173 28199"],["1981","24639 31992 33562 33173 28199"],["1985","24639 31992 33562 33173 28199"],["1986","24639 31992 33562 33173 28199"],["1991","24639 31992 33562 33173 28199"],["1993","24639 31992 33562 33173 28199"],["1999","24639 31992 33562 33173 28199"],["2007","24639 31992 33562 33173 28199"],["2009","24639 31992 33562 33173 28199"],["2011","24639 31992 33562 33173 28199"],["2013","24639 31992 33562 33173 28199"],["2017","24639 31992 33562 33173 28199"],["2020","24639 31992 33562 33173 28199"],["2027","24639 31992 33562 33173 28199"],["2028","24639 31992 33562 33173 28199"],["2037","24639 31992 33562 33173 28199"],["2040","24639 31992 33562 33173 28199"],["2041","24639 31992 33562 33173 28199"],["2042","24639 31992 33562 33173 28199"],["2045","24639 31992 33562 33173 28199"],["2051","24639 31992 33562 33173 28199"],["2052","24639 31992 33562 33173 28199"],["2053","24639 31992 33562 33173 28199"],["2054","24639 31992 33562 33173 28199"],["2058","24639 31992 33562 33173 28199"],["2060","24639 31992 33562 33173 28199"],["2061","24639 31992 33562 33173 28199"],["2066","24639 31992 33562 33173 28199"],["2072","24639 31992 33562 33173 28199"],["2073","24639 31992 33562 33173 28199"],["2080","24639 31992 33562 33173 28199"],["2081","24639 31992 33562 33173 28199"],["2084","24639 31992 33562 33173 28199"],["2086","24639 31992 33562 33173 28199"],["2090","24639 31992 33562 33173 28199"],["2091","24639 31992 33562 33173 28199"],["2095","24639 31992 33562 33173 28199"],["2097","24639 31992 33562 33173 28199"],["2106","24639 31992 33562 33173 28199"],["2108","24639 31992 33562 33173 28199"],["2117","24639 31992 33562 33173 28199"],["2119","24639 31992 33562 33173 28199"],["2121","24639 31992 33562 33173 28199"],["2124","24639 31992 33562 33173 28199"],["2129","24639 31992 33562 33173 28199"],["2130","24639 31992 33562 33173 28199"],["2132","24639 31992 33562 33173 28199"],["2133","24639 31992 33562 33173 28199"],["2135","24639 31992 33562 33173 28199"],["2136","24639 31992 33562 33173 28199"],["2137","24639 31992 33562 33173 28199"],["2146","24639 31992 33562 33173 28199"],["2147","24639 31992 33562 33173 28199"],["2149","24639 31992 33562 33173 28199"],["2155","24639 31992 33562 33173 28199"],["2156","24639 31992 33562 33173 28199"],["2157","24639 31992 33562 33173 28199"],["2164","24639 31992 33562 33173 28199"],["2167","24639 31992 33562 33173 28199"],["2168","24639 31992 33562 33173 28199"],["2179","24639 31992 33562 33173 28199"],["2182","24639 31992 33562 33173 28199"],["2186","24639 31992 33562 33173 28199"],["2195","24639 31992 33562 33173 28199"],["2202","24639 31992 33562 33173 28199"],["2212","24639 31992 33562 33173 28199"],["2227","24639 31992 33562 33173 28199"],["2236","24639 31992 33562 33173 28199"],["2244","24639 31992 33562 33173 28199"],["2247","24639 31992 33562 33173 28199"],["2248","24639 31992 33562 33173 28199"],["2254","24639 31992 33562 33173 28199"],["2257","24639 31992 33562 33173 28199"],["2261","24639 31992 33562 33173 28199"],["2263","24639 31992 33562 33173 28199"],["2265","24639 31992 33562 33173 28199"],["2268","24639 31992 33562 33173 28199"],["2270","24639 31992 33562 33173 28199"],["2272","24639 31992 33562 33173 28199"],["2273","24639 31992 33562 33173 28199"],["2274","24639 31992 33562 33173 28199"],["2280","24639 31992 33562 33173 28199"],["2285","24639 31992 33562 33173 28199"],["2287","24639 31992 33562 33173 28199"],["2290","24639 31992 33562 33173 28199"],["2298","24639 31992 33562 33173 28199"],["2305","24639 31992 33562 33173 28199"],["2306","24639 31992 33562 33173 28199"],["2312","24639 31992 33562 33173 28199"],["2313","24639 31992 33562 33173 28199"],["2319","24639 31992 33562 33173 28199"],["2320","24639 31992 33562 33173 28199"],["2324","24639 31992 33562 33173 28199"],["2326","24639 31992 33562 33173 28199"],["2330","24639 31992 33562 33173 28199"],["2338","24639 31992 33562 33173 28199"],["2341","24639 31992 33562 33173 28199"],["2345","24639 31992 33562 33173 28199"],["2346","24639 33562 33173 28199 19127"],["2347","24639 31992 33562 33173 28199"],["2351","24639 31992 33562 33173 28199"],["2352","24639 31992 33562 33173 28199"],["2357","24639 31992 33562 33173 28199"],["2360","24639 31992 33562 33173 28199"],["2361","24639 31992 33562 33173 28199"],["2366","24639 31992 33562 33173 28199"],["2368","24639 31992 33562 33173 28199"],["2369","24639 31992 33562 33173 28199"],["2374","24639 31992 33562 33173 28199"],["2379","24639 31992 33562 33173 28199"],["2388","24639 31992 33562 33173 28199"],["2394","24639 31992 33562 33173 28199"],["2397","24639 31992 33562 33173 28199"],["2398","24639 31992 33562 33173 28199"],["2399","24639 31992 33562 33173 28199"],["2403","24639 31992 33562 33173 28199"],["2404","24639 31992 33562 33173 28199"],["2407","24639 31992 33562 33173 28199"],["2409","24639 31992 33562 33173 28199"],["2410","24639 31992 33562 33173 28199"],["2414","24639 31992 33562 33173 28199"],["2421","24639 31992 33562 33173 28199"],["2426","24639 31992 33562 33173 28199"],["2428","24639 31992 33562 33173 28199"],["2435","24639 31992 33562 33173 28199"],["2442","24639 31992 33562 33173 28199"],["2448","24639 31992 33562 33173 28199"],["2449","24639 31992 33562 33173 28199"],["2452","24639 31992 33562 33173 28199"],["2455","24639 31992 33562 33173 28199"],["2466","24639 31992 33562 33173 28199"],["2467","24639 31992 33562 33173 28199"],["2472","24639 31992 33562 33173 28199"],["2474","24639 31992 33562 33173 28199"],["2480","24639 31992 33562 33173 28199"],["2489","24639 31992 33562 33173 28199"],["2496","24639 31992 33562 33173 28199"],["2500","24639 31992 33562 33173 28199"],["2502","24639 31992 33562 33173 28199"],["2504","24639 31992 33562 33173 28199"],["2506","24639 31992 33562 33173 28199"],["2508","24639 31992 33562 33173 28199"],["2512","24639 31992 33562 33173 28199"],["2519","24639 31992 33562 33173 28199"],["2520","24639 31992 33562 33173 28199"],["2521","24639 31992 33562 33173 28199"],["2524","24639 31992 33562 33173 28199"],["2528","24639 31992 33562 33173 28199"],["2543","24639 31992 33562 33173 28199"],["2547","24639 31992 33562 33173 28199"],["2549","24639 31992 33562 33173 28199"],["2551","24639 31992 33562 33173 28199"],["2557","24639 31992 33562 33173 28199"],["2560","24639 31992 33562 33173 28199"],["2561","24639 31992 33562 33173 28199"],["2564","24639 31992 33562 33173 28199"],["2569","24639 31992 33562 33173 28199"],["2570","24639 31992 33562 33173 28199"],["2571","24639 31992 33562 33173 28199"],["2581","24639 31992 33562 33173 28199"],["2582","24639 31992 33562 33173 28199"],["2585","24639 31992 33562 33173 28199"],["2591","24639 31992 33562 33173 28199"],["2595","24639 31992 33562 33173 28199"],["2597","24639 31992 33562 33173 28199"],["2599","24639 31992 33562 33173 28199"],["2602","24639 31992 33562 33173 28199"],["2603","24639 31992 33562 33173 28199"],["2604","24639 31992 33562 33173 28199"],["2610","24639 31992 33562 33173 28199"],["2617","24639 31992 33562 33173 28199"],["2621","24639 31992 33562 33173 28199"],["2623","24639 31992 33562 33173 28199"],["2624","24639 31992 33562 33173 28199"],["2629","24639 31992 33562 33173 28199"],["2631","24639 31992 33562 33173 28199"],["2633","24639 31992 33562 33173 28199"],["2638","24639 31992 33562 33173 28199"],["2644","24639 31992 33562 33173 28199"],["2645","24639 31992 33562 33173 28199"],["2647","24639 31992 33562 33173 28199"],["2648","24639 31992 33562 33173 28199"],["2651","24639 31992 33562 33173 28199"],["2654","24639 31992 33562 33173 28199"],["2655","24639 31992 33562 33173 28199"],["2658","24639 31992 33562 33173 28199"],["2661","24639 31992 33562 33173 28199"],["2662","24639 31992 33562 33173 28199"],["2667","24639 31992 33562 33173 28199"],["2674","24639 31992 33562 33173 28199"],["2675","24639 31992 33562 33173 28199"],["2680","24639 31992 33562 33173 28199"],["2686","24639 31992 33562 33173 28199"],["2690","24639 31992 33562 33173 28199"],["2696","31992 33562 33173 28199 19127"],["2697","24639 31992 33562 33173 28199"],["2699","24639 31992 33562 33173 28199"],["2701","24639 31992 33562 33173 28199"],["2709","24639 31992 33562 33173 28199"],["2712","24639 31992 33562 33173 28199"],["2713","24639 31992 33562 33173 28199"],["2716","24639 31992 33562 33173 28199"],["2718","24639 31992 33562 33173 28199"],["2721","24639 31992 33562 33173 28199"],["2728","24639 31992 33562 33173 28199"],["2729","24639 31992 33562 33173 28199"],["2734","24639 31992 33562 33173 28199"],["2737","24639 31992 33562 33173 28199"],["2743","24639 31992 33562 33173 28199"],["2751","24639 31992 33562 33173 28199"],["2762","24639 31992 33562 33173 28199"],["2764","24639 31992 33562 33173 28199"],["2772","24639 31992 33562 33173 28199"],["2775","24639 31992 33562 33173 28199"],["2776","24639 31992 33562 33173 28199"],["2782","24639 31992 33562 33173 28199"],["2784","24639 31992 33562 33173 28199"],["2785","24639 31992 33562 33173 28199"],["2795","24639 31992 33562 33173 28199"],["2800","24639 31992 33562 33173 28199"],["2801","24639 31992 33562 33173 28199"],["2808","24639 31992 33562 33173 28199"],["2812","24639 31992 33562 33173 28199"],["2813","24639 31992 33562 33173 28199"],["2816","24639 31992 33562 33173 28199"],["2823","24639 31992 33562 33173 28199"],["2829","24639 31992 33562 33173 28199"],["2830","24639 31992 33562 33173 28199"],["2832","24639 31992 33562 33173 28199"],["2835","24639 31992 33562 33173 28199"],["2837","24639 31992 33562 33173 28199"],["2839","24639 31992 33562 33173 28199"],["2843","24639 31992 33562 33173 28199"],["2845","24639 31992 33562 33173 28199"],["2850","24639 31992 33562 33173 28199"],["2860","24639 31992 33562 33173 28199"],["2862","24639 31992 33562 33173 28199"],["2865","24639 31992 33562 33173 28199"],["2867","24639 31992 33562 33173 28199"],["2869","24639 31992 33562 33173 28199"],["2875","24639 31992 33562 33173 28199"],["2877","24639 31992 33562 33173 28199"],["2880","24639 31992 33562 33173 28199"],["2883","24639 31992 33562 33173 28199"],["2884","24639 31992 33562 33173 28199"],["2886","24639 31992 33562 33173 28199"],["2888","24639 31992 33562 33173 28199"],["2895","24639 31992 33562 33173 28199"],["2903","24639 31992 33562 33173 28199"],["2904","24639 31992 33562 33173 28199"],["2908","24639 31992 33562 33173 28199"],["2909","24639 31992 33562 33173 28199"],["2914","24639 31992 33562 33173 28199"],["2917","24639 31992 33562 33173 28199"],["2921","24639 31992 33562 33173 28199"],["2926","24639 31992 33562 33173 28199"],["2933","24639 31992 33562 33173 28199"],["2935","24639 31992 33562 33173 28199"],["2951","24639 31992 33562 33173 28199"],["2957","24639 31992 33562 33173 28199"],["2964","24639 31992 33562 33173 28199"],["2967","24639 31992 33562 33173 28199"],["2968","24639 31992 33562 33173 28199"],["2978","24639 31992 33562 33173 28199"],["2985","24639 31992 33562 33173 28199"],["2990","24639 31992 33562 33173 28199"],["2993","24639 31992 33562 33173 28199"],["2996","24639 31992 33562 33173 28199"],["2997","24639 31992 33562 33173 28199"],["2998","24639 31992 33562 33173 28199"],["3001","24639 31992 33562 33173 28199"],["3003","24639 31992 33562 33173 28199"],["3014","24639 31992 33562 33173 28199"],["3017","24639 31992 33173 28199 19127"],["3019","24639 31992 33562 33173 28199"],["3020","31992 33562 33173 28199 19127"],["3023","24639 31992 33562 33173 28199"],["3028","24639 31992 33562 33173 28199"],["3032","24639 31992 33562 33173 28199"],["3041","24639 31992 33562 33173 28199"],["3043","24639 31992 33562 33173 28199"],["3050","24639 31992 33562 33173 28199"],["3056","24639 31992 33562 33173 28199"],["3057","24639 31992 33562 33173 28199"],["3059","24639 31992 33562 33173 28199"],["3064","24639 31992 33562 33173 28199"],["3065","24639 31992 33562 33173 28199"],["3066","24639 31992 33562 33173 28199"],["3069","24639 31992 33562 33173 28199"],["3071","24639 31992 33562 33173 28199"],["3072","24639 31992 33562 33173 28199"],["3073","24639 31992 33562 33173 28199"],["3074","24639 31992 33562 33173 28199"],["3077","24639 31992 33562 33173 28199"],["3082","24639 31992 33562 33173 28199"],["3091","24639 31992 33562 33173 28199"],["3093","24639 31992 33562 33173 28199"],["3095","24639 31992 33562 33173 28199"],["3098","24639 31992 33562 33173 28199"],["3101","24639 31992 33562 33173 28199"],["3104","24639 31992 33562 33173 28199"],["3105","24639 31992 33562 33173 28199"],["3106","24639 31992 33562 33173 28199"],["3107","24639 31992 33562 33173 28199"],["3108","24639 31992 33562 33173 28199"],["3113","24639 31992 33562 33173 28199"],["3118","24639 31992 33562 33173 28199"],["3123","24639 31992 33562 33173 28199"],["3127","24639 31992 33562 33173 28199"],["3133","24639 31992 33562 33173 28199"],["3137","24639 31992 33562 33173 28199"],["3157","24639 31992 33562 33173 28199"],["3163","24639 31992 33562 33173 28199"],["3165","24639 31992 33562 33173 28199"],["3166","24639 31992 33562 33173 28199"],["3167","24639 31992 33562 33173 28199"],["3168","24639 31992 33562 33173 28199"],["3173","24639 31992 33562 33173 28199"],["3180","24639 31992 33562 33173 28199"],["3188","24639 31992 33562 33173 28199"],["3189","24639 31992 33562 33173 28199"],["3190","24639 31992 33562 33173 28199"],["3191","24639 31992 33562 33173 28199"],["3192","24639 31992 33562 33173 28199"],["3195","24639 31992 33562 33173 28199"],["3198","24639 31992 33562 33173 28199"],["3201","24639 31992 33562 33173 28199"],["3202","24639 31992 33562 33173 28199"],["3203","24639 31992 33562 33173 28199"],["3206","24639 31992 33562 33173 28199"],["3212","24639 31992 33562 33173 28199"],["3214","24639 31992 33562 33173 28199"],["3216","24639 31992 33562 33173 28199"],["3218","24639 31992 33173 28199 25694"],["3221","24639 31992 33562 33173 28199"],["3227","24639 31992 33562 33173 28199"],["3229","24639 31992 33562 33173 28199"],["3240","24639 31992 33562 33173 28199"],["3243","24639 31992 33562 33173 28199"],["3244","24639 31992 33562 33173 28199"],["3248","24639 31992 33562 33173 28199"],["3249","24639 31992 33562 33173 28199"],["3250","24639 31992 33562 33173 28199"],["3253","24639 31992 33562 33173 28199"],["3256","24639 31992 33562 33173 28199"],["3260","24639 31992 33562 33173 28199"],["3265","24639 31992 33562 33173 28199"],["3273","24639 31992 33562 33173 28199"],["3279","24639 31992 33562 33173 28199"],["3281","24639 31992 33562 33173 19127"],["3287","24639 31992 33562 33173 28199"],["3294","24639 31992 33562 33173 28199"],["3296","24639 31992 33562 33173 28199"],["3298","24639 31992 33562 33173 28199"],["3302","24639 31992 33562 33173 28199"],["3304","24639 31992 33562 33173 28199"],["3309","24639 31992 33562 33173 28199"],["3319","24639 31992 33562 33173 28199"],["3320","24639 31992 33562 33173 28199"],["3324","24639 31992 33562 33173 28199"],["3325","24639 31992 33562 33173 28199"],["3326","24639 31992 33562 33173 28199"],["3328","24639 31992 33562 33173 28199"],["3330","24639 31992 33562 33173 28199"],["3332","24639 31992 33562 33173 28199"],["3336","24639 31992 33562 33173 28199"],["3350","24639 31992 33562 33173 28199"],["3351","24639 31992 33562 33173 28199"],["3354","24639 31992 33562 33173 28199"],["3358","24639 31992 33562 33173 28199"],["3360","24639 31992 33562 33173 28199"],["3361","24639 31992 33562 33173 28199"],["3364","24639 31992 33562 33173 28199"],["3374","24639 31992 33562 33173 28199"],["3376","24639 31992 33562 33173 28199"],["3378","24639 31992 33562 33173 28199"],["3379","24639 31992 33562 33173 28199"],["3387","24639 31992 33562 33173 28199"],["3392","24639 31992 33562 33173 28199"],["3396","24639 31992 33562 33173 28199"],["3402","24639 31992 33562 33173 28199"],["3407","24639 31992 33562 33173 28199"],["3411","24639 31992 33562 33173 28199"],["3413","24639 31992 33562 33173 28199"],["3418","24639 31992 33562 33173 28199"],["3421","24639 31992 33562 33173 28199"],["3422","24639 31992 33562 33173 28199"],["3424","24639 31992 33562 33173 28199"],["3434","24639 31992 33562 33173 28199"],["3435","24639 31992 33562 33173 28199"],["3438","24639 31992 33562 33173 28199"],["3439","24639 31992 33562 33173 28199"],["3452","24639 31992 33562 33173 28199"],["3455","24639 31992 33562 33173 28199"],["3459","24639 31992 33562 33173 28199"],["3461","24639 31992 33562 33173 28199"],["3464","24639 31992 33562 33173 28199"],["3468","24639 31992 33562 33173 28199"],["3469","24639 31992 33562 33173 28199"],["3474","24639 31992 33562 33173 28199"],["3475","24639 31992 33562 33173 28199"],["3482","24639 31992 33562 33173 28199"],["3487","24639 31992 33562 33173 28199"],["3488","24639 31992 33562 33173 28199"],["3492","24639 31992 33562 33173 28199"],["3496","24639 31992 33562 33173 28199"],["3505","24639 31992 33562 33173 28199"],["3511","24639 31992 33562 33173 28199"],["3513","24639 31992 33562 33173 28199"],["3518","24639 31992 33562 33173 28199"],["3523","24639 31992 33562 33173 28199"],["3525","24639 31992 33562 33173 28199"],["3528","24639 31992 33562 33173 28199"],["3532","24639 31992 33562 33173 28199"],["3540","24639 31992 33562 33173 28199"],["3543","24639 31992 33562 33173 28199"],["3548","24639 31992 33562 33173 28199"],["3550","24639 31992 33562 33173 28199"],["3552","24639 31992 33562 33173 28199"],["3558","24639 31992 33562 33173 28199"],["3560","24639 31992 33562 33173 28199"],["3561","24639 31992 33562 33173 28199"],["3563","24639 31992 33562 33173 28199"],["3564","24639 31992 33562 33173 28199"],["3565","24639 31992 33562 33173 28199"],["3572","24639 31992 33562 33173 28199"],["3581","24639 31992 33562 33173 28199"],["3582","24639 31992 33562 33173 28199"],["3583","24639 31992 33562 33173 28199"],["3587","24639 31992 33562 33173 28199"],["3591","24639 31992 33562 33173 28199"],["3592","24639 31992 33562 33173 28199"],["3596","24639 31992 33562 33173 28199"],["3602","24639 31992 33173 28199 19127"],["3604","24639 31992 33562 33173 28199"]],"arguments":{},"addedWidgets":{},"removedWidgets":[],"schema":[{"name":"0","type":"\"string\""},{"name":"1","type":"\"string\""}],"overflow":true,"aggData":[],"aggSchema":[],"aggOverflow":false,"aggSeriesLimitReached":false,"aggError":"","aggType":"","plotOptions":null,"isJsonSchema":true,"dbfsResultPath":null,"datasetInfos":[],"columnCustomDisplayInfos":{}},"errorSummary":"Command skipped","error":null,"workflows":[],"startTime":1494837737645,"submitTime":1494837700349,"finishTime":1494837737920,"collapsed":false,"bindings":{},"inputWidgets":{},"displayType":"table","width":"auto","height":"auto","xColumns":null,"yColumns":null,"pivotColumns":null,"pivotAggregation":null,"customPlotOptions":{},"commentThread":[],"commentsVisible":false,"parentHierarchy":[],"diffInserts":[],"diffDeletes":[],"globalVars":{},"latestUser":"amarildolikmeta@gmail.com","latestUserId":null,"commandTitle":"","showCommandTitle":false,"hideCommandCode":false,"hideCommandResult":false,"iPythonMetadata":null,"streamStates":{},"datasetPreviewNameToCmdIdMap":{},"nuid":"0b5a1257-270d-45cb-bb44-47442ca4882f"},{"version":"CommandV1","origId":3057526854304836,"guid":"77699608-3d70-4bce-9d5b-a0047db5b73d","subtype":"command","commandType":"auto","position":19.5,"command":"users=[]\nrecs=[]\nfor i in xrange(len(recomendations)):\n  users.append([recomendations[i][0],str(recomendations[i][1][0])+\" \"+str(recomendations[i][1][1])+\" \"+str(+recomendations[i][1][2])+\" \"+str(recomendations[i][1][3])+\" \"+str(recomendations[i][1][4])])\n  recs.append(recomendations[i][1])\n","commandVersion":0,"state":"finished","results":{"type":"html","data":"<div class=\"ansiout\"></div>","arguments":{},"addedWidgets":{},"removedWidgets":[],"datasetInfos":[]},"errorSummary":"Command skipped","error":null,"workflows":[],"startTime":1494837737376,"submitTime":1494837700231,"finishTime":1494837737600,"collapsed":false,"bindings":{},"inputWidgets":{},"displayType":"table","width":"auto","height":"auto","xColumns":null,"yColumns":null,"pivotColumns":null,"pivotAggregation":null,"customPlotOptions":{},"commentThread":[],"commentsVisible":false,"parentHierarchy":[],"diffInserts":[],"diffDeletes":[],"globalVars":{},"latestUser":"amarildolikmeta@gmail.com","latestUserId":null,"commandTitle":"","showCommandTitle":false,"hideCommandCode":false,"hideCommandResult":false,"iPythonMetadata":null,"streamStates":{},"datasetPreviewNameToCmdIdMap":{},"nuid":"7666ef7b-736b-4668-b64e-2e868e5bc5e9"},{"version":"CommandV1","origId":3057526854304839,"guid":"89f85980-796f-4b90-8fba-edc8f0cbd4a7","subtype":"command","commandType":"auto","position":21.0,"command":"def recommendTopRated(user_id, removeSeen=1):\n    recommendedList = ratings\n    if(removeSeen):\n      seenItems = np.array(userSeenItems_dict[user_id])\n      unseen_mask = np.in1d(recommendedList, seenItems, invert=True)\n      recommendedList = recommendedList[unseen_mask]      \n    return [user_id,recommendedList[0:numberOfItemsToRecommend].tolist()]","commandVersion":0,"state":"finished","results":{"type":"html","data":"<div class=\"ansiout\"></div>","arguments":{},"addedWidgets":{},"removedWidgets":[],"datasetInfos":[]},"errorSummary":"Command skipped","error":null,"workflows":[],"startTime":1494837747192,"submitTime":1494837700553,"finishTime":1494837747232,"collapsed":false,"bindings":{},"inputWidgets":{},"displayType":"table","width":"auto","height":"auto","xColumns":null,"yColumns":null,"pivotColumns":null,"pivotAggregation":null,"customPlotOptions":{},"commentThread":[],"commentsVisible":false,"parentHierarchy":[],"diffInserts":[],"diffDeletes":[],"globalVars":{},"latestUser":"amarildolikmeta@gmail.com","latestUserId":null,"commandTitle":"","showCommandTitle":false,"hideCommandCode":false,"hideCommandResult":false,"iPythonMetadata":null,"streamStates":{},"datasetPreviewNameToCmdIdMap":{},"nuid":"30330f75-f70f-446e-9936-41c6ac7aad1a"},{"version":"CommandV1","origId":3057526854304841,"guid":"dce0f641-aa93-46d1-ba3c-efae08e285a3","subtype":"command","commandType":"auto","position":19.75,"command":"print(users[0])","commandVersion":0,"state":"finished","results":{"type":"html","data":"<div class=\"ansiout\">[&apos;4&apos;, &apos;24639 31992 33562 33173 28199&apos;]\n</div>","arguments":{},"addedWidgets":{},"removedWidgets":[],"datasetInfos":[]},"errorSummary":"Command skipped","error":null,"workflows":[],"startTime":1494837737603,"submitTime":1494837700280,"finishTime":1494837737642,"collapsed":false,"bindings":{},"inputWidgets":{},"displayType":"table","width":"auto","height":"auto","xColumns":null,"yColumns":null,"pivotColumns":null,"pivotAggregation":null,"customPlotOptions":{},"commentThread":[],"commentsVisible":false,"parentHierarchy":[],"diffInserts":[],"diffDeletes":[],"globalVars":{},"latestUser":"amarildolikmeta@gmail.com","latestUserId":null,"commandTitle":"","showCommandTitle":false,"hideCommandCode":false,"hideCommandResult":false,"iPythonMetadata":null,"streamStates":{},"datasetPreviewNameToCmdIdMap":{},"nuid":"756b2885-386c-4f39-8b7f-3000f5c8d124"},{"version":"CommandV1","origId":3057526854304845,"guid":"c5e1d0fe-50fd-423b-8a09-30eda8e596e5","subtype":"command","commandType":"auto","position":13.5,"command":"testRDD=sqlContext.sql(\"select  userId from target order By userId\").rdd.map(lambda x: str(x[0]))\ntestList=testRDD.sortBy(lambda x:float(x))","commandVersion":0,"state":"finished","results":{"type":"html","data":"<div class=\"ansiout\"></div>","arguments":{},"addedWidgets":{},"removedWidgets":[],"datasetInfos":[]},"errorSummary":"<span class=\"ansired\">AnalysisException</span>: u&quot;extraneous input &apos;userId&apos; expecting EOF near &apos;&lt;EOF&gt;&apos;; line 1 pos 35&quot;","error":null,"workflows":[],"startTime":1494837711058,"submitTime":1494837699846,"finishTime":1494837715803,"collapsed":false,"bindings":{},"inputWidgets":{},"displayType":"table","width":"auto","height":"auto","xColumns":null,"yColumns":null,"pivotColumns":null,"pivotAggregation":null,"customPlotOptions":{},"commentThread":[],"commentsVisible":false,"parentHierarchy":[],"diffInserts":[],"diffDeletes":[],"globalVars":{},"latestUser":"amarildolikmeta@gmail.com","latestUserId":null,"commandTitle":"","showCommandTitle":false,"hideCommandCode":false,"hideCommandResult":false,"iPythonMetadata":null,"streamStates":{},"datasetPreviewNameToCmdIdMap":{},"nuid":"cbcc2112-b887-4041-96f5-b1768464c0cf"},{"version":"CommandV1","origId":3057526854304846,"guid":"b8ba0a6c-135f-4eb4-a447-421b5f3c8826","subtype":"command","commandType":"auto","position":15.5,"command":"recomendationsTest=sc.parallelize(testList.toLocalIterator()).map(recommendTopPopRDDfree).collect()","commandVersion":0,"state":"finished","results":{"type":"html","data":"<div class=\"ansiout\"></div>","arguments":{},"addedWidgets":{},"removedWidgets":[],"datasetInfos":[]},"errorSummary":"org.apache.spark.SparkException: Job aborted due to stage failure: Task 4 in stage 28.0 failed 1 times, most recent failure: Lost task 4.0 in stage 28.0 (TID 30, localhost): org.apache.spark.api.python.PythonException: Traceback (most recent call last):","error":null,"workflows":[],"startTime":1494837721336,"submitTime":1494837700124,"finishTime":1494837737343,"collapsed":false,"bindings":{},"inputWidgets":{},"displayType":"table","width":"auto","height":"auto","xColumns":null,"yColumns":null,"pivotColumns":null,"pivotAggregation":null,"customPlotOptions":{},"commentThread":[],"commentsVisible":false,"parentHierarchy":[],"diffInserts":[],"diffDeletes":[],"globalVars":{},"latestUser":"amarildolikmeta@gmail.com","latestUserId":null,"commandTitle":"","showCommandTitle":false,"hideCommandCode":false,"hideCommandResult":false,"iPythonMetadata":null,"streamStates":{},"datasetPreviewNameToCmdIdMap":{},"nuid":"f1b07afa-dff7-41c4-aa10-61effc8e003f"},{"version":"CommandV1","origId":3057526854304847,"guid":"d48fca60-29b5-4168-a1d0-533f5941d3d8","subtype":"command","commandType":"auto","position":14.5,"command":"type(testList)","commandVersion":0,"state":"finished","results":{"type":"html","data":"<div class=\"ansiout\"><span class=\"ansired\">Out[</span><span class=\"ansired\">18</span><span class=\"ansired\">]: </span>pyspark.rdd.PipelinedRDD\n</div>","arguments":{},"addedWidgets":{},"removedWidgets":[],"datasetInfos":[]},"errorSummary":"<span class=\"ansired\">NameError</span>: name &apos;testList&apos; is not defined","error":null,"workflows":[],"startTime":1494837721216,"submitTime":1494837699957,"finishTime":1494837721258,"collapsed":false,"bindings":{},"inputWidgets":{},"displayType":"table","width":"auto","height":"auto","xColumns":null,"yColumns":null,"pivotColumns":null,"pivotAggregation":null,"customPlotOptions":{},"commentThread":[],"commentsVisible":false,"parentHierarchy":[],"diffInserts":[],"diffDeletes":[],"globalVars":{},"latestUser":"amarildolikmeta@gmail.com","latestUserId":null,"commandTitle":"","showCommandTitle":false,"hideCommandCode":false,"hideCommandResult":false,"iPythonMetadata":null,"streamStates":{},"datasetPreviewNameToCmdIdMap":{},"nuid":"70297e07-3f96-4600-83a0-48a8f0c2418f"},{"version":"CommandV1","origId":3057526854304848,"guid":"bd6c40f2-7e5c-43b3-93d7-06d565e5119f","subtype":"command","commandType":"auto","position":14.75,"command":"type(userList_distinct)","commandVersion":0,"state":"finished","results":{"type":"html","data":"<div class=\"ansiout\"><span class=\"ansired\">Out[</span><span class=\"ansired\">19</span><span class=\"ansired\">]: </span>pyspark.rdd.PipelinedRDD\n</div>","arguments":{},"addedWidgets":{},"removedWidgets":[],"datasetInfos":[]},"errorSummary":"Command skipped","error":null,"workflows":[],"startTime":1494837721261,"submitTime":1494837700012,"finishTime":1494837721303,"collapsed":false,"bindings":{},"inputWidgets":{},"displayType":"table","width":"auto","height":"auto","xColumns":null,"yColumns":null,"pivotColumns":null,"pivotAggregation":null,"customPlotOptions":{},"commentThread":[],"commentsVisible":false,"parentHierarchy":[],"diffInserts":[],"diffDeletes":[],"globalVars":{},"latestUser":"amarildolikmeta@gmail.com","latestUserId":null,"commandTitle":"","showCommandTitle":false,"hideCommandCode":false,"hideCommandResult":false,"iPythonMetadata":null,"streamStates":{},"datasetPreviewNameToCmdIdMap":{},"nuid":"d085e151-2de3-4757-a2d0-9ea5dc029e92"},{"version":"CommandV1","origId":3057526854304849,"guid":"113b71d0-9d29-458d-bfac-37b32a1bb625","subtype":"command","commandType":"auto","position":9.5,"command":"type(userSeenItems)","commandVersion":0,"state":"finished","results":{"type":"html","data":"<div class=\"ansiout\"><span class=\"ansired\">Out[</span><span class=\"ansired\">12</span><span class=\"ansired\">]: </span>pyspark.rdd.PipelinedRDD\n</div>","arguments":{},"addedWidgets":{},"removedWidgets":[],"datasetInfos":[]},"errorSummary":"Command skipped","error":null,"workflows":[],"startTime":1494837710596,"submitTime":1494837699624,"finishTime":1494837710670,"collapsed":false,"bindings":{},"inputWidgets":{},"displayType":"table","width":"auto","height":"auto","xColumns":null,"yColumns":null,"pivotColumns":null,"pivotAggregation":null,"customPlotOptions":{},"commentThread":[],"commentsVisible":false,"parentHierarchy":[],"diffInserts":[],"diffDeletes":[],"globalVars":{},"latestUser":"amarildolikmeta@gmail.com","latestUserId":null,"commandTitle":"","showCommandTitle":false,"hideCommandCode":false,"hideCommandResult":false,"iPythonMetadata":null,"streamStates":{},"datasetPreviewNameToCmdIdMap":{},"nuid":"6e5f167d-5005-492a-9e56-08b7821a0751"},{"version":"CommandV1","origId":3185618696592201,"guid":"319cc47c-20ca-4854-89dd-cda6ae570735","subtype":"command","commandType":"auto","position":26.0,"command":"trainRDD_unbiased=trainRDD.map(lambda x:(x[0],x[1],int(x[2])-avgRating))\ntrainRDD_unbiased.take(10)","commandVersion":0,"state":"error","results":null,"errorSummary":"Command skipped","error":null,"workflows":[],"startTime":1494837700849,"submitTime":1494837700849,"finishTime":1494837761585,"collapsed":false,"bindings":{},"inputWidgets":{},"displayType":"table","width":"auto","height":"auto","xColumns":null,"yColumns":null,"pivotColumns":null,"pivotAggregation":null,"customPlotOptions":{},"commentThread":[],"commentsVisible":false,"parentHierarchy":[],"diffInserts":[],"diffDeletes":[],"globalVars":{},"latestUser":"amarildolikmeta@gmail.com","latestUserId":null,"commandTitle":"","showCommandTitle":false,"hideCommandCode":false,"hideCommandResult":false,"iPythonMetadata":null,"streamStates":{},"datasetPreviewNameToCmdIdMap":{},"nuid":"1d9aed95-218c-4140-b89c-b0a6ccd6e216"},{"version":"CommandV1","origId":3185618696592202,"guid":"4a6eef11-e4db-423f-9857-e78f20089484","subtype":"command","commandType":"auto","position":27.0,"command":"sumAndCount = trainRDD_unbiased.map(lambda x: (x[1], float(x[2]))).\\\n    aggregateByKey((0,0), lambda x,y: (x[0] + y,    x[1] + 1),\n                          lambda x,y: (x[0] + y[0], x[1] + y[1]))\n\nsumAndCount.take(10)","commandVersion":0,"state":"error","results":null,"errorSummary":"Command skipped","error":null,"workflows":[],"startTime":1494837700891,"submitTime":1494837700891,"finishTime":1494837761586,"collapsed":false,"bindings":{},"inputWidgets":{},"displayType":"table","width":"auto","height":"auto","xColumns":null,"yColumns":null,"pivotColumns":null,"pivotAggregation":null,"customPlotOptions":{},"commentThread":[],"commentsVisible":false,"parentHierarchy":[],"diffInserts":[],"diffDeletes":[],"globalVars":{},"latestUser":"amarildolikmeta@gmail.com","latestUserId":null,"commandTitle":"","showCommandTitle":false,"hideCommandCode":false,"hideCommandResult":false,"iPythonMetadata":null,"streamStates":{},"datasetPreviewNameToCmdIdMap":{},"nuid":"fff51e90-ddb5-4c6a-85cd-409df4f03460"},{"version":"CommandV1","origId":3185618696592205,"guid":"1573d971-2ccf-49f8-b500-19acd4454057","subtype":"command","commandType":"auto","position":28.0,"command":"itemBias = sumAndCount.mapValues(lambda x: x[0]/x[1])\n\nitemBias.take(10)","commandVersion":0,"state":"error","results":null,"errorSummary":"Command skipped","error":null,"workflows":[],"startTime":1494837700933,"submitTime":1494837700933,"finishTime":1494837761587,"collapsed":false,"bindings":{},"inputWidgets":{},"displayType":"table","width":"auto","height":"auto","xColumns":null,"yColumns":null,"pivotColumns":null,"pivotAggregation":null,"customPlotOptions":{},"commentThread":[],"commentsVisible":false,"parentHierarchy":[],"diffInserts":[],"diffDeletes":[],"globalVars":{},"latestUser":"amarildolikmeta@gmail.com","latestUserId":null,"commandTitle":"","showCommandTitle":false,"hideCommandCode":false,"hideCommandResult":false,"iPythonMetadata":null,"streamStates":{},"datasetPreviewNameToCmdIdMap":{},"nuid":"f060b063-c270-4c3e-93ac-37464dbc71e6"},{"version":"CommandV1","origId":3185618696592206,"guid":"4b2b2908-b1ef-4b96-8e9b-df99525a0fbb","subtype":"command","commandType":"auto","position":29.0,"command":"itemBias_sorted = itemBias.sortBy(lambda x: x[1], ascending=False)\n\nitemBias_sorted.take(10)","commandVersion":0,"state":"error","results":null,"errorSummary":"Command skipped","error":null,"workflows":[],"startTime":1494837701225,"submitTime":1494837701225,"finishTime":1494837761589,"collapsed":false,"bindings":{},"inputWidgets":{},"displayType":"table","width":"auto","height":"auto","xColumns":null,"yColumns":null,"pivotColumns":null,"pivotAggregation":null,"customPlotOptions":{},"commentThread":[],"commentsVisible":false,"parentHierarchy":[],"diffInserts":[],"diffDeletes":[],"globalVars":{},"latestUser":"amarildolikmeta@gmail.com","latestUserId":null,"commandTitle":"","showCommandTitle":false,"hideCommandCode":false,"hideCommandResult":false,"iPythonMetadata":null,"streamStates":{},"datasetPreviewNameToCmdIdMap":{},"nuid":"7ab4a4c3-5cbf-42be-9b93-f45ba8cf043c"},{"version":"CommandV1","origId":3185618696592207,"guid":"23b1be8c-0155-440e-a262-e8e6730faa35","subtype":"command","commandType":"auto","position":30.0,"command":"sumAndCount = trainRDD_unbiased.map(lambda x: (x[0], float(x[2]))).\\\n    aggregateByKey((0,0), lambda x,y: (x[0] + y,    x[1] + 1),\n                          lambda x,y: (x[0] + y[0], x[1] + y[1]))\n\nsumAndCount.take(10)","commandVersion":0,"state":"error","results":null,"errorSummary":"Command skipped","error":null,"workflows":[],"startTime":1494837701266,"submitTime":1494837701266,"finishTime":1494837761590,"collapsed":false,"bindings":{},"inputWidgets":{},"displayType":"table","width":"auto","height":"auto","xColumns":null,"yColumns":null,"pivotColumns":null,"pivotAggregation":null,"customPlotOptions":{},"commentThread":[],"commentsVisible":false,"parentHierarchy":[],"diffInserts":[],"diffDeletes":[],"globalVars":{},"latestUser":"amarildolikmeta@gmail.com","latestUserId":null,"commandTitle":"","showCommandTitle":false,"hideCommandCode":false,"hideCommandResult":false,"iPythonMetadata":null,"streamStates":{},"datasetPreviewNameToCmdIdMap":{},"nuid":"ad5b2c4e-5c5f-4746-b6f4-9c204c207a1c"},{"version":"CommandV1","origId":3185618696592208,"guid":"8c781bc4-25b6-44a3-8a4f-cf3b9c7bad7f","subtype":"command","commandType":"auto","position":31.0,"command":"userBias = sumAndCount.mapValues(lambda x: x[0]/x[1])\n\nuserBias.take(10)","commandVersion":0,"state":"error","results":null,"errorSummary":"Command skipped","error":null,"workflows":[],"startTime":1494837701308,"submitTime":1494837701308,"finishTime":1494837761590,"collapsed":false,"bindings":{},"inputWidgets":{},"displayType":"table","width":"auto","height":"auto","xColumns":null,"yColumns":null,"pivotColumns":null,"pivotAggregation":null,"customPlotOptions":{},"commentThread":[],"commentsVisible":false,"parentHierarchy":[],"diffInserts":[],"diffDeletes":[],"globalVars":{},"latestUser":"amarildolikmeta@gmail.com","latestUserId":null,"commandTitle":"","showCommandTitle":false,"hideCommandCode":false,"hideCommandResult":false,"iPythonMetadata":null,"streamStates":{},"datasetPreviewNameToCmdIdMap":{},"nuid":"91497614-f420-4172-9ef9-f27de92e07cc"},{"version":"CommandV1","origId":3185618696592209,"guid":"673a556e-a64b-46ac-8c4b-671dae2a3b67","subtype":"command","commandType":"auto","position":32.0,"command":"userBias_sorted = userBias.sortBy(lambda x: x[1], ascending=False)","commandVersion":0,"state":"error","results":null,"errorSummary":"Command skipped","error":null,"workflows":[],"startTime":1494837701350,"submitTime":1494837701350,"finishTime":1494837761591,"collapsed":false,"bindings":{},"inputWidgets":{},"displayType":"table","width":"auto","height":"auto","xColumns":null,"yColumns":null,"pivotColumns":null,"pivotAggregation":null,"customPlotOptions":{},"commentThread":[],"commentsVisible":false,"parentHierarchy":[],"diffInserts":[],"diffDeletes":[],"globalVars":{},"latestUser":"amarildolikmeta@gmail.com","latestUserId":null,"commandTitle":"","showCommandTitle":false,"hideCommandCode":false,"hideCommandResult":false,"iPythonMetadata":null,"streamStates":{},"datasetPreviewNameToCmdIdMap":{},"nuid":"fe6d02fe-cbde-4a9e-9eb0-33e4ff2fb28a"},{"version":"CommandV1","origId":3185618696592210,"guid":"4b30b026-2bb4-4bc4-82dd-97c76028e723","subtype":"command","commandType":"auto","position":33.0,"command":"def recommendUnbiased(user_id, removeSeen=1):\n    recommendedList = itemBias_sortedIDs\n    if(removeSeen):\n      seenItems = np.array(userSeenItems_dict[user_id])\n      unseen_mask = np.in1d(recommendedList, seenItems, invert=True)\n      recommendedList = recommendedList[unseen_mask]      \n    return [user_id,recommendedList[0:numberOfItemsToRecommend].tolist()]","commandVersion":0,"state":"error","results":null,"errorSummary":"Command skipped","error":null,"workflows":[],"startTime":1494837701557,"submitTime":1494837701557,"finishTime":1494837761596,"collapsed":false,"bindings":{},"inputWidgets":{},"displayType":"table","width":"auto","height":"auto","xColumns":null,"yColumns":null,"pivotColumns":null,"pivotAggregation":null,"customPlotOptions":{},"commentThread":[],"commentsVisible":false,"parentHierarchy":[],"diffInserts":[],"diffDeletes":[],"globalVars":{},"latestUser":"amarildolikmeta@gmail.com","latestUserId":null,"commandTitle":"","showCommandTitle":false,"hideCommandCode":false,"hideCommandResult":false,"iPythonMetadata":null,"streamStates":{},"datasetPreviewNameToCmdIdMap":{},"nuid":"063aa5ee-92c2-41be-a15a-b29569e6d03c"},{"version":"CommandV1","origId":3185618696592211,"guid":"8becbf24-f446-4703-93a2-e368fb880ba9","subtype":"command","commandType":"auto","position":32.5,"command":"itemBias_sortedIDs=itemBias_sorted.map(lambda x:x[0]).collect()","commandVersion":0,"state":"error","results":null,"errorSummary":"Command skipped","error":null,"workflows":[],"startTime":1494837701391,"submitTime":1494837701391,"finishTime":1494837761592,"collapsed":false,"bindings":{},"inputWidgets":{},"displayType":"table","width":"auto","height":"auto","xColumns":null,"yColumns":null,"pivotColumns":null,"pivotAggregation":null,"customPlotOptions":{},"commentThread":[],"commentsVisible":false,"parentHierarchy":[],"diffInserts":[],"diffDeletes":[],"globalVars":{},"latestUser":"amarildolikmeta@gmail.com","latestUserId":null,"commandTitle":"","showCommandTitle":false,"hideCommandCode":false,"hideCommandResult":false,"iPythonMetadata":null,"streamStates":{},"datasetPreviewNameToCmdIdMap":{},"nuid":"4edc16ac-8897-48b2-8080-ffd495ebe6a0"},{"version":"CommandV1","origId":3185618696592212,"guid":"94696aeb-2be0-4e34-b03f-5392aa257b69","subtype":"command","commandType":"auto","position":34.0,"command":"recomendations=recomendationsUnbiased\nusers=[]\nrecs=[]\nfor i in xrange(len(recomendations)):\n  users.append([recomendations[i][0],str(recomendations[i][1][0])+\" \"+str(recomendations[i][1][1])+\" \"+str(recomendations[i][1][2])+\" \"+str(recomendations[i][1][3])+\" \"+str(recomendations[i][1][4])])\n  recs.append(recomendations[i][1])","commandVersion":0,"state":"error","results":null,"errorSummary":"Command skipped","error":null,"workflows":[],"startTime":1494837701641,"submitTime":1494837701641,"finishTime":1494837761597,"collapsed":false,"bindings":{},"inputWidgets":{},"displayType":"table","width":"auto","height":"auto","xColumns":null,"yColumns":null,"pivotColumns":null,"pivotAggregation":null,"customPlotOptions":{},"commentThread":[],"commentsVisible":false,"parentHierarchy":[],"diffInserts":[],"diffDeletes":[],"globalVars":{},"latestUser":"amarildolikmeta@gmail.com","latestUserId":null,"commandTitle":"","showCommandTitle":false,"hideCommandCode":false,"hideCommandResult":false,"iPythonMetadata":null,"streamStates":{},"datasetPreviewNameToCmdIdMap":{},"nuid":"85cc5b8b-277c-498b-b76d-19348bfebb5d"},{"version":"CommandV1","origId":3185618696592213,"guid":"36a2ad2d-04ca-4a54-b220-9a6a3a8c5b14","subtype":"command","commandType":"auto","position":33.5,"command":"recomendationsUnbiased=sc.parallelize(testList.toLocalIterator()).map(recommendUnbiased).collect()","commandVersion":0,"state":"error","results":null,"errorSummary":"Command skipped","error":null,"workflows":[],"startTime":1494837701598,"submitTime":1494837701598,"finishTime":1494837761596,"collapsed":false,"bindings":{},"inputWidgets":{},"displayType":"table","width":"auto","height":"auto","xColumns":null,"yColumns":null,"pivotColumns":null,"pivotAggregation":null,"customPlotOptions":{},"commentThread":[],"commentsVisible":false,"parentHierarchy":[],"diffInserts":[],"diffDeletes":[],"globalVars":{},"latestUser":"amarildolikmeta@gmail.com","latestUserId":null,"commandTitle":"","showCommandTitle":false,"hideCommandCode":false,"hideCommandResult":false,"iPythonMetadata":null,"streamStates":{},"datasetPreviewNameToCmdIdMap":{},"nuid":"1fc64d68-8ff8-49ee-9c6e-ca088b68e670"},{"version":"CommandV1","origId":3185618696592215,"guid":"fd05f01d-e30f-43db-bef0-448db55ceb70","subtype":"command","commandType":"auto","position":32.75,"command":"itemBias_sortedIDs=np.array(itemBias_sortedIDs)","commandVersion":0,"state":"error","results":null,"errorSummary":"Command skipped","error":null,"workflows":[],"startTime":1494837701433,"submitTime":1494837701433,"finishTime":1494837761593,"collapsed":false,"bindings":{},"inputWidgets":{},"displayType":"table","width":"auto","height":"auto","xColumns":null,"yColumns":null,"pivotColumns":null,"pivotAggregation":null,"customPlotOptions":{},"commentThread":[],"commentsVisible":false,"parentHierarchy":[],"diffInserts":[],"diffDeletes":[],"globalVars":{},"latestUser":"amarildolikmeta@gmail.com","latestUserId":null,"commandTitle":"","showCommandTitle":false,"hideCommandCode":false,"hideCommandResult":false,"iPythonMetadata":null,"streamStates":{},"datasetPreviewNameToCmdIdMap":{},"nuid":"f805d392-42ec-417c-a406-e18f70305f2b"},{"version":"CommandV1","origId":3185618696592216,"guid":"5e9f8bd0-5550-4fc6-a605-1e4dcfe17d72","subtype":"command","commandType":"auto","position":35.0,"command":"df=pd.DataFrame(data=users  # values\n                      # 1st column as index\n                    )\ndisplay(sqlContext.createDataFrame(df))\n","commandVersion":0,"state":"error","results":null,"errorSummary":"Command skipped","error":null,"workflows":[],"startTime":1494837701678,"submitTime":1494837701678,"finishTime":1494837761598,"collapsed":false,"bindings":{},"inputWidgets":{},"displayType":"table","width":"auto","height":"auto","xColumns":null,"yColumns":null,"pivotColumns":null,"pivotAggregation":null,"customPlotOptions":{},"commentThread":[],"commentsVisible":false,"parentHierarchy":[],"diffInserts":[],"diffDeletes":[],"globalVars":{},"latestUser":"amarildolikmeta@gmail.com","latestUserId":null,"commandTitle":"","showCommandTitle":false,"hideCommandCode":false,"hideCommandResult":false,"iPythonMetadata":null,"streamStates":{},"datasetPreviewNameToCmdIdMap":{},"nuid":"1d2f9089-066f-4d51-9634-1848bb53eac9"},{"version":"CommandV1","origId":3185618696592217,"guid":"7e55d246-56bd-478c-99d8-fc86de14303f","subtype":"command","commandType":"auto","position":36.0,"command":" \ndef recommendGlobalEffects(user_id, removeSeen=1):\n    recommendedList = []\n    userBias=user_bias_dict[user_id]\n    if(removeSeen):\n      seenItems = np.array(userSeenItems_dict[user_id])\n      for i in xrange(len(itemBias_sortedIDs)):\n        if itemBias_sortedIDs[i] not in seenItems:\n          rating=avgRating+float(userBias)+float(itemBias_sortedRatings[i])\n          recommendedList.append((itemBias_sortedIDs[i],rating))  \n      recommendedList = sorted(recommendedList, key=lambda tup: tup[1],reverse=True)    \n      recommendedList=[ seq[0] for seq in recommendedList[0:numberOfItemsToRecommend] ]\n    return [user_id,recommendedList[0:numberOfItemsToRecommend]]","commandVersion":0,"state":"error","results":null,"errorSummary":"Command skipped","error":null,"workflows":[],"startTime":1494837701794,"submitTime":1494837701794,"finishTime":1494837761601,"collapsed":false,"bindings":{},"inputWidgets":{},"displayType":"table","width":"auto","height":"auto","xColumns":null,"yColumns":null,"pivotColumns":null,"pivotAggregation":null,"customPlotOptions":{},"commentThread":[],"commentsVisible":false,"parentHierarchy":[],"diffInserts":[],"diffDeletes":[],"globalVars":{},"latestUser":"amarildolikmeta@gmail.com","latestUserId":null,"commandTitle":"","showCommandTitle":false,"hideCommandCode":false,"hideCommandResult":false,"iPythonMetadata":null,"streamStates":{},"datasetPreviewNameToCmdIdMap":{},"nuid":"6ad5373b-1051-4cbc-b7a8-440a56ff1c6e"},{"version":"CommandV1","origId":3331611799304129,"guid":"aba321d8-e0a9-4433-b8b4-18e6ef09944c","subtype":"command","commandType":"auto","position":53.0,"command":"import sys\nprint (sys.version_info)\n    ","commandVersion":0,"state":"error","results":null,"errorSummary":"Command skipped","error":null,"workflows":[],"startTime":1494837702680,"submitTime":1494837702680,"finishTime":1494837761623,"collapsed":false,"bindings":{},"inputWidgets":{},"displayType":"table","width":"auto","height":"auto","xColumns":null,"yColumns":null,"pivotColumns":null,"pivotAggregation":null,"customPlotOptions":{},"commentThread":[],"commentsVisible":false,"parentHierarchy":[],"diffInserts":[],"diffDeletes":[],"globalVars":{},"latestUser":"amarildolikmeta@gmail.com","latestUserId":null,"commandTitle":"","showCommandTitle":false,"hideCommandCode":false,"hideCommandResult":false,"iPythonMetadata":null,"streamStates":{},"datasetPreviewNameToCmdIdMap":{},"nuid":"9aec9356-8a46-4814-91e5-b8d52c3a214b"},{"version":"CommandV1","origId":3331611799304130,"guid":"5e5e4550-c943-4813-8c6c-ca312d0c6cdc","subtype":"command","commandType":"auto","position":54.0,"command":"userRatings=trainRDD.map(lambda x:(x[0],[(x[1],int(x[2]))])).reduceByKey(lambda x,y:x+y)","commandVersion":0,"state":"error","results":null,"errorSummary":"Command skipped","error":null,"workflows":[],"startTime":1494837702712,"submitTime":1494837702712,"finishTime":1494837761624,"collapsed":false,"bindings":{},"inputWidgets":{},"displayType":"table","width":"auto","height":"auto","xColumns":null,"yColumns":null,"pivotColumns":null,"pivotAggregation":null,"customPlotOptions":{},"commentThread":[],"commentsVisible":false,"parentHierarchy":[],"diffInserts":[],"diffDeletes":[],"globalVars":{},"latestUser":"amarildolikmeta@gmail.com","latestUserId":null,"commandTitle":"","showCommandTitle":false,"hideCommandCode":false,"hideCommandResult":false,"iPythonMetadata":null,"streamStates":{},"datasetPreviewNameToCmdIdMap":{},"nuid":"0889a865-b23e-40f7-ad20-b5f2530007c4"},{"version":"CommandV1","origId":4087362244415895,"guid":"b565acd5-4d5e-42eb-abda-593510c73b7e","subtype":"command","commandType":"auto","position":7.5,"command":"type(itemPopularity_sorted)","commandVersion":0,"state":"finished","results":{"type":"html","data":"<div class=\"ansiout\"><span class=\"ansired\">Out[</span><span class=\"ansired\">9</span><span class=\"ansired\">]: </span>pyspark.rdd.PipelinedRDD\n</div>","arguments":{},"addedWidgets":{},"removedWidgets":[],"datasetInfos":[]},"errorSummary":null,"error":null,"workflows":[],"startTime":1494837708250,"submitTime":1494837699456,"finishTime":1494837708289,"collapsed":false,"bindings":{},"inputWidgets":{},"displayType":"table","width":"auto","height":"auto","xColumns":null,"yColumns":null,"pivotColumns":null,"pivotAggregation":null,"customPlotOptions":{},"commentThread":[],"commentsVisible":false,"parentHierarchy":[],"diffInserts":[],"diffDeletes":[],"globalVars":{},"latestUser":"amarildolikmeta@gmail.com","latestUserId":null,"commandTitle":"","showCommandTitle":false,"hideCommandCode":false,"hideCommandResult":false,"iPythonMetadata":null,"streamStates":{},"datasetPreviewNameToCmdIdMap":{},"nuid":"71fc3897-4566-44e2-aa3e-42e27c4dfed7"},{"version":"CommandV1","origId":4087362244415897,"guid":"2350bea1-4b91-42ae-b431-380dd373a2c4","subtype":"command","commandType":"auto","position":19.375,"command":"recomendations=recomendationsTest","commandVersion":0,"state":"finished","results":{"type":"html","data":"<div class=\"ansiout\"></div>","arguments":{},"addedWidgets":{},"removedWidgets":[],"datasetInfos":[]},"errorSummary":"Command skipped","error":null,"workflows":[],"startTime":1494837737349,"submitTime":1494837700182,"finishTime":1494837737373,"collapsed":false,"bindings":{},"inputWidgets":{},"displayType":"table","width":"auto","height":"auto","xColumns":null,"yColumns":null,"pivotColumns":null,"pivotAggregation":null,"customPlotOptions":{},"commentThread":[],"commentsVisible":false,"parentHierarchy":[],"diffInserts":[],"diffDeletes":[],"globalVars":{},"latestUser":"amarildolikmeta@gmail.com","latestUserId":null,"commandTitle":"","showCommandTitle":false,"hideCommandCode":false,"hideCommandResult":false,"iPythonMetadata":null,"streamStates":{},"datasetPreviewNameToCmdIdMap":{},"nuid":"51a759b4-cdfa-4640-93ae-22b67a3a3ac7"},{"version":"CommandV1","origId":4087362244415898,"guid":"1f470bef-6a0d-4b30-91c7-917b8bcd27e8","subtype":"command","commandType":"auto","position":13.75,"command":"testList.take(5)","commandVersion":0,"state":"finished","results":{"type":"html","data":"<div class=\"ansiout\"><span class=\"ansired\">Out[</span><span class=\"ansired\">17</span><span class=\"ansired\">]: </span>[&apos;4&apos;, &apos;5&apos;, &apos;8&apos;, &apos;9&apos;, &apos;13&apos;]\n</div>","arguments":{},"addedWidgets":{},"removedWidgets":[],"datasetInfos":[]},"errorSummary":"<span class=\"ansired\">TypeError</span>: &apos;instancemethod&apos; object has no attribute &apos;__getitem__&apos;","error":null,"workflows":[],"startTime":1494837715810,"submitTime":1494837699902,"finishTime":1494837721211,"collapsed":false,"bindings":{},"inputWidgets":{},"displayType":"table","width":"auto","height":"auto","xColumns":null,"yColumns":null,"pivotColumns":null,"pivotAggregation":null,"customPlotOptions":{},"commentThread":[],"commentsVisible":false,"parentHierarchy":[],"diffInserts":[],"diffDeletes":[],"globalVars":{},"latestUser":"amarildolikmeta@gmail.com","latestUserId":null,"commandTitle":"","showCommandTitle":false,"hideCommandCode":false,"hideCommandResult":false,"iPythonMetadata":null,"streamStates":{},"datasetPreviewNameToCmdIdMap":{},"nuid":"3866a9b0-fdcb-4d50-9577-ba223c2207d5"},{"version":"CommandV1","origId":4087362244415899,"guid":"0a6a9687-3ea4-4199-960f-16592aaec4df","subtype":"command","commandType":"auto","position":20.5,"command":"ratings=sqlContext.sql(\"Select itemId ,sum(rating)/(count(rating)+5) as AvgRating from train group by itemId order by AvgRating desc\").rdd\nratings.take(10)","commandVersion":0,"state":"finished","results":{"type":"html","data":"<div class=\"ansiout\"><span class=\"ansired\">Out[</span><span class=\"ansired\">26</span><span class=\"ansired\">]: </span>\n[Row(itemId=u&apos;33475&apos;, AvgRating=9.116883116883116),\n Row(itemId=u&apos;33173&apos;, AvgRating=9.023076923076923),\n Row(itemId=u&apos;15743&apos;, AvgRating=8.725),\n Row(itemId=u&apos;32347&apos;, AvgRating=8.710144927536232),\n Row(itemId=u&apos;1076&apos;, AvgRating=8.709677419354838),\n Row(itemId=u&apos;36872&apos;, AvgRating=8.707317073170731),\n Row(itemId=u&apos;34517&apos;, AvgRating=8.671052631578947),\n Row(itemId=u&apos;35300&apos;, AvgRating=8.666666666666666),\n Row(itemId=u&apos;29848&apos;, AvgRating=8.661764705882353),\n Row(itemId=u&apos;3431&apos;, AvgRating=8.63768115942029)]\n</div>","arguments":{},"addedWidgets":{},"removedWidgets":[],"datasetInfos":[]},"errorSummary":"Command skipped","error":null,"workflows":[],"startTime":1494837737929,"submitTime":1494837700404,"finishTime":1494837745495,"collapsed":false,"bindings":{},"inputWidgets":{},"displayType":"table","width":"auto","height":"auto","xColumns":null,"yColumns":null,"pivotColumns":null,"pivotAggregation":null,"customPlotOptions":{},"commentThread":[],"commentsVisible":false,"parentHierarchy":[],"diffInserts":[],"diffDeletes":[],"globalVars":{},"latestUser":"amarildolikmeta@gmail.com","latestUserId":null,"commandTitle":"","showCommandTitle":false,"hideCommandCode":false,"hideCommandResult":false,"iPythonMetadata":null,"streamStates":{},"datasetPreviewNameToCmdIdMap":{},"nuid":"48600667-5e9d-4968-a241-681a4def0353"},{"version":"CommandV1","origId":4087362244415901,"guid":"627fdbc4-55c4-4e01-987b-578396390f67","subtype":"command","commandType":"auto","position":20.75,"command":"ratings=ratings.map(lambda x:str(x[0]))\nratings.take(10)","commandVersion":0,"state":"finished","results":{"type":"html","data":"<div class=\"ansiout\"><span class=\"ansired\">Out[</span><span class=\"ansired\">27</span><span class=\"ansired\">]: </span>\n[&apos;33475&apos;,\n &apos;33173&apos;,\n &apos;15743&apos;,\n &apos;32347&apos;,\n &apos;1076&apos;,\n &apos;36872&apos;,\n &apos;34517&apos;,\n &apos;35300&apos;,\n &apos;29848&apos;,\n &apos;3431&apos;]\n</div>","arguments":{},"addedWidgets":{},"removedWidgets":[],"datasetInfos":[]},"errorSummary":"Command skipped","error":null,"workflows":[],"startTime":1494837745499,"submitTime":1494837700455,"finishTime":1494837745572,"collapsed":false,"bindings":{},"inputWidgets":{},"displayType":"table","width":"auto","height":"auto","xColumns":null,"yColumns":null,"pivotColumns":null,"pivotAggregation":null,"customPlotOptions":{},"commentThread":[],"commentsVisible":false,"parentHierarchy":[],"diffInserts":[],"diffDeletes":[],"globalVars":{},"latestUser":"amarildolikmeta@gmail.com","latestUserId":null,"commandTitle":"","showCommandTitle":false,"hideCommandCode":false,"hideCommandResult":false,"iPythonMetadata":null,"streamStates":{},"datasetPreviewNameToCmdIdMap":{},"nuid":"30dae104-d89d-4bea-80c0-39622e469ad2"},{"version":"CommandV1","origId":4087362244415902,"guid":"34745e40-3c8b-407b-9e8c-8ae49483026d","subtype":"command","commandType":"auto","position":22.0,"command":"recomendationsAvg=sc.parallelize(testList.toLocalIterator()).map(recommendTopRated).collect()","commandVersion":0,"state":"error","results":null,"errorSummary":"Cancelled","error":null,"workflows":[],"startTime":1494837700603,"submitTime":1494837700603,"finishTime":1494837761565,"collapsed":false,"bindings":{},"inputWidgets":{},"displayType":"table","width":"auto","height":"auto","xColumns":null,"yColumns":null,"pivotColumns":null,"pivotAggregation":null,"customPlotOptions":{},"commentThread":[],"commentsVisible":false,"parentHierarchy":[],"diffInserts":[],"diffDeletes":[],"globalVars":{},"latestUser":"amarildolikmeta@gmail.com","latestUserId":null,"commandTitle":"","showCommandTitle":false,"hideCommandCode":false,"hideCommandResult":false,"iPythonMetadata":null,"streamStates":{},"datasetPreviewNameToCmdIdMap":{},"nuid":"e33005cf-b5a1-4478-a7ec-8dd3b60c3c2c"},{"version":"CommandV1","origId":4087362244415903,"guid":"89129877-5923-47ec-9592-68aa8b7475c5","subtype":"command","commandType":"auto","position":23.0,"command":"recomendations=recomendationsAvg\nusers=[]\nrecs=[]\nfor i in xrange(len(recomendations)):\n  users.append([recomendations[i][0],str(recomendations[i][1][0])+\" \"+str(recomendations[i][1][1])+\" \"+str(recomendations[i][1][2])+\" \"+str(recomendations[i][1][3])+\" \"+str(recomendations[i][1][4])])\n  recs.append(recomendations[i][1])","commandVersion":0,"state":"error","results":null,"errorSummary":"Command skipped","error":null,"workflows":[],"startTime":1494837700714,"submitTime":1494837700714,"finishTime":1494837761583,"collapsed":false,"bindings":{},"inputWidgets":{},"displayType":"table","width":"auto","height":"auto","xColumns":null,"yColumns":null,"pivotColumns":null,"pivotAggregation":null,"customPlotOptions":{},"commentThread":[],"commentsVisible":false,"parentHierarchy":[],"diffInserts":[],"diffDeletes":[],"globalVars":{},"latestUser":"amarildolikmeta@gmail.com","latestUserId":null,"commandTitle":"","showCommandTitle":false,"hideCommandCode":false,"hideCommandResult":false,"iPythonMetadata":null,"streamStates":{},"datasetPreviewNameToCmdIdMap":{},"nuid":"06157892-e160-44f0-b0da-6a090736c530"},{"version":"CommandV1","origId":4087362244415904,"guid":"e1ff0ad4-daae-4160-8f49-9ec0fd0dbf26","subtype":"command","commandType":"auto","position":20.875,"command":"ratings=np.array(ratings.collect())","commandVersion":0,"state":"finished","results":{"type":"html","data":"<div class=\"ansiout\"></div>","arguments":{},"addedWidgets":{},"removedWidgets":[],"datasetInfos":[]},"errorSummary":"Command skipped","error":null,"workflows":[],"startTime":1494837745576,"submitTime":1494837700504,"finishTime":1494837747188,"collapsed":false,"bindings":{},"inputWidgets":{},"displayType":"table","width":"auto","height":"auto","xColumns":null,"yColumns":null,"pivotColumns":null,"pivotAggregation":null,"customPlotOptions":{},"commentThread":[],"commentsVisible":false,"parentHierarchy":[],"diffInserts":[],"diffDeletes":[],"globalVars":{},"latestUser":"amarildolikmeta@gmail.com","latestUserId":null,"commandTitle":"","showCommandTitle":false,"hideCommandCode":false,"hideCommandResult":false,"iPythonMetadata":null,"streamStates":{},"datasetPreviewNameToCmdIdMap":{},"nuid":"14917939-3a75-4732-8f5b-e6e612708f90"},{"version":"CommandV1","origId":4087362244415905,"guid":"b1eafc81-5a48-41b5-8651-9b4da1ee7149","subtype":"command","commandType":"auto","position":22.5,"command":"print(recomendationsAvg)","commandVersion":0,"state":"error","results":null,"errorSummary":"Command skipped","error":null,"workflows":[],"startTime":1494837700655,"submitTime":1494837700655,"finishTime":1494837761582,"collapsed":false,"bindings":{},"inputWidgets":{},"displayType":"table","width":"auto","height":"auto","xColumns":null,"yColumns":null,"pivotColumns":null,"pivotAggregation":null,"customPlotOptions":{},"commentThread":[],"commentsVisible":false,"parentHierarchy":[],"diffInserts":[],"diffDeletes":[],"globalVars":{},"latestUser":"amarildolikmeta@gmail.com","latestUserId":null,"commandTitle":"","showCommandTitle":false,"hideCommandCode":false,"hideCommandResult":false,"iPythonMetadata":null,"streamStates":{},"datasetPreviewNameToCmdIdMap":{},"nuid":"11050204-61d4-4f88-85f4-f2993fe6af25"},{"version":"CommandV1","origId":4087362244415906,"guid":"55f1ee03-c41d-490e-a942-39e6fa9d25f2","subtype":"command","commandType":"auto","position":24.0,"command":"df=pd.DataFrame(data=users  # values\n                      # 1st column as index\n                    )\ndisplay(sqlContext.createDataFrame(df))","commandVersion":0,"state":"error","results":null,"errorSummary":"Command skipped","error":null,"workflows":[],"startTime":1494837700757,"submitTime":1494837700757,"finishTime":1494837761584,"collapsed":false,"bindings":{},"inputWidgets":{},"displayType":"table","width":"auto","height":"auto","xColumns":null,"yColumns":null,"pivotColumns":null,"pivotAggregation":null,"customPlotOptions":{},"commentThread":[],"commentsVisible":false,"parentHierarchy":[],"diffInserts":[],"diffDeletes":[],"globalVars":{},"latestUser":"amarildolikmeta@gmail.com","latestUserId":null,"commandTitle":"","showCommandTitle":false,"hideCommandCode":false,"hideCommandResult":false,"iPythonMetadata":null,"streamStates":{},"datasetPreviewNameToCmdIdMap":{},"nuid":"eef5a6c8-f22b-4d63-b75d-a66aa17af819"},{"version":"CommandV1","origId":4087362244415907,"guid":"28089d37-a133-428c-adfd-2463362136d0","subtype":"command","commandType":"auto","position":25.0,"command":"avgRating=str(sqlContext.sql(\"Select avg(rating) from train\").rdd.collect()[0][0])\navgRating=float(avgRating) \n","commandVersion":0,"state":"error","results":null,"errorSummary":"Command skipped","error":null,"workflows":[],"startTime":1494837700806,"submitTime":1494837700806,"finishTime":1494837761584,"collapsed":false,"bindings":{},"inputWidgets":{},"displayType":"table","width":"auto","height":"auto","xColumns":null,"yColumns":null,"pivotColumns":null,"pivotAggregation":null,"customPlotOptions":{},"commentThread":[],"commentsVisible":false,"parentHierarchy":[],"diffInserts":[],"diffDeletes":[],"globalVars":{},"latestUser":"amarildolikmeta@gmail.com","latestUserId":null,"commandTitle":"","showCommandTitle":false,"hideCommandCode":false,"hideCommandResult":false,"iPythonMetadata":null,"streamStates":{},"datasetPreviewNameToCmdIdMap":{},"nuid":"d7a17168-2ab5-4a2a-baee-2f27dcd79ddf"},{"version":"CommandV1","origId":4188018607527796,"guid":"4dfd061d-7315-4e19-ad13-3f8dfa8070c1","subtype":"command","commandType":"auto","position":6.0,"command":"display(itemPopularity.toDF())","commandVersion":0,"state":"finished","results":{"type":"table","data":[[32768,1],[2,1],[4,36],[6,7],[8,1],[10,7],[12,52],[32770,2],[14,1],[16,1],[18,7],[22,1],[24,2],[32772,2],[26,1],[32796,1],[30,3],[32,1],[34,1],[36,1],[32774,1],[38,1],[32808,19],[42,2],[32812,1],[46,1],[48,8],[32776,1],[50,2],[52,36],[54,42],[56,1],[58,20],[32778,2],[62,1],[64,3],[66,5],[68,4],[70,13],[72,1],[32780,36],[74,2],[76,21],[78,1],[80,2],[32850,4],[84,12],[32782,1],[86,2],[88,21],[90,2],[92,1],[94,1],[96,1],[32784,1],[98,3],[100,28],[102,6],[104,12],[106,1],[108,1],[32786,1],[110,4],[112,2],[114,23],[116,2],[118,1],[120,2],[122,3],[124,1],[126,2],[128,6],[130,3],[132,1],[32790,4],[134,1],[136,1],[138,5],[140,1],[142,1],[144,1],[146,43],[148,3],[150,1],[152,6],[154,18],[156,3],[32794,1],[158,1],[32928,7],[162,6],[164,1],[166,6],[168,2],[170,2],[32940,1],[174,1],[176,7],[178,2],[180,15],[32798,1],[182,4],[184,29],[186,6],[188,2],[190,1],[192,2],[32800,8],[194,17],[196,1],[198,2],[200,9],[32970,1],[204,1],[32802,5],[206,1],[208,3],[210,2],[32980,27],[214,1],[216,2],[218,1],[220,2],[222,4],[224,1],[32994,5],[228,46],[32806,36],[230,1],[33000,8],[33002,6],[236,2],[238,10],[240,2],[242,1],[244,1],[246,1],[250,6],[252,20],[32810,3],[254,2],[256,2],[258,1],[260,9],[262,2],[264,5],[266,21],[33036,1],[270,1],[272,4],[274,3],[276,1],[32814,4],[33046,3],[33048,4],[282,7],[284,1],[33054,2],[288,1],[32816,1],[290,3],[292,1],[294,1],[296,2],[33066,1],[300,4],[32818,1],[302,7],[304,4],[306,25],[308,3],[312,2],[32820,3],[314,6],[316,1],[318,1],[320,2],[322,39],[324,1],[32822,1],[326,2],[328,1],[330,1],[332,1],[334,2],[336,1],[32824,2],[338,1],[340,1],[342,2],[344,18],[346,12],[348,3],[32826,2],[350,15],[352,1],[354,1],[356,1],[358,24],[360,2],[33130,20],[364,1],[366,53],[368,5],[370,7],[372,11],[32830,1],[374,5],[376,1],[378,2],[380,1],[382,3],[384,1],[32832,2],[386,2],[388,1],[390,3],[392,18],[394,7],[396,3],[32834,3],[398,1],[400,1],[402,2],[33172,2],[406,2],[408,2],[32836,11],[410,1],[414,1],[33184,2],[418,42],[420,4],[32838,2],[422,2],[424,11],[426,1],[428,1],[430,8],[432,2],[32840,2],[434,4],[436,2],[438,2],[440,1],[442,3],[444,1],[32842,16],[446,3],[33216,9],[33218,2],[452,1],[33222,1],[33224,5],[32844,3],[458,2],[33228,1],[462,1],[464,4],[466,1],[468,3],[32846,1],[33238,8],[472,1],[474,8],[476,19],[478,1],[33248,1],[32848,5],[482,1],[33252,1],[488,1],[490,3],[492,1],[494,1],[496,1],[498,2],[500,2],[33270,2],[33272,1],[32852,2],[506,2],[508,1],[510,1],[512,3],[514,1],[516,21],[32854,1],[518,3],[520,1],[522,9],[524,1],[526,8],[528,7],[32856,1],[530,4],[33300,6],[534,5],[536,5],[538,3],[540,1],[32858,3],[542,1],[544,1],[546,2],[548,1],[550,2],[552,1],[32860,1],[554,2],[556,2],[558,1],[560,16],[562,37],[564,1],[32862,1],[566,1],[568,1],[570,1],[572,1],[574,2],[576,1],[32864,1],[33346,1],[580,3],[582,3],[584,1],[33354,2],[588,1],[32866,4],[590,3],[592,1],[594,2],[596,1],[598,14],[600,2],[32868,22],[602,1],[604,2],[606,1],[608,1],[33378,1],[612,25],[32870,2],[614,1],[616,1],[618,1],[620,1],[622,2],[624,1],[32872,1],[626,41],[628,3],[33398,25],[33400,6],[634,3],[636,4],[32874,1],[638,3],[640,1],[33410,1],[644,2],[33414,2],[33416,3],[32876,1],[650,1],[652,4],[654,2],[656,1],[658,1],[660,1],[32878,1],[662,1],[664,8],[666,1],[668,4],[33438,1],[672,2],[32880,1],[674,2],[33444,1],[678,3],[680,2],[682,1],[684,2],[686,1],[33456,1],[690,3],[692,9],[694,2],[696,2],[32884,3],[698,1],[33468,1],[702,1],[704,3],[706,4],[708,2],[710,1],[712,1],[714,1],[33484,3],[718,20],[720,1],[32888,5],[722,31],[724,2],[33496,4],[730,1],[33500,89],[32890,4],[734,1],[33504,1],[738,2],[740,5],[33510,1],[744,1],[32892,1],[746,3],[748,1],[33518,1],[752,4],[33522,1],[756,2],[32894,1],[758,3],[760,1],[762,1],[764,1],[766,1],[33536,4],[32896,1],[770,2],[772,1],[774,4],[776,2],[778,1],[33548,1],[32898,4],[782,27],[784,2],[786,11],[33556,2],[790,1],[792,1],[794,1],[796,1],[798,1],[800,1],[802,2],[804,1],[32902,3],[806,3],[808,1],[810,1],[812,3],[814,3],[816,5],[32904,2],[818,6],[820,2],[822,9],[824,25],[826,8],[33596,1],[32906,2],[830,1],[33600,3],[33602,4],[836,1],[838,2],[840,1],[32908,8],[842,1],[844,2],[846,6],[848,5],[850,7],[852,5],[32910,1],[854,4],[856,1],[858,1],[860,2],[862,1],[864,1],[32912,25],[866,2],[868,2],[870,6],[874,1],[876,74],[32914,6],[33646,2],[33648,7],[33650,5],[884,1],[886,1],[888,2],[32916,83],[890,1],[892,2],[33662,1],[896,1],[898,1],[900,11],[32918,3],[902,4],[904,2],[906,1],[908,1],[910,2],[912,16],[32920,5],[33682,2],[916,1],[918,6],[920,3],[922,1],[924,1],[32922,2],[926,1],[928,3],[930,1],[932,3],[934,3],[33704,1],[32924,1],[938,2],[940,3],[942,16],[944,2],[946,13],[33716,2],[32926,1],[950,2],[952,3],[954,1],[956,31],[958,1],[960,29],[962,13],[964,3],[966,1],[968,4],[970,10],[972,1],[33742,1],[976,7],[978,3],[33748,2],[33750,1],[984,2],[32932,1],[986,22],[988,3],[990,1],[992,1],[994,3],[996,1],[32934,4],[998,1],[1000,1],[1002,1],[1004,1],[1006,1],[1008,3],[32936,1],[1010,6],[1012,5],[1014,2],[1016,1],[1018,1],[1020,6],[32938,5],[1022,2],[1024,4],[33794,6],[1028,1],[1030,19],[1032,1],[1034,1],[1036,6],[1038,1],[1040,1],[1042,1],[1044,1],[32942,3],[33814,3],[1048,2],[33818,39],[1052,1],[1056,9],[32944,2],[1058,2],[33828,3],[1062,1],[1064,9],[1066,1],[1068,4],[32946,1],[1070,1],[1072,1],[1074,22],[1076,88],[1078,1],[1080,2],[32948,1],[1082,2],[1084,2],[1086,2],[1088,2],[33858,3],[1092,1],[32950,1],[1094,3],[1096,1],[1098,1],[1100,1],[1102,12],[1104,4],[32952,2],[1106,4],[1108,1],[1110,1],[1112,1],[1114,5],[1116,5],[32954,2],[1118,1],[1120,7],[1122,1],[1124,3],[1126,1],[1128,2],[32956,32],[1130,1],[1132,1],[1136,2],[1138,4],[1140,1],[32958,3],[1142,5],[1144,13],[1146,1],[1148,1],[1150,1],[1152,1],[32960,1],[1154,4],[1156,5],[1158,7],[33928,1],[1162,8],[1164,6],[32962,3],[1166,4],[1168,1],[1170,1],[1172,1],[1174,1],[1176,1],[1178,1],[1180,1],[1182,1],[1184,5],[33954,1],[1188,10],[32966,1],[1190,12],[1192,32],[1194,3],[1196,3],[1198,1],[1200,3],[32968,2],[33970,1],[1204,4],[1206,1],[1208,1],[1210,1],[1212,5],[1214,1],[1216,4],[1218,1],[1220,2],[1222,1],[1224,1],[32972,1],[1226,1],[1228,3],[1230,1],[1232,1],[1234,1],[1236,1],[32974,3],[1238,3],[1240,5],[1242,1],[1244,3],[1246,5],[1248,1],[32976,5],[1250,1],[1252,2],[1254,1],[1256,1],[1258,24],[1260,14],[32978,7],[1262,1],[1264,3],[1266,1],[1268,4],[1270,2],[1272,13],[1274,2],[1276,1],[1278,3],[1280,3],[1282,2],[1284,1],[32982,1],[1286,1],[1288,1],[1290,10],[1292,14],[1294,1],[1296,1],[32984,1],[1298,1],[1300,1],[1302,1],[1304,23],[1306,24],[1308,10],[32986,1],[1310,1],[1312,3],[1314,3],[34084,17],[1318,3],[1320,3],[32988,3],[1322,2],[1324,1],[34094,1],[1328,4],[1330,1],[1332,2],[32990,1],[34102,4],[1336,4],[1338,12],[1340,19],[1342,2],[1344,2],[32992,19],[1346,2],[1348,3],[1350,3],[1352,1],[1354,1],[1356,5],[1358,1],[1360,26],[1362,3],[1364,1],[1366,1],[1368,1],[1370,1],[1372,8],[1374,1],[1376,2],[1378,12],[1380,2],[32998,1],[1382,1],[1384,1],[1386,1],[1388,2],[1390,1],[1392,2],[1396,1],[1398,2],[1400,1],[1402,4],[1404,1],[1406,1],[1408,1],[1410,2],[1412,3],[1414,8],[1416,4],[33004,1],[1418,4],[1420,8],[1422,4],[1424,1],[1426,1],[1428,1],[33006,1],[1430,7],[1432,5],[1434,21],[1436,13],[1438,39],[1440,4],[33008,2],[1442,27],[1444,15],[1446,2],[1448,57],[1450,1],[1452,5],[33010,12],[1454,1],[1456,39],[1458,2],[1460,17],[1462,1],[1464,1],[33012,5],[1466,1],[1468,2],[1470,2],[1472,2],[1474,6],[1476,3],[33014,43],[1478,4],[1480,14],[1482,1],[1484,1],[1486,2],[1488,1],[1490,9],[1492,9],[1494,3],[1496,1],[1498,32],[1500,26],[33018,1],[1502,11],[1504,1],[1506,1],[1508,3],[1510,1],[1512,4],[33020,2],[1514,2],[34284,7],[1518,21],[1520,12],[1522,3],[1524,2],[33022,1],[1526,2],[1530,4],[1532,1],[1534,2],[1536,4],[1538,3],[1540,1],[1542,1],[1544,8],[1546,2],[34316,1],[33026,1],[1550,1],[1552,1],[1554,2],[1556,1],[1558,3],[1560,10],[33028,1],[1562,1],[1564,3],[1566,6],[34336,3],[1570,1],[1572,1],[33030,2],[1574,23],[1576,16],[1578,2],[1580,1],[1582,1],[1584,1],[33032,1],[1586,2],[1588,1],[1590,1],[1592,4],[1594,2],[1596,1],[33034,1],[34366,1],[1600,5],[1602,3],[1604,1],[1606,8],[1608,1],[1610,3],[1612,2],[1614,1],[1616,1],[1618,3],[1620,1],[33038,1],[1622,5],[1624,3],[1626,2],[1630,2],[1632,3],[33040,1],[1634,1],[34404,1],[1638,4],[34408,1],[1642,1],[1644,10],[1646,1],[1648,3],[1650,2],[1652,30],[1654,4],[1656,4],[33044,6],[1658,3],[1660,1],[1662,1],[1664,1],[34434,1],[1668,2],[1670,1],[1672,2],[1674,1],[1676,1],[1678,23],[34448,8],[1682,1],[1684,1],[1686,20],[1688,1],[1690,1],[1692,1],[33050,11],[1694,2],[1696,2],[1698,1],[1700,1],[1702,1],[34472,13],[33052,1],[1708,10],[1710,1],[1712,5],[1714,1],[1716,1],[1718,3],[1720,1],[1722,1],[1724,2],[1726,1],[1728,24],[33056,5],[1730,29],[1732,18],[34502,1],[1736,2],[1738,5],[1740,4],[33058,1],[1742,1],[1744,4],[1746,13],[1748,1],[1750,1],[1752,1],[33060,2],[1754,1],[34524,1],[1758,2],[1760,13],[1762,19],[1764,1],[33062,1],[1766,3],[1768,1],[1770,3],[1772,1],[1774,3],[34544,1],[33064,1],[1778,4],[1780,1],[1782,8],[34552,1],[1786,1]],"arguments":{},"addedWidgets":{},"removedWidgets":[],"schema":[{"name":"_1","type":"\"long\""},{"name":"_2","type":"\"long\""}],"overflow":true,"aggData":[],"aggSchema":[],"aggOverflow":false,"aggSeriesLimitReached":false,"aggError":"","aggType":"","plotOptions":null,"isJsonSchema":true,"dbfsResultPath":null,"datasetInfos":[],"columnCustomDisplayInfos":{}},"errorSummary":"Command skipped","error":null,"workflows":[],"startTime":1494837706408,"submitTime":1494837699340,"finishTime":1494837707880,"collapsed":false,"bindings":{},"inputWidgets":{},"displayType":"barChart","width":"660","height":"auto","xColumns":null,"yColumns":null,"pivotColumns":null,"pivotAggregation":null,"customPlotOptions":{},"commentThread":[],"commentsVisible":false,"parentHierarchy":[],"diffInserts":[],"diffDeletes":[],"globalVars":{},"latestUser":"amarildolikmeta@gmail.com","latestUserId":null,"commandTitle":"","showCommandTitle":false,"hideCommandCode":false,"hideCommandResult":false,"iPythonMetadata":null,"streamStates":{},"datasetPreviewNameToCmdIdMap":{},"nuid":"601c6811-6bc7-44d7-8649-c54fe6db1d78"},{"version":"CommandV1","origId":4188018607527797,"guid":"aa26629e-db4c-4430-b596-0f7bd5d3251a","subtype":"command","commandType":"auto","position":7.0,"command":"itemPopularity_sorted = itemPopularity.sortBy(lambda x:x[1],ascending=0)","commandVersion":0,"state":"finished","results":{"type":"html","data":"<div class=\"ansiout\"></div>","arguments":{},"addedWidgets":{},"removedWidgets":[],"datasetInfos":[]},"errorSummary":"Command skipped","error":null,"workflows":[],"startTime":1494837708016,"submitTime":1494837699401,"finishTime":1494837708246,"collapsed":false,"bindings":{},"inputWidgets":{},"displayType":"table","width":"auto","height":"auto","xColumns":null,"yColumns":null,"pivotColumns":null,"pivotAggregation":null,"customPlotOptions":{},"commentThread":[],"commentsVisible":false,"parentHierarchy":[],"diffInserts":[],"diffDeletes":[],"globalVars":{},"latestUser":"amarildolikmeta@gmail.com","latestUserId":null,"commandTitle":"","showCommandTitle":false,"hideCommandCode":false,"hideCommandResult":false,"iPythonMetadata":null,"streamStates":{},"datasetPreviewNameToCmdIdMap":{},"nuid":"fbaa5e8d-aa2c-44eb-8df4-e6d439955350"}],"dashboards":[],"guid":"17e4eb9e-fe7c-4c90-ba4a-da1ca6a2ce9b","globalVars":{},"iPythonMetadata":null,"inputWidgets":{}}