{"version":"NotebookV1","origId":1851344826878345,"name":"Collaborative","language":"python","commands":[{"version":"CommandV1","origId":726631496901564,"guid":"84b764d4-5181-4a17-a69c-271da80470d7","subtype":"command","commandType":"auto","position":6.5,"command":"avgGloabalRating","commandVersion":0,"state":"finished","results":{"type":"html","data":"<div class=\"ansiout\"><span class=\"ansired\">Out[</span><span class=\"ansired\">14</span><span class=\"ansired\">]: </span>6.81887639657\n</div>","arguments":{},"addedWidgets":{},"removedWidgets":[],"datasetInfos":[]},"errorSummary":"<span class=\"ansired\">NameError</span>: name &apos;avgGloabalRating&apos; is not defined","error":null,"workflows":[],"startTime":1499021331068,"submitTime":1499021283903,"finishTime":1499021331109,"collapsed":false,"bindings":{},"inputWidgets":{},"displayType":"table","width":"auto","height":"auto","xColumns":null,"yColumns":null,"pivotColumns":null,"pivotAggregation":null,"customPlotOptions":{},"commentThread":[],"commentsVisible":false,"parentHierarchy":[],"diffInserts":[],"diffDeletes":[],"globalVars":{},"latestUser":"amarildolikmeta@gmail.com","latestUserId":null,"commandTitle":"","showCommandTitle":false,"hideCommandCode":false,"hideCommandResult":false,"iPythonMetadata":null,"streamStates":{},"datasetPreviewNameToCmdIdMap":{},"nuid":"ad584a15-e829-4e49-9928-13f38494ca7c"},{"version":"CommandV1","origId":726631496901584,"guid":"86774939-5e49-48a7-a0f6-a6d3a36d2f27","subtype":"command","commandType":"auto","position":27.5,"command":"getSimilarItems('987','26726',['26726'])","commandVersion":0,"state":"finished","results":{"type":"html","data":"<div class=\"ansiout\"><span class=\"ansired\">Out[</span><span class=\"ansired\">48</span><span class=\"ansired\">]: </span>\n[(&apos;30339&apos;, 2.759132341581691),\n (&apos;5811&apos;, 2.759132341581691),\n (&apos;18774&apos;, 2.759132341581691),\n (&apos;21899&apos;, 2.759132341581691),\n (&apos;13215&apos;, 2.759132341581691),\n (&apos;18955&apos;, 2.759132341581691),\n (&apos;8648&apos;, 2.759132341581691),\n (&apos;16966&apos;, 2.759132341581691),\n (&apos;8958&apos;, 2.759132341581691),\n (&apos;25367&apos;, 2.759132341581691)]\n</div>","arguments":{},"addedWidgets":{},"removedWidgets":[],"datasetInfos":[]},"errorSummary":null,"error":null,"workflows":[],"startTime":1499021367420,"submitTime":1499021284088,"finishTime":1499021367673,"collapsed":false,"bindings":{},"inputWidgets":{},"displayType":"table","width":"auto","height":"auto","xColumns":null,"yColumns":null,"pivotColumns":null,"pivotAggregation":null,"customPlotOptions":{},"commentThread":[],"commentsVisible":false,"parentHierarchy":[],"diffInserts":[],"diffDeletes":[],"globalVars":{},"latestUser":"amarildolikmeta@gmail.com","latestUserId":null,"commandTitle":"","showCommandTitle":false,"hideCommandCode":false,"hideCommandResult":false,"iPythonMetadata":null,"streamStates":{},"datasetPreviewNameToCmdIdMap":{},"nuid":"50d7ab10-2bde-4fed-a4ee-21ca1b9c3289"},{"version":"CommandV1","origId":1851344826878347,"guid":"fb2a06d9-d01c-46c3-bccb-68ea1e76ac2c","subtype":"command","commandType":"auto","position":1.0,"command":"import numpy as np\nimport pandas as pd \nfrom math import sqrt ","commandVersion":0,"state":"finished","results":{"type":"html","data":"<div class=\"ansiout\"></div>","arguments":{},"addedWidgets":{},"removedWidgets":[],"datasetInfos":[]},"errorSummary":null,"error":null,"workflows":[],"startTime":1499021314539,"submitTime":1499021283776,"finishTime":1499021314854,"collapsed":false,"bindings":{},"inputWidgets":{},"displayType":"table","width":"auto","height":"auto","xColumns":null,"yColumns":null,"pivotColumns":null,"pivotAggregation":null,"customPlotOptions":{},"commentThread":[],"commentsVisible":false,"parentHierarchy":[],"diffInserts":[],"diffDeletes":[],"globalVars":{},"latestUser":"amarildolikmeta@gmail.com","latestUserId":null,"commandTitle":"","showCommandTitle":false,"hideCommandCode":false,"hideCommandResult":false,"iPythonMetadata":null,"streamStates":{},"datasetPreviewNameToCmdIdMap":{},"nuid":"e5ce3b4d-70a7-4f88-b513-0e92a1b9a52c"},{"version":"CommandV1","origId":1851344826878348,"guid":"890c1088-0ca4-427a-9cbd-5f928bc18fcf","subtype":"command","commandType":"auto","position":2.0,"command":"train=sqlContext.sql(\"SELECT * from train\")\ntrainRDD=train.rdd","commandVersion":0,"state":"finished","results":{"type":"html","data":"<div class=\"ansiout\"></div>","arguments":{},"addedWidgets":{},"removedWidgets":[],"datasetInfos":[]},"errorSummary":null,"error":null,"workflows":[],"startTime":1499021315137,"submitTime":1499021283849,"finishTime":1499021317257,"collapsed":false,"bindings":{},"inputWidgets":{},"displayType":"table","width":"auto","height":"auto","xColumns":null,"yColumns":null,"pivotColumns":null,"pivotAggregation":null,"customPlotOptions":{},"commentThread":[],"commentsVisible":false,"parentHierarchy":[],"diffInserts":[],"diffDeletes":[],"globalVars":{},"latestUser":"amarildolikmeta@gmail.com","latestUserId":null,"commandTitle":"","showCommandTitle":false,"hideCommandCode":false,"hideCommandResult":false,"iPythonMetadata":null,"streamStates":{},"datasetPreviewNameToCmdIdMap":{},"nuid":"80d4e7b9-b850-44e1-9b5b-cea8953a7dc6"},{"version":"CommandV1","origId":1851344826878349,"guid":"b2f990e6-3f0c-4481-b533-01ae499386fa","subtype":"command","commandType":"auto","position":3.0,"command":"testRDD=sqlContext.sql(\"Select * from target\").rdd.map(lambda x:x[0])\ntestList=testRDD.sortBy(lambda x:float(x))","commandVersion":0,"state":"finished","results":{"type":"html","data":"<div class=\"ansiout\"></div>","arguments":{},"addedWidgets":{},"removedWidgets":[],"datasetInfos":[]},"errorSummary":"<span class=\"ansired\">NameError</span>: name &apos;testRDD&apos; is not defined","error":null,"workflows":[],"startTime":1499021317266,"submitTime":1499021283855,"finishTime":1499021317642,"collapsed":false,"bindings":{},"inputWidgets":{},"displayType":"table","width":"auto","height":"auto","xColumns":null,"yColumns":null,"pivotColumns":null,"pivotAggregation":null,"customPlotOptions":{},"commentThread":[],"commentsVisible":false,"parentHierarchy":[],"diffInserts":[],"diffDeletes":[],"globalVars":{},"latestUser":"amarildolikmeta@gmail.com","latestUserId":null,"commandTitle":"","showCommandTitle":false,"hideCommandCode":false,"hideCommandResult":false,"iPythonMetadata":null,"streamStates":{},"datasetPreviewNameToCmdIdMap":{},"nuid":"d7cd4568-e82a-4b03-bb46-9140fbd694ac"},{"version":"CommandV1","origId":1851344826878350,"guid":"b5a0ca55-f166-4117-befa-c4ca08adfb09","subtype":"command","commandType":"auto","position":4.0,"command":"userSeenItems = trainRDD.map(lambda x: (x[0], [x[1]])).reduceByKey(lambda x,y : x+y)\nuserSeenItems_dict = userSeenItems.collectAsMap()","commandVersion":0,"state":"finished","results":{"type":"html","data":"<div class=\"ansiout\"></div>","arguments":{},"addedWidgets":{},"removedWidgets":[],"datasetInfos":[]},"errorSummary":null,"error":null,"workflows":[],"startTime":1499021317652,"submitTime":1499021283860,"finishTime":1499021321502,"collapsed":false,"bindings":{},"inputWidgets":{},"displayType":"table","width":"auto","height":"auto","xColumns":null,"yColumns":null,"pivotColumns":null,"pivotAggregation":null,"customPlotOptions":{},"commentThread":[],"commentsVisible":false,"parentHierarchy":[],"diffInserts":[],"diffDeletes":[],"globalVars":{},"latestUser":"amarildolikmeta@gmail.com","latestUserId":null,"commandTitle":"","showCommandTitle":false,"hideCommandCode":false,"hideCommandResult":false,"iPythonMetadata":null,"streamStates":{},"datasetPreviewNameToCmdIdMap":{},"nuid":"691b60b5-1519-46b8-919d-75c7e7c88b16"},{"version":"CommandV1","origId":1851344826878351,"guid":"5f9b146b-4c79-4532-a29b-4822606e5832","subtype":"command","commandType":"auto","position":5.0,"command":"ratings=sqlContext.sql(\"Select itemId ,sum(rating)/(count(rating)+5) as AvgRating from train group by itemId order by AvgRating desc\").rdd\nAvgItemratings_dict=ratings.map(lambda x:(x[0],float(x[1]))).collectAsMap()","commandVersion":0,"state":"finished","results":{"type":"html","data":"<div class=\"ansiout\"></div>","arguments":{},"addedWidgets":{},"removedWidgets":[],"datasetInfos":[]},"errorSummary":"<span class=\"ansired\">SyntaxError</span><span class=\"ansired\">:</span> invalid syntax","error":null,"workflows":[],"startTime":1499021321551,"submitTime":1499021283871,"finishTime":1499021328510,"collapsed":false,"bindings":{},"inputWidgets":{},"displayType":"table","width":"auto","height":"auto","xColumns":null,"yColumns":null,"pivotColumns":null,"pivotAggregation":null,"customPlotOptions":{},"commentThread":[],"commentsVisible":false,"parentHierarchy":[],"diffInserts":[],"diffDeletes":[],"globalVars":{},"latestUser":"amarildolikmeta@gmail.com","latestUserId":null,"commandTitle":"","showCommandTitle":false,"hideCommandCode":false,"hideCommandResult":false,"iPythonMetadata":null,"streamStates":{},"datasetPreviewNameToCmdIdMap":{},"nuid":"94147da1-fb54-4ad4-9168-3e4926d1633b"},{"version":"CommandV1","origId":1851344826878352,"guid":"65eae51b-1b80-4d08-936e-ae529c6c2725","subtype":"command","commandType":"auto","position":6.0,"command":"avgGlobalRating=str(sqlContext.sql(\"Select avg(rating) from train\").rdd.collect()[0][0])\navgGloabalRating=float(avgGlobalRating) ","commandVersion":0,"state":"finished","results":{"type":"html","data":"<div class=\"ansiout\"></div>","arguments":{},"addedWidgets":{},"removedWidgets":[],"datasetInfos":[]},"errorSummary":"<span class=\"ansired\">NameError</span>: name &apos;avgRating&apos; is not defined","error":null,"workflows":[],"startTime":1499021330137,"submitTime":1499021283898,"finishTime":1499021331061,"collapsed":false,"bindings":{},"inputWidgets":{},"displayType":"table","width":"auto","height":"auto","xColumns":null,"yColumns":null,"pivotColumns":null,"pivotAggregation":null,"customPlotOptions":{},"commentThread":[],"commentsVisible":false,"parentHierarchy":[],"diffInserts":[],"diffDeletes":[],"globalVars":{},"latestUser":"amarildolikmeta@gmail.com","latestUserId":null,"commandTitle":"","showCommandTitle":false,"hideCommandCode":false,"hideCommandResult":false,"iPythonMetadata":null,"streamStates":{},"datasetPreviewNameToCmdIdMap":{},"nuid":"491f50aa-dc41-408a-85fd-bfc9ead58489"},{"version":"CommandV1","origId":1851344826878353,"guid":"0301df56-a43c-4deb-862c-b5cfc54967c4","subtype":"command","commandType":"auto","position":7.0,"command":"userRatings=trainRDD.map(lambda x:(x[0],[(x[1],int(x[2]))])).reduceByKey(lambda x,y:x+y)","commandVersion":0,"state":"finished","results":{"type":"html","data":"<div class=\"ansiout\"></div>","arguments":{},"addedWidgets":{},"removedWidgets":[],"datasetInfos":[]},"errorSummary":null,"error":null,"workflows":[],"startTime":1499021331115,"submitTime":1499021283909,"finishTime":1499021331187,"collapsed":false,"bindings":{},"inputWidgets":{},"displayType":"table","width":"auto","height":"auto","xColumns":null,"yColumns":null,"pivotColumns":null,"pivotAggregation":null,"customPlotOptions":{},"commentThread":[],"commentsVisible":false,"parentHierarchy":[],"diffInserts":[],"diffDeletes":[],"globalVars":{},"latestUser":"amarildolikmeta@gmail.com","latestUserId":null,"commandTitle":"","showCommandTitle":false,"hideCommandCode":false,"hideCommandResult":false,"iPythonMetadata":null,"streamStates":{},"datasetPreviewNameToCmdIdMap":{},"nuid":"0afeafed-cbaa-4139-aef9-c074dcf2d693"},{"version":"CommandV1","origId":1851344826878354,"guid":"aecf9cdf-8520-474c-9953-ef25bc059a50","subtype":"command","commandType":"auto","position":8.0,"command":"userRatings_dict=userRatings.collectAsMap()","commandVersion":0,"state":"finished","results":{"type":"html","data":"<div class=\"ansiout\"></div>","arguments":{},"addedWidgets":{},"removedWidgets":[],"datasetInfos":[]},"errorSummary":null,"error":null,"workflows":[],"startTime":1499021334528,"submitTime":1499021283919,"finishTime":1499021334978,"collapsed":false,"bindings":{},"inputWidgets":{},"displayType":"table","width":"auto","height":"auto","xColumns":null,"yColumns":null,"pivotColumns":null,"pivotAggregation":null,"customPlotOptions":{},"commentThread":[],"commentsVisible":false,"parentHierarchy":[],"diffInserts":[],"diffDeletes":[],"globalVars":{},"latestUser":"amarildolikmeta@gmail.com","latestUserId":null,"commandTitle":"","showCommandTitle":false,"hideCommandCode":false,"hideCommandResult":false,"iPythonMetadata":null,"streamStates":{},"datasetPreviewNameToCmdIdMap":{},"nuid":"785c7480-75b7-4173-acc5-0ef060e8a6d2"},{"version":"CommandV1","origId":1851344826878355,"guid":"901f522f-b6be-46d2-8f9d-6a40453c12c5","subtype":"command","commandType":"auto","position":9.0,"command":"for key in userRatings_dict:\n  userRatings_dict[key]=dict(userRatings_dict[key])\nuserRatings_dict[\"4446\"][\"14644\"]","commandVersion":0,"state":"finished","results":{"type":"html","data":"<div class=\"ansiout\"><span class=\"ansired\">Out[</span><span class=\"ansired\">18</span><span class=\"ansired\">]: </span>10\n</div>","arguments":{},"addedWidgets":{},"removedWidgets":[],"datasetInfos":[]},"errorSummary":null,"error":null,"workflows":[],"startTime":1499021334984,"submitTime":1499021283925,"finishTime":1499021335069,"collapsed":false,"bindings":{},"inputWidgets":{},"displayType":"table","width":"auto","height":"auto","xColumns":null,"yColumns":null,"pivotColumns":null,"pivotAggregation":null,"customPlotOptions":{},"commentThread":[],"commentsVisible":false,"parentHierarchy":[],"diffInserts":[],"diffDeletes":[],"globalVars":{},"latestUser":"amarildolikmeta@gmail.com","latestUserId":null,"commandTitle":"","showCommandTitle":false,"hideCommandCode":false,"hideCommandResult":false,"iPythonMetadata":null,"streamStates":{},"datasetPreviewNameToCmdIdMap":{},"nuid":"96a72d28-c1ac-4499-9752-08d0eb79f174"},{"version":"CommandV1","origId":1851344826878356,"guid":"a38785b6-dc3e-4197-8c0c-ef884679fc62","subtype":"command","commandType":"auto","position":10.0,"command":"from math import sqrt\ndef PearsonSimilarity(user1,user2):\n  seenItems1=set(userSeenItems_dict[user1])\n  seenItems2=set(userSeenItems_dict[user2])\n  totalItems=seenItems1&seenItems2\n  ratings1=np.zeros(len(totalItems))\n  ratings2=np.zeros(len(totalItems))\n  totalItems=list(totalItems)\n  if len(totalItems)==0:\n    return 0\n  for i in xrange(len(totalItems)):\n    try:\n      ratings1[i]=float(userRatings_dict[user1][str(totalItems[i])])\n    except:\n      ratings1[i]=float(meanItemRatings[str(totalItems[i])])\n    try:\n      ratings2[i]=float(userRatings_dict[user2][str(totalItems[i])])\n    except:\n      ratings2[i]=float(meanItemRatings[str(totalItems[i])])  \n  number_of_ratings=len(totalItems)\n  \n  person1_preferences_sum=sum(ratings1)\n  person2_preferences_sum=sum(ratings2)\n  person1_square_preferences_sum=sum([pow(item,2) for item in ratings1 ])\n  person2_square_preferences_sum=sum([pow(item,2) for item in ratings2 ])\n  product_sum_of_both_users=sum([ratings1[i] * ratings2[i] for i in xrange(len(ratings1))])\n   # Calculate the pearson score\n  numerator_value = product_sum_of_both_users - (person1_preferences_sum*person2_preferences_sum/number_of_ratings)\n  denominator_value = sqrt((person1_square_preferences_sum - pow(person1_preferences_sum,2)/number_of_ratings) * (person2_square_preferences_sum -pow(person2_preferences_sum,2)/number_of_ratings))\n\n  if denominator_value == 0:\n      return 0\n  else:\n      r = numerator_value / denominator_value\n      return r\n  ","commandVersion":0,"state":"finished","results":{"type":"html","data":"<div class=\"ansiout\"></div>","arguments":{},"addedWidgets":{},"removedWidgets":[],"datasetInfos":[]},"errorSummary":null,"error":null,"workflows":[],"startTime":1499021335077,"submitTime":1499021283930,"finishTime":1499021335151,"collapsed":false,"bindings":{},"inputWidgets":{},"displayType":"table","width":"auto","height":"auto","xColumns":null,"yColumns":null,"pivotColumns":null,"pivotAggregation":null,"customPlotOptions":{},"commentThread":[],"commentsVisible":false,"parentHierarchy":[],"diffInserts":[],"diffDeletes":[],"globalVars":{},"latestUser":"amarildolikmeta@gmail.com","latestUserId":null,"commandTitle":"","showCommandTitle":false,"hideCommandCode":false,"hideCommandResult":false,"iPythonMetadata":null,"streamStates":{},"datasetPreviewNameToCmdIdMap":{},"nuid":"95d7e941-22b6-4fb1-a13d-cc527473d2db"},{"version":"CommandV1","origId":1851344826878357,"guid":"9ce9c000-1ab8-4bfc-bb5f-39669fd2a0ee","subtype":"command","commandType":"auto","position":11.0,"command":"itemRaters=sqlContext.sql(\"Select itemId, userId from train\").rdd.map(lambda x:(x[0],[x[1]])).reduceByKey(lambda x,y:x+y)\nitemRaters_dict=itemRaters.collectAsMap()\nitemRaters_dict[\"15\"]","commandVersion":0,"state":"finished","results":{"type":"html","data":"<div class=\"ansiout\"><span class=\"ansired\">Out[</span><span class=\"ansired\">20</span><span class=\"ansired\">]: </span>[u&apos;3418&apos;, u&apos;4672&apos;, u&apos;9052&apos;, u&apos;9520&apos;]\n</div>","arguments":{},"addedWidgets":{},"removedWidgets":[],"datasetInfos":[]},"errorSummary":null,"error":null,"workflows":[],"startTime":1499021335158,"submitTime":1499021283935,"finishTime":1499021337576,"collapsed":false,"bindings":{},"inputWidgets":{},"displayType":"table","width":"auto","height":"auto","xColumns":null,"yColumns":null,"pivotColumns":null,"pivotAggregation":null,"customPlotOptions":{},"commentThread":[],"commentsVisible":false,"parentHierarchy":[],"diffInserts":[],"diffDeletes":[],"globalVars":{},"latestUser":"amarildolikmeta@gmail.com","latestUserId":null,"commandTitle":"","showCommandTitle":false,"hideCommandCode":false,"hideCommandResult":false,"iPythonMetadata":null,"streamStates":{},"datasetPreviewNameToCmdIdMap":{},"nuid":"ea507ef6-7b00-464e-a50f-88ed12382136"},{"version":"CommandV1","origId":1851344826878358,"guid":"6b3ca4ea-305f-42b1-852e-172f68b73d01","subtype":"command","commandType":"auto","position":12.0,"command":"itemList=sqlContext.sql(\"Select distinct itemId from train order by int(itemId)\").rdd.map(lambda x:x[0]).collect()\nitemList[0:5]","commandVersion":0,"state":"finished","results":{"type":"html","data":"<div class=\"ansiout\"><span class=\"ansired\">Out[</span><span class=\"ansired\">21</span><span class=\"ansired\">]: </span>[u&apos;1&apos;, u&apos;2&apos;, u&apos;3&apos;, u&apos;4&apos;, u&apos;5&apos;]\n</div>","arguments":{},"addedWidgets":{},"removedWidgets":[],"datasetInfos":[]},"errorSummary":null,"error":null,"workflows":[],"startTime":1499021337583,"submitTime":1499021283941,"finishTime":1499021343529,"collapsed":false,"bindings":{},"inputWidgets":{},"displayType":"table","width":"auto","height":"auto","xColumns":null,"yColumns":null,"pivotColumns":null,"pivotAggregation":null,"customPlotOptions":{},"commentThread":[],"commentsVisible":false,"parentHierarchy":[],"diffInserts":[],"diffDeletes":[],"globalVars":{},"latestUser":"amarildolikmeta@gmail.com","latestUserId":null,"commandTitle":"","showCommandTitle":false,"hideCommandCode":false,"hideCommandResult":false,"iPythonMetadata":null,"streamStates":{},"datasetPreviewNameToCmdIdMap":{},"nuid":"bee9c5f3-8fd4-4d23-b771-ab92bf537c07"},{"version":"CommandV1","origId":1851344826878359,"guid":"68f232aa-8aae-4a63-bb52-00d7aa386c7a","subtype":"command","commandType":"auto","position":13.0,"command":"userAverage=sqlContext.sql(\"Select userId , avg(rating) from train group by userId\").rdd.map(lambda x:(x[0],float(x[1])))\nuserAverage_dict=userAverage.collectAsMap()\nuserAverage_dict[\"15\"]","commandVersion":0,"state":"finished","results":{"type":"html","data":"<div class=\"ansiout\"><span class=\"ansired\">Out[</span><span class=\"ansired\">22</span><span class=\"ansired\">]: </span>8.0\n</div>","arguments":{},"addedWidgets":{},"removedWidgets":[],"datasetInfos":[]},"errorSummary":"<span class=\"ansired\">SyntaxError</span><span class=\"ansired\">:</span> invalid syntax","error":null,"workflows":[],"startTime":1499021343536,"submitTime":1499021283946,"finishTime":1499021346155,"collapsed":false,"bindings":{},"inputWidgets":{},"displayType":"table","width":"auto","height":"auto","xColumns":null,"yColumns":null,"pivotColumns":null,"pivotAggregation":null,"customPlotOptions":{},"commentThread":[],"commentsVisible":false,"parentHierarchy":[],"diffInserts":[],"diffDeletes":[],"globalVars":{},"latestUser":"amarildolikmeta@gmail.com","latestUserId":null,"commandTitle":"","showCommandTitle":false,"hideCommandCode":false,"hideCommandResult":false,"iPythonMetadata":null,"streamStates":{},"datasetPreviewNameToCmdIdMap":{},"nuid":"544bfa9a-36f9-4890-875d-a8e6ee926059"},{"version":"CommandV1","origId":1851344826878361,"guid":"87efefe4-1ef9-463f-8c8d-26609bf94d5a","subtype":"command","commandType":"auto","position":14.0,"command":"def Collaborative(userId):\n  userId=str(userId)\n  if numRatings_dict[userId]<3:\n    return recommendTopRated(userId)\n  averageUserRating=userAverage_dict[userId]\n  seenItems=seenItems = np.array(userSeenItems_dict[userId])\n  similarUsers=getNMostSimilarUsers(userId,10)\n  reccomendedList=[]\n  itemRatingsList=[]\n  for item in itemList:\n    if item not in seenItems:\n      itemRating=averageUserRating[item]\n      numerator=0\n      denominator=0\n      if len(similarUsers)!=0:\n        for user in similarUsers:\n          try:\n            numerator=numerator+(userRatings_dict[user][item]-itemRating)*PearsonSimilarity(userId,user)\n            denominator=denominator+PearsonSimilarity(userId,user)\n          except:\n            pass\n        if denominator!=0:\n          itemRating=itemRating+(numerator/denominator)\n      itemRatingsList.append((item,itemRating))\n  itemRatingsList = sorted(itemRatingsList, key=lambda tup: tup[1],reverse=True)\n  reccomendedList=[ seq[0] for seq in itemRatingsList[0:numberOfItemsToRecommend] ]\n  return [userId,reccomendedList[0:numberOfItemsToRecommend]]\n       ","commandVersion":0,"state":"finished","results":{"type":"html","data":"<div class=\"ansiout\"></div>","arguments":{},"addedWidgets":{},"removedWidgets":[],"datasetInfos":[]},"errorSummary":"<span class=\"ansired\">IndentationError</span><span class=\"ansired\">:</span> unindent does not match any outer indentation level","error":null,"workflows":[],"startTime":1499021352516,"submitTime":1499021283984,"finishTime":1499021352570,"collapsed":false,"bindings":{},"inputWidgets":{},"displayType":"table","width":"auto","height":"auto","xColumns":null,"yColumns":null,"pivotColumns":null,"pivotAggregation":null,"customPlotOptions":{},"commentThread":[],"commentsVisible":false,"parentHierarchy":[],"diffInserts":[],"diffDeletes":[],"globalVars":{},"latestUser":"amarildolikmeta@gmail.com","latestUserId":null,"commandTitle":"","showCommandTitle":false,"hideCommandCode":false,"hideCommandResult":false,"iPythonMetadata":null,"streamStates":{},"datasetPreviewNameToCmdIdMap":{},"nuid":"f3ea70ce-c36e-4f36-9381-04f3a4c9fa93"},{"version":"CommandV1","origId":1851344826878362,"guid":"f8cbd8bc-2c1c-44e5-bc5a-37d4bcd0562a","subtype":"command","commandType":"auto","position":13.5,"command":"def recommendTopRated(user_id, removeSeen=1):\n    recommendedList = ratings\n    if(removeSeen):\n      seenItems = np.array(userSeenItems_dict[user_id])\n      unseen_mask = np.in1d(recommendedList, seenItems, invert=True)\n      recommendedList = recommendedList[unseen_mask]      \n    return [user_id,recommendedList[0:numberOfItemsToRecommend].tolist()]","commandVersion":0,"state":"finished","results":{"type":"html","data":"<div class=\"ansiout\"></div>","arguments":{},"addedWidgets":{},"removedWidgets":[],"datasetInfos":[]},"errorSummary":null,"error":null,"workflows":[],"startTime":1499021350093,"submitTime":1499021283957,"finishTime":1499021350117,"collapsed":false,"bindings":{},"inputWidgets":{},"displayType":"table","width":"auto","height":"auto","xColumns":null,"yColumns":null,"pivotColumns":null,"pivotAggregation":null,"customPlotOptions":{},"commentThread":[],"commentsVisible":false,"parentHierarchy":[],"diffInserts":[],"diffDeletes":[],"globalVars":{},"latestUser":"amarildolikmeta@gmail.com","latestUserId":null,"commandTitle":"","showCommandTitle":false,"hideCommandCode":false,"hideCommandResult":false,"iPythonMetadata":null,"streamStates":{},"datasetPreviewNameToCmdIdMap":{},"nuid":"17983de2-7ce7-46c9-b0b6-da08abb5170e"},{"version":"CommandV1","origId":1851344826878363,"guid":"a9a7a8c5-a216-4471-b491-636a1f250199","subtype":"command","commandType":"auto","position":13.25,"command":"completeUserList=sqlContext.sql(\"Select distinct userId from train order by int(userId)\").rdd.map(lambda x:x[0]).collect()","commandVersion":0,"state":"finished","results":{"type":"html","data":"<div class=\"ansiout\"></div>","arguments":{},"addedWidgets":{},"removedWidgets":[],"datasetInfos":[]},"errorSummary":null,"error":null,"workflows":[],"startTime":1499021346162,"submitTime":1499021283951,"finishTime":1499021350087,"collapsed":false,"bindings":{},"inputWidgets":{},"displayType":"table","width":"auto","height":"auto","xColumns":null,"yColumns":null,"pivotColumns":null,"pivotAggregation":null,"customPlotOptions":{},"commentThread":[],"commentsVisible":false,"parentHierarchy":[],"diffInserts":[],"diffDeletes":[],"globalVars":{},"latestUser":"amarildolikmeta@gmail.com","latestUserId":null,"commandTitle":"","showCommandTitle":false,"hideCommandCode":false,"hideCommandResult":false,"iPythonMetadata":null,"streamStates":{},"datasetPreviewNameToCmdIdMap":{},"nuid":"4ce6db85-9706-40ec-86ca-f9092687c43f"},{"version":"CommandV1","origId":1851344826878364,"guid":"3362ffc7-c60a-4242-832d-c56812101880","subtype":"command","commandType":"auto","position":5.5,"command":"ratings=ratings.map(lambda x:str(x[0])).collect()\n","commandVersion":0,"state":"finished","results":{"type":"html","data":"<div class=\"ansiout\"></div>","arguments":{},"addedWidgets":{},"removedWidgets":[],"datasetInfos":[]},"errorSummary":null,"error":null,"workflows":[],"startTime":1499021328600,"submitTime":1499021283882,"finishTime":1499021330014,"collapsed":false,"bindings":{},"inputWidgets":{},"displayType":"table","width":"auto","height":"auto","xColumns":null,"yColumns":null,"pivotColumns":null,"pivotAggregation":null,"customPlotOptions":{},"commentThread":[],"commentsVisible":false,"parentHierarchy":[],"diffInserts":[],"diffDeletes":[],"globalVars":{},"latestUser":"amarildolikmeta@gmail.com","latestUserId":null,"commandTitle":"","showCommandTitle":false,"hideCommandCode":false,"hideCommandResult":false,"iPythonMetadata":null,"streamStates":{},"datasetPreviewNameToCmdIdMap":{},"nuid":"c35252a0-beef-4bbd-9118-76f1540bd9a4"},{"version":"CommandV1","origId":1851344826878365,"guid":"8aa4441d-ae27-4fa4-b267-7038186f5d57","subtype":"command","commandType":"auto","position":5.75,"command":"ratings=np.array(ratings)","commandVersion":0,"state":"finished","results":{"type":"html","data":"<div class=\"ansiout\"></div>","arguments":{},"addedWidgets":{},"removedWidgets":[],"datasetInfos":[]},"errorSummary":null,"error":null,"workflows":[],"startTime":1499021330025,"submitTime":1499021283887,"finishTime":1499021330100,"collapsed":false,"bindings":{},"inputWidgets":{},"displayType":"table","width":"auto","height":"auto","xColumns":null,"yColumns":null,"pivotColumns":null,"pivotAggregation":null,"customPlotOptions":{},"commentThread":[],"commentsVisible":false,"parentHierarchy":[],"diffInserts":[],"diffDeletes":[],"globalVars":{},"latestUser":"amarildolikmeta@gmail.com","latestUserId":null,"commandTitle":"","showCommandTitle":false,"hideCommandCode":false,"hideCommandResult":false,"iPythonMetadata":null,"streamStates":{},"datasetPreviewNameToCmdIdMap":{},"nuid":"1d5040ef-e158-41f8-a6bb-033d42c38271"},{"version":"CommandV1","origId":1851344826878367,"guid":"be55aea8-0289-47c9-bb5d-c9c0707f314b","subtype":"command","commandType":"auto","position":13.75,"command":"#Returns n similar users if they exist, otherwise return those with coeffiecient different than 0\ndef getNMostSimilarUsers(userId,n):\n  similarities=[]\n  count=0\n  for user in completeUserList:\n    if(userId!=user):\n      similarity=PearsonSimilarity(userId,user)\n      if similarity!=0:\n        similarities.append((user,similarity))\n        count=count+1\n  similarities = sorted(similarities, key=lambda tup: tup[1],reverse=True)\n  if count>n:\n    count=n\n  similarities=[ seq[0] for seq in similarities[0:count] ]\n  return similarities","commandVersion":0,"state":"finished","results":{"type":"html","data":"<div class=\"ansiout\"></div>","arguments":{},"addedWidgets":{},"removedWidgets":[],"datasetInfos":[]},"errorSummary":null,"error":null,"workflows":[],"startTime":1499021350154,"submitTime":1499021283968,"finishTime":1499021350179,"collapsed":false,"bindings":{},"inputWidgets":{},"displayType":"table","width":"auto","height":"auto","xColumns":null,"yColumns":null,"pivotColumns":null,"pivotAggregation":null,"customPlotOptions":{},"commentThread":[],"commentsVisible":false,"parentHierarchy":[],"diffInserts":[],"diffDeletes":[],"globalVars":{},"latestUser":"amarildolikmeta@gmail.com","latestUserId":null,"commandTitle":"","showCommandTitle":false,"hideCommandCode":false,"hideCommandResult":false,"iPythonMetadata":null,"streamStates":{},"datasetPreviewNameToCmdIdMap":{},"nuid":"11377c0b-5c14-4c59-a32f-a79d85544a8f"},{"version":"CommandV1","origId":1851344826878368,"guid":"4dfd71b0-ea5d-44ea-96ce-582a7d6740d7","subtype":"command","commandType":"auto","position":13.875,"command":"getNMostSimilarUsers(\"19\",10)","commandVersion":0,"state":"finished","results":{"type":"html","data":"<div class=\"ansiout\"><span class=\"ansired\">Out[</span><span class=\"ansired\">27</span><span class=\"ansired\">]: </span>[u&apos;406&apos;, u&apos;3748&apos;, u&apos;15280&apos;, u&apos;4386&apos;, u&apos;14572&apos;]\n</div>","arguments":{},"addedWidgets":{},"removedWidgets":[],"datasetInfos":[]},"errorSummary":"<span class=\"ansired\">ZeroDivisionError</span>: integer division or modulo by zero","error":null,"workflows":[],"startTime":1499021350185,"submitTime":1499021283973,"finishTime":1499021350389,"collapsed":false,"bindings":{},"inputWidgets":{},"displayType":"table","width":"auto","height":"auto","xColumns":null,"yColumns":null,"pivotColumns":null,"pivotAggregation":null,"customPlotOptions":{},"commentThread":[],"commentsVisible":false,"parentHierarchy":[],"diffInserts":[],"diffDeletes":[],"globalVars":{},"latestUser":"amarildolikmeta@gmail.com","latestUserId":null,"commandTitle":"","showCommandTitle":false,"hideCommandCode":false,"hideCommandResult":false,"iPythonMetadata":null,"streamStates":{},"datasetPreviewNameToCmdIdMap":{},"nuid":"580800c9-3296-45c6-8933-2460aec41485"},{"version":"CommandV1","origId":1851344826878369,"guid":"dea94391-8802-42cb-a8ed-f7055a510404","subtype":"command","commandType":"auto","position":1.5,"command":"numberOfItemsToRecommend=5","commandVersion":0,"state":"finished","results":{"type":"html","data":"<div class=\"ansiout\"></div>","arguments":{},"addedWidgets":{},"removedWidgets":[],"datasetInfos":[]},"errorSummary":null,"error":null,"workflows":[],"startTime":1499021314985,"submitTime":1499021283839,"finishTime":1499021315074,"collapsed":false,"bindings":{},"inputWidgets":{},"displayType":"table","width":"auto","height":"auto","xColumns":null,"yColumns":null,"pivotColumns":null,"pivotAggregation":null,"customPlotOptions":{},"commentThread":[],"commentsVisible":false,"parentHierarchy":[],"diffInserts":[],"diffDeletes":[],"globalVars":{},"latestUser":"amarildolikmeta@gmail.com","latestUserId":null,"commandTitle":"","showCommandTitle":false,"hideCommandCode":false,"hideCommandResult":false,"iPythonMetadata":null,"streamStates":{},"datasetPreviewNameToCmdIdMap":{},"nuid":"360d2ace-046e-4d5d-93d8-f3bb461ae0c5"},{"version":"CommandV1","origId":1851344826878372,"guid":"0737fe99-de4a-4993-8461-4606b568bb57","subtype":"command","commandType":"auto","position":13.9375,"command":"numRatings=sqlContext.sql(\"Select userId,count(rating) as numRatings from train group by userId \").rdd.map(lambda x:(x[0],int(x[1])))\nnumRatings_dict=numRatings.collectAsMap()\nnumRatings_dict[\"15\"]","commandVersion":0,"state":"finished","results":{"type":"html","data":"<div class=\"ansiout\"><span class=\"ansired\">Out[</span><span class=\"ansired\">28</span><span class=\"ansired\">]: </span>5\n</div>","arguments":{},"addedWidgets":{},"removedWidgets":[],"datasetInfos":[]},"errorSummary":"<span class=\"ansired\">AnalysisException</span>: u&quot;cannot resolve &apos;ratings&apos; given input columns: [userId, itemId, rating]; line 1 pos 20&quot;","error":null,"workflows":[],"startTime":1499021350395,"submitTime":1499021283978,"finishTime":1499021352510,"collapsed":false,"bindings":{},"inputWidgets":{},"displayType":"table","width":"auto","height":"auto","xColumns":null,"yColumns":null,"pivotColumns":null,"pivotAggregation":null,"customPlotOptions":{},"commentThread":[],"commentsVisible":false,"parentHierarchy":[],"diffInserts":[],"diffDeletes":[],"globalVars":{},"latestUser":"amarildolikmeta@gmail.com","latestUserId":null,"commandTitle":"","showCommandTitle":false,"hideCommandCode":false,"hideCommandResult":false,"iPythonMetadata":null,"streamStates":{},"datasetPreviewNameToCmdIdMap":{},"nuid":"8d2f198c-9de5-4ec0-80dc-ff5cce39a28b"},{"version":"CommandV1","origId":1851344826878375,"guid":"0d8285ba-3499-4e0c-b51a-6d594c7f1cc0","subtype":"command","commandType":"auto","position":13.625,"command":"recommendTopRated(\"4\")","commandVersion":0,"state":"finished","results":{"type":"html","data":"<div class=\"ansiout\"><span class=\"ansired\">Out[</span><span class=\"ansired\">25</span><span class=\"ansired\">]: </span>[&apos;4&apos;, [&apos;33475&apos;, &apos;33173&apos;, &apos;15743&apos;, &apos;32347&apos;, &apos;1076&apos;]]\n</div>","arguments":{},"addedWidgets":{},"removedWidgets":[],"datasetInfos":[]},"errorSummary":"<span class=\"ansired\">IndexError</span>: index 33557 is out of bounds for axis 0 with size 33557","error":null,"workflows":[],"startTime":1499021350122,"submitTime":1499021283962,"finishTime":1499021350148,"collapsed":false,"bindings":{},"inputWidgets":{},"displayType":"table","width":"auto","height":"auto","xColumns":null,"yColumns":null,"pivotColumns":null,"pivotAggregation":null,"customPlotOptions":{},"commentThread":[],"commentsVisible":false,"parentHierarchy":[],"diffInserts":[],"diffDeletes":[],"globalVars":{},"latestUser":"amarildolikmeta@gmail.com","latestUserId":null,"commandTitle":"","showCommandTitle":false,"hideCommandCode":false,"hideCommandResult":false,"iPythonMetadata":null,"streamStates":{},"datasetPreviewNameToCmdIdMap":{},"nuid":"b8332556-daf2-4488-a845-d6e62407a1ec"},{"version":"CommandV1","origId":1851344826878376,"guid":"45949fda-07f5-4e2a-8c7d-feb6e5ea3dcc","subtype":"command","commandType":"auto","position":5.875,"command":"ratings[0:5]","commandVersion":0,"state":"finished","results":{"type":"html","data":"<div class=\"ansiout\"><span class=\"ansired\">Out[</span><span class=\"ansired\">12</span><span class=\"ansired\">]: </span>\narray([&apos;33475&apos;, &apos;33173&apos;, &apos;15743&apos;, &apos;32347&apos;, &apos;1076&apos;], \n      dtype=&apos;|S5&apos;)\n</div>","arguments":{},"addedWidgets":{},"removedWidgets":[],"datasetInfos":[]},"errorSummary":null,"error":null,"workflows":[],"startTime":1499021330107,"submitTime":1499021283893,"finishTime":1499021330130,"collapsed":false,"bindings":{},"inputWidgets":{},"displayType":"table","width":"auto","height":"auto","xColumns":null,"yColumns":null,"pivotColumns":null,"pivotAggregation":null,"customPlotOptions":{},"commentThread":[],"commentsVisible":false,"parentHierarchy":[],"diffInserts":[],"diffDeletes":[],"globalVars":{},"latestUser":"amarildolikmeta@gmail.com","latestUserId":null,"commandTitle":"","showCommandTitle":false,"hideCommandCode":false,"hideCommandResult":false,"iPythonMetadata":null,"streamStates":{},"datasetPreviewNameToCmdIdMap":{},"nuid":"32e949b7-4637-4a78-b400-9f82c1201877"},{"version":"CommandV1","origId":1851344826878377,"guid":"4ee08d31-8402-4483-9bda-5a6bc3c6b52c","subtype":"command","commandType":"auto","position":14.5,"command":"Collaborative2(\"4\")","commandVersion":0,"state":"finished","results":{"type":"html","data":"<div class=\"ansiout\"><span class=\"ansired\">Out[</span><span class=\"ansired\">31</span><span class=\"ansired\">]: </span>[&apos;4&apos;, [u&apos;33475&apos;, u&apos;33173&apos;, u&apos;15743&apos;, u&apos;32347&apos;, u&apos;1076&apos;]]\n</div>","arguments":{},"addedWidgets":{},"removedWidgets":[],"datasetInfos":[]},"errorSummary":"<span class=\"ansired\">TypeError</span>: unsupported operand type(s) for +: &apos;dict&apos; and &apos;int&apos;","error":null,"workflows":[],"startTime":1499021352610,"submitTime":1499021283995,"finishTime":1499021356198,"collapsed":false,"bindings":{},"inputWidgets":{},"displayType":"table","width":"auto","height":"auto","xColumns":null,"yColumns":null,"pivotColumns":null,"pivotAggregation":null,"customPlotOptions":{},"commentThread":[],"commentsVisible":false,"parentHierarchy":[],"diffInserts":[],"diffDeletes":[],"globalVars":{},"latestUser":"amarildolikmeta@gmail.com","latestUserId":null,"commandTitle":"","showCommandTitle":false,"hideCommandCode":false,"hideCommandResult":false,"iPythonMetadata":null,"streamStates":{},"datasetPreviewNameToCmdIdMap":{},"nuid":"3efef4ad-3856-453e-8c38-27580179b252"},{"version":"CommandV1","origId":1851344826878380,"guid":"18338867-14dc-44e2-9a12-46207e3dea36","subtype":"command","commandType":"auto","position":19.0,"command":"features=sqlContext.sql(\"Select * from icm \").rdd.map(lambda x:(x[0],x[1]))\nfeatures.take(10)","commandVersion":0,"state":"finished","results":{"type":"html","data":"<div class=\"ansiout\"><span class=\"ansired\">Out[</span><span class=\"ansired\">33</span><span class=\"ansired\">]: </span>\n[(2135, 1),\n (2303, 1),\n (6292, 1),\n (12395, 1),\n (24520, 1),\n (25297, 1),\n (32548, 1),\n (34303, 1),\n (36141, 1),\n (11812, 2)]\n</div>","arguments":{},"addedWidgets":{},"removedWidgets":[],"datasetInfos":[]},"errorSummary":"Command skipped","error":null,"workflows":[],"startTime":1499021359904,"submitTime":1499021284006,"finishTime":1499021360429,"collapsed":false,"bindings":{},"inputWidgets":{},"displayType":"table","width":"auto","height":"auto","xColumns":null,"yColumns":null,"pivotColumns":null,"pivotAggregation":null,"customPlotOptions":{},"commentThread":[],"commentsVisible":false,"parentHierarchy":[],"diffInserts":[],"diffDeletes":[],"globalVars":{},"latestUser":"amarildolikmeta@gmail.com","latestUserId":null,"commandTitle":"","showCommandTitle":false,"hideCommandCode":false,"hideCommandResult":false,"iPythonMetadata":null,"streamStates":{},"datasetPreviewNameToCmdIdMap":{},"nuid":"328efac6-25c1-4666-8ae4-5d9fbf23ab85"},{"version":"CommandV1","origId":1851344826878381,"guid":"fb738c98-92c5-44a8-98c5-d2b909139a30","subtype":"command","commandType":"auto","position":5.25,"command":"AvgItemratings_dict[\"15\"]","commandVersion":0,"state":"finished","results":{"type":"html","data":"<div class=\"ansiout\"><span class=\"ansired\">Out[</span><span class=\"ansired\">9</span><span class=\"ansired\">]: </span>1.6666666666666667\n</div>","arguments":{},"addedWidgets":{},"removedWidgets":[],"datasetInfos":[]},"errorSummary":null,"error":null,"workflows":[],"startTime":1499021328519,"submitTime":1499021283876,"finishTime":1499021328592,"collapsed":false,"bindings":{},"inputWidgets":{},"displayType":"table","width":"auto","height":"auto","xColumns":null,"yColumns":null,"pivotColumns":null,"pivotAggregation":null,"customPlotOptions":{},"commentThread":[],"commentsVisible":false,"parentHierarchy":[],"diffInserts":[],"diffDeletes":[],"globalVars":{},"latestUser":"amarildolikmeta@gmail.com","latestUserId":null,"commandTitle":"","showCommandTitle":false,"hideCommandCode":false,"hideCommandResult":false,"iPythonMetadata":null,"streamStates":{},"datasetPreviewNameToCmdIdMap":{},"nuid":"9bba1125-52ba-4611-8663-71141b94ed23"},{"version":"CommandV1","origId":1851344826878382,"guid":"8d8b7a97-f064-4530-a2fd-6c9c031ae388","subtype":"command","commandType":"auto","position":14.25,"command":"def Collaborative2(userId):\n  userId=str(userId)\n  seenItems=seenItems = np.array(userSeenItems_dict[userId])\n  reccomendedList=[]\n  itemRatingsList=[]\n  for item in itemList:\n    if item not in seenItems:\n      itemRating=AvgItemratings_dict[item]\n      numerator=0\n      denominator=0\n      for user in itemRaters_dict[item]:\n        try:\n          numerator=numerator+(float(userRatings_dict[user][item])*PearsonSimilarity(userId,user))\n          denominator=denominator+1\n        except:\n          pass\n        if denominator!=0:\n          itemRating=itemRating+(numerator/denominator)\n      itemRatingsList.append((item,itemRating))\n  itemRatingsList = sorted(itemRatingsList, key=lambda tup: tup[1],reverse=True)\n  reccomendedList=[ seq[0] for seq in itemRatingsList[0:numberOfItemsToRecommend] ]\n  return [userId,reccomendedList[0:numberOfItemsToRecommend]]\n       ","commandVersion":0,"state":"finished","results":{"type":"html","data":"<div class=\"ansiout\"></div>","arguments":{},"addedWidgets":{},"removedWidgets":[],"datasetInfos":[]},"errorSummary":null,"error":null,"workflows":[],"startTime":1499021352576,"submitTime":1499021283989,"finishTime":1499021352603,"collapsed":false,"bindings":{},"inputWidgets":{},"displayType":"table","width":"auto","height":"auto","xColumns":null,"yColumns":null,"pivotColumns":null,"pivotAggregation":null,"customPlotOptions":{},"commentThread":[],"commentsVisible":false,"parentHierarchy":[],"diffInserts":[],"diffDeletes":[],"globalVars":{},"latestUser":"amarildolikmeta@gmail.com","latestUserId":null,"commandTitle":"","showCommandTitle":false,"hideCommandCode":false,"hideCommandResult":false,"iPythonMetadata":null,"streamStates":{},"datasetPreviewNameToCmdIdMap":{},"nuid":"8bdc925a-5902-4197-9a2c-02dcb38321e5"},{"version":"CommandV1","origId":1851344826878383,"guid":"aaf4b0f9-1941-477e-8396-cde3c6903537","subtype":"command","commandType":"auto","position":15.25,"command":"Collaborative2(\"15\")","commandVersion":0,"state":"finished","results":{"type":"html","data":"<div class=\"ansiout\"><span class=\"ansired\">Out[</span><span class=\"ansired\">32</span><span class=\"ansired\">]: </span>[&apos;15&apos;, [u&apos;24991&apos;, u&apos;23507&apos;, u&apos;17657&apos;, u&apos;16891&apos;, u&apos;269&apos;]]\n</div>","arguments":{},"addedWidgets":{},"removedWidgets":[],"datasetInfos":[]},"errorSummary":null,"error":null,"workflows":[],"startTime":1499021356206,"submitTime":1499021284000,"finishTime":1499021359899,"collapsed":false,"bindings":{},"inputWidgets":{},"displayType":"table","width":"auto","height":"auto","xColumns":null,"yColumns":null,"pivotColumns":null,"pivotAggregation":null,"customPlotOptions":{},"commentThread":[],"commentsVisible":false,"parentHierarchy":[],"diffInserts":[],"diffDeletes":[],"globalVars":{},"latestUser":"amarildolikmeta@gmail.com","latestUserId":null,"commandTitle":"","showCommandTitle":false,"hideCommandCode":false,"hideCommandResult":false,"iPythonMetadata":null,"streamStates":{},"datasetPreviewNameToCmdIdMap":{},"nuid":"c76fd21c-20e2-4a49-a4b3-6d53f2eb1c7a"},{"version":"CommandV1","origId":2743778135306860,"guid":"533f51eb-c73e-4bb6-822d-39bc82199586","subtype":"command","commandType":"auto","position":26.625,"command":"def getSimilar(item):\n  similar=[]\n  for i in featuredItemsList:\n    if i!=item:\n      similarity=itemSimilarity(item,i)\n      if similarity!=0:\n        similar.append((str(i),similarity))\n  return similar","commandVersion":0,"state":"finished","results":{"type":"html","data":"<div class=\"ansiout\"></div>","arguments":{},"addedWidgets":{},"removedWidgets":[],"datasetInfos":[]},"errorSummary":"Command skipped","error":null,"workflows":[],"startTime":1499021367120,"submitTime":1499021284065,"finishTime":1499021367158,"collapsed":false,"bindings":{},"inputWidgets":{},"displayType":"table","width":"auto","height":"auto","xColumns":null,"yColumns":null,"pivotColumns":null,"pivotAggregation":null,"customPlotOptions":{},"commentThread":[],"commentsVisible":false,"parentHierarchy":[],"diffInserts":[],"diffDeletes":[],"globalVars":{},"latestUser":"amarildolikmeta@gmail.com","latestUserId":null,"commandTitle":"","showCommandTitle":false,"hideCommandCode":false,"hideCommandResult":false,"iPythonMetadata":null,"streamStates":{},"datasetPreviewNameToCmdIdMap":{},"nuid":"df68a81c-5674-4c72-b3c8-eaf8d8e8aec3"},{"version":"CommandV1","origId":2743778135306862,"guid":"7565f2a9-3a29-4041-abb5-fcad55fc6b6a","subtype":"command","commandType":"auto","position":26.8125,"command":"print(7)","commandVersion":0,"state":"finished","results":{"type":"html","data":"<div class=\"ansiout\">7\n</div>","arguments":{},"addedWidgets":{},"removedWidgets":[],"datasetInfos":[]},"errorSummary":"Command skipped","error":null,"workflows":[],"startTime":1499021367366,"submitTime":1499021284077,"finishTime":1499021367380,"collapsed":false,"bindings":{},"inputWidgets":{},"displayType":"table","width":"auto","height":"auto","xColumns":null,"yColumns":null,"pivotColumns":null,"pivotAggregation":null,"customPlotOptions":{},"commentThread":[],"commentsVisible":false,"parentHierarchy":[],"diffInserts":[],"diffDeletes":[],"globalVars":{},"latestUser":"amarildolikmeta@gmail.com","latestUserId":null,"commandTitle":"","showCommandTitle":false,"hideCommandCode":false,"hideCommandResult":false,"iPythonMetadata":null,"streamStates":{},"datasetPreviewNameToCmdIdMap":{},"nuid":"a25ed930-5854-41b3-8bd4-d89bfd8f418c"},{"version":"CommandV1","origId":2743778135306870,"guid":"f70848a9-115d-4311-b0fb-d143bbeaecb9","subtype":"command","commandType":"auto","position":29.5,"command":"recomendationsContent[0]","commandVersion":0,"state":"finished","results":{"type":"html","data":"<div class=\"ansiout\"><span class=\"ansired\">Out[</span><span class=\"ansired\">51</span><span class=\"ansired\">]: </span>[&apos;4&apos;, [&apos;20384&apos;, &apos;23476&apos;, &apos;31701&apos;, &apos;28526&apos;, &apos;20424&apos;]]\n</div>","arguments":{},"addedWidgets":{},"removedWidgets":[],"datasetInfos":[]},"errorSummary":"Command skipped","error":null,"workflows":[],"startTime":1499027482981,"submitTime":1499021284105,"finishTime":1499027483021,"collapsed":false,"bindings":{},"inputWidgets":{},"displayType":"table","width":"auto","height":"auto","xColumns":null,"yColumns":null,"pivotColumns":null,"pivotAggregation":null,"customPlotOptions":{},"commentThread":[],"commentsVisible":false,"parentHierarchy":[],"diffInserts":[],"diffDeletes":[],"globalVars":{},"latestUser":"amarildolikmeta@gmail.com","latestUserId":null,"commandTitle":"","showCommandTitle":false,"hideCommandCode":false,"hideCommandResult":false,"iPythonMetadata":null,"streamStates":{},"datasetPreviewNameToCmdIdMap":{},"nuid":"dd35c7a4-a8c4-4aee-b5d9-525425234202"},{"version":"CommandV1","origId":3180229192564018,"guid":"5d6c2958-452a-499f-82a1-10af944a5dfb","subtype":"command","commandType":"auto","position":20.0,"command":"features_dict=features.map(lambda x:(str(x[0]),[x[1]])).reduceByKey(lambda x,y:x+y).collectAsMap() \nfeatures_dict[\"2135\"] #features of item 2135","commandVersion":0,"state":"finished","results":{"type":"html","data":"<div class=\"ansiout\"><span class=\"ansired\">Out[</span><span class=\"ansired\">34</span><span class=\"ansired\">]: </span>[1, 3250, 4715, 5786, 6524, 8317]\n</div>","arguments":{},"addedWidgets":{},"removedWidgets":[],"datasetInfos":[]},"errorSummary":"Command skipped","error":null,"workflows":[],"startTime":1499021360434,"submitTime":1499021284011,"finishTime":1499021362550,"collapsed":false,"bindings":{},"inputWidgets":{},"displayType":"table","width":"auto","height":"auto","xColumns":null,"yColumns":null,"pivotColumns":null,"pivotAggregation":null,"customPlotOptions":{},"commentThread":[],"commentsVisible":false,"parentHierarchy":[],"diffInserts":[],"diffDeletes":[],"globalVars":{},"latestUser":"amarildolikmeta@gmail.com","latestUserId":null,"commandTitle":"","showCommandTitle":false,"hideCommandCode":false,"hideCommandResult":false,"iPythonMetadata":null,"streamStates":{},"datasetPreviewNameToCmdIdMap":{},"nuid":"30a391d5-883b-4a02-808a-9e1e02cc0174"},{"version":"CommandV1","origId":3180229192564019,"guid":"9bdf38bb-a83f-45ba-8615-f433a0f976b6","subtype":"command","commandType":"auto","position":21.0,"command":"from scipy import spatial\nfrom math import sqrt\ndef itemSimilarity(item1,item2):\n  try :\n    featuresItems1=set(features_dict[item1])\n    featuresItems2=set(features_dict[item2])\n    numerator=len(featuresItems1&featuresItems2)\n    shrink=7\n    sum1=sqrt(len(featuresItems1))\n    sum2=sqrt(len(featuresItems2))\n    #return 1-  spatial.distance.cosine(features1, features2)\n    return numerator/((sum1*sum2)+shrink)\n  except:\n    return 0","commandVersion":0,"state":"finished","results":{"type":"html","data":"<div class=\"ansiout\"></div>","arguments":{},"addedWidgets":{},"removedWidgets":[],"datasetInfos":[]},"errorSummary":"Command skipped","error":null,"workflows":[],"startTime":1499021364176,"submitTime":1499021284022,"finishTime":1499021364308,"collapsed":false,"bindings":{},"inputWidgets":{},"displayType":"table","width":"auto","height":"auto","xColumns":null,"yColumns":null,"pivotColumns":null,"pivotAggregation":null,"customPlotOptions":{},"commentThread":[],"commentsVisible":false,"parentHierarchy":[],"diffInserts":[],"diffDeletes":[],"globalVars":{},"latestUser":"amarildolikmeta@gmail.com","latestUserId":null,"commandTitle":"","showCommandTitle":false,"hideCommandCode":false,"hideCommandResult":false,"iPythonMetadata":null,"streamStates":{},"datasetPreviewNameToCmdIdMap":{},"nuid":"82509402-33c9-49e5-98ea-3713f4d62f24"},{"version":"CommandV1","origId":3180229192564020,"guid":"be41a8f3-e13e-422c-9ea8-bb48e9d0a4dd","subtype":"command","commandType":"auto","position":20.5,"command":"print(sqlContext.sql(\"Select distinct featureId from icm\").count())","commandVersion":0,"state":"finished","results":{"type":"html","data":"<div class=\"ansiout\">19715\n</div>","arguments":{},"addedWidgets":{},"removedWidgets":[],"datasetInfos":[]},"errorSummary":"Command skipped","error":null,"workflows":[],"startTime":1499021362558,"submitTime":1499021284016,"finishTime":1499021364170,"collapsed":false,"bindings":{},"inputWidgets":{},"displayType":"table","width":"auto","height":"auto","xColumns":null,"yColumns":null,"pivotColumns":null,"pivotAggregation":null,"customPlotOptions":{},"commentThread":[],"commentsVisible":false,"parentHierarchy":[],"diffInserts":[],"diffDeletes":[],"globalVars":{},"latestUser":"amarildolikmeta@gmail.com","latestUserId":null,"commandTitle":"","showCommandTitle":false,"hideCommandCode":false,"hideCommandResult":true,"iPythonMetadata":null,"streamStates":{},"datasetPreviewNameToCmdIdMap":{},"nuid":"61c9ad85-a4a4-478a-bea6-090d255d9f35"},{"version":"CommandV1","origId":3180229192564023,"guid":"39544f6d-d088-4498-a14a-c53d9437fadf","subtype":"command","commandType":"auto","position":24.0,"command":"itemSimilarity(\"15\",\"17\")","commandVersion":0,"state":"finished","results":{"type":"html","data":"<div class=\"ansiout\"><span class=\"ansired\">Out[</span><span class=\"ansired\">37</span><span class=\"ansired\">]: </span>0.0\n</div>","arguments":{},"addedWidgets":{},"removedWidgets":[],"datasetInfos":[]},"errorSummary":"Command skipped","error":null,"workflows":[],"startTime":1499021364314,"submitTime":1499021284027,"finishTime":1499021364386,"collapsed":false,"bindings":{},"inputWidgets":{},"displayType":"table","width":"auto","height":"auto","xColumns":null,"yColumns":null,"pivotColumns":null,"pivotAggregation":null,"customPlotOptions":{},"commentThread":[],"commentsVisible":false,"parentHierarchy":[],"diffInserts":[],"diffDeletes":[],"globalVars":{},"latestUser":"amarildolikmeta@gmail.com","latestUserId":null,"commandTitle":"","showCommandTitle":false,"hideCommandCode":false,"hideCommandResult":false,"iPythonMetadata":null,"streamStates":{},"datasetPreviewNameToCmdIdMap":{},"nuid":"d5b23a53-6cdc-4065-8801-dfe7b42af11d"},{"version":"CommandV1","origId":3180229192564024,"guid":"6c025b9a-bfd2-46b1-869e-fd98411321bc","subtype":"command","commandType":"auto","position":25.0,"command":"userRatingsList_dict=userRatings.collectAsMap()\nuserRatingsList_dict[\"15\"]","commandVersion":0,"state":"finished","results":{"type":"html","data":"<div class=\"ansiout\"><span class=\"ansired\">Out[</span><span class=\"ansired\">38</span><span class=\"ansired\">]: </span>[(u&apos;1686&apos;, 9), (u&apos;4949&apos;, 7), (u&apos;13298&apos;, 8), (u&apos;25363&apos;, 9), (u&apos;33993&apos;, 7)]\n</div>","arguments":{},"addedWidgets":{},"removedWidgets":[],"datasetInfos":[]},"errorSummary":"Command skipped","error":null,"workflows":[],"startTime":1499021364391,"submitTime":1499021284033,"finishTime":1499021364820,"collapsed":false,"bindings":{},"inputWidgets":{},"displayType":"table","width":"auto","height":"auto","xColumns":null,"yColumns":null,"pivotColumns":null,"pivotAggregation":null,"customPlotOptions":{},"commentThread":[],"commentsVisible":false,"parentHierarchy":[],"diffInserts":[],"diffDeletes":[],"globalVars":{},"latestUser":"amarildolikmeta@gmail.com","latestUserId":null,"commandTitle":"","showCommandTitle":false,"hideCommandCode":false,"hideCommandResult":false,"iPythonMetadata":null,"streamStates":{},"datasetPreviewNameToCmdIdMap":{},"nuid":"01a86cac-c3bf-486b-b933-af0c35fdca82"},{"version":"CommandV1","origId":3180229192564025,"guid":"4f13d5d7-6702-4992-8fba-cef6978f80d1","subtype":"command","commandType":"auto","position":26.0,"command":"for key in userRatingsList_dict:\n  userRatingsList_dict[key]=sorted(userRatingsList_dict[key],key=lambda tup: tup[1],reverse=True)\n  userRatingsList_dict[key]=[ seq[0] for seq in userRatingsList_dict[key] ]\nuserRatingsList_dict[\"15\"]  #OrderFavoriteItemsForEachUser","commandVersion":0,"state":"finished","results":{"type":"html","data":"<div class=\"ansiout\"><span class=\"ansired\">Out[</span><span class=\"ansired\">39</span><span class=\"ansired\">]: </span>[u&apos;1686&apos;, u&apos;25363&apos;, u&apos;13298&apos;, u&apos;4949&apos;, u&apos;33993&apos;]\n</div>","arguments":{},"addedWidgets":{},"removedWidgets":[],"datasetInfos":[]},"errorSummary":"Command skipped","error":null,"workflows":[],"startTime":1499021364825,"submitTime":1499021284038,"finishTime":1499021364947,"collapsed":false,"bindings":{},"inputWidgets":{},"displayType":"table","width":"auto","height":"auto","xColumns":null,"yColumns":null,"pivotColumns":null,"pivotAggregation":null,"customPlotOptions":{},"commentThread":[],"commentsVisible":false,"parentHierarchy":[],"diffInserts":[],"diffDeletes":[],"globalVars":{},"latestUser":"amarildolikmeta@gmail.com","latestUserId":null,"commandTitle":"","showCommandTitle":false,"hideCommandCode":false,"hideCommandResult":false,"iPythonMetadata":null,"streamStates":{},"datasetPreviewNameToCmdIdMap":{},"nuid":"c5db9755-882e-43d4-b600-ec0477b928b7"},{"version":"CommandV1","origId":3180229192564026,"guid":"8644c0c1-d2b2-47e8-84ca-cadf3eff6abc","subtype":"command","commandType":"auto","position":27.0,"command":"def ContentFiltering(userId):\n  userId=str(userId)\n  seenItems = np.array(userSeenItems_dict[userId])\n  reccomendedList=[]\n  reccomendedItems=[]\n  for item in userRatingsList_dict[userId]:\n    similar=getSimilarItems(userId,item,seenItems)\n    for tup in similar:\n      if tup[0] not in seenItems:\n        reccomendedItems.append(tup[0])\n        reccomendedList.append(tup)\n  reccomendedList = sorted(reccomendedList, key=lambda tup: tup[1],reverse=True)\n  reccomendedList=[ seq[0] for seq in reccomendedList ]\n  seen = set()\n  seen_add = seen.add\n  reccomendedList=[x for x in reccomendedList if not (x in seen or seen_add(x))]\n  return [userId,reccomendedList[0:numberOfItemsToRecommend]]","commandVersion":0,"state":"finished","results":{"type":"html","data":"<div class=\"ansiout\"></div>","arguments":{},"addedWidgets":{},"removedWidgets":[],"datasetInfos":[]},"errorSummary":"Command skipped","error":null,"workflows":[],"startTime":1499028071674,"submitTime":1499028071669,"finishTime":1499028071714,"collapsed":false,"bindings":{},"inputWidgets":{},"displayType":"table","width":"auto","height":"auto","xColumns":null,"yColumns":null,"pivotColumns":null,"pivotAggregation":null,"customPlotOptions":{},"commentThread":[],"commentsVisible":false,"parentHierarchy":[],"diffInserts":[],"diffDeletes":[],"globalVars":{},"latestUser":"amarildolikmeta@gmail.com","latestUserId":null,"commandTitle":"","showCommandTitle":false,"hideCommandCode":false,"hideCommandResult":false,"iPythonMetadata":null,"streamStates":{},"datasetPreviewNameToCmdIdMap":{},"nuid":"b5855cf9-4704-4e65-a68a-faae09ffa4df"},{"version":"CommandV1","origId":3180229192564027,"guid":"8fa0280c-1f47-47d7-a0bc-2e6219da1501","subtype":"command","commandType":"auto","position":26.5,"command":"def getSimilarItems(user,item,seenItems):\n  rating=userRatings_dict[user][item]\n  similar=[]\n  for i in featuredItemsList:\n    if i not in seenItems:\n      similarity=itemSimilarity(item,i)\n      rate=similarity*rating\n      if rate!=0:\n        similar.append((str(i),rate))\n  similar = sorted(similar, key=lambda tup: tup[1],reverse=True)\n  if len(similar)>10:\n    return similar[0:10]\n  else:\n    return similar","commandVersion":0,"state":"finished","results":{"type":"html","data":"<div class=\"ansiout\"></div>","arguments":{},"addedWidgets":{},"removedWidgets":[],"datasetInfos":[]},"errorSummary":"<span class=\"ansired\">SyntaxError</span><span class=\"ansired\">:</span> invalid syntax","error":null,"workflows":[],"startTime":1499021367074,"submitTime":1499021284060,"finishTime":1499021367115,"collapsed":false,"bindings":{},"inputWidgets":{},"displayType":"table","width":"auto","height":"auto","xColumns":null,"yColumns":null,"pivotColumns":null,"pivotAggregation":null,"customPlotOptions":{},"commentThread":[],"commentsVisible":false,"parentHierarchy":[],"diffInserts":[],"diffDeletes":[],"globalVars":{},"latestUser":"amarildolikmeta@gmail.com","latestUserId":null,"commandTitle":"","showCommandTitle":false,"hideCommandCode":false,"hideCommandResult":false,"iPythonMetadata":null,"streamStates":{},"datasetPreviewNameToCmdIdMap":{},"nuid":"74706376-0074-43b9-96e4-1052d4663109"},{"version":"CommandV1","origId":3180229192564028,"guid":"627bced2-f893-4bb3-b945-7514671d7288","subtype":"command","commandType":"auto","position":26.75,"command":"print(getSimilarItems(\"4446\",\"14644\",[]))","commandVersion":0,"state":"finished","results":{"type":"html","data":"<div class=\"ansiout\">[(&apos;14644&apos;, 4.615384615384616), (&apos;35564&apos;, 2.6684122382716597), (&apos;20801&apos;, 2.6684122382716597), (&apos;35227&apos;, 2.6684122382716597), (&apos;20922&apos;, 2.6684122382716597), (&apos;11793&apos;, 2.5212246173203727), (&apos;31584&apos;, 2.5212246173203727), (&apos;21532&apos;, 2.5212246173203727), (&apos;12352&apos;, 2.5212246173203727), (&apos;21220&apos;, 2.404380670971061)]\n</div>","arguments":{},"addedWidgets":{},"removedWidgets":[],"datasetInfos":[]},"errorSummary":"<span class=\"ansired\">TypeError</span>: getSimilarItems() takes exactly 3 arguments (2 given)","error":null,"workflows":[],"startTime":1499021367163,"submitTime":1499021284071,"finishTime":1499021367361,"collapsed":false,"bindings":{},"inputWidgets":{},"displayType":"table","width":"auto","height":"auto","xColumns":null,"yColumns":null,"pivotColumns":null,"pivotAggregation":null,"customPlotOptions":{},"commentThread":[],"commentsVisible":false,"parentHierarchy":[],"diffInserts":[],"diffDeletes":[],"globalVars":{},"latestUser":"amarildolikmeta@gmail.com","latestUserId":null,"commandTitle":"","showCommandTitle":false,"hideCommandCode":false,"hideCommandResult":false,"iPythonMetadata":null,"streamStates":{},"datasetPreviewNameToCmdIdMap":{},"nuid":"83c1bdc5-688c-49a8-994e-10c8dcdd9f26"},{"version":"CommandV1","origId":3180229192564029,"guid":"2bb3ae8d-eb23-4022-b033-272ef0e8f0fe","subtype":"command","commandType":"auto","position":26.25,"command":"featuredItems=sqlContext.sql(\"Select distinct itemId from icm\").rdd.map(lambda x:str(x[0]))\nfeaturedItemsList=featuredItems.collect()\nfeaturedItemsList[0:10]","commandVersion":0,"state":"finished","results":{"type":"html","data":"<div class=\"ansiout\"><span class=\"ansired\">Out[</span><span class=\"ansired\">40</span><span class=\"ansired\">]: </span>\n[&apos;21220&apos;,\n &apos;7880&apos;,\n &apos;148&apos;,\n &apos;36538&apos;,\n &apos;3997&apos;,\n &apos;23364&apos;,\n &apos;7993&apos;,\n &apos;36224&apos;,\n &apos;22521&apos;,\n &apos;16861&apos;]\n</div>","arguments":{},"addedWidgets":{},"removedWidgets":[],"datasetInfos":[]},"errorSummary":"Command skipped","error":null,"workflows":[],"startTime":1499021364952,"submitTime":1499021284043,"finishTime":1499021366988,"collapsed":false,"bindings":{},"inputWidgets":{},"displayType":"table","width":"auto","height":"auto","xColumns":null,"yColumns":null,"pivotColumns":null,"pivotAggregation":null,"customPlotOptions":{},"commentThread":[],"commentsVisible":false,"parentHierarchy":[],"diffInserts":[],"diffDeletes":[],"globalVars":{},"latestUser":"amarildolikmeta@gmail.com","latestUserId":null,"commandTitle":"","showCommandTitle":false,"hideCommandCode":false,"hideCommandResult":false,"iPythonMetadata":null,"streamStates":{},"datasetPreviewNameToCmdIdMap":{},"nuid":"bb4f3c53-fb06-49bc-9bbc-8210380a4108"},{"version":"CommandV1","origId":3180229192564030,"guid":"8c7c00ed-e441-4d1e-9740-3d04ca7d3653","subtype":"command","commandType":"auto","position":26.375,"command":"type(featuredItemsList[0])","commandVersion":0,"state":"finished","results":{"type":"html","data":"<div class=\"ansiout\"><span class=\"ansired\">Out[</span><span class=\"ansired\">41</span><span class=\"ansired\">]: </span>str\n</div>","arguments":{},"addedWidgets":{},"removedWidgets":[],"datasetInfos":[]},"errorSummary":"Command skipped","error":null,"workflows":[],"startTime":1499021366997,"submitTime":1499021284049,"finishTime":1499021367038,"collapsed":false,"bindings":{},"inputWidgets":{},"displayType":"table","width":"auto","height":"auto","xColumns":null,"yColumns":null,"pivotColumns":null,"pivotAggregation":null,"customPlotOptions":{},"commentThread":[],"commentsVisible":false,"parentHierarchy":[],"diffInserts":[],"diffDeletes":[],"globalVars":{},"latestUser":"amarildolikmeta@gmail.com","latestUserId":null,"commandTitle":"","showCommandTitle":false,"hideCommandCode":false,"hideCommandResult":false,"iPythonMetadata":null,"streamStates":{},"datasetPreviewNameToCmdIdMap":{},"nuid":"5dcc8442-38d1-4523-96aa-6eadc7242d8a"},{"version":"CommandV1","origId":3180229192564031,"guid":"6e63be09-1654-453c-a9e9-82d62c5309f8","subtype":"command","commandType":"auto","position":26.4375,"command":"len(itemList)","commandVersion":0,"state":"finished","results":{"type":"html","data":"<div class=\"ansiout\"><span class=\"ansired\">Out[</span><span class=\"ansired\">42</span><span class=\"ansired\">]: </span>33557\n</div>","arguments":{},"addedWidgets":{},"removedWidgets":[],"datasetInfos":[]},"errorSummary":"Command skipped","error":null,"workflows":[],"startTime":1499021367044,"submitTime":1499021284054,"finishTime":1499021367068,"collapsed":false,"bindings":{},"inputWidgets":{},"displayType":"table","width":"auto","height":"auto","xColumns":null,"yColumns":null,"pivotColumns":null,"pivotAggregation":null,"customPlotOptions":{},"commentThread":[],"commentsVisible":false,"parentHierarchy":[],"diffInserts":[],"diffDeletes":[],"globalVars":{},"latestUser":"amarildolikmeta@gmail.com","latestUserId":null,"commandTitle":"","showCommandTitle":false,"hideCommandCode":false,"hideCommandResult":false,"iPythonMetadata":null,"streamStates":{},"datasetPreviewNameToCmdIdMap":{},"nuid":"7c1ab993-be89-440d-b573-8c8f0a0a795f"},{"version":"CommandV1","origId":3180229192564032,"guid":"abeeccfe-4f00-4b88-ba94-3da1709c5c64","subtype":"command","commandType":"auto","position":28.0,"command":"ContentFiltering(987)","commandVersion":0,"state":"finished","results":{"type":"html","data":"<div class=\"ansiout\"><span class=\"ansired\">Out[</span><span class=\"ansired\">58</span><span class=\"ansired\">]: </span>[&apos;987&apos;, [&apos;30339&apos;, &apos;5811&apos;, &apos;18774&apos;, &apos;21899&apos;, &apos;13215&apos;]]\n</div>","arguments":{},"addedWidgets":{},"removedWidgets":[],"datasetInfos":[]},"errorSummary":"<span class=\"ansired\">NameError</span>: global name &apos;getSimilarItems&apos; is not defined","error":null,"workflows":[],"startTime":1499028075663,"submitTime":1499028075657,"finishTime":1499028076037,"collapsed":false,"bindings":{},"inputWidgets":{},"displayType":"table","width":"auto","height":"auto","xColumns":null,"yColumns":null,"pivotColumns":null,"pivotAggregation":null,"customPlotOptions":{},"commentThread":[],"commentsVisible":false,"parentHierarchy":[],"diffInserts":[],"diffDeletes":[],"globalVars":{},"latestUser":"amarildolikmeta@gmail.com","latestUserId":null,"commandTitle":"","showCommandTitle":false,"hideCommandCode":false,"hideCommandResult":false,"iPythonMetadata":null,"streamStates":{},"datasetPreviewNameToCmdIdMap":{},"nuid":"2635c20e-e85d-4c3b-8c84-0949d5fc2507"},{"version":"CommandV1","origId":3180229192564033,"guid":"3d396735-0400-4941-a6b3-ce4e8accfa37","subtype":"command","commandType":"auto","position":29.0,"command":"recomendationsContent=sc.parallelize(testList.toLocalIterator()).map(ContentFiltering).collect()","commandVersion":0,"state":"finished","results":{"type":"html","data":"<div class=\"ansiout\"></div>","arguments":{},"addedWidgets":{},"removedWidgets":[],"datasetInfos":[]},"errorSummary":"Cancelled","error":null,"workflows":[],"startTime":1499028087011,"submitTime":1499028087006,"finishTime":1499034143121,"collapsed":false,"bindings":{},"inputWidgets":{},"displayType":"table","width":"auto","height":"auto","xColumns":null,"yColumns":null,"pivotColumns":null,"pivotAggregation":null,"customPlotOptions":{},"commentThread":[],"commentsVisible":false,"parentHierarchy":[],"diffInserts":[],"diffDeletes":[],"globalVars":{},"latestUser":"amarildolikmeta@gmail.com","latestUserId":null,"commandTitle":"","showCommandTitle":false,"hideCommandCode":false,"hideCommandResult":false,"iPythonMetadata":null,"streamStates":{},"datasetPreviewNameToCmdIdMap":{},"nuid":"496a4818-5908-46d3-8e04-f8bacbb8c9bb"},{"version":"CommandV1","origId":3180229192564036,"guid":"d73d2adc-5113-4a00-88a2-f10dc96abb07","subtype":"command","commandType":"auto","position":30.0,"command":"recomendations=recomendationsContent\nusers=[]\nrecs=[]\n\nfor i in xrange(len(recomendations)):\n  try:\n    users.append([recomendations[i][0],str(recomendations[i][1][0])+\" \"+str(recomendations[i][1][1])+\" \"+str(recomendations[i][1][2])+\" \"+str(recomendations[i][1][3])+\" \"+str(recomendations[i][1][4])])\n  except:\n    recomendations[i][1]=recomendations[i][1]+recommendTopRated(recomendations[i][0])[1]\n    recomendations[i][1]=recomendations[i][1][0:5]\n    print(recomendations[i][1])\n  recs.append(recomendations[i][1])","commandVersion":0,"state":"finished","results":{"type":"html","data":"<div class=\"ansiout\"></div>","arguments":{},"addedWidgets":{},"removedWidgets":[],"datasetInfos":[]},"errorSummary":"<span class=\"ansired\">NameError</span>: name &apos;recomendationsContent&apos; is not defined","error":null,"workflows":[],"startTime":1499034214940,"submitTime":1499034214932,"finishTime":1499034214984,"collapsed":false,"bindings":{},"inputWidgets":{},"displayType":"table","width":"auto","height":"auto","xColumns":null,"yColumns":null,"pivotColumns":null,"pivotAggregation":null,"customPlotOptions":{},"commentThread":[],"commentsVisible":false,"parentHierarchy":[],"diffInserts":[],"diffDeletes":[],"globalVars":{},"latestUser":"amarildolikmeta@gmail.com","latestUserId":null,"commandTitle":"","showCommandTitle":false,"hideCommandCode":false,"hideCommandResult":false,"iPythonMetadata":null,"streamStates":{},"datasetPreviewNameToCmdIdMap":{},"nuid":"b739ebbf-085b-495e-8f9f-e8d28e9e5079"},{"version":"CommandV1","origId":3180229192564037,"guid":"c7105919-8eaa-4940-9096-7718fa9055d6","subtype":"command","commandType":"auto","position":31.0,"command":"df=pd.DataFrame(data=users  # values\n                      # 1st column as index\n                ,columns=[\"userId\",\"RecommendedItemIds\"]\n                    )\ndisplay(sqlContext.createDataFrame(df))","commandVersion":0,"state":"finished","results":{"type":"table","data":[["4","14148 25948 5457 16839 31899"],["5","1269 2762 10 35637 9676"],["8","8134 19014 30851 14470 25084"],["9","30287 1265 32994 27629 30468"],["13","7130 25365 11745 11975 36076"],["18","1448 8877 18741 17207 24547"],["19","4269 33143 36535 13651 34657"],["23","33562 30610 11592 36285 15559"],["26","13069 24256 28592 34533 9038"],["29","24217 1041 31496 19270 7716"],["31","17126 10963 35251 22010 37115"],["32","25987 15112 35399 19578 7351"],["33","31285 85 24588 7666 30114"],["35","36350 22731 457 25887 33554"],["37","26550 27731 5926 15566 16016"],["51","15973 20941 24547 23336 19907"],["52","11557 28294 31484 8376 21388"],["53","30053 17925 29833 23282 4708"],["54","25952 25839 18383 35355 23799"],["61","4037 36748 22265 320 6862"],["64","15973 8216 33266 31107 32287"],["69","27778 15599 12530 29408 19977"],["76","36163 24837 11863 6942 32680"],["78","35300 20495 6612 35626 385"],["79","10734 2134 21195 34255 4256"],["85","876 17645 31484 8376 21388"],["89","21157 30308 14029 34829 32951"],["92","18351 15994 2563 31046 29866"],["93","14738 33628 4554 1460 37056"],["95","7876 32692 11806 10123 30339"],["100","12535 20532 11133 4223 11554"],["104","10149 672 7371 10598 37015"],["105","17782 32793 34011 17502 4240"],["109","16004 29046 31341 26621 2623"],["110","30539 22787 2031 5828 2192"],["111","2041 12866 20955 22579 13726"],["112","30053 14532 33515 6725 19072"],["122","16451 2041 23949 10094 21604"],["126","1304 7168 24362 25967 29208"],["131","27152 14648 19494 30603 28477"],["132","14644 34081 17555 29560 12533"],["136","21412 12102 17648 12873 9980"],["140","22104 25304 35378 199 22970"],["144","20083 35399 35626 385 29560"],["145","31345 18439 13040 25777 36151"],["146","21412 8394 12873 20777 35626"],["151","36705 35775 23338 35903 32684"],["152","29355 7971 22092 31556 26605"],["155","613 10727 35218 26513 1556"],["156","14738 33628 4554 1460 37056"],["160","12693 4905 4357 17396 16278"],["162","25831 644 24155 15037 17866"],["164","16313 28246 12456 4173 26576"],["165","8173 31887 25421 19240 33361"],["166","1073 7019 28114 21833 5039"],["169","22433 3272 19523 19427 22533"],["173","3584 16659 23081 9576 13405"],["179","31341 20959 2623 37065 2561"],["184","16155 32463 18351 15994 2563"],["185","29885 473 15959 12556 18301"],["186","23949 30265 20955 31601 8336"],["187","17364 34706 31479 6010 32403"],["189","29673 22727 31992 36127 12350"],["190","30201 12458 11131 4966 14063"],["191","711 11028 12478 28516 13397"],["197","14588 20920 20495 26489 11398"],["205","12362 35738 2030 27726 13228"],["208","23453 20040 2928 11097 18407"],["209","36193 27083 8912 34975 13500"],["217","10069 10727 35218 26513 1556"],["218","13069 24256 28592 34533 9038"],["222","18170 16491 4966 14063 33215"],["223","13173 16766 18088 34751 10133"],["234","20941 8216 33266 6623 11752"],["240","15263 33443 17658 6707 14583"],["246","33693 20867 9987 30157 2590"],["247","15221 10334 34762 3811 26283"],["250","33389 4140 33473 14814 15823"],["257","7274 32674 35809 35481 3457"],["258","21725 18148 12676 32928 27097"],["268","6753 10425 22457 30810 19926"],["269","32802 5591 10087 15894 15183"],["270","25050 15625 20651 9307 29768"],["274","21505 3077 21884 12028 34685"],["278","36583 6956 17853 35583 31428"],["281","34595 24547 1076 15743 1873"],["288","15888 14013 16920 18176 15051"],["294","35473 11731 29584 19127 22976"],["296","18741 17644 12594 33215 26744"],["299","30804 20680 20878 15961 1530"],["301","36354 32692 11806 10123 32592"],["308","18200 17383 35626 385 3694"],["310","17794 17321 10944 4527 6741"],["312","5054 8425 14705 23195 3004"],["314","19523 19427 32903 29623 2821"],["318","21403 27460 17862 29950 12393"],["321","29642 29650 26736 27477 21245"],["326","28347 10461 22229 29873 2193"],["327","17301 30261 30008 6641 37066"],["333","16825 5039 6237 35688 20634"],["336","538 14807 13763 1402 23341"],["337","598 11107 34698 10196 14111"],["339","29046 31341 2623 1397 21495"],["344","16001 6442 14538 11487 10903"],["350","29521 36718 8732 30616 4966"],["353","18351 15994 2563 31046 29866"],["355","13963 18755 23843 618 18437"],["359","1017 31129 33757 5253 12242"],["361","7274 32674 35809 35481 3457"],["364","35046 25134 17778 2406 24853"],["365","19322 14227 22579 15678 16107"],["374","15973 33266 20941 9233 2049"],["375","2911 2464 35300 8233 24662"],["376","33215 20583 31202 34358 33048"],["378","17011 17756 18063 27753 10278"],["379","21947 8506 6842 13303 19216"],["380","26585 8476 3077 7704 457"],["383","35626 385 3694 1548 5732"],["385","16314 10480 34421 22007 19999"],["388","31484 8376 21388 24653 3494"],["390","21725 18148 12676 32928 27097"],["393","366 2442 17936 5644 33215"],["399","15973 8216 5494 21818 33266"],["401","15108 11868 26147 28761 23788"],["405","25529 23833 27083 8912 34975"],["412","29885 473 15959 12556 24819"],["413","2041 20955 1076 15743 13726"],["415","21486 18948 21614 13833 32672"],["418","17041 30137 33143 36535 17524"],["431","19426 15221 10334 34762 16803"],["433","11758 25938 11624 14464 30156"],["441","21799 14532 8549 35378 199"],["443","15973 8216 33266 30870 12093"],["445","29046 31341 26621 2623 1397"],["449","33437 33384 8032 17417 20345"],["456","23938 16452 4885 3273 13985"],["458","25967 24664 23831 33333 233"],["459","14197 11927 30722 4092 22400"],["463","27569 5951 14786 11701 27647"],["466","18351 15994 2563 31046 29866"],["477","26983 36552 11868 26147 20941"],["478","28966 28203 14317 22003 33900"],["481","12347 30428 30810 5290 28946"],["487","25936 35158 11989 7592 4357"],["488","26474 17437 16235 4824 14934"],["491","5834 17833 15932 24918 9949"],["494","34084 17851 33758 9740 23184"],["503","5884 28473 27736 35100 29383"],["504","11397 15732 11964 27246 26399"],["508","30244 6320 15939 6884 24589"],["509","18088 34751 10133 9997 20139"],["510","35583 31428 15971 12635 14944"],["511","3272 22776 9294 33562 4357"],["516","5578 17782 33215 20583 31202"],["524","3272 22776 9294 33562 4357"],["527","15743 17648 32019 1448 20083"],["531","4655 30504 10879 20083 21277"],["532","30168 23833 11648 28437 4374"],["541","30059 8724 37124 33276 13668"],["542","14738 11927 30722 4092 22400"],["543","31484 8376 21388 24653 3494"],["549","13257 9333 17604 33509 26350"],["551","23336 16803 34602 16687 33215"],["559","19159 28021 33136 12528 24237"],["565","8085 10108 33536 6606 8005"],["568","19523 19427 29623 2821 9655"],["569","29046 31341 17207 2623 2561"],["572","4475 33215 20583 31202 34358"],["582","23453 30391 20040 2928 11097"],["589","32287 23833 27083 8912 34975"],["590","23336 16803 34602 16687 33215"],["592","3224 21000 28819 30087 24786"],["595","34340 14148 25948 5457 16839"],["599","8134 19014 30851 30677 17925"],["600","3067 34790 12456 1489 25735"],["603","20256 14118 3515 6627 36663"],["605","15973 8216 33266 11927 30722"],["606","31107 32287 14372 30438 17780"],["615","24974 5945 7188 17585 27871"],["616","19887 20398 1316 31450 12558"],["617","36122 9519 30539 16574 3790"],["621","27271 20356 12057 24498 3433"],["632","22224 29199 32304 24663 37046"],["643","31830 17881 29790 35344 7467"],["646","1162 3528 6471 6010 32403"],["651","26462 9922 20937 4215 22509"],["652","4228 25938 21299 24488 12719"],["653","25626 24942 30803 31648 19242"],["654","11459 2255 5025 37104 1812"],["658","13502 32642 11579 25939 7250"],["659","1709 25908 16965 26549 22734"],["663","29046 31341 2623 2561 37065"],["665","11989 33598 7114 26254 4357"],["673","20301 29387 11168 6161 4635"],["675","31341 26621 2623 2561 37065"],["680","7274 32674 35809 35481 3457"],["681","17925 28151 4708 26394 10701"],["684","33475 17383 17011 17756 27753"],["691","19683 5681 9294 1041 36204"],["696","33838 10708 3069 16743 29936"],["700","8810 14118 17445 23580 17597"],["705","22029 3584 15449 24584 25952"],["706","33214 7689 29019 2144 2387"],["710","21446 3841 11111 21765 29577"],["712","1076 17648 37065 32019 1448"],["713","37065 29046 31341 26621 2623"],["715","28877 28605 22103 22340 20972"],["717","33672 21035 6022 32083 22917"],["722","4037 36748 15500 22265 320"],["725","5847 13222 16836 26989 4459"],["729","4648 29186 4357 17396 16278"],["733","21725 30339 5811 18774 21899"],["739","24231 19516 21884 12028 34685"],["741","15743 23949 33475 17383 17648"],["744","16446 17132 14837 35670 27591"],["747","8216 15973 20941 11752 11707"],["750","6263 18970 33215 20583 31202"],["757","3216 1853 17082 13068 25952"],["759","33755 32636 22104 13459 12524"],["761","20495 28199 30019 35626 385"],["773","29905 32690 15111 250 2003"],["777","36230 31316 4393 13105 15284"],["780","24547 14055 28992 19907 25536"],["782","9233 2049 13651 28946 5884"],["784","4282 2053 14148 25948 5457"],["787","29046 31341 26621 2623 37065"],["788","33215 20583 31202 34358 33048"],["789","9902 32287 29847 27258 30503"],["791","4447 14489 16417 8439 7731"],["792","2829 17938 24356 20947 4618"],["796","6623 31924 33660 35046 25134"],["801","33391 20798 31932 31484 8376"],["806","12941 696 24416 1729 17452"],["808","36338 17023 22706 7279 11677"],["810","10859 15241 27302 31061 27343"],["813","32879 5494 21818 17925 18168"],["816","3435 10663 33509 4515 25860"],["820","20020 28585 31341 26621 35915"],["826","7951 10040 37111 18708 24900"],["827","19931 603 20955 9659 30156"],["828","30539 2031 2192 18350 28102"],["831","15534 14800 26566 4373 24700"],["833","21037 1480 22904 36840 22770"],["834","12556 26712 22312 4198 34448"],["835","33143 36535 27752 15656 7133"],["839","13257 1267 15983 36338 35378"],["850","16076 19419 32536 1469 30965"],["852","28966 8099 18434 29061 29824"],["853","10305 17607 17882 28892 18468"],["854","9576 10410 2675 6871 31825"],["857","25626 24942 30803 31648 18351"],["862","29046 26621 31444 12091 2623"],["867","33475 17383 2712 30019 30622"],["869","14013 16920 18176 6151 30168"],["873","8146 36723 25908 16965 26549"],["874","18527 1961 12569 17602 7223"],["879","32793 34011 17502 4240 30215"],["883","36387 26399 22649 6220 31763"],["884","18383 17187 17254 18753 15249"],["886","7274 8759 35809 35481 3457"],["888","1659 13522 36452 13235 14982"],["890","25752 20594 19917 5045 30622"],["899","2854 1544 30170 30417 12170"],["900","15743 26473 17648 2759 17351"],["905","14020 35626 385 3694 1548"],["907","28294 16653 18759 14874 33965"],["908","17893 8562 7716 5585 28634"],["909","35378 199 22970 10366 28224"],["916","3943 10470 21947 6842 19216"],["919","7876 32692 11806 10123 32592"],["926","22465 3426 5373 30033 25406"],["927","1304 21116 7168 24362 19931"],["929","26688 4966 14063 32611 11120"],["937","13494 22461 23910 23015 14345"],["942","25597 4357 17396 16278 34568"],["944","31526 4357 17396 16278 34568"],["946","7250 2882 6365 13403 1483"],["947","25657 14976 22690 348 25084"],["949","15241 27302 31061 27343 9864"],["956","1617 34153 24595 16988 3180"],["958","17702 15771 1051 601 28760"],["961","31924 6623 21164 8424 23144"],["968","3272 22776 9294 33562 4357"],["969","8900 35119 19149 34125 8762"],["972","25752 20594 19917 5045 22953"],["977","10727 35218 26513 1556 20156"],["978","8810 4381 10170 24560 18035"],["979","18200 17383 35626 385 3694"],["982","2522 31484 8376 21388 24653"],["983","21667 29529 21113 21035 3567"],["987","30339 5811 18774 21899 13215"],["990","16421 31542 24362 17064 13027"],["1005","22502 33033 14148 25948 5457"],["1010","3002 20975 20964 11745 11975"],["1011","14105 31341 26621 19523 19427"],["1014","29046 31341 26621 2623 37065"],["1016","19523 19427 29623 2821 9655"],["1017","8415 30280 1338 34275 15829"],["1033","8147 21776 27083 8912 34975"],["1043","19408 9105 33475 33173 15743"],["1044","14001 33761 16494 6997 17452"],["1046","538 14807 13763 1402 23341"],["1055","17207 24547 9420 21884 12028"],["1060","15534 35091 30317 18480 11790"],["1061","14174 28083 2855 21053 23323"],["1067","23116 10954 3362 25936 28602"],["1068","18810 29556 21127 19878 19131"],["1076","1037 34324 16772 32692 11806"],["1077","17782 25050 18798 30516 7937"],["1084","11868 26147 28761 2909 36021"],["1097","26705 3719 12222 36663 29413"],["1102","23453 20040 2928 11097 18407"],["1107","13214 1141 3272 9294 7876"],["1110","31924 7250 2882 6365 13403"],["1112","31506 2176 28817 21561 29282"],["1113","23647 12602 9555 1518 24042"],["1114","32672 21556 26447 18516 31090"],["1117","3826 21216 28876 7241 6185"],["1118","23336 13530 16803 17207 16687"],["1121","9766 25481 23831 582 14357"],["1122","33215 20583 31202 34358 33048"],["1128","11994 24986 21399 4009 30997"],["1135","35355 23799 31439 36501 8840"],["1136","33562 30610 11592 36285 15559"],["1137","13502 7274 32674 17190 7974"],["1144","5283 31285 85 24588 7666"],["1145","22346 2659 28525 32889 34634"],["1146","26024 19523 19427 29623 2821"],["1148","19426 16803 28148 34602 16687"],["1151","12187 32573 3707 32672 19929"],["1152","12866 13502 29046 26621 37065"],["1157","10727 35218 26513 1556 20156"],["1159","30938 31932 10098 15396 27072"],["1161","15845 32914 4557 27667 10663"],["1163","28018 13422 212 30595 34850"],["1165","19127 22976 13502 11707 7274"],["1173","33051 19646 14148 25948 5457"],["1175","23831 35129 22776 13797 30441"],["1177","8001 20673 31484 8376 21388"],["1178","29848 28289 23262 4010 23663"],["1180","5579 26397 17074 30526 21560"],["1181","21412 8394 12873 20777 35626"],["1184","2424 7241 3783 27901 8245"],["1189","18948 21614 13833 18806 32672"],["1190","14404 21998 30059 13235 6951"],["1193","10425 9194 10026 24637 4734"],["1201","25831 12523 13574 30265 15037"],["1204","13903 5494 15674 10727 35218"],["1205","21459 1677 10755 16782 6476"],["1218","35300 20495 6612 35626 385"],["1222","27083 8912 34975 15634 24762"],["1224","15207 11237 14465 5220 25301"],["1229","14762 21910 32827 27559 26325"],["1233","6516 6024 32867 4950 16504"],["1235","17982 31609 14148 25948 5457"],["1236","12102 11758 23949 19718 1619"],["1238","22399 34610 20215 32509 8846"],["1240","3958 14111 19543 213 16766"],["1249","5227 4357 17396 16278 34568"],["1256","28771 21322 3783 27901 8245"],["1263","10160 17585 11582 18349 22482"],["1264","30360 27761 1460 37056 15719"],["1279","10149 7406 23213 963 27530"],["1280","19873 4531 3149 8628 18553"],["1282","1267 30825 11582 2150 22294"],["1289","19683 17821 36599 5681 34642"],["1291","25636 20825 30417 12170 24343"],["1292","34862 18810 29556 21127 19878"],["1297","10016 30354 6960 9630 15732"],["1298","30008 6641 37066 14056 6820"],["1314","4064 10446 11708 24626 22796"],["1316","5866 21796 4739 24070 11531"],["1322","2125 32789 26164 22054 2149"],["1327","17925 23282 26394 10701 5166"],["1333","24089 4480 32888 2617 18552"],["1334","29046 31341 26621 37065 21495"],["1335","9730 22570 32287 25529 29389"],["1336","26462 9922 4357 17396 16278"],["1343","1677 10755 16782 26459 36468"],["1345","35065 23951 30417 12170 24343"],["1346","12102 8394 12873 20777 35626"],["1348","11707 88 23775 15973 33266"],["1356","17023 22706 23100 33148 13683"],["1361","28982 6328 12122 26547 26741"],["1365","12535 20532 35919 11133 4223"],["1373","9237 17193 30839 23580 17597"],["1378","5331 23938 16452 4885 3273"],["1379","19523 19427 29623 2821 9655"],["1387","32591 23188 36248 25887 36843"],["1391","2522 31484 8376 21388 14148"],["1405","3789 21719 31954 18558 21276"],["1406","14020 35626 385 3694 1548"],["1408","5494 21818 29673 4731 6111"],["1416","12748 33213 24309 30300 17149"],["1417","13530 21151 17259 26045 11043"],["1418","3259 18351 15994 2563 31046"],["1420","17782 7250 2882 6365 13403"],["1423","30141 15585 4574 29109 27777"],["1426","25952 14899 13502 10059 29229"],["1428","31285 85 24588 7666 30114"],["1431","35327 25512 32572 9833 33708"],["1433","6872 15241 8548 27302 31061"],["1436","10149 4527 34638 24805 37036"],["1438","14020 2924 27477 11529 5352"],["1444","25136 15593 5211 18704 18057"],["1445","21840 7933 35789 709 19664"],["1447","34129 35577 24002 4195 34900"],["1452","30539 19077 16574 17554 2192"],["1453","35095 8001 5905 26024 15687"],["1463","36663 35345 2822 20547 23190"],["1470","32353 18351 15994 34739 5846"],["1473","7595 10007 16168 19853 24477"],["1474","663 10803 22609 36714 26212"],["1476","23951 30417 12170 24343 30493"],["1481","29046 18063 2623 2561 37065"],["1484","19523 19427 29623 2821 9655"],["1486","17925 23282 26394 5166 758"],["1487","29046 31341 26621 2623 1397"],["1493","34790 9381 20301 29317 31796"],["1501","3736 21825 8173 21949 14148"],["1502","5598 8049 35146 14185 30238"],["1503","21412 12102 35626 385 3694"],["1506","31995 3460 1294 5839 2479"],["1508","1076 15743 32019 1448 24974"],["1509","4475 29673 22727 31992 35300"],["1510","4475 10573 7876 26529 14105"],["1511","20256 14118 3515 6627 36663"],["1516","34439 4099 36714 18285 12947"],["1527","22029 15449 24584 25952 13094"],["1528","31484 8376 21388 24653 3494"],["1538","6010 32403 6795 2455 12591"],["1547","31616 28867 14212 7188 15405"],["1551","21406 27011 20611 33915 20859"],["1555","13284 1617 31830 17881 6473"],["1560","21443 1646 21430 32453 28333"],["1564","33475 17383 15769 4249 7913"],["1572","26622 27952 26761 31750 12764"],["1576","29355 31556 26605 16414 7250"],["1577","988 16168 23703 16167 31026"],["1578","25967 24664 23831 33333 233"],["1587","25939 14988 21412 12102 21910"],["1588","15983 10461 22229 29873 2193"],["1606","17756 2675 88 17011 18063"],["1607","17925 28151 4708 26394 10701"],["1617","35401 5658 13508 4648 2146"],["1620","35355 23799 31439 36501 8840"],["1624","13502 32642 11579 25939 7250"],["1626","19887 20398 1316 31450 12558"],["1627","3587 33993 4357 17396 16278"],["1635","17782 17644 12594 33215 26744"],["1636","9725 30334 28731 33715 34202"],["1637","14148 25948 5457 16839 31899"],["1638","31057 9420 34858 21884 12028"],["1641","21025 29544 9939 18337 2061"],["1642","27271 37124 12186 12946 30168"],["1643","16394 4966 14063 32011 964"],["1644","26399 22649 6220 31763 14420"],["1645","38 22865 6775 9754 21626"],["1647","18088 34751 10133 9997 20139"],["1648","19523 19427 23706 29623 14319"],["1649","11745 11975 36076 5086 5526"],["1657","24825 27124 29950 12393 26128"],["1658","8109 15674 10727 35218 26513"],["1661","15616 36513 34901 5521 36978"],["1663","27995 5592 27000 867 22348"],["1664","31616 6263 14762 33215 35378"],["1667","10098 18108 31788 11858 7250"],["1670","15108 23788 20955 13726 16451"],["1675","17207 24547 32793 9420 4238"],["1681","3736 21825 14148 25948 5457"],["1684","6010 32403 6795 2455 12591"],["1685","18351 15994 2563 31046 29866"],["1686","19523 19427 29623 2821 9655"],["1693","2167 31885 10677 12582 28092"],["1696","15743 17648 32019 1448 36533"],["1699","2041 20955 13726 16451 27635"],["1707","35486 7876 13886 6343 9302"],["1713","1267 30825 1103 35503 8271"],["1719","6893 24259 27360 29392 11395"],["1723","12587 31512 9125 14029 18720"],["1726","16814 30806 33693 29905 21746"],["1727","26984 23143 29950 12393 26128"],["1728","19426 16803 34602 16687 33439"],["1734","29046 26621 2623 2561 37065"],["1739","36716 9827 8993 19605 17659"],["1740","17193 20877 31484 8376 21388"],["1750","25444 35626 385 3694 1548"],["1756","32591 23188 36248 16803 23336"],["1757","20609 10243 34440 21546 32488"],["1760","35378 199 22970 10366 28224"],["1761","21425 8928 22469 6563 26260"],["1764","23239 14912 34176 27486 9290"],["1765","23784 4357 17396 16278 34568"],["1766","10261 31676 30379 24676 26485"],["1767","11745 11975 36076 5086 5526"],["1768","26401 3017 15616 36513 34901"],["1773","35378 199 22970 10366 28224"],["1782","233 176 27698 4410 13401"],["1785","7716 34572 9485 30040 20080"],["1786","28294 16653 18759 14874 33965"],["1787","24547 19907 10059 33215 31484"],["1788","26473 2759 17351 25752 20594"],["1789","21412 12102 33815 20947 2984"],["1792","34084 17851 33758 9740 23184"],["1796","4620 24130 34102 15066 35854"],["1800","16004 8510 31484 8376 21388"],["1803","7566 35904 36181 7010 4357"],["1804","8900 22140 26407 29613 10727"],["1805","18603 12530 27242 30008 29408"],["1806","12642 33215 20583 31202 34358"],["1807","10452 2134 21195 21399 4009"],["1808","14119 12295 33754 25421 10423"],["1812","36487 33153 93 4352 3996"],["1813","16825 8133 26405 15797 30539"],["1816","33912 16451 19718 2041 23949"],["1818","11745 11975 36076 5086 5526"],["1820","14372 15721 12284 729 17911"],["1823","35300 20495 6612 35626 385"],["1827","1076 17648 32019 1448 31444"],["1829","27083 8912 34975 13500 33406"],["1833","16599 16049 25564 17633 33142"],["1845","9512 18866 34234 10703 31301"],["1857","8962 2911 2464 8233 10454"],["1858","10685 7464 18393 29544 9939"],["1862","12654 9982 873 15732 25908"],["1866","4238 22028 20917 13844 2653"],["1874","17067 33421 16554 26943 5509"],["1875","7971 22092 17674 30880 10456"],["1876","23580 36663 14777 7657 30059"],["1879","18301 35943 34000 15415 11984"],["1881","1677 10755 16782 26459 18269"],["1883","5579 26397 17074 32678 34411"],["1885","11408 29730 31285 85 24588"],["1888","29800 31887 366 21081 16307"],["1898","18088 34751 10133 9997 20139"],["1899","16087 20774 35832 559 18970"],["1900","33424 18170 4966 14063 32611"],["1901","36850 31020 7053 21027 6081"],["1906","30400 102 16414 35503 4788"],["1910","27047 29544 9939 18337 15198"],["1911","27635 36559 11286 1927 24466"],["1918","36552 30839 23580 17597 12222"],["1919","30839 23580 17597 12222 36663"],["1920","8877 26407 16511 14738 3242"],["1933","11592 21299 7961 4735 32287"],["1935","3993 17198 9239 1181 30674"],["1936","15224 20299 11459 2255 5025"],["1938","32019 1076 15743 17648 20083"],["1940","35513 16891 18351 15994 2563"],["1941","3392 4410 17585 1619 16929"],["1943","2068 31136 32447 8496 18016"],["1944","18597 16834 35046 25134 17778"],["1945","5864 15192 30366 4221 14264"],["1947","2640 2148 32001 36043 36261"],["1948","23336 21910 16803 14762 32827"],["1950","36811 21884 12028 34685 24019"],["1952","9233 2049 13651 28946 5884"],["1954","8146 32591 36248 14734 30340"],["1955","2167 31885 27744 10677 28092"],["1956","7657 22803 26462 9922 27036"],["1957","32972 8555 29950 12393 26128"],["1963","15973 25454 8216 10482 11481"],["1964","22787 19642 9271 23107 35036"],["1976","1375 28763 3922 35426 33812"],["1977","10915 15441 24300 22182 5734"],["1978","13594 6666 4037 36748 16333"],["1981","15634 1060 32202 15241 27302"],["1985","15447 36354 10356 30674 32692"],["1986","876 17645 29229 31484 8376"],["1991","9233 2049 2588 33558 13651"],["1993","16659 266 22552 13502 32642"],["1999","5734 4709 32619 14148 25948"],["2007","21412 12102 35626 385 3694"],["2009","35158 21884 12028 34685 24019"],["2011","17781 16345 33298 13502 17287"],["2013","4966 14063 22787 19642 9271"],["2017","25626 24942 30803 31648 14148"],["2020","28572 28124 27173 10296 7967"],["2027","22202 19709 22938 5420 34271"],["2028","23501 14246 36156 13280 27146"],["2037","8488 31646 12570 14105 5494"],["2040","23664 23370 4887 37070 10727"],["2041","28966 35503 4788 16047 4410"],["2042","19676 35046 25134 17778 2406"],["2045","28867 2712 23581 30019 29690"],["2051","12866 35300 2464 8233 24662"],["2052","3736 21825 14148 25948 5457"],["2053","19426 16803 10769 34602 16687"],["2054","21830 7199 2031 20965 25398"],["2058","9233 2049 13651 28946 5884"],["2060","13886 15188 28539 5588 34599"],["2061","18866 34234 10703 31301 34878"],["2066","15743 24547 17648 17463 282"],["2072","12362 35738 2030 27726 13228"],["2073","11989 33598 7114 26254 4357"],["2080","30230 1677 10755 16782 26459"],["2081","31223 30672 8295 33562 19798"],["2084","32674 8759 10625 34799 17086"],["2086","22435 25227 29912 33253 4583"],["2090","1677 10755 16782 26459 7439"],["2091","23336 11707 28750 16803 34602"],["2095","23837 30672 13028 17193 33780"],["2097","29966 24705 1455 1967 22680"],["2106","28294 16653 18759 14874 33965"],["2108","8846 4244 35739 25005 34610"],["2117","14738 33628 4554 1460 37056"],["2119","25512 32572 9833 17000 9604"],["2121","12362 35738 10469 2030 27726"],["2124","104 35486 17445 3515 19544"],["2129","11982 6286 16020 10532 33333"],["2130","21505 3077 21884 12028 34685"],["2132","26468 4120 367 15607 10606"],["2133","29046 26621 2623 2561 37065"],["2135","20413 19683 4995 16864 33826"],["2136","25627 31285 85 24588 7666"],["2137","14634 15687 30008 6641 37066"],["2146","30104 22693 185 32692 11806"],["2147","31644 30339 5811 18774 21899"],["2149","26399 22649 6220 31763 14420"],["2155","3584 9607 17893 20256 14118"],["2156","10942 34246 20917 5396 23952"],["2157","5227 4357 17396 16278 34568"],["2164","29413 7167 34691 2783 7325"],["2167","20917 13844 2653 12175 9590"],["2168","5905 31484 8376 21388 24653"],["2179","31433 21590 17664 8336 19111"],["2182","8146 6249 19739 27679 8724"],["2186","4922 3456 14839 15291 3818"],["2195","30417 12170 24343 30493 16758"],["2202","3224 21000 22482 16746 10955"],["2212","23545 11629 24155 3272 4269"],["2227","21635 30339 5811 18774 21899"],["2236","10217 12222 6010 32403 6795"],["2244","9730 17866 27719 22888 7943"],["2247","13651 33173 2049 4288 2468"],["2248","13425 28866 23047 2545 162"],["2254","29544 9939 18337 15198 3376"],["2257","9233 2049 21399 4009 30997"],["2261","9833 22443 5655 30455 36223"],["2263","25939 14988 13530 14209 20953"],["2265","30267 28150 9556 27971 4475"],["2268","7876 21561 32692 11806 10123"],["2270","8724 30053 33605 33477 25527"],["2272","29364 31700 35885 8336 35378"],["2273","7838 33260 33597 34771 24663"],["2274","15165 21177 5557 2719 16005"],["2280","23137 30360 5861 14738 37056"],["2285","30417 12170 24343 30493 16758"],["2287","31484 8376 21388 2822 24653"],["2290","16820 15616 36513 34901 5521"],["2298","15241 27302 31177 31061 9864"],["2305","25444 25908 16965 26549 22734"],["2306","30156 15509 25379 26601 15618"],["2312","13315 6002 16201 11514 10727"],["2313","1076 15743 32019 1448 8394"],["2319","4102 28415 28152 7415 4896"],["2320","14174 28083 3392 25253 34662"],["2324","33214 7689 29019 2144 2387"],["2326","21561 13709 11397 15732 11964"],["2330","30417 12170 24343 30493 16758"],["2338","8146 36723 5225 35626 385"],["2341","16710 27952 26761 25456 22378"],["2345","3609 16684 11904 2869 8723"],["2346","12587 16825 31512 2754 26224"],["2347","4064 11264 35579 24626 23267"],["2351","26658 22806 18768 17771 15352"],["2352","23336 16803 34602 16687 33215"],["2357","14372 3681 31831 6 9329"],["2360","8810 26509 4381 10170 24560"],["2361","15973 18200 33266 23951 9290"],["2366","35300 12851 20495 6612 35626"],["2368","10924 6606 8005 3904 17705"],["2369","15769 4249 7913 33827 7144"],["2374","16451 2041 23949 19001 1306"],["2379","18740 5669 4605 7069 26668"],["2388","7480 25830 25844 7272 25136"],["2394","7168 31848 25599 27020 11028"],["2397","35401 29544 9939 18337 15198"],["2398","9233 2049 9930 23949 13651"],["2399","10573 8216 26529 36533 26191"],["2403","19242 24471 33761 14148 25948"],["2404","10461 827 21804 7124 24167"],["2407","7343 6988 15814 16903 18348"],["2409","36162 17524 11570 25920 22976"],["2410","6334 31924 23281 29461 9690"],["2414","29612 3497 7520 17293 19573"],["2421","17149 23595 16364 7003 516"],["2426","21412 17893 598 27083 8912"],["2428","18897 17067 10376 33421 16554"],["2435","20959 26529 31135 7250 2882"],["2442","3584 11989 7592 696 24416"],["2448","10147 14526 17058 17735 21987"],["2449","25458 30494 11417 34171 2295"],["2452","16421 17064 14351 1304 35100"],["2455","12594 33215 26744 37072 19865"],["2466","28513 29805 27941 29261 21187"],["2467","5612 3551 14234 11459 2255"],["2472","30417 12170 24343 30493 16758"],["2474","30141 15585 4574 35649 15183"],["2480","5578 33215 20583 31202 34358"],["2489","9978 6024 3783 5841 758"],["2496","33838 10708 3069 16743 29936"],["2500","12222 36663 20084 19529 27885"],["2502","12261 34089 35068 31178 14148"],["2504","28018 13422 212 30595 34850"],["2506","26529 6210 12281 13061 7622"],["2508","15534 35091 30317 18480 11790"],["2512","10466 24143 31360 14174 14920"],["2519","19862 26164 2578 18547 27635"],["2520","25920 23281 29461 9690 2068"],["2521","20477 29308 2270 31526 31141"],["2524","20737 25939 26529 6210 13502"],["2528","5571 30602 35046 25134 17778"],["2543","25978 23468 31952 7520 17293"],["2547","24547 19907 7107 10059 18351"],["2549","29642 18104 9290 36839 10727"],["2551","8398 27083 8912 34975 13500"],["2557","35775 25631 21286 23338 35903"],["2560","34982 10067 25988 18351 15994"],["2561","29355 18200 17383 31556 26605"],["2564","10645 35972 15616 36513 34901"],["2569","25389 4685 7250 2882 6365"],["2570","25576 29104 11487 10903 36530"],["2571","3570 26271 17190 3656 23215"],["2581","19683 5681 9294 1041 36204"],["2582","29046 31341 26621 2623 1397"],["2585","31810 21163 29184 20261 5187"],["2591","840 17893 24294 30087 24786"],["2595","28817 28658 24883 938 27952"],["2597","4357 17396 16278 34568 13017"],["2599","8496 6446 8578 562 17555"],["2602","25298 26616 9299 3672 24795"],["2603","8146 23949 20955 13726 16451"],["2604","29047 531 8743 30781 18660"],["2610","24471 36037 17198 11042 3993"],["2617","22210 643 16940 18810 29556"],["2621","14464 4410 5951 1141 30257"],["2623","19895 4201 5803 29030 24932"],["2624","33498 2842 32658 35523 35793"],["2629","30910 20917 13844 2653 12175"],["2631","35953 31086 12558 6265 7737"],["2633","8509 24768 30197 33381 29592"],["2638","233 3450 18732 34286 27265"],["2644","24178 22169 24325 20122 20108"],["2645","14647 3800 15615 13264 24663"],["2647","4120 367 15607 10606 13041"],["2648","3242 15489 31037 26147 28761"],["2651","36655 13060 22684 27471 16835"],["2654","9233 9928 33173 25421 1518"],["2655","31106 29782 868 96 20957"],["2658","18306 15127 18351 15994 2563"],["2661","34439 4099 18759 14874 33965"],["2662","23647 31031 4 16826 24042"],["2667","30293 6068 13290 10822 15917"],["2674","10117 18615 26535 25050 35492"],["2675","2068 31136 32447 8496 18016"],["2680","6494 14800 33555 26566 24902"],["2686","14634 15687 30008 6641 37066"],["2690","15207 11237 25050 14465 5220"],["2696","32019 5578 29046 31341 26621"],["2697","23336 16803 34602 16687 33215"],["2699","13020 16659 35473 11731 29584"],["2701","23336 8216 15973 20941 16803"],["2709","11927 30722 4092 22400 13496"],["2712","29790 35344 7467 32105 36187"],["2713","28028 26713 36992 32400 12270"],["2716","16076 19419 1469 3783 27901"],["2718","17420 30977 32565 13989 10098"],["2721","25050 15625 20651 9307 29768"],["2728","12261 34089 10016 35068 31178"],["2729","15236 5866 21796 4739 24070"],["2734","30738 19567 6884 15970 11009"],["2737","15188 28539 5588 34599 13423"],["2743","9059 32914 15845 6589 23083"],["2751","34595 7086 35626 385 3694"],["2762","29046 31341 26621 37065 21495"],["2764","12362 35738 2030 27726 4855"],["2772","12102 2754 35486 9239 11042"],["2775","1267 28246 2836 15749 18318"],["2776","29046 31341 2623 2561 37065"],["2782","11989 33598 7114 26254 4357"],["2784","7247 35011 32680 8211 758"],["2785","1873 16367 5951 25904 30257"],["2795","27753 17011 13220 18063 10278"],["2800","3216 37132 17082 21884 12028"],["2801","29046 26621 4475 2623 2561"],["2808","21412 12102 32287 23833 27083"],["2812","27938 7332 14740 36372 34940"],["2813","16451 9233 2041 23949 5494"],["2816","30655 26491 6155 6299 9186"],["2823","32674 8759 22104 18116 29046"],["2829","15593 2320 33340 33993 17239"],["2830","876 17645 31484 8376 21388"],["2832","36382 15645 23938 16452 4885"],["2835","4238 22028 20917 13844 2653"],["2837","30884 23836 36957 24471 14148"],["2839","29364 31830 31700 35885 17881"],["2843","19127 22976 34826 19565 23109"],["2845","17471 24223 10727 35218 26513"],["2850","12362 35738 3272 22776 9294"],["2860","25696 19831 1902 21257 17866"],["2862","7480 25830 23721 7876 25844"],["2865","28866 34172 30205 13425 27192"],["2867","32692 11806 10123 32592 37096"],["2869","23775 36063 21858 24978 27039"],["2875","34565 12350 19523 19427 25063"],["2877","35052 17160 36315 8847 26375"],["2880","13502 19156 32642 11579 24971"],["2883","35046 25134 17778 2406 25752"],["2884","5905 31484 8376 21388 24653"],["2886","7232 17991 30558 30130 18160"],["2888","16503 26046 11131 4966 14063"],["2895","32710 14564 11018 9202 4034"],["2903","25939 32019 35065 14988 12851"],["2904","26005 28200 9802 10286 32219"],["2908","31924 24783 6623 18069 27257"],["2909","2712 30622 1518 31887 2049"],["2914","23910 818 17352 4966 14063"],["2917","19800 35588 16449 11578 15238"],["2921","4037 36748 22265 320 6862"],["2926","19144 20719 5482 3282 18650"],["2933","13284 6473 10562 24143 31360"],["2935","11487 10903 36530 17570 10460"],["2951","15743 33475 17383 17648 32019"],["2957","13538 15291 31216 32265 11258"],["2964","963 2496 19391 20859 20356"],["2967","14634 15687 30008 6641 37066"],["2968","5884 25752 20594 19917 5045"],["2978","24354 5321 32077 33120 36674"],["2985","4455 9283 36833 31163 4894"],["2990","21053 23323 29555 23731 2879"],["2993","24376 27477 20699 19240 21851"],["2996","4154 13939 13011 18351 15994"],["2997","35533 23594 31285 85 24588"],["2998","30839 23580 17597 12222 36663"],["3001","11927 30722 4092 22400 13496"],["3003","27477 33215 20583 31202 34358"],["3014","32536 30965 30098 19884 16667"],["3017","33391 17095 15593 29046 31341"],["3019","15016 3764 5861 31285 85"],["3020","8146 18200 18873 29642 26983"],["3023","15743 17648 32019 1448 20083"],["3028","21486 18948 21614 13833 32672"],["3032","20596 21053 23323 29555 23731"],["3041","21746 31260 15111 250 13751"],["3043","17782 3180 164 2716 5247"],["3050","32341 19242 14001 11867 15791"],["3056","23833 7178 26432 9682 24372"],["3057","1680 17069 12429 14061 4284"],["3059","35583 31428 15971 12635 14944"],["3064","36162 17524 11570 36502 20396"],["3065","18411 17979 14891 2786 27554"],["3066","33561 4348 19839 20837 16544"],["3069","7967 25424 15361 15289 17044"],["3071","8001 20673 31484 8376 21388"],["3072","18718 27544 1885 11677 7428"],["3073","1518 31887 2049 8762 23451"],["3074","1076 15743 32019 1448 8394"],["3077","28127 28289 35804 27530 34509"],["3082","29413 7167 34691 2783 7325"],["3091","34414 24220 8173 717 11059"],["3093","4475 33215 20583 31202 34358"],["3095","10723 13861 13929 27163 20049"],["3098","15452 2068 10067 25988 36047"],["3101","9933 8784 17475 9893 18617"],["3104","15973 8216 33266 11752 11707"],["3105","2522 31484 8376 21388 24653"],["3106","21053 23323 29555 23731 2879"],["3107","3007 14055 27356 19880 4405"],["3108","17866 27719 22888 7943 26312"],["3113","19297 31258 1824 24525 8848"],["3118","8877 35065 29732 31686 6476"],["3123","12261 11868 31037 28761 14464"],["3127","15534 11868 26147 28761 12261"],["3133","31484 8376 21388 24653 3494"],["3137","31484 8376 21388 24653 3494"],["3157","6606 8005 3904 15953 29028"],["3163","7584 27790 36319 20255 4386"],["3165","5884 28473 27736 35100 29383"],["3166","20495 21561 13709 28199 30019"],["3167","6092 31055 11341 30804 20680"],["3168","15973 33266 20941 21406 33915"],["3173","35513 16891 18351 15994 2563"],["3180","36846 20132 36755 26315 31621"],["3188","9535 36109 14372 18383 13068"],["3189","418 37074 14988 31713 32642"],["3190","2236 13752 35626 385 3694"],["3191","4547 30739 12896 2509 29950"],["3192","19523 19427 29623 2821 9655"],["3195","21412 12102 35626 385 3694"],["3198","35473 7876 11731 34790 29584"],["3201","25952 2786 27554 24126 25473"],["3202","26582 6606 8005 3904 17705"],["3203","30339 5811 18774 21899 13215"],["3206","9233 9928 33173 30428 2911"],["3212","33214 7689 29019 2144 2387"],["3214","3392 25253 34662 4357 17396"],["3216","11745 11975 36076 5086 5526"],["3218","15743 7230 11758 17648 17529"],["3221","27352 33215 20583 31202 34358"],["3227","8216 15973 20941 21037 11752"],["3229","18924 8749 14148 25948 5457"],["3240","19719 3775 538 14807 13763"],["3243","15917 35626 385 3694 1548"],["3244","29544 9939 18337 15198 3376"],["3248","1076 15743 32019 1448 23501"],["3249","15930 23967 12941 3669 32591"],["3250","34509 26462 9922 20937 4215"],["3253","7716 34572 9485 30040 20080"],["3256","32672 19929 21556 26447 18516"],["3260","8647 20301 1067 11168 3964"],["3265","8565 25908 16965 26549 22734"],["3273","24763 1478 14383 4964 22654"],["3279","30360 27761 1460 37056 15719"],["3281","603 17198 11042 3993 6938"],["3287","10160 35458 8134 15803 282"],["3294","29824 12091 12841 32791 27003"],["3296","33407 32988 25209 14336 32829"],["3298","19523 19427 29623 2821 9655"],["3302","31203 3006 27170 21036 32672"],["3304","20828 19112 6038 23938 16452"],["3309","21505 3077 21884 12028 34685"],["3319","4038 17676 29239 21446 3841"],["3320","27080 14148 25948 5457 16839"],["3324","34136 14013 16920 18176 15051"],["3325","15263 33443 17658 6707 20554"],["3326","9233 2049 13651 28946 5884"],["3328","603 29642 30960 25908 16965"],["3330","17207 29046 31341 19907 19242"],["3332","17925 2597 34574 23282 32722"],["3336","6494 14800 33555 26566 24902"],["3350","17756 17011 10016 32827 4833"],["3351","34924 24760 14793 10672 17131"],["3354","31616 14777 23581 34602 876"],["3358","5619 15183 29777 9854 25663"],["3360","876 17645 19683 5681 31484"],["3361","18301 21082 5290 36063 21858"],["3364","23081 10410 33475 17383 2675"],["3374","21036 3006 32362 32672 19929"],["3376","35626 385 3694 1548 5732"],["3378","15884 13103 20369 11190 33904"],["3379","17207 19907 10059 33215 20583"],["3387","36907 15207 11237 14465 5220"],["3392","19242 14001 14148 25948 5457"],["3396","3272 22776 9294 33562 4357"],["3402","20083 33387 35399 35626 385"],["3407","33475 17383 2712 30019 30622"],["3411","21299 24488 12719 2041 8590"],["3413","8877 26407 36811 6769 30071"],["3418","14533 23788 17021 21561 13709"],["3421","10542 24519 1447 8752 7614"],["3422","29219 17782 26529 10573 7086"],["3424","11927 30722 4092 22400 13496"],["3434","10059 21081 33215 9963 20583"],["3435","30764 31646 11125 26064 13211"],["3438","2675 23081 9576 10410 31825"],["3439","258 32692 11806 10123 32592"],["3452","11579 876 17645 13701 31924"],["3455","21412 8216 11579 8394 8567"],["3459","30267 28150 9556 27971 16601"],["3461","17463 4381 31484 8376 21388"],["3464","30091 17982 34725 26224 3707"],["3468","25936 35158 9588 35805 20255"],["3469","31961 25833 10319 33998 37056"],["3474","1448 1076 15743 17648 21037"],["3475","18351 15994 2563 31046 29866"],["3482","27477 29650 2924 11529 32692"],["3487","35046 25134 17778 2406 26754"],["3488","15814 17735 5961 5933 23455"],["3492","29570 9121 29790 35344 7467"],["3496","5474 26889 23784 4162 26014"],["3505","2167 31885 27744 10677 28092"],["3511","2590 33118 20867 35071 9987"],["3513","16004 31484 8376 21388 24653"],["3518","23949 20955 1518 13726 16451"],["3523","15072 23388 8198 18435 28018"],["3525","30168 11648 28437 4374 28280"],["3528","2041 23949 35454 23081 9576"],["3532","9523 13502 32642 11579 25939"],["3540","26468 4120 367 15607 10606"],["3543","23949 33475 17383 20955 28966"],["3548","14583 12963 14591 8488 4911"],["3550","25529 36235 27083 8912 34975"],["3552","22147 27828 8634 28396 27727"],["3558","29420 15243 6041 34158 27606"],["3560","4228 11758 16871 36889 14151"],["3561","20941 8216 18741 5578 33266"],["3563","13594 6666 8612 35692 31209"],["3564","25389 12587 31512 21406 32141"],["3565","16333 30964 13214 32619 6086"],["3572","25925 17512 6017 19705 26713"],["3581","35626 385 3694 1548 5732"],["3582","1677 10755 16782 26459 18269"],["3583","21802 29847 27258 30503 35440"],["3587","17149 23595 16364 7003 516"],["3591","27052 19811 6461 14148 25948"],["3592","12530 29408 19977 31311 31145"],["3596","23738 11531 3437 9853 32097"],["3602","35486 24471 18240 36037 25631"],["3604","9164 2442 21081 19452 5644"]],"arguments":{},"addedWidgets":{},"removedWidgets":[],"schema":[{"name":"userId","type":"\"string\"","metadata":"{}"},{"name":"RecommendedItemIds","type":"\"string\"","metadata":"{}"}],"overflow":true,"aggData":[],"aggSchema":[],"aggOverflow":false,"aggSeriesLimitReached":false,"aggError":"","aggType":"","plotOptions":null,"isJsonSchema":true,"dbfsResultPath":"dbfs:/databricks-results/3180229192564037/","datasetInfos":[],"columnCustomDisplayInfos":{}},"errorSummary":"Command skipped","error":null,"workflows":[],"startTime":1499034226109,"submitTime":1499034226092,"finishTime":1499034227632,"collapsed":false,"bindings":{},"inputWidgets":{},"displayType":"table","width":"auto","height":"auto","xColumns":null,"yColumns":null,"pivotColumns":null,"pivotAggregation":null,"customPlotOptions":{},"commentThread":[],"commentsVisible":false,"parentHierarchy":[],"diffInserts":[],"diffDeletes":[],"globalVars":{},"latestUser":"amarildolikmeta@gmail.com","latestUserId":null,"commandTitle":"","showCommandTitle":false,"hideCommandCode":false,"hideCommandResult":false,"iPythonMetadata":null,"streamStates":{},"datasetPreviewNameToCmdIdMap":{},"nuid":"c2d29743-6308-4a5a-af6c-e7f7533534ad"},{"version":"CommandV1","origId":3180229192564038,"guid":"eaf29993-4178-493a-8d47-dc6b5f06acaa","subtype":"command","commandType":"auto","position":32.0,"command":"","commandVersion":0,"state":"finished","results":null,"errorSummary":null,"error":null,"workflows":[],"startTime":0,"submitTime":0,"finishTime":0,"collapsed":false,"bindings":{},"inputWidgets":{},"displayType":"table","width":"auto","height":"auto","xColumns":null,"yColumns":null,"pivotColumns":null,"pivotAggregation":null,"customPlotOptions":{},"commentThread":[],"commentsVisible":false,"parentHierarchy":[],"diffInserts":[],"diffDeletes":[],"globalVars":{},"latestUser":"","latestUserId":null,"commandTitle":"","showCommandTitle":false,"hideCommandCode":false,"hideCommandResult":false,"iPythonMetadata":null,"streamStates":{},"datasetPreviewNameToCmdIdMap":{},"nuid":"ddd7a6ba-df8d-4d4f-9d47-28302c576c67"},{"version":"CommandV1","origId":3523344454446630,"guid":"0fd21016-8f24-44fc-a474-091683ddd901","subtype":"command","commandType":"auto","position":4.5,"command":"userSeenItems_dict[\"45\"]","commandVersion":0,"state":"finished","results":{"type":"html","data":"<div class=\"ansiout\"><span class=\"ansired\">Out[</span><span class=\"ansired\">7</span><span class=\"ansired\">]: </span>[u&apos;10134&apos;, u&apos;10427&apos;, u&apos;15895&apos;, u&apos;26340&apos;]\n</div>","arguments":{},"addedWidgets":{},"removedWidgets":[],"datasetInfos":[]},"errorSummary":null,"error":null,"workflows":[],"startTime":1499021321515,"submitTime":1499021283866,"finishTime":1499021321541,"collapsed":false,"bindings":{},"inputWidgets":{},"displayType":"table","width":"auto","height":"auto","xColumns":null,"yColumns":null,"pivotColumns":null,"pivotAggregation":null,"customPlotOptions":{},"commentThread":[],"commentsVisible":false,"parentHierarchy":[],"diffInserts":[],"diffDeletes":[],"globalVars":{},"latestUser":"amarildolikmeta@gmail.com","latestUserId":null,"commandTitle":"","showCommandTitle":false,"hideCommandCode":false,"hideCommandResult":false,"iPythonMetadata":null,"streamStates":{},"datasetPreviewNameToCmdIdMap":{},"nuid":"9b322bf8-3b55-4a29-b70e-b95930c3c816"},{"version":"CommandV1","origId":3523344454446634,"guid":"566b04b4-9205-475c-9bd8-fc1ba52c6f9d","subtype":"command","commandType":"auto","position":7.25,"command":"userRatings.take(5)","commandVersion":0,"state":"finished","results":{"type":"html","data":"<div class=\"ansiout\"><span class=\"ansired\">Out[</span><span class=\"ansired\">16</span><span class=\"ansired\">]: </span>\n[(u&apos;13357&apos;,\n  [(u&apos;8064&apos;, 7), (u&apos;11253&apos;, 9), (u&apos;11254&apos;, 6), (u&apos;25667&apos;, 7), (u&apos;34643&apos;, 5)]),\n (u&apos;4447&apos;, [(u&apos;3788&apos;, 7), (u&apos;6014&apos;, 7)]),\n (u&apos;11542&apos;, [(u&apos;418&apos;, 10), (u&apos;11021&apos;, 8), (u&apos;31910&apos;, 4), (u&apos;36163&apos;, 10)]),\n (u&apos;11543&apos;,\n  [(u&apos;9308&apos;, 10), (u&apos;21655&apos;, 4), (u&apos;23124&apos;, 7), (u&apos;23978&apos;, 7), (u&apos;35095&apos;, 5)]),\n (u&apos;11540&apos;,\n  [(u&apos;10696&apos;, 10),\n   (u&apos;12876&apos;, 10),\n   (u&apos;13752&apos;, 6),\n   (u&apos;21328&apos;, 5),\n   (u&apos;29005&apos;, 9)])]\n</div>","arguments":{},"addedWidgets":{},"removedWidgets":[],"datasetInfos":[]},"errorSummary":"<span class=\"ansired\">TypeError</span>: &apos;PipelinedRDD&apos; object has no attribute &apos;__getitem__&apos;","error":null,"workflows":[],"startTime":1499021331200,"submitTime":1499021283914,"finishTime":1499021334520,"collapsed":false,"bindings":{},"inputWidgets":{},"displayType":"table","width":"auto","height":"auto","xColumns":null,"yColumns":null,"pivotColumns":null,"pivotAggregation":null,"customPlotOptions":{},"commentThread":[],"commentsVisible":false,"parentHierarchy":[],"diffInserts":[],"diffDeletes":[],"globalVars":{},"latestUser":"amarildolikmeta@gmail.com","latestUserId":null,"commandTitle":"","showCommandTitle":false,"hideCommandCode":false,"hideCommandResult":false,"iPythonMetadata":null,"streamStates":{},"datasetPreviewNameToCmdIdMap":{},"nuid":"226d703c-ee6e-4ac4-8baf-be044acd7822"},{"version":"CommandV1","origId":3718471498079358,"guid":"be7916e9-533a-41e4-b321-dcddbb43e696","subtype":"command","commandType":"auto","position":1.75,"command":"numberOfItemsToRecommend","commandVersion":0,"state":"finished","results":{"type":"html","data":"<div class=\"ansiout\"><span class=\"ansired\">Out[</span><span class=\"ansired\">3</span><span class=\"ansired\">]: </span>5\n</div>","arguments":{},"addedWidgets":{},"removedWidgets":[],"datasetInfos":[]},"errorSummary":"<span class=\"ansired\">NameError</span>: name &apos;numberOfItemsToRecommend&apos; is not defined","error":null,"workflows":[],"startTime":1499021315085,"submitTime":1499021283844,"finishTime":1499021315126,"collapsed":false,"bindings":{},"inputWidgets":{},"displayType":"table","width":"auto","height":"auto","xColumns":null,"yColumns":null,"pivotColumns":null,"pivotAggregation":null,"customPlotOptions":{},"commentThread":[],"commentsVisible":false,"parentHierarchy":[],"diffInserts":[],"diffDeletes":[],"globalVars":{},"latestUser":"amarildolikmeta@gmail.com","latestUserId":null,"commandTitle":"","showCommandTitle":false,"hideCommandCode":false,"hideCommandResult":false,"iPythonMetadata":null,"streamStates":{},"datasetPreviewNameToCmdIdMap":{},"nuid":"8bb1533d-6249-4b21-9a0b-288e65920754"}],"dashboards":[],"guid":"a8f954c7-030f-491b-b471-9ea1693d46de","globalVars":{},"iPythonMetadata":null,"inputWidgets":{}}