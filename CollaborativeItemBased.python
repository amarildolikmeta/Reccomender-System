{"version":"NotebookV1","origId":215866868972794,"name":"CollaborativeItemBased","language":"python","commands":[{"version":"CommandV1","origId":215866868972796,"guid":"5e7be93b-39e5-484d-9f96-0083e2c3013c","subtype":"command","commandType":"auto","position":1.0,"command":"import numpy as np\nimport pandas as pd \nfrom math import sqrt ","commandVersion":0,"state":"finished","results":{"type":"html","data":"<div class=\"ansiout\"></div>","arguments":{},"addedWidgets":{},"removedWidgets":[],"datasetInfos":[]},"errorSummary":null,"error":null,"workflows":[],"startTime":1495266881034,"submitTime":1495266851359,"finishTime":1495266881384,"collapsed":false,"bindings":{},"inputWidgets":{},"displayType":"table","width":"auto","height":"auto","xColumns":null,"yColumns":null,"pivotColumns":null,"pivotAggregation":null,"customPlotOptions":{},"commentThread":[],"commentsVisible":false,"parentHierarchy":[],"diffInserts":[],"diffDeletes":[],"globalVars":{},"latestUser":"amarildolikmeta@gmail.com","latestUserId":null,"commandTitle":"","showCommandTitle":false,"hideCommandCode":false,"hideCommandResult":false,"iPythonMetadata":null,"streamStates":{},"datasetPreviewNameToCmdIdMap":{},"nuid":"c1b0d816-3139-4aca-9814-3ecafd277310"},{"version":"CommandV1","origId":215866868972833,"guid":"2c4d44d6-639b-4b20-8051-6bb91b05fc19","subtype":"command","commandType":"auto","position":2.0,"command":"numberOfItemsToRecommend=5","commandVersion":0,"state":"finished","results":{"type":"html","data":"<div class=\"ansiout\"></div>","arguments":{},"addedWidgets":{},"removedWidgets":[],"datasetInfos":[]},"errorSummary":null,"error":null,"workflows":[],"startTime":1495266881509,"submitTime":1495266851571,"finishTime":1495266881539,"collapsed":false,"bindings":{},"inputWidgets":{},"displayType":"table","width":"auto","height":"auto","xColumns":null,"yColumns":null,"pivotColumns":null,"pivotAggregation":null,"customPlotOptions":{},"commentThread":[],"commentsVisible":false,"parentHierarchy":[],"diffInserts":[],"diffDeletes":[],"globalVars":{},"latestUser":"amarildolikmeta@gmail.com","latestUserId":null,"commandTitle":"","showCommandTitle":false,"hideCommandCode":false,"hideCommandResult":false,"iPythonMetadata":null,"streamStates":{},"datasetPreviewNameToCmdIdMap":{},"nuid":"61c73a9b-0984-449d-bd93-a927bee2b5d1"},{"version":"CommandV1","origId":215866868972834,"guid":"77763c85-3184-4052-9618-0230c0702edc","subtype":"command","commandType":"auto","position":3.0,"command":"train=sqlContext.sql(\"SELECT * from train\")\ntrainRDD=train.rdd","commandVersion":0,"state":"finished","results":{"type":"html","data":"<div class=\"ansiout\"></div>","arguments":{},"addedWidgets":{},"removedWidgets":[],"datasetInfos":[]},"errorSummary":null,"error":null,"workflows":[],"startTime":1495266881548,"submitTime":1495266851645,"finishTime":1495266884068,"collapsed":false,"bindings":{},"inputWidgets":{},"displayType":"table","width":"auto","height":"auto","xColumns":null,"yColumns":null,"pivotColumns":null,"pivotAggregation":null,"customPlotOptions":{},"commentThread":[],"commentsVisible":false,"parentHierarchy":[],"diffInserts":[],"diffDeletes":[],"globalVars":{},"latestUser":"amarildolikmeta@gmail.com","latestUserId":null,"commandTitle":"","showCommandTitle":false,"hideCommandCode":false,"hideCommandResult":false,"iPythonMetadata":null,"streamStates":{},"datasetPreviewNameToCmdIdMap":{},"nuid":"e1a81be2-b650-4244-b967-6c94495e81bd"},{"version":"CommandV1","origId":215866868972835,"guid":"58a18259-0791-422a-a8f2-17ae2aa33532","subtype":"command","commandType":"auto","position":4.0,"command":"testRDD=sqlContext.sql(\"Select * from target\").rdd.map(lambda x:x[0])\ntestList=testRDD.sortBy(lambda x:float(x))","commandVersion":0,"state":"finished","results":{"type":"html","data":"<div class=\"ansiout\"></div>","arguments":{},"addedWidgets":{},"removedWidgets":[],"datasetInfos":[]},"errorSummary":null,"error":null,"workflows":[],"startTime":1495266884081,"submitTime":1495266851696,"finishTime":1495266885896,"collapsed":false,"bindings":{},"inputWidgets":{},"displayType":"table","width":"auto","height":"auto","xColumns":null,"yColumns":null,"pivotColumns":null,"pivotAggregation":null,"customPlotOptions":{},"commentThread":[],"commentsVisible":false,"parentHierarchy":[],"diffInserts":[],"diffDeletes":[],"globalVars":{},"latestUser":"amarildolikmeta@gmail.com","latestUserId":null,"commandTitle":"","showCommandTitle":false,"hideCommandCode":false,"hideCommandResult":false,"iPythonMetadata":null,"streamStates":{},"datasetPreviewNameToCmdIdMap":{},"nuid":"5fe69c89-0a02-4b6d-ad0a-b66ac3e3d318"},{"version":"CommandV1","origId":215866868972836,"guid":"9079b249-3ac7-4759-8f20-b5d8f20db3db","subtype":"command","commandType":"auto","position":5.0,"command":"userSeenItems = trainRDD.map(lambda x: (x[0], [x[1]])).reduceByKey(lambda x,y : x+y)\nuserSeenItems_dict = userSeenItems.collectAsMap()","commandVersion":0,"state":"finished","results":{"type":"html","data":"<div class=\"ansiout\"></div>","arguments":{},"addedWidgets":{},"removedWidgets":[],"datasetInfos":[]},"errorSummary":null,"error":null,"workflows":[],"startTime":1495266885905,"submitTime":1495266851752,"finishTime":1495266887934,"collapsed":false,"bindings":{},"inputWidgets":{},"displayType":"table","width":"auto","height":"auto","xColumns":null,"yColumns":null,"pivotColumns":null,"pivotAggregation":null,"customPlotOptions":{},"commentThread":[],"commentsVisible":false,"parentHierarchy":[],"diffInserts":[],"diffDeletes":[],"globalVars":{},"latestUser":"amarildolikmeta@gmail.com","latestUserId":null,"commandTitle":"","showCommandTitle":false,"hideCommandCode":false,"hideCommandResult":false,"iPythonMetadata":null,"streamStates":{},"datasetPreviewNameToCmdIdMap":{},"nuid":"9e05a3a6-d1f2-4b8e-b26d-756c676085a5"},{"version":"CommandV1","origId":215866868972837,"guid":"0385cb55-ab3b-4a13-88db-2bed067f7012","subtype":"command","commandType":"auto","position":6.0,"command":"ratings=sqlContext.sql(\"Select itemId ,sum(rating)/(count(rating)+8) as AvgRating from train group by itemId order by AvgRating desc\").rdd\nAvgItemratings_dict=ratings.map(lambda x:(x[0],float(x[1]))).collectAsMap()","commandVersion":0,"state":"finished","results":{"type":"html","data":"<div class=\"ansiout\"></div>","arguments":{},"addedWidgets":{},"removedWidgets":[],"datasetInfos":[]},"errorSummary":"Cancelled","error":null,"workflows":[],"startTime":1495266887944,"submitTime":1495266851802,"finishTime":1495266903239,"collapsed":false,"bindings":{},"inputWidgets":{},"displayType":"table","width":"auto","height":"auto","xColumns":null,"yColumns":null,"pivotColumns":null,"pivotAggregation":null,"customPlotOptions":{},"commentThread":[],"commentsVisible":false,"parentHierarchy":[],"diffInserts":[],"diffDeletes":[],"globalVars":{},"latestUser":"amarildolikmeta@gmail.com","latestUserId":null,"commandTitle":"","showCommandTitle":false,"hideCommandCode":false,"hideCommandResult":false,"iPythonMetadata":null,"streamStates":{},"datasetPreviewNameToCmdIdMap":{},"nuid":"879f75ad-845e-47ee-893b-89701b8d8f9f"},{"version":"CommandV1","origId":215866868972838,"guid":"7bbb13d2-75a0-4fb4-9f9c-0943b18130e0","subtype":"command","commandType":"auto","position":7.0,"command":"ratings=ratings.map(lambda x:str(x[0])).collect()\nratings=np.array(ratings)","commandVersion":0,"state":"finished","results":{"type":"html","data":"<div class=\"ansiout\"></div>","arguments":{},"addedWidgets":{},"removedWidgets":[],"datasetInfos":[]},"errorSummary":"Command skipped","error":null,"workflows":[],"startTime":1495266903248,"submitTime":1495266851864,"finishTime":1495266905263,"collapsed":false,"bindings":{},"inputWidgets":{},"displayType":"table","width":"auto","height":"auto","xColumns":null,"yColumns":null,"pivotColumns":null,"pivotAggregation":null,"customPlotOptions":{},"commentThread":[],"commentsVisible":false,"parentHierarchy":[],"diffInserts":[],"diffDeletes":[],"globalVars":{},"latestUser":"amarildolikmeta@gmail.com","latestUserId":null,"commandTitle":"","showCommandTitle":false,"hideCommandCode":false,"hideCommandResult":false,"iPythonMetadata":null,"streamStates":{},"datasetPreviewNameToCmdIdMap":{},"nuid":"8b67ebd7-8181-4d07-b22e-40253aa4ed5f"},{"version":"CommandV1","origId":215866868972839,"guid":"214a425e-c758-43cf-926b-819cea793598","subtype":"command","commandType":"auto","position":8.0,"command":"avgGlobalRating=str(sqlContext.sql(\"Select avg(rating) from train\").rdd.collect()[0][0])\navgGloabalRating=float(avgGlobalRating) ","commandVersion":0,"state":"finished","results":{"type":"html","data":"<div class=\"ansiout\"></div>","arguments":{},"addedWidgets":{},"removedWidgets":[],"datasetInfos":[]},"errorSummary":"Command skipped","error":null,"workflows":[],"startTime":1495266905272,"submitTime":1495266851913,"finishTime":1495266906482,"collapsed":false,"bindings":{},"inputWidgets":{},"displayType":"table","width":"auto","height":"auto","xColumns":null,"yColumns":null,"pivotColumns":null,"pivotAggregation":null,"customPlotOptions":{},"commentThread":[],"commentsVisible":false,"parentHierarchy":[],"diffInserts":[],"diffDeletes":[],"globalVars":{},"latestUser":"amarildolikmeta@gmail.com","latestUserId":null,"commandTitle":"","showCommandTitle":false,"hideCommandCode":false,"hideCommandResult":false,"iPythonMetadata":null,"streamStates":{},"datasetPreviewNameToCmdIdMap":{},"nuid":"6d926618-23f7-4e91-b078-221e734bff85"},{"version":"CommandV1","origId":215866868972840,"guid":"8575df2a-7b12-47d6-b75f-bb2ac7d1b875","subtype":"command","commandType":"auto","position":9.0,"command":"userRatings=trainRDD.map(lambda x:(x[0],[(x[1],int(x[2]))])).reduceByKey(lambda x,y:x+y)","commandVersion":0,"state":"finished","results":{"type":"html","data":"<div class=\"ansiout\"></div>","arguments":{},"addedWidgets":{},"removedWidgets":[],"datasetInfos":[]},"errorSummary":"Command skipped","error":null,"workflows":[],"startTime":1495266906493,"submitTime":1495266851973,"finishTime":1495266906567,"collapsed":false,"bindings":{},"inputWidgets":{},"displayType":"table","width":"auto","height":"auto","xColumns":null,"yColumns":null,"pivotColumns":null,"pivotAggregation":null,"customPlotOptions":{},"commentThread":[],"commentsVisible":false,"parentHierarchy":[],"diffInserts":[],"diffDeletes":[],"globalVars":{},"latestUser":"amarildolikmeta@gmail.com","latestUserId":null,"commandTitle":"","showCommandTitle":false,"hideCommandCode":false,"hideCommandResult":false,"iPythonMetadata":null,"streamStates":{},"datasetPreviewNameToCmdIdMap":{},"nuid":"836787c4-d47b-4808-83bc-8c01a65dd1f3"},{"version":"CommandV1","origId":215866868972841,"guid":"00660681-9ed5-4df5-95dd-925b79ea0c1f","subtype":"command","commandType":"auto","position":10.0,"command":"userRatings_dict=userRatings.collectAsMap()","commandVersion":0,"state":"finished","results":{"type":"html","data":"<div class=\"ansiout\"></div>","arguments":{},"addedWidgets":{},"removedWidgets":[],"datasetInfos":[]},"errorSummary":"Command skipped","error":null,"workflows":[],"startTime":1495266906574,"submitTime":1495266852032,"finishTime":1495266908596,"collapsed":false,"bindings":{},"inputWidgets":{},"displayType":"table","width":"auto","height":"auto","xColumns":null,"yColumns":null,"pivotColumns":null,"pivotAggregation":null,"customPlotOptions":{},"commentThread":[],"commentsVisible":false,"parentHierarchy":[],"diffInserts":[],"diffDeletes":[],"globalVars":{},"latestUser":"amarildolikmeta@gmail.com","latestUserId":null,"commandTitle":"","showCommandTitle":false,"hideCommandCode":false,"hideCommandResult":false,"iPythonMetadata":null,"streamStates":{},"datasetPreviewNameToCmdIdMap":{},"nuid":"da427ae8-ef36-49e7-8a8c-0a74ea8887ac"},{"version":"CommandV1","origId":215866868972842,"guid":"f731a261-e5df-435f-9798-90f711311ce2","subtype":"command","commandType":"auto","position":11.0,"command":"for key in userRatings_dict:\n  userRatings_dict[key]=dict(userRatings_dict[key])\nuserRatings_dict[\"4446\"][\"14644\"]","commandVersion":0,"state":"finished","results":{"type":"html","data":"<div class=\"ansiout\"><span class=\"ansired\">Out[</span><span class=\"ansired\">11</span><span class=\"ansired\">]: </span>10\n</div>","arguments":{},"addedWidgets":{},"removedWidgets":[],"datasetInfos":[]},"errorSummary":"Command skipped","error":null,"workflows":[],"startTime":1495266908607,"submitTime":1495266852120,"finishTime":1495266908702,"collapsed":false,"bindings":{},"inputWidgets":{},"displayType":"table","width":"auto","height":"auto","xColumns":null,"yColumns":null,"pivotColumns":null,"pivotAggregation":null,"customPlotOptions":{},"commentThread":[],"commentsVisible":false,"parentHierarchy":[],"diffInserts":[],"diffDeletes":[],"globalVars":{},"latestUser":"amarildolikmeta@gmail.com","latestUserId":null,"commandTitle":"","showCommandTitle":false,"hideCommandCode":false,"hideCommandResult":false,"iPythonMetadata":null,"streamStates":{},"datasetPreviewNameToCmdIdMap":{},"nuid":"20ba05c0-3cd4-4e78-8e6b-8bfeff036872"},{"version":"CommandV1","origId":215866868972843,"guid":"9d281170-471a-4121-b3d2-a13f9465ceae","subtype":"command","commandType":"auto","position":12.0,"command":"from math import sqrt\ndef UserSimilarity(user1,user2):\n  seenItems1=set(userSeenItems_dict[user1])\n  seenItems2=set(userSeenItems_dict[user2])\n  totalItems=seenItems1&seenItems2\n  ratings1=np.zeros(len(totalItems))\n  ratings2=np.zeros(len(totalItems))\n  totalItems=list(totalItems)\n  if len(totalItems)==0:\n    return 0\n  for i in xrange(len(totalItems)):\n    try:\n      ratings1[i]=float(userRatings_dict[user1][str(totalItems[i])])\n    except:\n      ratings1[i]=float(meanItemRatings[str(totalItems[i])])\n    try:\n      ratings2[i]=float(userRatings_dict[user2][str(totalItems[i])])\n    except:\n      ratings2[i]=float(meanItemRatings[str(totalItems[i])])  \n  number_of_ratings=len(totalItems)\n  \n  person1_preferences_sum=sum(ratings1)\n  person2_preferences_sum=sum(ratings2)\n  person1_square_preferences_sum=sum([pow(item,2) for item in ratings1 ])\n  person2_square_preferences_sum=sum([pow(item,2) for item in ratings2 ])\n  product_sum_of_both_users=sum([ratings1[i] * ratings2[i] for i in xrange(len(ratings1))])\n   # Calculate the pearson score\n  numerator_value = product_sum_of_both_users - (person1_preferences_sum*person2_preferences_sum/number_of_ratings)\n  denominator_value = sqrt((person1_square_preferences_sum - pow(person1_preferences_sum,2)/number_of_ratings) * (person2_square_preferences_sum -pow(person2_preferences_sum,2)/number_of_ratings))\n\n  if denominator_value == 0:\n      return 0\n  else:\n      r = numerator_value / denominator_value\n      return r\n  ","commandVersion":0,"state":"finished","results":{"type":"html","data":"<div class=\"ansiout\"></div>","arguments":{},"addedWidgets":{},"removedWidgets":[],"datasetInfos":[]},"errorSummary":"Command skipped","error":null,"workflows":[],"startTime":1495266908710,"submitTime":1495266852171,"finishTime":1495266908754,"collapsed":false,"bindings":{},"inputWidgets":{},"displayType":"table","width":"auto","height":"auto","xColumns":null,"yColumns":null,"pivotColumns":null,"pivotAggregation":null,"customPlotOptions":{},"commentThread":[],"commentsVisible":false,"parentHierarchy":[],"diffInserts":[],"diffDeletes":[],"globalVars":{},"latestUser":"amarildolikmeta@gmail.com","latestUserId":null,"commandTitle":"","showCommandTitle":false,"hideCommandCode":false,"hideCommandResult":false,"iPythonMetadata":null,"streamStates":{},"datasetPreviewNameToCmdIdMap":{},"nuid":"634aee96-135b-42af-a0f9-7233a2f04b1e"},{"version":"CommandV1","origId":215866868972844,"guid":"70f4e096-51dd-45fe-b9a3-fe99d0e21187","subtype":"command","commandType":"auto","position":13.0,"command":"itemRaters=sqlContext.sql(\"Select itemId, userId from train\").rdd.map(lambda x:(x[0],[x[1]])).reduceByKey(lambda x,y:x+y)\nitemRaters_dict=itemRaters.collectAsMap()\nitemRaters_dict[\"15\"]","commandVersion":0,"state":"finished","results":{"type":"html","data":"<div class=\"ansiout\"><span class=\"ansired\">Out[</span><span class=\"ansired\">13</span><span class=\"ansired\">]: </span>[u&apos;3418&apos;, u&apos;4672&apos;, u&apos;9052&apos;, u&apos;9520&apos;]\n</div>","arguments":{},"addedWidgets":{},"removedWidgets":[],"datasetInfos":[]},"errorSummary":"Command skipped","error":null,"workflows":[],"startTime":1495266908762,"submitTime":1495266852229,"finishTime":1495266910385,"collapsed":false,"bindings":{},"inputWidgets":{},"displayType":"table","width":"auto","height":"auto","xColumns":null,"yColumns":null,"pivotColumns":null,"pivotAggregation":null,"customPlotOptions":{},"commentThread":[],"commentsVisible":false,"parentHierarchy":[],"diffInserts":[],"diffDeletes":[],"globalVars":{},"latestUser":"amarildolikmeta@gmail.com","latestUserId":null,"commandTitle":"","showCommandTitle":false,"hideCommandCode":false,"hideCommandResult":false,"iPythonMetadata":null,"streamStates":{},"datasetPreviewNameToCmdIdMap":{},"nuid":"bf629fd5-b9aa-48b8-bc4b-0b764b9462e8"},{"version":"CommandV1","origId":215866868972845,"guid":"789e486d-9375-477e-9afa-bf90af51653a","subtype":"command","commandType":"auto","position":14.0,"command":"itemList=sqlContext.sql(\"Select distinct itemId from train order by int(itemId)\").rdd.map(lambda x:x[0]).collect()\nitemList[0:5]","commandVersion":0,"state":"finished","results":{"type":"html","data":"<div class=\"ansiout\"><span class=\"ansired\">Out[</span><span class=\"ansired\">14</span><span class=\"ansired\">]: </span>[u&apos;1&apos;, u&apos;2&apos;, u&apos;3&apos;, u&apos;4&apos;, u&apos;5&apos;]\n</div>","arguments":{},"addedWidgets":{},"removedWidgets":[],"datasetInfos":[]},"errorSummary":"Command skipped","error":null,"workflows":[],"startTime":1495266910392,"submitTime":1495266852300,"finishTime":1495266923246,"collapsed":false,"bindings":{},"inputWidgets":{},"displayType":"table","width":"auto","height":"auto","xColumns":null,"yColumns":null,"pivotColumns":null,"pivotAggregation":null,"customPlotOptions":{},"commentThread":[],"commentsVisible":false,"parentHierarchy":[],"diffInserts":[],"diffDeletes":[],"globalVars":{},"latestUser":"amarildolikmeta@gmail.com","latestUserId":null,"commandTitle":"","showCommandTitle":false,"hideCommandCode":false,"hideCommandResult":false,"iPythonMetadata":null,"streamStates":{},"datasetPreviewNameToCmdIdMap":{},"nuid":"d1561b4c-e1aa-4c55-a2b8-b81a95b1cb7e"},{"version":"CommandV1","origId":215866868972846,"guid":"d3fd7a7d-48e7-43e3-b86e-65206dc28868","subtype":"command","commandType":"auto","position":15.0,"command":"userAverage=sqlContext.sql(\"Select userId , avg(rating) from train group by userId\").rdd.map(lambda x:(x[0],float(x[1])))\nuserAverage_dict=userAverage.collectAsMap()\nuserAverage_dict[\"15\"]","commandVersion":0,"state":"finished","results":{"type":"html","data":"<div class=\"ansiout\"><span class=\"ansired\">Out[</span><span class=\"ansired\">15</span><span class=\"ansired\">]: </span>8.0\n</div>","arguments":{},"addedWidgets":{},"removedWidgets":[],"datasetInfos":[]},"errorSummary":"Command skipped","error":null,"workflows":[],"startTime":1495266923253,"submitTime":1495266852353,"finishTime":1495266926696,"collapsed":false,"bindings":{},"inputWidgets":{},"displayType":"table","width":"auto","height":"auto","xColumns":null,"yColumns":null,"pivotColumns":null,"pivotAggregation":null,"customPlotOptions":{},"commentThread":[],"commentsVisible":false,"parentHierarchy":[],"diffInserts":[],"diffDeletes":[],"globalVars":{},"latestUser":"amarildolikmeta@gmail.com","latestUserId":null,"commandTitle":"","showCommandTitle":false,"hideCommandCode":false,"hideCommandResult":false,"iPythonMetadata":null,"streamStates":{},"datasetPreviewNameToCmdIdMap":{},"nuid":"badbbcdc-c683-47d2-a81e-c5ca5ba9241a"},{"version":"CommandV1","origId":215866868972847,"guid":"17fa6f12-4f7d-4817-8360-5cff8be171d5","subtype":"command","commandType":"auto","position":16.0,"command":"completeUserList=sqlContext.sql(\"Select distinct userId from train order by int(userId)\").rdd.map(lambda x:x[0]).collect()","commandVersion":0,"state":"finished","results":{"type":"html","data":"<div class=\"ansiout\"></div>","arguments":{},"addedWidgets":{},"removedWidgets":[],"datasetInfos":[]},"errorSummary":"Command skipped","error":null,"workflows":[],"startTime":1495266926756,"submitTime":1495266852427,"finishTime":1495266938181,"collapsed":false,"bindings":{},"inputWidgets":{},"displayType":"table","width":"auto","height":"auto","xColumns":null,"yColumns":null,"pivotColumns":null,"pivotAggregation":null,"customPlotOptions":{},"commentThread":[],"commentsVisible":false,"parentHierarchy":[],"diffInserts":[],"diffDeletes":[],"globalVars":{},"latestUser":"amarildolikmeta@gmail.com","latestUserId":null,"commandTitle":"","showCommandTitle":false,"hideCommandCode":false,"hideCommandResult":false,"iPythonMetadata":null,"streamStates":{},"datasetPreviewNameToCmdIdMap":{},"nuid":"79877296-a13e-4d52-96f4-a64b2b483879"},{"version":"CommandV1","origId":215866868972848,"guid":"dfbb2bc6-98a3-41c2-b83a-55a5636ceffd","subtype":"command","commandType":"auto","position":17.0,"command":"def recommendTopRated(user_id, removeSeen=1):\n    recommendedList = ratings\n    if(removeSeen):\n      seenItems = np.array(userSeenItems_dict[user_id])\n      unseen_mask = np.in1d(recommendedList, seenItems, invert=True)\n      recommendedList = recommendedList[unseen_mask]      \n    return [user_id,recommendedList[0:numberOfItemsToRecommend].tolist()]","commandVersion":0,"state":"finished","results":{"type":"html","data":"<div class=\"ansiout\"></div>","arguments":{},"addedWidgets":{},"removedWidgets":[],"datasetInfos":[]},"errorSummary":"Command skipped","error":null,"workflows":[],"startTime":1495266938190,"submitTime":1495266852479,"finishTime":1495266938214,"collapsed":false,"bindings":{},"inputWidgets":{},"displayType":"table","width":"auto","height":"auto","xColumns":null,"yColumns":null,"pivotColumns":null,"pivotAggregation":null,"customPlotOptions":{},"commentThread":[],"commentsVisible":false,"parentHierarchy":[],"diffInserts":[],"diffDeletes":[],"globalVars":{},"latestUser":"amarildolikmeta@gmail.com","latestUserId":null,"commandTitle":"","showCommandTitle":false,"hideCommandCode":false,"hideCommandResult":false,"iPythonMetadata":null,"streamStates":{},"datasetPreviewNameToCmdIdMap":{},"nuid":"c49dbd13-7a9e-4df1-8a95-dfc424dec37d"},{"version":"CommandV1","origId":215866868972849,"guid":"13c32ce2-8a1b-49d9-89c1-e6b935d67e36","subtype":"command","commandType":"auto","position":18.0,"command":"def getNMostSimilarUsers(userId,n):\n  similarities=[]\n  count=0\n  for user in completeUserList:\n    if(userId!=user):\n      similarity=PearsonSimilarity(userId,user)\n      if similarity!=0:\n        similarities.append((user,similarity))\n        count=count+1\n  similarities = sorted(similarities, key=lambda tup: tup[1],reverse=True)\n  if count>n:\n    count=n\n  similarities=[ seq[0] for seq in similarities[0:count] ]\n  return similarities","commandVersion":0,"state":"finished","results":{"type":"html","data":"<div class=\"ansiout\"></div>","arguments":{},"addedWidgets":{},"removedWidgets":[],"datasetInfos":[]},"errorSummary":"Command skipped","error":null,"workflows":[],"startTime":1495266938220,"submitTime":1495266852543,"finishTime":1495266938264,"collapsed":false,"bindings":{},"inputWidgets":{},"displayType":"table","width":"auto","height":"auto","xColumns":null,"yColumns":null,"pivotColumns":null,"pivotAggregation":null,"customPlotOptions":{},"commentThread":[],"commentsVisible":false,"parentHierarchy":[],"diffInserts":[],"diffDeletes":[],"globalVars":{},"latestUser":"amarildolikmeta@gmail.com","latestUserId":null,"commandTitle":"","showCommandTitle":false,"hideCommandCode":false,"hideCommandResult":false,"iPythonMetadata":null,"streamStates":{},"datasetPreviewNameToCmdIdMap":{},"nuid":"4f3895ed-47e1-47ee-b6d3-c65741483196"},{"version":"CommandV1","origId":215866868972850,"guid":"18a0deca-5e6e-4e48-8692-2fd15a1f5a8a","subtype":"command","commandType":"auto","position":19.0,"command":"numRatings=sqlContext.sql(\"Select userId,count(rating) as numRatings from train group by userId \").rdd.map(lambda x:(x[0],int(x[1])))\nnumRatings_dict=numRatings.collectAsMap()\nnumRatings_dict[\"15\"]","commandVersion":0,"state":"finished","results":{"type":"html","data":"<div class=\"ansiout\"><span class=\"ansired\">Out[</span><span class=\"ansired\">19</span><span class=\"ansired\">]: </span>5\n</div>","arguments":{},"addedWidgets":{},"removedWidgets":[],"datasetInfos":[]},"errorSummary":"Command skipped","error":null,"workflows":[],"startTime":1495266938269,"submitTime":1495266852598,"finishTime":1495266940693,"collapsed":false,"bindings":{},"inputWidgets":{},"displayType":"table","width":"auto","height":"auto","xColumns":null,"yColumns":null,"pivotColumns":null,"pivotAggregation":null,"customPlotOptions":{},"commentThread":[],"commentsVisible":false,"parentHierarchy":[],"diffInserts":[],"diffDeletes":[],"globalVars":{},"latestUser":"amarildolikmeta@gmail.com","latestUserId":null,"commandTitle":"","showCommandTitle":false,"hideCommandCode":false,"hideCommandResult":false,"iPythonMetadata":null,"streamStates":{},"datasetPreviewNameToCmdIdMap":{},"nuid":"889aac4e-95f0-4bc2-aabc-8d784b9b679b"},{"version":"CommandV1","origId":215866868972851,"guid":"f0c0a57c-00c2-4914-b6ad-17e4933e27ac","subtype":"command","commandType":"auto","position":20.0,"command":"features=sqlContext.sql(\"Select * from icm \").rdd.map(lambda x:(x[0],x[1]))\nfeatures.take(10)","commandVersion":0,"state":"finished","results":{"type":"html","data":"<div class=\"ansiout\"><span class=\"ansired\">Out[</span><span class=\"ansired\">20</span><span class=\"ansired\">]: </span>\n[(2135, 1),\n (2303, 1),\n (6292, 1),\n (12395, 1),\n (24520, 1),\n (25297, 1),\n (32548, 1),\n (34303, 1),\n (36141, 1),\n (11812, 2)]\n</div>","arguments":{},"addedWidgets":{},"removedWidgets":[],"datasetInfos":[]},"errorSummary":"Command skipped","error":null,"workflows":[],"startTime":1495266940700,"submitTime":1495266852660,"finishTime":1495266941323,"collapsed":false,"bindings":{},"inputWidgets":{},"displayType":"table","width":"auto","height":"auto","xColumns":null,"yColumns":null,"pivotColumns":null,"pivotAggregation":null,"customPlotOptions":{},"commentThread":[],"commentsVisible":false,"parentHierarchy":[],"diffInserts":[],"diffDeletes":[],"globalVars":{},"latestUser":"amarildolikmeta@gmail.com","latestUserId":null,"commandTitle":"","showCommandTitle":false,"hideCommandCode":false,"hideCommandResult":false,"iPythonMetadata":null,"streamStates":{},"datasetPreviewNameToCmdIdMap":{},"nuid":"b5706824-d3e2-4e6f-a2c4-cd459b693ed9"},{"version":"CommandV1","origId":215866868972852,"guid":"737ec19a-72d4-4611-bf24-536373192878","subtype":"command","commandType":"auto","position":21.0,"command":"features_dict=features.map(lambda x:(str(x[0]),[x[1]])).reduceByKey(lambda x,y:x+y).collectAsMap() \nfeatures_dict[\"2135\"] #features of item 2135","commandVersion":0,"state":"finished","results":{"type":"html","data":"<div class=\"ansiout\"><span class=\"ansired\">Out[</span><span class=\"ansired\">21</span><span class=\"ansired\">]: </span>[1, 3250, 4715, 5786, 6524, 8317]\n</div>","arguments":{},"addedWidgets":{},"removedWidgets":[],"datasetInfos":[]},"errorSummary":"Command skipped","error":null,"workflows":[],"startTime":1495266941329,"submitTime":1495266852709,"finishTime":1495266942842,"collapsed":false,"bindings":{},"inputWidgets":{},"displayType":"table","width":"auto","height":"auto","xColumns":null,"yColumns":null,"pivotColumns":null,"pivotAggregation":null,"customPlotOptions":{},"commentThread":[],"commentsVisible":false,"parentHierarchy":[],"diffInserts":[],"diffDeletes":[],"globalVars":{},"latestUser":"amarildolikmeta@gmail.com","latestUserId":null,"commandTitle":"","showCommandTitle":false,"hideCommandCode":false,"hideCommandResult":false,"iPythonMetadata":null,"streamStates":{},"datasetPreviewNameToCmdIdMap":{},"nuid":"2b9df7c5-28de-472f-8408-acb348fc3733"},{"version":"CommandV1","origId":215866868972853,"guid":"5c810a6f-a529-452d-b15e-321d9ef42ea9","subtype":"command","commandType":"auto","position":22.0,"command":"from scipy import spatial\n\ndef itemFeatureSimilarity(item1,item2):\n  try :\n    featuresItems1=set(features_dict[item1])\n    featuresItems2=set(features_dict[item2])\n    totalFeatures=featuresItems1|featuresItems2\n    features1=np.zeros(len(totalFeatures))\n    features2=np.zeros(len(totalFeatures))\n    totalFeatures=list(totalFeatures)\n    if len(totalFeatures)==0:\n      return 0\n    for i in xrange(len(totalFeatures)):\n      if totalFeatures[i] in features_dict[item1]:\n        features1[i]=1\n      else:\n        features1[i]=0\n      if  totalFeatures[i] in features_dict[item2]:\n        features2[i]=1\n      else:\n        features2[i]=0\n    number_of_features=len(totalFeatures)\n    return 1-  spatial.distance.cosine(features1, features2)\n  except:\n    return 0","commandVersion":0,"state":"finished","results":{"type":"html","data":"<div class=\"ansiout\"></div>","arguments":{},"addedWidgets":{},"removedWidgets":[],"datasetInfos":[]},"errorSummary":"Command skipped","error":null,"workflows":[],"startTime":1495266942847,"submitTime":1495266852768,"finishTime":1495266942970,"collapsed":false,"bindings":{},"inputWidgets":{},"displayType":"table","width":"auto","height":"auto","xColumns":null,"yColumns":null,"pivotColumns":null,"pivotAggregation":null,"customPlotOptions":{},"commentThread":[],"commentsVisible":false,"parentHierarchy":[],"diffInserts":[],"diffDeletes":[],"globalVars":{},"latestUser":"amarildolikmeta@gmail.com","latestUserId":null,"commandTitle":"","showCommandTitle":false,"hideCommandCode":false,"hideCommandResult":false,"iPythonMetadata":null,"streamStates":{},"datasetPreviewNameToCmdIdMap":{},"nuid":"5877b734-d756-4aef-b99f-7d3a01805442"},{"version":"CommandV1","origId":215866868972854,"guid":"eb138dd7-fe84-4605-bc3d-965bf82156fb","subtype":"command","commandType":"auto","position":23.0,"command":"userRatingsList_dict=userRatings.collectAsMap()\nuserRatingsList_dict[\"15\"]","commandVersion":0,"state":"finished","results":{"type":"html","data":"<div class=\"ansiout\"><span class=\"ansired\">Out[</span><span class=\"ansired\">23</span><span class=\"ansired\">]: </span>[(u&apos;1686&apos;, 9), (u&apos;4949&apos;, 7), (u&apos;13298&apos;, 8), (u&apos;25363&apos;, 9), (u&apos;33993&apos;, 7)]\n</div>","arguments":{},"addedWidgets":{},"removedWidgets":[],"datasetInfos":[]},"errorSummary":"Command skipped","error":null,"workflows":[],"startTime":1495266942977,"submitTime":1495266852815,"finishTime":1495266943378,"collapsed":false,"bindings":{},"inputWidgets":{},"displayType":"table","width":"auto","height":"auto","xColumns":null,"yColumns":null,"pivotColumns":null,"pivotAggregation":null,"customPlotOptions":{},"commentThread":[],"commentsVisible":false,"parentHierarchy":[],"diffInserts":[],"diffDeletes":[],"globalVars":{},"latestUser":"amarildolikmeta@gmail.com","latestUserId":null,"commandTitle":"","showCommandTitle":false,"hideCommandCode":false,"hideCommandResult":false,"iPythonMetadata":null,"streamStates":{},"datasetPreviewNameToCmdIdMap":{},"nuid":"6d7e1c00-81ec-4c53-af8f-fb44a0acfb21"},{"version":"CommandV1","origId":215866868972855,"guid":"461ae771-e6f3-402e-8fae-11f0b5af9c22","subtype":"command","commandType":"auto","position":24.0,"command":"for key in userRatingsList_dict:\n  userRatingsList_dict[key]=sorted(userRatingsList_dict[key],key=lambda tup: tup[1],reverse=True)\n  userRatingsList_dict[key]=[ seq[0] for seq in userRatingsList_dict[key] ]\nuserRatingsList_dict[\"15\"]  #OrderFavoriteItemsForEachUser","commandVersion":0,"state":"finished","results":{"type":"html","data":"<div class=\"ansiout\"><span class=\"ansired\">Out[</span><span class=\"ansired\">24</span><span class=\"ansired\">]: </span>[u&apos;1686&apos;, u&apos;25363&apos;, u&apos;13298&apos;, u&apos;4949&apos;, u&apos;33993&apos;]\n</div>","arguments":{},"addedWidgets":{},"removedWidgets":[],"datasetInfos":[]},"errorSummary":"Command skipped","error":null,"workflows":[],"startTime":1495266943386,"submitTime":1495266852876,"finishTime":1495266943512,"collapsed":false,"bindings":{},"inputWidgets":{},"displayType":"table","width":"auto","height":"auto","xColumns":null,"yColumns":null,"pivotColumns":null,"pivotAggregation":null,"customPlotOptions":{},"commentThread":[],"commentsVisible":false,"parentHierarchy":[],"diffInserts":[],"diffDeletes":[],"globalVars":{},"latestUser":"amarildolikmeta@gmail.com","latestUserId":null,"commandTitle":"","showCommandTitle":false,"hideCommandCode":false,"hideCommandResult":false,"iPythonMetadata":null,"streamStates":{},"datasetPreviewNameToCmdIdMap":{},"nuid":"72c08890-7f79-459a-b583-47a7ff8466ce"},{"version":"CommandV1","origId":215866868972856,"guid":"0fcf4ac7-8e70-46da-8f51-4fb0a74ce1e4","subtype":"command","commandType":"auto","position":25.0,"command":"featuredItems=sqlContext.sql(\"Select distinct itemId from icm\").rdd.map(lambda x:str(x[0]))\nfeaturedItemsList=featuredItems.collect()\nfeaturedItemsList[0:10]","commandVersion":0,"state":"finished","results":{"type":"html","data":"<div class=\"ansiout\"><span class=\"ansired\">Out[</span><span class=\"ansired\">25</span><span class=\"ansired\">]: </span>\n[&apos;6031&apos;,\n &apos;23831&apos;,\n &apos;30031&apos;,\n &apos;27631&apos;,\n &apos;9031&apos;,\n &apos;31431&apos;,\n &apos;29231&apos;,\n &apos;14631&apos;,\n &apos;4631&apos;,\n &apos;33231&apos;]\n</div>","arguments":{},"addedWidgets":{},"removedWidgets":[],"datasetInfos":[]},"errorSummary":"Command skipped","error":null,"workflows":[],"startTime":1495266943518,"submitTime":1495266852945,"finishTime":1495266945734,"collapsed":false,"bindings":{},"inputWidgets":{},"displayType":"table","width":"auto","height":"auto","xColumns":null,"yColumns":null,"pivotColumns":null,"pivotAggregation":null,"customPlotOptions":{},"commentThread":[],"commentsVisible":false,"parentHierarchy":[],"diffInserts":[],"diffDeletes":[],"globalVars":{},"latestUser":"amarildolikmeta@gmail.com","latestUserId":null,"commandTitle":"","showCommandTitle":false,"hideCommandCode":false,"hideCommandResult":false,"iPythonMetadata":null,"streamStates":{},"datasetPreviewNameToCmdIdMap":{},"nuid":"82ada9ee-9430-4008-afbd-6751b395a639"},{"version":"CommandV1","origId":215866868972857,"guid":"cbe3508b-79a7-4d5d-ba8b-c5fc7b01fd80","subtype":"command","commandType":"auto","position":26.0,"command":"def getSimilarFeatureItems(user,item):\n  rating=userRatings_dict[user][item]\n  similar=[]\n  for i in featuredItemsList:\n    if i!=item:\n      similarity=itemSimilarity(item,i)\n      rate=similarity*rating\n      if rate!=0:\n        similar.append((str(i),rate))\n  similar = sorted(similar, key=lambda tup: tup[1],reverse=True)\n  if len(similar)>5:\n    return similar[0:5]\n  else:\n    return similar","commandVersion":0,"state":"finished","results":{"type":"html","data":"<div class=\"ansiout\"></div>","arguments":{},"addedWidgets":{},"removedWidgets":[],"datasetInfos":[]},"errorSummary":"Command skipped","error":null,"workflows":[],"startTime":1495266945739,"submitTime":1495266853022,"finishTime":1495266945779,"collapsed":false,"bindings":{},"inputWidgets":{},"displayType":"table","width":"auto","height":"auto","xColumns":null,"yColumns":null,"pivotColumns":null,"pivotAggregation":null,"customPlotOptions":{},"commentThread":[],"commentsVisible":false,"parentHierarchy":[],"diffInserts":[],"diffDeletes":[],"globalVars":{},"latestUser":"amarildolikmeta@gmail.com","latestUserId":null,"commandTitle":"","showCommandTitle":false,"hideCommandCode":false,"hideCommandResult":false,"iPythonMetadata":null,"streamStates":{},"datasetPreviewNameToCmdIdMap":{},"nuid":"f9502d85-4543-4455-b829-963a5a0d6e1a"},{"version":"CommandV1","origId":215866868972858,"guid":"06a81426-e013-4c84-8a22-e0cec8b95f46","subtype":"command","commandType":"auto","position":27.0,"command":"def ContentFiltering(userId):\n  userId=str(userId)\n  seenItems = np.array(userSeenItems_dict[userId])\n  reccomendedList=[]\n  reccomendedItems=[]\n  for item in userRatingsList_dict[userId]:\n    similar=getSimilarItems(userId,item)\n    for tup in similar:\n      if tup[0] not in seenItems and tup[0] not in reccomendedItems:\n        reccomendedItems.append(tup[0])\n        reccomendedList.append(tup)\n  reccomendedList = sorted(reccomendedList, key=lambda tup: tup[1],reverse=True)\n  reccomendedList=[ seq[0] for seq in reccomendedList ]\n  #reccomendedList=list(set(reccomendedList))\n  return [userId,reccomendedList[0:numberOfItemsToRecommend]]","commandVersion":0,"state":"finished","results":{"type":"html","data":"<div class=\"ansiout\"></div>","arguments":{},"addedWidgets":{},"removedWidgets":[],"datasetInfos":[]},"errorSummary":"Command skipped","error":null,"workflows":[],"startTime":1495266945885,"submitTime":1495266853241,"finishTime":1495266945913,"collapsed":false,"bindings":{},"inputWidgets":{},"displayType":"table","width":"auto","height":"auto","xColumns":null,"yColumns":null,"pivotColumns":null,"pivotAggregation":null,"customPlotOptions":{},"commentThread":[],"commentsVisible":false,"parentHierarchy":[],"diffInserts":[],"diffDeletes":[],"globalVars":{},"latestUser":"amarildolikmeta@gmail.com","latestUserId":null,"commandTitle":"","showCommandTitle":false,"hideCommandCode":false,"hideCommandResult":false,"iPythonMetadata":null,"streamStates":{},"datasetPreviewNameToCmdIdMap":{},"nuid":"42372a4d-2cac-4e3f-bc7f-e51a67c1aeec"},{"version":"CommandV1","origId":215866868972859,"guid":"dfb687b9-59ba-40fd-a625-66271de9db45","subtype":"command","commandType":"auto","position":28.0,"command":"itemUserRatings=sqlContext.sql(\"Select itemId, userId, rating from train \").rdd.map(lambda x:(str(x[0]),[(str(x[1]),int(x[2]))])).reduceByKey(lambda x,y:x+y)\nitemUserRatings.take(5)","commandVersion":0,"state":"finished","results":{"type":"html","data":"<div class=\"ansiout\"><span class=\"ansired\">Out[</span><span class=\"ansired\">30</span><span class=\"ansired\">]: </span>\n[(&apos;35236&apos;, [(&apos;7615&apos;, 5)]),\n (&apos;35182&apos;,\n  [(&apos;402&apos;, 5),\n   (&apos;1325&apos;, 8),\n   (&apos;4813&apos;, 4),\n   (&apos;7287&apos;, 4),\n   (&apos;7316&apos;, 7),\n   (&apos;8406&apos;, 7),\n   (&apos;9090&apos;, 7)]),\n (&apos;35234&apos;, [(&apos;3631&apos;, 7), (&apos;6479&apos;, 7)]),\n (&apos;35232&apos;, [(&apos;3502&apos;, 10)]),\n (&apos;4446&apos;, [(&apos;1022&apos;, 8), (&apos;13361&apos;, 10)])]\n</div>","arguments":{},"addedWidgets":{},"removedWidgets":[],"datasetInfos":[]},"errorSummary":"Command skipped","error":null,"workflows":[],"startTime":1495266945919,"submitTime":1495266853310,"finishTime":1495266947530,"collapsed":false,"bindings":{},"inputWidgets":{},"displayType":"table","width":"auto","height":"auto","xColumns":null,"yColumns":null,"pivotColumns":null,"pivotAggregation":null,"customPlotOptions":{},"commentThread":[],"commentsVisible":false,"parentHierarchy":[],"diffInserts":[],"diffDeletes":[],"globalVars":{},"latestUser":"amarildolikmeta@gmail.com","latestUserId":null,"commandTitle":"","showCommandTitle":false,"hideCommandCode":false,"hideCommandResult":false,"iPythonMetadata":null,"streamStates":{},"datasetPreviewNameToCmdIdMap":{},"nuid":"28731a21-318c-4d7b-a7f9-1efbb2dcccfc"},{"version":"CommandV1","origId":215866868972860,"guid":"6ead2c25-c3bd-4e29-9f5b-e28472ab00eb","subtype":"command","commandType":"auto","position":29.0,"command":"  def itemRatingSimilarity(item1,item2):\n    item1=str(item1)\n    item2=str(item2)\n    raters1=set(itemRaters_dict[item1])\n    raters2=set(itemRaters_dict[item2])\n    commonRaters=raters1&raters2\n    ratings1=np.zeros(len(commonRaters))\n    ratings2=np.zeros(len(commonRaters))\n    commonRaters=list(commonRaters)\n    userBias=np.zeros(len(commonRaters))\n    nominator=denominator1=denominator2=0\n    if len(commonRaters)==0:\n      return 0\n    for i in xrange(len(commonRaters)):\n      userBias[i]=userAverage_dict[str(commonRaters[i])]\n      try:\n        ratings1[i]=float(itemUserRatings_dict[item1][str(commonRaters[i])])\n        ratings2[i]=float(itemUserRatings_dict[item2][str(commonRaters[i])])\n      except:\n        return 0  \n      nominator=nominator+(ratings1[i]-userBias[i])*(ratings2[i]-userBias[i])\n      denominator1=denominator1+(ratings1[i]-userBias[i])**2\n      denominator2=denominator2+(ratings2[i]-userBias[i])**2\n    denominator=sqrt(denominator1)*sqrt(denominator2)+len(commonRaters)\n  \n    return nominator/denominator\n  ","commandVersion":0,"state":"finished","results":{"type":"html","data":"<div class=\"ansiout\"></div>","arguments":{},"addedWidgets":{},"removedWidgets":[],"datasetInfos":[]},"errorSummary":"Command skipped","error":null,"workflows":[],"startTime":1495266950335,"submitTime":1495266853597,"finishTime":1495266950372,"collapsed":false,"bindings":{},"inputWidgets":{},"displayType":"table","width":"auto","height":"auto","xColumns":null,"yColumns":null,"pivotColumns":null,"pivotAggregation":null,"customPlotOptions":{},"commentThread":[],"commentsVisible":false,"parentHierarchy":[],"diffInserts":[],"diffDeletes":[],"globalVars":{},"latestUser":"amarildolikmeta@gmail.com","latestUserId":null,"commandTitle":"","showCommandTitle":false,"hideCommandCode":false,"hideCommandResult":false,"iPythonMetadata":null,"streamStates":{},"datasetPreviewNameToCmdIdMap":{},"nuid":"c1ce625a-3bff-4609-8229-2b250de41113"},{"version":"CommandV1","origId":215866868972861,"guid":"1a73719b-92f3-4ff1-bc7a-1d0752032023","subtype":"command","commandType":"auto","position":28.5,"command":"itemUserRatings_dict=itemUserRatings.collectAsMap()\nitemUserRatings_dict[\"17\"]","commandVersion":0,"state":"error","results":null,"errorSummary":"<span class=\"ansired\">KeyError</span>: &apos;17&apos;","error":"<div class=\"ansiout\"><span class=\"ansired\">---------------------------------------------------------------------------</span>\n<span class=\"ansired\">KeyError</span>                                  Traceback (most recent call last)\n<span class=\"ansigreen\">&lt;ipython-input-31-49a22d3ce455&gt;</span> in <span class=\"ansicyan\">&lt;module&gt;</span><span class=\"ansiblue\">()</span>\n<span class=\"ansigreen\">      1</span> itemUserRatings_dict<span class=\"ansiyellow\">=</span>itemUserRatings<span class=\"ansiyellow\">.</span>collectAsMap<span class=\"ansiyellow\">(</span><span class=\"ansiyellow\">)</span><span class=\"ansiyellow\"></span>\n<span class=\"ansigreen\">----&gt; 2</span><span class=\"ansiyellow\"> </span>itemUserRatings_dict<span class=\"ansiyellow\">[</span><span class=\"ansiblue\">&quot;17&quot;</span><span class=\"ansiyellow\">]</span><span class=\"ansiyellow\"></span>\n\n<span class=\"ansired\">KeyError</span>: &apos;17&apos;\n</div>","workflows":[],"startTime":1495266853362,"submitTime":1495266853362,"finishTime":1495266948142,"collapsed":false,"bindings":{},"inputWidgets":{},"displayType":"table","width":"auto","height":"auto","xColumns":null,"yColumns":null,"pivotColumns":null,"pivotAggregation":null,"customPlotOptions":{},"commentThread":[],"commentsVisible":false,"parentHierarchy":[],"diffInserts":[],"diffDeletes":[],"globalVars":{},"latestUser":"amarildolikmeta@gmail.com","latestUserId":null,"commandTitle":"","showCommandTitle":false,"hideCommandCode":false,"hideCommandResult":false,"iPythonMetadata":null,"streamStates":{},"datasetPreviewNameToCmdIdMap":{},"nuid":"61e32480-b866-428e-83c4-e26d3b7b218b"},{"version":"CommandV1","origId":215866868972862,"guid":"42b37098-eeb0-4b53-8c85-334d075346e7","subtype":"command","commandType":"auto","position":28.75,"command":"for key in itemUserRatings_dict:\n  itemUserRatings_dict[key]=dict(itemUserRatings_dict[key])\nitemUserRatings_dict[\"35234\"][\"3631\"]","commandVersion":0,"state":"finished","results":{"type":"html","data":"<div class=\"ansiout\"><span class=\"ansired\">Out[</span><span class=\"ansired\">32</span><span class=\"ansired\">]: </span>7\n</div>","arguments":{},"addedWidgets":{},"removedWidgets":[],"datasetInfos":[]},"errorSummary":"Command skipped","error":null,"workflows":[],"startTime":1495266948124,"submitTime":1495266853436,"finishTime":1495266948260,"collapsed":false,"bindings":{},"inputWidgets":{},"displayType":"table","width":"auto","height":"auto","xColumns":null,"yColumns":null,"pivotColumns":null,"pivotAggregation":null,"customPlotOptions":{},"commentThread":[],"commentsVisible":false,"parentHierarchy":[],"diffInserts":[],"diffDeletes":[],"globalVars":{},"latestUser":"amarildolikmeta@gmail.com","latestUserId":null,"commandTitle":"","showCommandTitle":false,"hideCommandCode":false,"hideCommandResult":false,"iPythonMetadata":null,"streamStates":{},"datasetPreviewNameToCmdIdMap":{},"nuid":"87fcef4e-6f9f-4fe7-bb57-749f76d347be"},{"version":"CommandV1","origId":215866868972863,"guid":"1fa13ddf-0a37-429d-bb64-a6addf586177","subtype":"command","commandType":"auto","position":28.875,"command":"itemUserRatings2=sqlContext.sql(\"Select itemId, userId, rating from train \").rdd.map(lambda x:(str(x[0]),[(str(x[1]))])).reduceByKey(lambda x,y:x+y)\nitemUserRatings2.take(5)","commandVersion":0,"state":"finished","results":{"type":"html","data":"<div class=\"ansiout\"><span class=\"ansired\">Out[</span><span class=\"ansired\">33</span><span class=\"ansired\">]: </span>\n[(&apos;35236&apos;, [&apos;7615&apos;]),\n (&apos;35182&apos;, [&apos;402&apos;, &apos;1325&apos;, &apos;4813&apos;, &apos;7287&apos;, &apos;7316&apos;, &apos;8406&apos;, &apos;9090&apos;]),\n (&apos;35234&apos;, [&apos;3631&apos;, &apos;6479&apos;]),\n (&apos;35232&apos;, [&apos;3502&apos;]),\n (&apos;4446&apos;, [&apos;1022&apos;, &apos;13361&apos;])]\n</div>","arguments":{},"addedWidgets":{},"removedWidgets":[],"datasetInfos":[]},"errorSummary":"Command skipped","error":null,"workflows":[],"startTime":1495266948266,"submitTime":1495266853483,"finishTime":1495266949977,"collapsed":false,"bindings":{},"inputWidgets":{},"displayType":"table","width":"auto","height":"auto","xColumns":null,"yColumns":null,"pivotColumns":null,"pivotAggregation":null,"customPlotOptions":{},"commentThread":[],"commentsVisible":false,"parentHierarchy":[],"diffInserts":[],"diffDeletes":[],"globalVars":{},"latestUser":"amarildolikmeta@gmail.com","latestUserId":null,"commandTitle":"","showCommandTitle":false,"hideCommandCode":false,"hideCommandResult":false,"iPythonMetadata":null,"streamStates":{},"datasetPreviewNameToCmdIdMap":{},"nuid":"c9931589-c987-4213-8e8b-bdd948197f4d"},{"version":"CommandV1","origId":215866868972864,"guid":"d2ac281a-770d-4b86-af7c-5322eca08ae4","subtype":"command","commandType":"auto","position":30.0,"command":"itemRatingSimilarity(14,15)","commandVersion":0,"state":"finished","results":{"type":"html","data":"<div class=\"ansiout\"><span class=\"ansired\">Out[</span><span class=\"ansired\">36</span><span class=\"ansired\">]: </span>0\n</div>","arguments":{},"addedWidgets":{},"removedWidgets":[],"datasetInfos":[]},"errorSummary":"Command skipped","error":null,"workflows":[],"startTime":1495266950377,"submitTime":1495266853659,"finishTime":1495266950416,"collapsed":false,"bindings":{},"inputWidgets":{},"displayType":"table","width":"auto","height":"auto","xColumns":null,"yColumns":null,"pivotColumns":null,"pivotAggregation":null,"customPlotOptions":{},"commentThread":[],"commentsVisible":false,"parentHierarchy":[],"diffInserts":[],"diffDeletes":[],"globalVars":{},"latestUser":"amarildolikmeta@gmail.com","latestUserId":null,"commandTitle":"","showCommandTitle":false,"hideCommandCode":false,"hideCommandResult":false,"iPythonMetadata":null,"streamStates":{},"datasetPreviewNameToCmdIdMap":{},"nuid":"b14e2808-01e0-4d51-9f18-440ac7c8faea"},{"version":"CommandV1","origId":215866868972865,"guid":"382673cc-06e9-4bde-bf3e-37046aa2e0f8","subtype":"command","commandType":"auto","position":31.0,"command":"def getNSimilarItems(item,user,n):\n  similar=[]\n  for i in userRatingsList_dict[user]:\n    if i!=item:\n      similarity=itemRatingSimilarity(item,i)\n      if similarity!=0:\n        similar.append((str(i),similarity))\n  similar=sorted(similar,key=lambda tup: tup[1],reverse=True)\n  if len(similar)>n:\n    return similar[0:n]\n  else:\n    return similar","commandVersion":0,"state":"finished","results":{"type":"html","data":"<div class=\"ansiout\"></div>","arguments":{},"addedWidgets":{},"removedWidgets":[],"datasetInfos":[]},"errorSummary":"Command skipped","error":null,"workflows":[],"startTime":1495266950421,"submitTime":1495266853705,"finishTime":1495266950446,"collapsed":false,"bindings":{},"inputWidgets":{},"displayType":"table","width":"auto","height":"auto","xColumns":null,"yColumns":null,"pivotColumns":null,"pivotAggregation":null,"customPlotOptions":{},"commentThread":[],"commentsVisible":false,"parentHierarchy":[],"diffInserts":[],"diffDeletes":[],"globalVars":{},"latestUser":"amarildolikmeta@gmail.com","latestUserId":null,"commandTitle":"","showCommandTitle":false,"hideCommandCode":false,"hideCommandResult":false,"iPythonMetadata":null,"streamStates":{},"datasetPreviewNameToCmdIdMap":{},"nuid":"3313cea6-3ead-4ab7-8e52-5cd4576d7623"},{"version":"CommandV1","origId":215866868972866,"guid":"31ac5b86-0d00-4aa6-9a96-495ad021a866","subtype":"command","commandType":"auto","position":28.9375,"command":"itemRaters_dict=itemUserRatings2.collectAsMap()","commandVersion":0,"state":"finished","results":{"type":"html","data":"<div class=\"ansiout\"></div>","arguments":{},"addedWidgets":{},"removedWidgets":[],"datasetInfos":[]},"errorSummary":"Command skipped","error":null,"workflows":[],"startTime":1495266949983,"submitTime":1495266853552,"finishTime":1495266950329,"collapsed":false,"bindings":{},"inputWidgets":{},"displayType":"table","width":"auto","height":"auto","xColumns":null,"yColumns":null,"pivotColumns":null,"pivotAggregation":null,"customPlotOptions":{},"commentThread":[],"commentsVisible":false,"parentHierarchy":[],"diffInserts":[],"diffDeletes":[],"globalVars":{},"latestUser":"amarildolikmeta@gmail.com","latestUserId":null,"commandTitle":"","showCommandTitle":false,"hideCommandCode":false,"hideCommandResult":false,"iPythonMetadata":null,"streamStates":{},"datasetPreviewNameToCmdIdMap":{},"nuid":"0557cf3b-42da-4dd1-b4d2-a1278d1193ad"},{"version":"CommandV1","origId":215866868972867,"guid":"6760b543-c8ba-40d9-98d8-778e89a2b5cd","subtype":"command","commandType":"auto","position":32.0,"command":"def itemBasedCollaborative(userId):\n  userId=str(userId)\n  seenItems=userRatingsList_dict[userId]\n  recomendedItems=[]\n  for item in itemList:\n    if item not in seenItems:\n      similar=getNSimilarItems(item,userId,50)\n      nominator=denominator=0\n      for tup in similar:\n        nominator=nominator+userRatings_dict[userId][str(tup[0])]*float(tup[1])\n        denominator=denominator+float(tup[1])\n      if denominator!=0:  \n        recomendedItems.append((item,nominator/denominator))\n  recomendedItems=sorted(recomendedItems,key=lambda tup: tup[1],reverse=True)\n  recomendedItems=[ seq[0] for seq in recomendedItems ]\n  return [userId,recomendedItems[0:numberOfItemsToRecommend]]","commandVersion":0,"state":"finished","results":{"type":"html","data":"<div class=\"ansiout\"></div>","arguments":{},"addedWidgets":{},"removedWidgets":[],"datasetInfos":[]},"errorSummary":"Command skipped","error":null,"workflows":[],"startTime":1495266950476,"submitTime":1495266853858,"finishTime":1495266950519,"collapsed":false,"bindings":{},"inputWidgets":{},"displayType":"table","width":"auto","height":"auto","xColumns":null,"yColumns":null,"pivotColumns":null,"pivotAggregation":null,"customPlotOptions":{},"commentThread":[],"commentsVisible":false,"parentHierarchy":[],"diffInserts":[],"diffDeletes":[],"globalVars":{},"latestUser":"amarildolikmeta@gmail.com","latestUserId":null,"commandTitle":"","showCommandTitle":false,"hideCommandCode":false,"hideCommandResult":false,"iPythonMetadata":null,"streamStates":{},"datasetPreviewNameToCmdIdMap":{},"nuid":"0d92462a-0c9a-46da-9aea-3658ce9c6909"},{"version":"CommandV1","origId":215866868972869,"guid":"d245ea19-de63-445e-902f-c28889387cbc","subtype":"command","commandType":"auto","position":33.0,"command":"itemBasedCollaborative(\"4\")","commandVersion":0,"state":"finished","results":{"type":"html","data":"<div class=\"ansiout\"><span class=\"ansired\">Out[</span><span class=\"ansired\">40</span><span class=\"ansired\">]: </span>[&apos;4&apos;, [u&apos;26621&apos;, u&apos;22330&apos;, u&apos;33175&apos;, u&apos;6595&apos;, u&apos;1729&apos;]]\n</div>","arguments":{},"addedWidgets":{},"removedWidgets":[],"datasetInfos":[]},"errorSummary":"Command skipped","error":null,"workflows":[],"startTime":1495266950525,"submitTime":1495266853915,"finishTime":1495266951486,"collapsed":false,"bindings":{},"inputWidgets":{},"displayType":"table","width":"auto","height":"auto","xColumns":null,"yColumns":null,"pivotColumns":null,"pivotAggregation":null,"customPlotOptions":{},"commentThread":[],"commentsVisible":false,"parentHierarchy":[],"diffInserts":[],"diffDeletes":[],"globalVars":{},"latestUser":"amarildolikmeta@gmail.com","latestUserId":null,"commandTitle":"","showCommandTitle":false,"hideCommandCode":false,"hideCommandResult":false,"iPythonMetadata":null,"streamStates":{},"datasetPreviewNameToCmdIdMap":{},"nuid":"08f778ed-d621-469c-8d3d-86c2938a72b3"},{"version":"CommandV1","origId":215866868972870,"guid":"fca81cf7-f4da-4ee5-9d0a-af9e6b27127c","subtype":"command","commandType":"auto","position":34.0,"command":"recomendationsItemCollaborative=sc.parallelize(testList.toLocalIterator()).map(itemBasedCollaborative).collect()","commandVersion":0,"state":"error","results":null,"errorSummary":"Cancelled","error":null,"workflows":[],"startTime":1495266853968,"submitTime":1495266853968,"finishTime":1495266962330,"collapsed":false,"bindings":{},"inputWidgets":{},"displayType":"table","width":"auto","height":"auto","xColumns":null,"yColumns":null,"pivotColumns":null,"pivotAggregation":null,"customPlotOptions":{},"commentThread":[],"commentsVisible":false,"parentHierarchy":[],"diffInserts":[],"diffDeletes":[],"globalVars":{},"latestUser":"amarildolikmeta@gmail.com","latestUserId":null,"commandTitle":"","showCommandTitle":false,"hideCommandCode":false,"hideCommandResult":false,"iPythonMetadata":null,"streamStates":{},"datasetPreviewNameToCmdIdMap":{},"nuid":"e3f0b42a-f169-473c-a87b-c3d4b8b77cb4"},{"version":"CommandV1","origId":215866868972871,"guid":"f7d04ee9-614e-4584-a35b-ac7b69f779db","subtype":"command","commandType":"auto","position":31.75,"command":"numRatings_dict[\"14632\"]","commandVersion":0,"state":"finished","results":{"type":"html","data":"<div class=\"ansiout\"><span class=\"ansired\">Out[</span><span class=\"ansired\">38</span><span class=\"ansired\">]: </span>1695\n</div>","arguments":{},"addedWidgets":{},"removedWidgets":[],"datasetInfos":[]},"errorSummary":"Command skipped","error":null,"workflows":[],"startTime":1495266950452,"submitTime":1495266853770,"finishTime":1495266950469,"collapsed":false,"bindings":{},"inputWidgets":{},"displayType":"table","width":"auto","height":"auto","xColumns":null,"yColumns":null,"pivotColumns":null,"pivotAggregation":null,"customPlotOptions":{},"commentThread":[],"commentsVisible":false,"parentHierarchy":[],"diffInserts":[],"diffDeletes":[],"globalVars":{},"latestUser":"amarildolikmeta@gmail.com","latestUserId":null,"commandTitle":"","showCommandTitle":false,"hideCommandCode":false,"hideCommandResult":false,"iPythonMetadata":null,"streamStates":{},"datasetPreviewNameToCmdIdMap":{},"nuid":"e5ab0295-3fc9-49c0-9f91-1a98c5c62041"},{"version":"CommandV1","origId":215866868972874,"guid":"81d16459-b47c-46f8-9af3-434188799e76","subtype":"command","commandType":"auto","position":35.0,"command":"recomendations=recomendationsItemCollaborative\nusers=[]\nrecs=[]\n\nfor i in xrange(len(recomendations)):\n  try:\n    users.append([recomendations[i][0],str(recomendations[i][1][0])+\" \"+str(recomendations[i][1][1])+\" \"+str(recomendations[i][1][2])+\" \"+str(recomendations[i][1][3])+\" \"+str(recomendations[i][1][4])])\n  except:\n    print recomendations[i] \n    print i\n  recs.append(recomendations[i][1])","commandVersion":0,"state":"error","results":null,"errorSummary":"<span class=\"ansired\">NameError</span>: name &apos;recomendationsItemCollaborative&apos; is not defined","error":"<div class=\"ansiout\"><span class=\"ansired\">---------------------------------------------------------------------------</span>\n<span class=\"ansired\">NameError</span>                                 Traceback (most recent call last)\n<span class=\"ansigreen\">&lt;ipython-input-42-341703b246ef&gt;</span> in <span class=\"ansicyan\">&lt;module&gt;</span><span class=\"ansiblue\">()</span>\n<span class=\"ansigreen\">----&gt; 1</span><span class=\"ansiyellow\"> </span>recomendations<span class=\"ansiyellow\">=</span>recomendationsItemCollaborative<span class=\"ansiyellow\"></span>\n<span class=\"ansigreen\">      2</span> users<span class=\"ansiyellow\">=</span><span class=\"ansiyellow\">[</span><span class=\"ansiyellow\">]</span><span class=\"ansiyellow\"></span>\n<span class=\"ansigreen\">      3</span> recs<span class=\"ansiyellow\">=</span><span class=\"ansiyellow\">[</span><span class=\"ansiyellow\">]</span><span class=\"ansiyellow\"></span>\n<span class=\"ansigreen\">      4</span> <span class=\"ansiyellow\"></span>\n<span class=\"ansigreen\">      5</span> <span class=\"ansigreen\">for</span> i <span class=\"ansigreen\">in</span> xrange<span class=\"ansiyellow\">(</span>len<span class=\"ansiyellow\">(</span>recomendations<span class=\"ansiyellow\">)</span><span class=\"ansiyellow\">)</span><span class=\"ansiyellow\">:</span><span class=\"ansiyellow\"></span>\n\n<span class=\"ansired\">NameError</span>: name &apos;recomendationsItemCollaborative&apos; is not defined\n</div>","workflows":[],"startTime":1495266854043,"submitTime":1495266854043,"finishTime":1495266962450,"collapsed":false,"bindings":{},"inputWidgets":{},"displayType":"table","width":"auto","height":"auto","xColumns":null,"yColumns":null,"pivotColumns":null,"pivotAggregation":null,"customPlotOptions":{},"commentThread":[],"commentsVisible":false,"parentHierarchy":[],"diffInserts":[],"diffDeletes":[],"globalVars":{},"latestUser":"amarildolikmeta@gmail.com","latestUserId":null,"commandTitle":"","showCommandTitle":false,"hideCommandCode":false,"hideCommandResult":false,"iPythonMetadata":null,"streamStates":{},"datasetPreviewNameToCmdIdMap":{},"nuid":"5f5d7ee4-e559-433d-9634-8397b1bb0917"},{"version":"CommandV1","origId":215866868972875,"guid":"3e2021ba-db3d-44fa-8a54-5bacb7bd1c36","subtype":"command","commandType":"auto","position":36.0,"command":"df=pd.DataFrame(data=users  # values\n                      # 1st column as index\n                    )\ndisplay(sqlContext.createDataFrame(df))","commandVersion":0,"state":"error","results":null,"errorSummary":"<span class=\"ansired\">NameError</span>: name &apos;users&apos; is not defined","error":"<div class=\"ansiout\"><span class=\"ansired\">---------------------------------------------------------------------------</span>\n<span class=\"ansired\">NameError</span>                                 Traceback (most recent call last)\n<span class=\"ansigreen\">&lt;ipython-input-44-40026eb1d2b6&gt;</span> in <span class=\"ansicyan\">&lt;module&gt;</span><span class=\"ansiblue\">()</span>\n<span class=\"ansigreen\">----&gt; 1</span><span class=\"ansiyellow\"> df=pd.DataFrame(data=users  # values\n</span><span class=\"ansigreen\">      2</span>                       <span class=\"ansired\"># 1st column as index</span><span class=\"ansiyellow\"></span><span class=\"ansiyellow\"></span>\n<span class=\"ansigreen\">      3</span>                     )\n<span class=\"ansigreen\">      4</span> display<span class=\"ansiyellow\">(</span>sqlContext<span class=\"ansiyellow\">.</span>createDataFrame<span class=\"ansiyellow\">(</span>df<span class=\"ansiyellow\">)</span><span class=\"ansiyellow\">)</span><span class=\"ansiyellow\"></span>\n\n<span class=\"ansired\">NameError</span>: name &apos;users&apos; is not defined\n</div>","workflows":[],"startTime":1495266854193,"submitTime":1495266854193,"finishTime":1495266962686,"collapsed":false,"bindings":{},"inputWidgets":{},"displayType":"table","width":"auto","height":"auto","xColumns":null,"yColumns":null,"pivotColumns":null,"pivotAggregation":null,"customPlotOptions":{},"commentThread":[],"commentsVisible":false,"parentHierarchy":[],"diffInserts":[],"diffDeletes":[],"globalVars":{},"latestUser":"amarildolikmeta@gmail.com","latestUserId":null,"commandTitle":"","showCommandTitle":false,"hideCommandCode":false,"hideCommandResult":false,"iPythonMetadata":null,"streamStates":{},"datasetPreviewNameToCmdIdMap":{},"nuid":"63c96549-c14f-4666-94a8-388581ca9bd2"},{"version":"CommandV1","origId":215866868972876,"guid":"7f54ebd4-533c-4128-b8a8-d90c8e19333b","subtype":"command","commandType":"auto","position":37.0,"command":"def Hybrid(userId):\n  userId=str(userId)\n  if numRatings_dict[userId]>400:\n    return itemBasedCollaborative(userId)\n  else:\n    return ContentFiltering(userId)\n  ","commandVersion":0,"state":"finished","results":{"type":"html","data":"<div class=\"ansiout\"></div>","arguments":{},"addedWidgets":{},"removedWidgets":[],"datasetInfos":[]},"errorSummary":"Command skipped","error":null,"workflows":[],"startTime":1495266965007,"submitTime":1495266854304,"finishTime":1495266965079,"collapsed":false,"bindings":{},"inputWidgets":{},"displayType":"table","width":"auto","height":"auto","xColumns":null,"yColumns":null,"pivotColumns":null,"pivotAggregation":null,"customPlotOptions":{},"commentThread":[],"commentsVisible":false,"parentHierarchy":[],"diffInserts":[],"diffDeletes":[],"globalVars":{},"latestUser":"amarildolikmeta@gmail.com","latestUserId":null,"commandTitle":"","showCommandTitle":false,"hideCommandCode":false,"hideCommandResult":false,"iPythonMetadata":null,"streamStates":{},"datasetPreviewNameToCmdIdMap":{},"nuid":"60f5f0e4-07e4-4650-82aa-18df8713b92d"},{"version":"CommandV1","origId":215866868972877,"guid":"7c8cce52-1c01-4705-a034-0bef74dbbe83","subtype":"command","commandType":"auto","position":35.5,"command":"recomendationsItemCollaborative[2590]=recommendTopRated(\"9503\")","commandVersion":0,"state":"error","results":null,"errorSummary":"<span class=\"ansired\">NameError</span>: name &apos;recomendationsItemCollaborative&apos; is not defined","error":"<div class=\"ansiout\"><span class=\"ansired\">---------------------------------------------------------------------------</span>\n<span class=\"ansired\">NameError</span>                                 Traceback (most recent call last)\n<span class=\"ansigreen\">&lt;ipython-input-43-0409e0ca972b&gt;</span> in <span class=\"ansicyan\">&lt;module&gt;</span><span class=\"ansiblue\">()</span>\n<span class=\"ansigreen\">----&gt; 1</span><span class=\"ansiyellow\"> </span>recomendationsItemCollaborative<span class=\"ansiyellow\">[</span><span class=\"ansicyan\">2590</span><span class=\"ansiyellow\">]</span><span class=\"ansiyellow\">=</span>recommendTopRated<span class=\"ansiyellow\">(</span><span class=\"ansiblue\">&quot;9503&quot;</span><span class=\"ansiyellow\">)</span><span class=\"ansiyellow\"></span>\n\n<span class=\"ansired\">NameError</span>: name &apos;recomendationsItemCollaborative&apos; is not defined\n</div>","workflows":[],"startTime":1495266854115,"submitTime":1495266854115,"finishTime":1495266962597,"collapsed":false,"bindings":{},"inputWidgets":{},"displayType":"table","width":"auto","height":"auto","xColumns":null,"yColumns":null,"pivotColumns":null,"pivotAggregation":null,"customPlotOptions":{},"commentThread":[],"commentsVisible":false,"parentHierarchy":[],"diffInserts":[],"diffDeletes":[],"globalVars":{},"latestUser":"amarildolikmeta@gmail.com","latestUserId":null,"commandTitle":"","showCommandTitle":false,"hideCommandCode":false,"hideCommandResult":false,"iPythonMetadata":null,"streamStates":{},"datasetPreviewNameToCmdIdMap":{},"nuid":"ada97267-422e-4b0e-bb5a-4b32ae5d0d18"},{"version":"CommandV1","origId":215866868972878,"guid":"580c4688-67e9-41c0-9376-72258c94f236","subtype":"command","commandType":"auto","position":26.5,"command":"def getSimilarItems(user,item):\n  rating=userRatings_dict[user][item]\n  similar=[]\n  for i in featuredItemsList:\n    if i!=item:\n      similarity=itemSimilarity(item,i)\n      rate=similarity*rating\n      if rate!=0:\n        similar.append((str(i),rate))\n  similar = sorted(similar, key=lambda tup: tup[1],reverse=True)\n  if len(similar)>5:\n    return similar[0:5]\n  else:\n    return similar","commandVersion":0,"state":"finished","results":{"type":"html","data":"<div class=\"ansiout\"></div>","arguments":{},"addedWidgets":{},"removedWidgets":[],"datasetInfos":[]},"errorSummary":"Command skipped","error":null,"workflows":[],"startTime":1495266945831,"submitTime":1495266853176,"finishTime":1495266945878,"collapsed":false,"bindings":{},"inputWidgets":{},"displayType":"table","width":"auto","height":"auto","xColumns":null,"yColumns":null,"pivotColumns":null,"pivotAggregation":null,"customPlotOptions":{},"commentThread":[],"commentsVisible":false,"parentHierarchy":[],"diffInserts":[],"diffDeletes":[],"globalVars":{},"latestUser":"amarildolikmeta@gmail.com","latestUserId":null,"commandTitle":"","showCommandTitle":false,"hideCommandCode":false,"hideCommandResult":false,"iPythonMetadata":null,"streamStates":{},"datasetPreviewNameToCmdIdMap":{},"nuid":"65672fd5-b8e1-4734-b335-7b769f83307a"},{"version":"CommandV1","origId":215866868972879,"guid":"02eccf30-d5b3-4583-b0f6-5af59741bb71","subtype":"command","commandType":"auto","position":31.875,"command":"","commandVersion":0,"state":"finished","results":null,"errorSummary":null,"error":null,"workflows":[],"startTime":0,"submitTime":0,"finishTime":0,"collapsed":false,"bindings":{},"inputWidgets":{},"displayType":"table","width":"auto","height":"auto","xColumns":null,"yColumns":null,"pivotColumns":null,"pivotAggregation":null,"customPlotOptions":{},"commentThread":[],"commentsVisible":false,"parentHierarchy":[],"diffInserts":[],"diffDeletes":[],"globalVars":{},"latestUser":"","latestUserId":null,"commandTitle":"","showCommandTitle":false,"hideCommandCode":false,"hideCommandResult":false,"iPythonMetadata":null,"streamStates":{},"datasetPreviewNameToCmdIdMap":{},"nuid":"3b27fb7c-5e0e-4658-9c26-6b9670c45eb4"},{"version":"CommandV1","origId":215866868972880,"guid":"79ede7c4-de28-463b-874f-e0596a54eaee","subtype":"command","commandType":"auto","position":26.25,"command":"from scipy import spatial\n\ndef itemSimilarity(item1,item2):\n  try :\n    featuresItems1=set(features_dict[item1])\n    featuresItems2=set(features_dict[item2])\n    totalFeatures=featuresItems1|featuresItems2\n    features1=np.zeros(len(totalFeatures))\n    features2=np.zeros(len(totalFeatures))\n    totalFeatures=list(totalFeatures)\n    if len(totalFeatures)==0:\n      return 0\n    for i in xrange(len(totalFeatures)):\n      if totalFeatures[i] in features_dict[item1]:\n        features1[i]=1\n      else:\n        features1[i]=0\n      if  totalFeatures[i] in features_dict[item2]:\n        features2[i]=1\n      else:\n        features2[i]=0\n    number_of_features=len(totalFeatures)\n    return 1-  spatial.distance.cosine(features1, features2)\n  except:\n    return 0","commandVersion":0,"state":"finished","results":{"type":"html","data":"<div class=\"ansiout\"></div>","arguments":{},"addedWidgets":{},"removedWidgets":[],"datasetInfos":[]},"errorSummary":"Command skipped","error":null,"workflows":[],"startTime":1495266945785,"submitTime":1495266853111,"finishTime":1495266945825,"collapsed":false,"bindings":{},"inputWidgets":{},"displayType":"table","width":"auto","height":"auto","xColumns":null,"yColumns":null,"pivotColumns":null,"pivotAggregation":null,"customPlotOptions":{},"commentThread":[],"commentsVisible":false,"parentHierarchy":[],"diffInserts":[],"diffDeletes":[],"globalVars":{},"latestUser":"amarildolikmeta@gmail.com","latestUserId":null,"commandTitle":"","showCommandTitle":false,"hideCommandCode":false,"hideCommandResult":false,"iPythonMetadata":null,"streamStates":{},"datasetPreviewNameToCmdIdMap":{},"nuid":"f9c77072-e682-4589-b673-5c9ec4265207"},{"version":"CommandV1","origId":215866868972881,"guid":"ab318518-f7c0-4d25-8bdb-b44b35852007","subtype":"command","commandType":"auto","position":38.0,"command":"recomendationsHybrid=sc.parallelize(testList.toLocalIterator()).map(Hybrid).collect()","commandVersion":0,"state":"finished","results":{"type":"html","data":"<div class=\"ansiout\"></div>","arguments":{},"addedWidgets":{},"removedWidgets":[],"datasetInfos":[]},"errorSummary":"Command skipped","error":null,"workflows":[],"startTime":1495266969863,"submitTime":1495266854409,"finishTime":1495289537054,"collapsed":false,"bindings":{},"inputWidgets":{},"displayType":"table","width":"auto","height":"auto","xColumns":null,"yColumns":null,"pivotColumns":null,"pivotAggregation":null,"customPlotOptions":{},"commentThread":[],"commentsVisible":false,"parentHierarchy":[],"diffInserts":[],"diffDeletes":[],"globalVars":{},"latestUser":"amarildolikmeta@gmail.com","latestUserId":null,"commandTitle":"","showCommandTitle":false,"hideCommandCode":false,"hideCommandResult":false,"iPythonMetadata":null,"streamStates":{},"datasetPreviewNameToCmdIdMap":{},"nuid":"d48fbe07-5b83-4b32-bea7-0c7faa67b7ba"},{"version":"CommandV1","origId":215866868972882,"guid":"5715d9b3-4f5d-4d7e-a9e2-761c1dda6a8e","subtype":"command","commandType":"auto","position":39.0,"command":"recomendations=recomendationsHybrid\nusers=[]\nrecs=[]\n\nfor i in xrange(len(recomendations)):\n  try:\n    users.append([recomendations[i][0],str(recomendations[i][1][0])+\" \"+str(recomendations[i][1][1])+\" \"+str(recomendations[i][1][2])+\" \"+str(recomendations[i][1][3])+\" \"+str(recomendations[i][1][4])])\n  except:\n    recomendations[i] =recommendTopRated(recomendations[i][0])\n    \n  recs.append(recomendations[i][1])","commandVersion":0,"state":"finished","results":{"type":"html","data":"<div class=\"ansiout\"></div>","arguments":{},"addedWidgets":{},"removedWidgets":[],"datasetInfos":[]},"errorSummary":null,"error":null,"workflows":[],"startTime":1495294676460,"submitTime":1495294676455,"finishTime":1495294676583,"collapsed":false,"bindings":{},"inputWidgets":{},"displayType":"table","width":"auto","height":"auto","xColumns":null,"yColumns":null,"pivotColumns":null,"pivotAggregation":null,"customPlotOptions":{},"commentThread":[],"commentsVisible":false,"parentHierarchy":[],"diffInserts":[],"diffDeletes":[],"globalVars":{},"latestUser":"amarildolikmeta@gmail.com","latestUserId":null,"commandTitle":"","showCommandTitle":false,"hideCommandCode":false,"hideCommandResult":false,"iPythonMetadata":null,"streamStates":{},"datasetPreviewNameToCmdIdMap":{},"nuid":"6b3d9b0a-b44f-4623-8aed-b2d18c1d20e5"},{"version":"CommandV1","origId":215866868972883,"guid":"bdc11cc0-0fb7-4a65-ae2c-4995d0a2d65c","subtype":"command","commandType":"auto","position":37.5,"command":"Hybrid(\"4\")","commandVersion":0,"state":"finished","results":{"type":"html","data":"<div class=\"ansiout\"><span class=\"ansired\">Out[</span><span class=\"ansired\">47</span><span class=\"ansired\">]: </span>[&apos;4&apos;, [&apos;34238&apos;, &apos;16839&apos;, &apos;5457&apos;, &apos;10465&apos;, &apos;35470&apos;]]\n</div>","arguments":{},"addedWidgets":{},"removedWidgets":[],"datasetInfos":[]},"errorSummary":"Command skipped","error":null,"workflows":[],"startTime":1495266965084,"submitTime":1495266854351,"finishTime":1495266969858,"collapsed":false,"bindings":{},"inputWidgets":{},"displayType":"table","width":"auto","height":"auto","xColumns":null,"yColumns":null,"pivotColumns":null,"pivotAggregation":null,"customPlotOptions":{},"commentThread":[],"commentsVisible":false,"parentHierarchy":[],"diffInserts":[],"diffDeletes":[],"globalVars":{},"latestUser":"amarildolikmeta@gmail.com","latestUserId":null,"commandTitle":"","showCommandTitle":false,"hideCommandCode":false,"hideCommandResult":false,"iPythonMetadata":null,"streamStates":{},"datasetPreviewNameToCmdIdMap":{},"nuid":"4bc8bb19-06b4-4252-9c0c-50acf732f785"},{"version":"CommandV1","origId":2502345787138477,"guid":"8597a0d2-5266-4aa2-ae79-c674e111ca20","subtype":"command","commandType":"auto","position":40.0,"command":"df=pd.DataFrame(data=users,  # values\n                   columns=[\"userId\",\"RecommendedItemIds\"]   # 1st column as index\n                    )\ndisplay(sqlContext.createDataFrame(df))","commandVersion":0,"state":"finished","results":{"type":"table","data":[["4","34238 16839 5457 10465 35470"],["5","32202 1269 2762 10 12858"],["8","8134 34238 16839 5457 10465"],["9","30287 18351 15994 1265 30468"],["13","29640 4850 19462 29875 36076"],["18","1448 18741 8877 24547 17207"],["19","36535 33143 36646 11054 7474"],["23","33562 36285 11592 30610 1233"],["26","13069 8245 27901 10936 3783"],["29","24217 19270 7716 1041 31496"],["31","35251 22010 17126 10963 37115"],["32","35399 25987 15112 12304 7351"],["33","28831 27435 2243 26844 20047"],["35","36350 20799 21884 34685 12028"],["37","26550 4431 832 4032 9432"],["51","20941 15973 24547 23336 33215"],["52","28294 29037 4644 1452 5453"],["53","17925 29833 23282 4708 18678"],["54","8840 28676 36501 37118 35355"],["61","4037 36748 17866 22888 27719"],["64","15973 8216 33266 33215 32287"],["69","12530 19977 29408 22248 31311"],["76","36163 6942 36646 11054 7474"],["78","3694 5732 1548 385 35626"],["79","10734 2134 34255 4256 4860"],["85","31484 8376 21388 17645 876"],["89","21157 20454 2255 8455 25455"],["92","18351 15994 31046 34853 29866"],["93","14738 28831 27435 2243 26844"],["95","32692 10123 11806 8648 21899"],["100","20532 12535 35251 22010 11133"],["104","672 7371 10598 13509 29746"],["105","17782 32793 12594 27233 4240"],["109","31484 8376 21388 16004 29046"],["110","9973 1464 15741 5546 4561"],["111","2041 12866 20955 33215 22579"],["112","30053 35378 199 19072 33515"],["122","16451 10094 28927 23579 21604"],["126","1304 7168 24362 25967 16016"],["131","27152 14648 19494 1233 36868"],["132","17555 14644 34835 24250 36904"],["136","12102 21412 20083 16920 6151"],["140","22104 35378 199 25304 35651"],["144","20083 11047 10067 3694 27499"],["145","18439 31345 13040 25777 25832"],["146","21412 8394 3694 5732 1548"],["151","36705 17866 22888 27719 7943"],["152","13302 3164 1783 23244 5463"],["155","17834 26077 26513 10126 10727"],["156","14738 28831 27435 2243 26844"],["160","30234 36238 16278 30555 2157"],["162","33460 16101 35905 10314 5946"],["164","16313 28246 12456 4173 8833"],["165","17834 26077 26513 10126 10727"],["166","7019 1073 14063 5866 25679"],["169","19523 19427 22533 1233 36868"],["173","3584 23081 9576 16659 10410"],["179","20959 37065 31341 2623 2561"],["184","18351 15994 32463 16155 31046"],["185","29885 473 15959 18301 20454"],["186","30265 31601 23949 8336 26808"],["187","17364 2455 31709 6521 24955"],["189","29673 30234 36238 16278 30555"],["190","14063 4966 28831 27435 2243"],["191","14435 3243 29843 37046 22248"],["197","28831 27435 2243 26844 20047"],["205","35738 12362 4431 832 4032"],["208","23453 1233 17659 36868 17872"],["209","27083 8912 34975 34246 10942"],["217","17834 26077 26513 10126 10727"],["218","13069 8245 27901 10936 3783"],["222","14063 4966 33215 16491 18170"],["223","13173 17067 16766 14668 18088"],["234","20941 8216 33266 6623 35046"],["240","1233 14264 36868 17872 19873"],["246","34762 4632 33634 34875 3904"],["247","34762 10334 15221 26283 30593"],["250","25832 32034 30635 10840 21240"],["257","7274 32674 7689 2144 33214"],["258","4632 33634 34875 3904 17705"],["268","26247 12850 13053 17859 31266"],["269","32802 4431 832 4032 9432"],["270","25050 15625 36646 26247 12850"],["274","21884 34685 12028 3077 21505"],["278","20233 12667 15501 24559 21408"],["281","1076 15743 34595 24547 1873"],["288","23267 27930 15194 14605 15888"],["294","35473 30722 11927 11731 19127"],["296","18741 12594 19865 37072 26744"],["299","20680 30804 28831 27435 2243"],["301","32692 10123 11806 36354 1286"],["308","17383 18200 3694 5732 1548"],["310","10944 17321 17794 4431 832"],["312","20237 462 19663 34275 2280"],["314","19523 19427 32903 8833 16835"],["318","4231 11831 35231 36231 34632"],["321","29642 29650 21245 27477 11529"],["326","28347 10461 34246 8847 19248"],["327","17301 6641 37066 30008 30261"],["333","16825 5039 20237 462 19663"],["336","538 23341 13763 1402 14807"],["337","34698 10196 11107 598 28831"],["339","29046 31341 1397 21495 11042"],["344","10460 1882 11487 10903 36530"],["350","14063 4966 30616 36718 29521"],["353","18351 15994 31046 34853 29866"],["355","23843 18755 13963 18437 618"],["359","1017 31129 33757 34238 16839"],["361","7274 32674 7689 2144 33214"],["364","35046 25134 17778 2406 24853"],["365","19322 16107 14227 22579 15678"],["374","33266 20941 15973 9233 2049"],["375","2911 7689 2144 33214 29019"],["376","33215 17641 33048 34358 20583"],["378","17011 18063 17756 10278 27753"],["379","26070 29935 6842 8506 21947"],["380","21884 34685 12028 26585 8476"],["383","3694 5732 1548 385 35626"],["385","16314 10480 22007 34421 23473"],["388","31484 8376 21388 24653 3494"],["390","30234 36238 16278 30555 2157"],["393","33215 2442 5644 17936 366"],["399","15973 8216 5494 21818 1233"],["401","15108 11868 26147 28761 28831"],["405","27083 8912 34975 23833 25529"],["412","29885 473 15959 20454 2255"],["413","2041 1076 15743 20955 16451"],["415","13833 18948 21614 11836 33838"],["418","36535 33143 17041 20233 12667"],["431","34238 16839 5457 10465 35470"],["433","11758 25938 14464 11624 26462"],["441","21799 35378 199 14532 35651"],["443","15973 8216 20454 2255 8455"],["445","29046 21495 31341 1397 26621"],["449","8032 33437 20345 33384 6814"],["456","16452 3273 4885 23938 13985"],["458","25967 23831 34231 233 20055"],["459","30722 11927 14632 19854 18867"],["463","18633 11701 14786 27569 5951"],["466","18351 15994 31046 34853 29866"],["477","36552 11868 26147 30265 26983"],["478","28966 28203 14317 16612 217"],["481","12347 30428 30810 5290 1233"],["487","25936 30234 36238 16278 30555"],["488","26474 16235 17437 14934 4367"],["491","5834 17833 15932 25832 32034"],["494","17851 1710 5512 9740 33758"],["503","33215 5884 28473 35100 27736"],["504","22649 26399 6220 11397 15732"],["508","4431 832 4032 9432 18633"],["509","17067 18088 10133 20139 34751"],["510","20233 12667 15501 24559 21408"],["511","30234 36238 16278 30555 2157"],["516","5578 17782 33215 17641 33048"],["524","30234 36238 16278 30555 2157"],["527","15743 17648 1448 32019 20083"],["531","4231 11831 35231 36231 34632"],["532","14435 3243 29843 37046 22248"],["541","37124 8724 34238 16839 5457"],["542","14738 30722 11927 14632 19854"],["543","31484 8376 21388 24653 3494"],["549","13257 22654 7063 1478 4964"],["551","23336 16803 33215 16687 34602"],["559","19159 28021 33136 12528 18678"],["565","4632 33634 34875 3904 17705"],["568","19523 19427 29623 26247 12850"],["569","22649 26399 6220 29046 31341"],["572","4475 33215 17641 33048 34358"],["582","23453 1233 36868 17872 19873"],["589","27083 8912 34975 23833 32287"],["590","23336 16803 33215 16687 34602"],["592","3224 17659 33904 36716 1118"],["595","34238 16839 5457 10465 35470"],["599","17925 8134 4708 28151 18678"],["600","3067 12456 1489 4431 16632"],["603","20256 14118 36663 3515 6627"],["605","15973 30722 11927 8216 14632"],["606","32287 31107 14372 21434 2238"],["615","14435 3243 29843 37046 22248"],["616","19887 1233 36868 17872 19873"],["617","36122 9519 30539 36922 20433"],["621","27271 20454 2255 8455 25455"],["632","22224 14435 3243 29843 37046"],["643","31830 17881 7467 32105 35344"],["646","2455 31709 6521 24955 17163"],["651","26462 9922 22509 20937 4215"],["652","4228 5508 11727 25187 8245"],["653","25626 34238 16839 5457 10465"],["654","20454 2255 8455 25455 31656"],["658","7250 2882 6365 13403 7689"],["659","25908 32311 22734 18946 26549"],["663","29046 31341 37065 21495 2561"],["665","30234 36238 16278 30555 2157"],["673","14435 3243 29843 37046 22248"],["675","30722 11927 31341 26621 14632"],["680","7274 32674 7689 2144 33214"],["681","17925 4708 28151 18678 11296"],["684","33475 17383 17011 17756 3694"],["691","19683 30234 36238 16278 7716"],["696","33838 26247 12850 13053 17859"],["700","8810 31484 8376 21388 27083"],["705","22029 14435 3243 29843 37046"],["706","7689 2144 33214 29019 13232"],["710","7689 2144 33214 29019 13232"],["712","1076 17648 37065 1448 32019"],["713","37065 29046 21495 31341 26621"],["715","25832 32034 30635 10840 21240"],["717","33672 14435 3243 29843 37046"],["722","4037 36748 2454 6862 22265"],["725","8847 35052 29458 23106 36315"],["729","10467 10091 26518 12321 23926"],["733","7048 8648 21899 27717 1719"],["739","21884 34685 12028 14435 3243"],["741","15743 23949 33475 17383 17648"],["744","4044 34573 5424 16446 17132"],["747","8216 20941 15973 29640 4850"],["750","33215 1464 15741 5546 4561"],["757","21884 34685 12028 14435 3243"],["759","35378 199 33755 14435 3243"],["761","20495 3694 5732 1548 385"],["773","32690 29905 7344 15111 250"],["777","34838 34240 8106 30707 29913"],["780","14055 24547 30234 36238 16278"],["782","9233 2049 1233 36868 17872"],["784","34238 16839 5457 10465 35470"],["787","29046 37065 31341 26621 2623"],["788","33215 17641 33048 34358 20583"],["789","9902 35440 29847 27258 30503"],["791","3598 34238 16839 5457 10465"],["792","17938 20947 24356 2829 4618"],["796","6623 35046 25134 17778 2406"],["801","4431 832 4032 9432 18633"],["806","14063 4966 12941 34238 16839"],["808","36338 22706 17023 7279 11677"],["810","10859 15241 36646 11054 7474"],["813","17925 32879 23282 18678 11296"],["816","24699 6321 7166 3435 29698"],["820","17454 21871 20310 6118 30937"],["826","7951 10040 13715 34238 16839"],["827","9659 603 4037 36748 30156"],["828","15885 29394 20680 30804 4231"],["831","15534 14800 26566 26070 29935"],["833","23267 27930 15194 14605 8833"],["834","12556 2455 31709 6521 24955"],["835","36535 33143 20233 12667 9297"],["839","13257 35378 199 36338 1267"],["850","8245 27901 10936 3783 24987"],["852","28966 2143 8099 16452 3273"],["853","538 23341 13763 1402 14807"],["854","9576 10410 6871 2675 36646"],["857","25626 18351 15994 34238 16839"],["862","12091 29046 26621 31444 37065"],["867","33475 17383 3694 5732 1548"],["869","14435 3243 29843 37046 22248"],["873","25908 32311 22734 18946 26549"],["874","18527 25832 32034 30635 10840"],["879","32793 21884 34685 12028 35061"],["883","22649 26399 6220 32432 31238"],["884","14435 3243 29843 37046 22248"],["886","7274 8759 7689 2144 33214"],["888","1659 13522 34238 16839 5457"],["890","5045 19917 25752 20594 17888"],["899","2854 1544 30170 30493 19710"],["900","15743 26473 17648 2143 14063"],["905","14020 3694 5732 1548 385"],["907","28294 29037 4644 1452 5453"],["908","28634 5585 8833 16835 13838"],["909","35378 199 35651 13281 34903"],["916","10470 3943 26070 29935 6842"],["919","32692 10123 11806 7876 1286"],["926","22465 4431 832 4032 9432"],["927","1304 7168 24362 30230 16016"],["929","14063 4966 26688 841 26041"],["937","23015 30234 36238 16278 30555"],["942","30234 36238 16278 30555 2157"],["944","31526 30234 36238 16278 30555"],["946","7250 2882 6365 13403 19041"],["947","25657 34238 16839 5457 10465"],["949","15241 36646 11054 7474 32680"],["956","1617 29737 14063 4966 25908"],["958","17702 15771 34255 4256 4860"],["961","31924 8833 16835 13838 14439"],["968","30234 36238 16278 30555 2157"],["969","27952 26761 4632 33634 34875"],["972","5045 19917 25752 20594 17888"],["977","28831 27435 2243 26844 20047"],["978","8810 31484 8376 21388 4381"],["979","17383 18200 3694 5732 1548"],["982","31484 8376 21388 2522 24653"],["983","21667 29529 21113 27799 14435"],["987","8648 21899 27717 1719 30339"],["990","31542 13027 16421 32259 17064"],["1005","34238 16839 5457 10465 35470"],["1010","29640 4850 19462 29875 36076"],["1011","14105 19523 19427 17451 35879"],["1014","29046 37065 31341 26621 2623"],["1016","19523 19427 29623 26247 12850"],["1017","8415 20237 462 19663 34275"],["1033","27083 8912 34975 18351 15994"],["1043","33173 33475 1076 35300 15743"],["1044","6666 13594 30234 36238 16278"],["1046","538 23341 13763 1402 14807"],["1055","21884 34685 12028 24547 17207"],["1060","18480 35091 30317 15534 17834"],["1061","14174 28083 21053 29258 20466"],["1067","28602 31427 29037 4644 1452"],["1068","21127 29556 18810 8833 16835"],["1076","34324 28831 27435 2243 26844"],["1077","25832 32034 30635 10840 21240"],["1084","11868 26147 28761 2909 22649"],["1097","29413 8833 16835 13838 14439"],["1102","23453 1233 17659 36868 17872"],["1107","26247 12850 13053 17859 31266"],["1110","7250 2882 6365 13403 31924"],["1112","31506 4231 11831 35231 36231"],["1113","23647 12602 24042 26868 10672"],["1114","26447 32672 31090 18516 21556"],["1117","23453 1060 14264 22329 16560"],["1118","23336 13530 33215 32692 10123"],["1121","25481 9766 14435 3243 29843"],["1122","33215 17641 33048 34358 20583"],["1128","30997 21399 4009 35046 25134"],["1135","31439 8840 28676 36501 37118"],["1136","33562 36285 11592 30610 1233"],["1137","7274 32674 13502 7974 17190"],["1144","5283 28831 27435 2243 26844"],["1145","22346 8833 16835 13838 14439"],["1146","19523 19427 26024 29623 26247"],["1148","19426 16803 17834 26077 26513"],["1151","32573 26447 32672 31090 18516"],["1152","12866 13502 29046 37065 21495"],["1157","17834 26077 26513 10126 10727"],["1159","10098 30938 18108 31788 31932"],["1161","15845 10663 27667 32281 33509"],["1163","21434 2238 8245 19049 31651"],["1165","13173 19127 22976 13502 11707"],["1173","19646 33051 34238 16839 5457"],["1175","30234 36238 16278 30555 2157"],["1177","31484 8376 21388 23453 20673"],["1178","29848 28289 23453 22649 26399"],["1180","17834 26077 26513 10126 10727"],["1181","21412 8394 3694 5732 1548"],["1184","8245 27901 10936 3783 24987"],["1189","4231 11831 35231 36231 34632"],["1190","25908 32311 22734 18946 26549"],["1193","9194 10425 21053 29258 20466"],["1201","30265 12523 13574 19035 6643"],["1204","17834 26077 26513 10126 10727"],["1205","21459 4231 11831 35231 36231"],["1218","3694 5732 1548 385 35626"],["1222","27083 8912 34975 14435 3243"],["1224","36646 11054 7474 32680 9109"],["1229","21884 34685 12028 14762 4833"],["1233","5841 8245 18678 11296 27901"],["1235","34238 16839 5457 10465 35470"],["1236","23070 2964 19767 29321 222"],["1238","22399 34610 20215 36646 11054"],["1240","3958 14111 19543 213 10067"],["1249","30234 36238 16278 30555 2157"],["1256","8245 27901 10936 3783 24987"],["1263","10160 17585 11582 14435 3243"],["1264","30360 27761 28831 27435 2243"],["1279","10149 7406 29640 4850 19462"],["1280","1233 36868 17872 19873 4296"],["1282","28263 19597 1267 30825 29413"],["1289","35811 36599 17821 19683 30234"],["1291","36646 11054 7474 9109 14115"],["1292","34862 21127 29556 18810 8833"],["1297","10016 30354 15732 6960 9630"],["1298","6641 37066 30008 14056 22654"],["1314","4064 23267 27930 15194 14605"],["1316","5866 21796 24070 4739 17454"],["1322","36646 11054 7474 32680 9109"],["1327","17925 23282 18678 11296 23543"],["1333","8833 16835 13838 14439 5646"],["1334","29046 37065 21495 31341 26621"],["1335","9730 26247 12850 13053 17859"],["1336","26462 9922 30234 36238 16278"],["1343","1677 10755 16782 23267 27930"],["1345","35065 23951 30493 24343 16758"],["1346","12102 8394 3694 5732 1548"],["1348","88 11707 14063 4966 33215"],["1356","22706 17023 13683 23100 22509"],["1361","28982 26741 6328 26547 22649"],["1365","7250 2882 6365 13403 20532"],["1373","31484 8376 21388 9237 17193"],["1378","16452 3273 4885 23938 13985"],["1379","19523 19427 29623 26247 12850"],["1387","36248 23188 32591 21884 34685"],["1391","34238 16839 5457 10465 35470"],["1405","34238 16839 5457 10465 35470"],["1406","14020 3694 5732 1548 385"],["1408","5494 21818 1233 36868 17872"],["1416","12748 21884 34685 12028 8509"],["1417","13530 34238 16839 5457 10465"],["1418","18351 15994 3259 31046 34853"],["1420","8833 16835 13838 14439 5646"],["1423","30141 4574 15585 25832 32034"],["1426","2455 31709 6521 24955 17163"],["1428","28831 27435 2243 26844 20047"],["1431","35327 32268 25908 32311 22734"],["1433","6872 28831 27435 2243 26844"],["1436","10149 4527 29640 4850 19462"],["1438","14020 7250 2882 6365 13403"],["1444","25136 5453 22655 23465 18704"],["1445","21840 7933 20454 2255 8455"],["1447","34129 35577 24002 4431 832"],["1452","30539 19077 17233 33244 7851"],["1453","17659 36716 30331 3191 8993"],["1463","34238 16839 5457 10465 35470"],["1470","32353 18351 15994 26247 12850"],["1473","4632 33634 34875 3904 17705"],["1474","20454 2255 8455 25455 31656"],["1476","23951 30493 24343 16758 12170"],["1481","29046 18063 37065 21495 2561"],["1484","19523 19427 29623 26247 12850"],["1486","17925 23282 18678 11296 23543"],["1487","29046 21495 31341 1397 26621"],["1493","9381 22654 7063 1478 4964"],["1501","34238 16839 5457 10465 35470"],["1502","14185 8049 35146 5598 30238"],["1503","3694 5732 1548 385 35626"],["1506","5839 1294 3460 31995 17454"],["1508","1076 15743 1448 32019 14435"],["1509","4475 32793 29673 33215 30234"],["1510","32692 10123 11806 6560 4475"],["1511","20256 14118 36663 3515 6627"],["1516","29037 4644 1452 5453 22655"],["1527","22029 14435 3243 29843 37046"],["1528","31484 8376 21388 24653 3494"],["1538","2455 31709 6521 24955 17163"],["1547","28867 31616 14212 20454 2255"],["1551","27011 21406 17067 20611 33915"],["1555","1617 13284 31830 24143 31360"],["1560","1646 21443 32453 28333 21430"],["1564","33475 17383 30234 36238 16278"],["1572","13073 20499 29527 16534 25368"],["1576","29355 31556 26605 7250 2882"],["1577","23703 16167 16168 988 18337"],["1578","25967 34504 1793 23831 34231"],["1587","25939 14988 12102 21412 7250"],["1588","10461 34246 8847 19248 35052"],["1606","2675 17756 88 17011 33076"],["1607","17925 4708 28151 18678 11296"],["1617","26671 13531 13508 12460 30060"],["1620","31439 8840 28676 36501 37118"],["1624","7250 2882 6365 13403 13502"],["1626","19887 1233 36868 17872 19873"],["1627","30234 36238 16278 30555 2157"],["1635","17782 12594 19865 37072 26744"],["1636","29458 23106 5508 26722 11727"],["1637","34238 16839 5457 10465 35470"],["1638","21884 34685 12028 3694 5732"],["1641","30234 36238 16278 30555 2157"],["1642","37124 14435 3243 29843 37046"],["1643","14063 4966 7451 33838 30234"],["1644","22649 26399 6220 32432 31238"],["1645","38 22865 6775 25832 32034"],["1647","17067 18088 10133 20139 34751"],["1648","18678 11296 23543 11156 758"],["1649","29640 4850 19462 29875 36076"],["1657","4231 11831 35231 36231 34632"],["1658","17834 26077 26513 10126 10727"],["1661","34901 36513 15616 5521 22336"],["1663","27995 8833 16835 13838 14439"],["1664","33215 35378 199 31616 21884"],["1667","10098 18108 31788 34835 8842"],["1670","15108 23788 20955 16451 13726"],["1675","22329 16560 30366 4221 36833"],["1681","34238 16839 5457 10465 35470"],["1684","2455 31709 6521 24955 17163"],["1685","18351 15994 4231 11831 35231"],["1686","19523 19427 29623 26247 12850"],["1693","25832 32034 30635 10840 21240"],["1696","15743 17648 10067 25988 1448"],["1699","2041 20955 16451 13726 27635"],["1707","35486 7876 1464 15741 5546"],["1713","1267 30825 14435 3243 29843"],["1719","6893 24259 27360 25908 32311"],["1723","12587 31512 14029 18720 35328"],["1726","27306 1672 21819 17811 8043"],["1727","4231 11831 35231 36231 34632"],["1728","19426 16803 33215 33439 32692"],["1734","29046 26621 37065 21495 2561"],["1739","17659 36716 30331 3191 8993"],["1740","31484 8376 21388 8833 16835"],["1750","3694 5732 1548 385 35626"],["1756","36248 23188 32591 20233 12667"],["1757","20609 10243 28831 27435 2243"],["1760","35378 199 35651 13281 34903"],["1761","20454 2255 8455 25455 31656"],["1764","26247 12850 13053 17859 31266"],["1765","30234 36238 16278 30555 2157"],["1766","29037 4644 1452 5453 22655"],["1767","29640 4850 19462 29875 36076"],["1768","34901 36513 15616 26401 3017"],["1773","35378 199 35651 23261 13281"],["1782","17911 4410 233 34238 16839"],["1785","7716 4431 832 4032 9432"],["1786","28294 29037 4644 1452 5453"],["1787","24547 19907 33215 31484 8376"],["1788","5045 19917 25752 20594 26473"],["1789","12102 21412 33815 29037 4644"],["1792","17851 1710 5512 9740 33758"],["1796","24130 4620 20237 462 19663"],["1800","31484 8376 21388 16004 8510"],["1803","7566 30234 36238 16278 30555"],["1804","17834 26077 26513 10126 10727"],["1805","6641 27242 24066 37066 12530"],["1806","538 23341 13763 1402 14807"],["1807","10452 2134 30997 21399 4009"],["1808","17834 26077 26513 10126 10727"],["1812","36487 25832 30635 10840 21240"],["1813","16825 8133 15797 26405 27635"],["1816","33912 16451 19718 27083 8912"],["1818","29640 4850 19462 29875 36076"],["1820","14372 15721 4431 832 4032"],["1823","3694 5732 1548 385 35626"],["1827","1076 17648 1448 32019 20083"],["1829","27083 8912 34975 12031 2033"],["1833","16049 16599 19646 33051 15763"],["1845","4431 832 4032 9432 18633"],["1857","21646 20652 32887 5299 24945"],["1858","10685 18393 7464 18337 9939"],["1862","12654 25908 32311 22734 18946"],["1866","13844 2653 20917 12175 9590"],["1874","17067 14435 3243 29843 37046"],["1875","15442 16094 15812 35835 35275"],["1876","26462 9922 37124 14777 36663"],["1879","18301 14435 3243 29843 37046"],["1881","1677 10755 16782 23267 27930"],["1883","2004 14435 3243 29843 37046"],["1885","11408 28831 27435 2243 26844"],["1888","25908 32311 22734 18946 26549"],["1898","17067 18088 10133 20139 34751"],["1899","4231 11831 35231 36231 34632"],["1900","26247 12850 13053 17859 31266"],["1901","4231 11831 35231 36231 34632"],["1906","7250 2882 6365 13403 102"],["1910","27047 18337 9939 29544 3376"],["1911","27635 1233 8245 36868 17872"],["1918","36552 6744 34246 10942 35755"],["1919","17834 26077 26513 10126 19330"],["1920","14738 8877 16511 26407 29640"],["1933","11592 8245 27901 10936 3783"],["1935","3993 9239 17198 1181 22147"],["1936","20454 2255 8455 25455 31656"],["1938","32019 17648 1076 15743 20083"],["1940","18351 15994 16891 35513 31046"],["1941","3392 1619 30234 36238 16278"],["1943","2068 31136 2657 18678 11296"],["1944","1233 36868 17872 19873 1702"],["1945","14264 22329 16560 30366 4221"],["1947","36233 16290 7321 1822 2640"],["1948","23336 21910 16803 26447 32672"],["1950","21884 34685 12028 36811 6296"],["1952","9233 2049 1233 36868 17872"],["1954","8146 36248 14734 32591 20233"],["1955","20233 12667 15501 24559 21408"],["1956","26462 9922 14435 3243 29843"],["1957","4231 11831 35231 36231 34632"],["1963","25454 15973 6641 37066 30008"],["1964","35036 19642 9271 23107 25967"],["1976","1375 33904 1118 31320 26126"],["1977","7484 7689 2144 33214 29019"],["1978","6666 13594 4037 36748 18248"],["1981","1060 32202 15634 34031 12858"],["1985","28831 27435 2243 26844 20047"],["1986","31484 8376 21388 33215 17645"],["1991","9233 2049 29413 1233 36868"],["1993","7250 2882 6365 13403 16659"],["1999","34238 16839 5457 10465 35470"],["2007","3694 5732 1548 385 35626"],["2009","21884 34685 12028 35158 6296"],["2011","17781 16345 7250 2882 6365"],["2013","14063 4966 29640 4850 19462"],["2017","25626 34238 16839 5457 10465"],["2020","28572 4431 832 4032 9432"],["2027","34238 16839 5457 10465 35470"],["2028","14246 23501 34838 34240 26247"],["2037","8488 20884 31646 30234 36238"],["2040","17834 26077 26513 10126 10727"],["2041","28966 35503 14063 4966 34238"],["2042","35046 25134 17778 2406 34762"],["2045","28867 2712 23581 29690 10523"],["2051","12866 35300 7689 2144 33214"],["2052","34238 16839 5457 10465 35470"],["2053","19426 16803 33215 7250 2882"],["2054","21830 2455 31709 6521 24955"],["2058","9233 2049 1233 36868 17872"],["2060","13886 15188 28539 5588 1233"],["2061","4431 832 4032 9432 18633"],["2066","15743 17648 17925 24547 17463"],["2072","35738 12362 4431 832 4032"],["2073","30234 36238 16278 30555 2157"],["2080","1677 10755 16782 23267 27930"],["2081","31223 30234 36238 16278 30555"],["2084","32674 8759 13041 10490 4120"],["2086","22435 25832 32034 30635 10840"],["2090","1677 10755 16782 23267 27930"],["2091","23336 11707 16803 28750 33215"],["2095","23267 27930 15194 14605 30234"],["2097","1455 29276 22680 22357 1967"],["2106","28294 29037 4644 1452 5453"],["2108","35811 4244 8846 35280 26230"],["2117","14738 28831 27435 2243 26844"],["2119","4431 832 4032 9432 18633"],["2121","35738 12362 4431 832 4032"],["2124","5045 19917 25752 20594 104"],["2129","6286 11982 16020 26247 12850"],["2130","21884 34685 12028 3077 21505"],["2132","13041 10490 4120 367 1174"],["2133","29046 26621 37065 21495 2561"],["2135","16864 15907 4995 33826 20413"],["2136","28831 27435 2243 26844 20047"],["2137","6641 37066 30008 14634 15687"],["2146","30104 32692 10123 11806 22693"],["2147","29037 4644 1452 5453 22655"],["2149","22649 26399 6220 32432 31238"],["2155","3584 2143 9607 17893 5045"],["2156","34246 10942 34835 10842 13844"],["2157","30234 36238 16278 30555 2157"],["2164","29413 7167 34838 34240 33904"],["2167","13844 2653 20917 12175 9590"],["2168","31484 8376 21388 5905 24653"],["2179","31433 21590 17664 14063 4966"],["2182","8146 6249 19739 27679 8724"],["2186","4922 28831 27435 2243 26844"],["2195","36192 29190 30493 24343 16758"],["2202","3224 17659 33904 36716 1118"],["2212","35251 22010 23545 11629 37115"],["2227","17851 1710 5512 33758 23184"],["2236","2455 31709 6521 24955 17163"],["2244","17866 22888 27719 7943 26312"],["2247","36646 11054 7474 32680 9109"],["2248","13425 28866 1233 36868 17872"],["2254","18337 9939 29544 3376 15198"],["2257","30997 21399 4009 7689 2144"],["2261","17454 21871 20310 6118 30937"],["2263","25939 32793 30234 36238 16278"],["2265","30267 28150 9556 27971 32245"],["2268","32692 10123 11806 21561 30856"],["2270","8724 30053 33477 33605 22706"],["2272","35378 199 30234 36238 16278"],["2273","14435 3243 29843 37046 22248"],["2274","15165 21177 6322 21385 2719"],["2280","28831 27435 2243 26844 20047"],["2285","30493 24343 16758 12170 30417"],["2287","31484 8376 21388 24653 3494"],["2290","34901 36513 15616 23267 27930"],["2298","15241 36646 11054 7474 32680"],["2305","25444 25908 32311 22734 18946"],["2306","30156 1464 15741 5546 4561"],["2312","13315 17834 26077 26513 10126"],["2313","1076 15743 1448 32019 20083"],["2319","28152 4102 28415 7415 8833"],["2320","14174 28083 3392 4231 11831"],["2324","7689 2144 33214 29019 13232"],["2326","21561 30856 32103 1722 22649"],["2330","30493 24343 16758 12170 30417"],["2338","3694 5732 1548 385 35626"],["2341","4231 11831 35231 36231 34632"],["2345","3609 16684 11904 2869 3392"],["2346","12587 16825 5947 31512 34838"],["2347","4064 23267 27930 15194 14605"],["2351","17851 1710 5512 9740 33758"],["2352","23336 16803 33215 16687 34602"],["2357","14372 14435 3243 29843 37046"],["2360","6027 917 28152 26509 8810"],["2361","18200 33266 15973 23951 30493"],["2366","3694 5732 1548 385 35626"],["2368","4632 33634 34875 24092 3904"],["2369","30234 36238 16278 30555 2157"],["2374","16451 2041 23949 1233 36868"],["2379","34238 16839 5457 10465 35470"],["2388","7480 25844 25830 7272 25136"],["2394","20454 2255 8455 25455 31656"],["2397","35401 18337 9939 29544 3376"],["2398","9233 2049 1233 36868 17872"],["2399","10573 10067 25988 32692 10123"],["2403","34238 16839 5457 10465 35470"],["2404","10461 8847 35052 36315 17160"],["2407","18348 6988 7343 33090 4311"],["2409","36162 17524 11570 25920 22976"],["2410","6334 25908 32311 22734 18946"],["2414","8245 27901 10936 3783 24987"],["2421","17149 23595 1464 15741 5546"],["2426","17893 27083 8912 34975 21412"],["2428","8833 16835 13838 14439 5646"],["2435","20959 28831 27435 2243 26844"],["2442","3584 30234 36238 16278 30555"],["2448","14526 10147 8833 16835 13838"],["2449","25458 30494 11417 1696 35703"],["2452","16421 13041 10490 4120 367"],["2455","12594 19865 37072 26744 33215"],["2466","8833 16835 13838 14439 5646"],["2467","20454 2255 8455 25455 31656"],["2472","30493 24343 16758 12170 30417"],["2474","30141 4574 15585 25832 32034"],["2480","5578 33215 17641 33048 34358"],["2489","5841 8245 24054 18678 11296"],["2496","33838 3069 10708 16743 13833"],["2500","8833 16835 13838 14439 5646"],["2502","12261 34089 34238 16839 5457"],["2504","21434 2238 8245 19049 31651"],["2506","12281 12533 8948 29560 16180"],["2508","18480 35091 30317 15534 17834"],["2512","10466 24143 31360 14174 14920"],["2519","18547 21434 2238 19049 31651"],["2520","25920 25908 32311 22734 18946"],["2521","31526 31141 2270 20477 29308"],["2524","20737 25939 13502 26529 6210"],["2528","35046 25134 17778 2406 8648"],["2543","23468 25978 31952 26247 12850"],["2547","24547 19907 18351 15994 33215"],["2549","18104 29642 17834 26077 26513"],["2551","8398 27083 8912 34975 12031"],["2557","17866 22888 27719 7943 30234"],["2560","10067 25988 18351 15994 24243"],["2561","17383 18200 29355 31556 26605"],["2564","34901 36513 15616 10645 35972"],["2569","7250 2882 6365 13403 4685"],["2570","10460 1882 11487 10903 36530"],["2571","3570 20454 2255 8455 25455"],["2581","19683 30234 36238 16278 7716"],["2582","29046 21495 31341 1397 26621"],["2585","34838 34240 8106 30707 29913"],["2591","22649 26399 6220 538 23341"],["2595","28817 27952 26761 28658 24883"],["2597","30234 36238 16278 30555 2157"],["2599","6446 8496 17555 8578 34835"],["2602","5433 24863 17687 36646 11054"],["2603","8146 23949 20955 13041 10490"],["2604","29047 8833 16835 13838 14439"],["2610","34238 16839 5457 10465 35470"],["2617","22210 21127 29556 18810 8833"],["2621","14464 4410 1141 5951 14059"],["2623","28727 32560 19895 4201 4231"],["2624","33498 34238 16839 5457 10465"],["2629","13844 2653 20917 12175 9590"],["2631","17372 31086 2502 4529 23972"],["2633","29037 4644 1452 5453 22655"],["2638","233 3450 30234 36238 16278"],["2644","24178 24325 22169 17834 26077"],["2645","14435 3243 29843 37046 22248"],["2647","13041 10490 4120 367 1174"],["2648","29640 4850 19462 29875 36076"],["2651","8833 16835 13838 14439 5646"],["2654","9233 9928 33173 1518 25421"],["2655","31106 21434 2238 19049 31651"],["2658","18351 15994 18306 15127 31046"],["2661","29037 4644 1452 5453 22655"],["2662","26247 12850 13053 17859 31266"],["2667","30293 33838 23640 35255 2868"],["2674","25050 29640 4850 19462 29875"],["2675","2068 31136 2657 18678 11296"],["2680","6494 18351 15994 33555 14800"],["2686","6641 37066 30008 14634 15687"],["2690","25050 36646 11054 7474 32680"],["2696","32019 18633 5578 29046 37065"],["2697","23336 16803 33215 25413 18678"],["2699","13020 29640 4850 19462 29875"],["2701","23336 8216 20941 15973 16803"],["2709","30722 11927 14632 19854 18867"],["2712","7467 32105 35344 29790 36233"],["2713","25832 32034 30635 10840 21240"],["2716","8245 27901 10936 3783 24987"],["2718","8833 16835 13838 14439 5646"],["2721","25050 15625 36646 26247 12850"],["2728","12261 34089 34238 16839 5457"],["2729","5866 21796 15236 24070 4739"],["2734","4431 832 4032 9432 18633"],["2737","15188 28539 5588 1233 36868"],["2743","9059 5939 14958 32914 15845"],["2751","34595 28831 27435 2243 26844"],["2762","29046 37065 21495 31341 26621"],["2764","35738 12362 4431 832 4032"],["2772","12102 24853 2754 35486 8833"],["2775","28246 29458 23106 16313 26722"],["2776","29046 31341 37065 21495 2561"],["2782","30234 36238 16278 30555 2157"],["2784","36646 11054 7474 18678 32680"],["2785","1873 5951 16367 23267 27930"],["2795","27753 17011 18063 10278 13220"],["2800","21884 34685 12028 17082 37132"],["2801","29046 26621 4475 37065 21495"],["2808","12102 21412 27083 8912 34975"],["2812","34940 36372 7332 27938 14740"],["2813","16451 9233 14063 4966 2041"],["2816","17248 35849 3054 23454 32264"],["2823","32674 8759 22104 18116 25920"],["2829","15593 32067 30234 36238 16278"],["2830","31484 8376 21388 17645 876"],["2832","36382 8833 16835 13838 14439"],["2835","13844 2653 20917 12175 9590"],["2837","34238 16839 5457 10465 35470"],["2839","18351 15994 29364 31830 35885"],["2843","19127 22976 20233 12667 15501"],["2845","17834 26077 26513 10126 10727"],["2850","14372 30234 36238 16278 30555"],["2860","27867 4431 832 4032 9432"],["2862","7480 25844 25830 35378 199"],["2865","28866 32627 17834 26077 26513"],["2867","32692 10123 11806 1286 31091"],["2869","14435 3243 29843 37046 22248"],["2875","19523 19427 34565 30234 36238"],["2877","8847 35052 36315 17160 14033"],["2880","24699 6321 7166 7689 2144"],["2883","5045 19917 25752 20594 35046"],["2884","31484 8376 21388 5905 24653"],["2886","14435 3243 29843 37046 22248"],["2888","14063 4966 26046 16503 11131"],["2895","32710 14564 14063 4966 17834"],["2903","32019 25939 35065 14988 7250"],["2904","17067 28200 26005 14435 3243"],["2908","29413 8833 16835 13838 14439"],["2909","2712 30622 1518 24143 31360"],["2914","14063 4966 23910 17352 818"],["2917","19800 14435 3243 29843 37046"],["2921","4037 36748 2454 6862 22265"],["2926","19144 14435 3243 29843 37046"],["2933","13284 24143 31360 6473 10562"],["2935","10460 1882 11487 10903 36530"],["2951","15743 33475 17383 17648 1448"],["2957","11258 13538 15291 26844 21970"],["2964","963 2496 19391 20859 29241"],["2967","6641 37066 30008 14634 15687"],["2968","5045 19917 25752 20594 17888"],["2978","24354 32077 5321 33120 36674"],["2985","36833 4455 9283 4894 31163"],["2990","21053 29258 20466 2879 20295"],["2993","17834 26077 26513 10126 10727"],["2996","18351 15994 28831 27435 2243"],["2997","28831 27435 2243 26844 20047"],["2998","30839 36663 5508 11727 23580"],["3001","30722 11927 14632 19854 18867"],["3003","33215 27477 17641 33048 34358"],["3014","13041 10490 4120 367 1174"],["3017","6721 33391 15593 17095 32641"],["3019","28831 27435 2243 26844 20047"],["3020","8146 18200 19127 22976 18873"],["3023","15743 17648 1448 32019 20083"],["3028","13833 18948 21614 11836 33838"],["3032","20596 21053 29258 20466 2879"],["3041","21746 31260 32793 14435 3243"],["3043","17782 164 3180 21434 2238"],["3050","32341 26416 34238 16839 5457"],["3056","23833 4431 26432 832 4032"],["3057","20454 2255 8455 25455 31656"],["3059","20233 12667 15501 24559 21408"],["3064","36162 17524 16452 3273 4885"],["3065","18411 17979 25473 24126 27554"],["3066","33561 4348 4431 832 4032"],["3069","4431 832 4032 9432 18633"],["3071","31484 8376 21388 20673 8001"],["3072","27544 18718 1885 14435 3243"],["3073","1518 17834 26077 26513 10126"],["3074","1076 15743 1448 32019 20083"],["3077","28289 28127 20922 35564 20801"],["3082","29413 7167 34838 34240 33904"],["3091","34414 8173 24220 11059 23241"],["3093","4475 33215 17641 33048 34358"],["3095","10723 13861 26247 12850 13053"],["3098","10067 25988 15452 2068 24243"],["3101","9933 17475 9893 8784 23859"],["3104","15973 8216 33266 33215 11752"],["3105","31484 8376 21388 2522 24653"],["3106","21053 29258 20466 2879 20295"],["3107","3007 14055 19880 22355 4405"],["3108","17866 22888 27719 7943 26312"],["3113","20237 462 19663 34275 2280"],["3118","35046 25134 17778 2406 8877"],["3123","12261 31037 11868 28761 14464"],["3127","11868 26147 28761 12261 12683"],["3133","31484 8376 21388 24653 3494"],["3137","31484 8376 21388 24653 3494"],["3157","4632 33634 34875 3904 28306"],["3163","7584 27790 1464 15741 5546"],["3165","5884 28473 35100 27736 29383"],["3166","21561 30856 32103 1722 20495"],["3167","30856 32103 1722 6092 31055"],["3168","17433 18861 33266 20941 15973"],["3173","18351 15994 16891 35513 31046"],["3180","36846 8847 17451 35052 35879"],["3188","9535 14372 36109 20233 12667"],["3189","7923 418 5834 7250 2882"],["3190","3694 5732 1548 385 35626"],["3191","4231 11831 35231 36231 34632"],["3192","19523 19427 29623 26247 12850"],["3195","3694 5732 1548 385 35626"],["3198","32692 10123 11806 35473 17851"],["3201","25473 24126 27554 2786 25952"],["3202","22649 26399 6220 4632 33634"],["3203","36646 11054 7474 32680 9109"],["3206","9233 9928 33173 30428 2911"],["3212","7689 2144 33214 29019 13232"],["3214","3392 30234 36238 16278 30555"],["3216","29640 4850 19462 29875 36076"],["3218","15743 7230 11758 17648 17529"],["3221","33215 27352 17641 33048 34358"],["3227","8216 20941 15973 21037 33215"],["3229","34238 16839 5457 10465 35470"],["3240","538 23341 13763 1402 14807"],["3243","3694 5732 1548 385 35626"],["3244","14435 3243 29843 37046 22248"],["3248","1076 15743 1448 32019 14246"],["3249","5296 34238 16839 5457 10465"],["3250","26462 9922 34509 20937 4215"],["3253","7716 4431 832 4032 9432"],["3256","26447 32672 31090 18516 19929"],["3260","8647 14435 3243 29843 37046"],["3265","8565 25908 32311 22734 18946"],["3273","22654 7063 1478 4964 14383"],["3279","30360 27761 28831 27435 2243"],["3281","11210 603 30234 36238 16278"],["3287","10160 18383 26868 11486 34924"],["3294","12091 29824 2143 12841 32791"],["3296","33407 26070 29935 32988 33788"],["3298","19523 19427 29623 26247 12850"],["3302","17925 26447 32672 31090 18516"],["3304","20828 16452 3273 4885 23938"],["3309","21884 34685 12028 3077 21505"],["3319","7689 2144 33214 29019 4038"],["3320","34238 16839 5457 10465 35470"],["3324","34136 16920 18176 14013 8032"],["3325","1233 14264 36868 17872 19873"],["3326","9233 2049 1233 36868 17872"],["3328","25908 32311 22734 18946 26549"],["3330","17207 34238 16839 5457 10465"],["3332","17925 4231 11831 35231 36231"],["3336","6494 18351 15994 33555 14800"],["3350","17756 17011 10016 4833 32827"],["3351","10672 34924 24760 14793 17131"],["3354","31616 14777 36192 23581 33215"],["3358","5619 8245 27901 10936 3783"],["3360","31484 8376 21388 13041 10490"],["3361","18301 8032 33437 20345 33384"],["3364","23081 10410 33475 17383 6871"],["3374","21036 26447 32672 31090 18516"],["3376","3694 5732 1548 385 35626"],["3378","33904 1118 31320 26126 15552"],["3379","17207 19907 33215 34762 10059"],["3387","36646 11054 7474 32680 9109"],["3392","34238 16839 5457 10465 35470"],["3396","30234 36238 16278 30555 2157"],["3402","20083 33387 11047 10067 3694"],["3407","33475 17383 3694 5732 1548"],["3411","5508 11727 25187 24488 21299"],["3413","8877 26407 36811 30071 6769"],["3418","14533 23788 21561 20047 30856"],["3421","33904 1118 31320 26126 15552"],["3422","29219 17782 7086 26741 6641"],["3424","30722 11927 14632 19854 18867"],["3434","33215 1233 36868 17872 19873"],["3435","30764 5508 11727 25187 31646"],["3438","2675 23081 9576 10410 1060"],["3439","32692 10123 11806 258 472"],["3452","35046 25134 17778 2406 31484"],["3455","21412 7250 2882 6365 13403"],["3459","35378 199 30267 28150 9556"],["3461","17463 31484 8376 21388 4381"],["3464","34238 16839 5457 10465 35470"],["3468","25936 35158 1464 15741 5546"],["3469","31961 17248 35849 3054 23454"],["3474","1448 17648 1076 15743 20083"],["3475","18351 15994 31046 7653 34853"],["3482","27477 32692 10123 11806 29650"],["3487","35046 25134 17778 2406 32336"],["3488","15814 17735 34238 16839 5457"],["3492","29570 7467 32105 9121 35344"],["3496","10120 30234 36238 16278 30555"],["3505","20233 12667 15501 24559 21408"],["3511","2590 23241 65 20525 15761"],["3513","31484 8376 21388 14435 3243"],["3518","23949 20955 1518 17834 26077"],["3523","15072 4431 832 4032 9432"],["3525","14435 3243 29843 37046 22248"],["3528","2041 23949 35454 31542 30785"],["3532","7250 2882 6365 13403 20454"],["3540","13041 10490 4120 367 1174"],["3543","23949 28966 33475 17383 20955"],["3548","14583 12963 25832 32034 30635"],["3550","27083 8912 34975 36235 25529"],["3552","20454 2255 8455 25455 31656"],["3558","6041 15243 29420 3897 927"],["3560","4228 11758 16871 29037 4644"],["3561","20941 8216 18741 5578 33266"],["3563","6666 13594 35692 20300 12308"],["3564","12587 25389 31512 31889 9119"],["3565","16333 30964 26247 12850 13053"],["3572","25925 17512 25832 32034 30635"],["3581","3694 5732 1548 385 35626"],["3582","1677 10755 16782 23267 27930"],["3583","21802 35440 29847 27258 30503"],["3587","17149 23595 1464 15741 5546"],["3591","34238 16839 5457 10465 35470"],["3592","12530 19977 29408 36051 31311"],["3596","23738 11531 5866 21796 3437"],["3602","5834 35486 18240 17833 18511"],["3604","33215 2442 5644 19452 21081"]],"arguments":{},"addedWidgets":{},"removedWidgets":[],"schema":[{"name":"userId","type":"\"string\""},{"name":"RecommendedItemIds","type":"\"string\""}],"overflow":true,"aggData":[],"aggSchema":[],"aggOverflow":false,"aggSeriesLimitReached":false,"aggError":"","aggType":"","plotOptions":null,"isJsonSchema":true,"dbfsResultPath":"dbfs:/databricks-results/2502345787138477/part-00000","datasetInfos":[],"columnCustomDisplayInfos":{}},"errorSummary":null,"error":null,"workflows":[],"startTime":1495294693362,"submitTime":1495294693347,"finishTime":1495294695111,"collapsed":false,"bindings":{},"inputWidgets":{},"displayType":"table","width":"auto","height":"auto","xColumns":null,"yColumns":null,"pivotColumns":null,"pivotAggregation":null,"customPlotOptions":{},"commentThread":[],"commentsVisible":false,"parentHierarchy":[],"diffInserts":[],"diffDeletes":[],"globalVars":{},"latestUser":"amarildolikmeta@gmail.com","latestUserId":null,"commandTitle":"","showCommandTitle":false,"hideCommandCode":false,"hideCommandResult":false,"iPythonMetadata":null,"streamStates":{},"datasetPreviewNameToCmdIdMap":{},"nuid":"a388841d-0be6-483d-a36a-465ac7035d7d"},{"version":"CommandV1","origId":2502345787138478,"guid":"7c658125-ebca-4818-a8b7-80497ea1e8d4","subtype":"command","commandType":"auto","position":41.0,"command":"","commandVersion":0,"state":"finished","results":null,"errorSummary":null,"error":null,"workflows":[],"startTime":0,"submitTime":0,"finishTime":0,"collapsed":false,"bindings":{},"inputWidgets":{},"displayType":"table","width":"auto","height":"auto","xColumns":null,"yColumns":null,"pivotColumns":null,"pivotAggregation":null,"customPlotOptions":{},"commentThread":[],"commentsVisible":false,"parentHierarchy":[],"diffInserts":[],"diffDeletes":[],"globalVars":{},"latestUser":"","latestUserId":null,"commandTitle":"","showCommandTitle":false,"hideCommandCode":false,"hideCommandResult":false,"iPythonMetadata":null,"streamStates":{},"datasetPreviewNameToCmdIdMap":{},"nuid":"33a93dc9-ae99-4537-bd72-1764115d3692"},{"version":"CommandV1","origId":2502345787138479,"guid":"b35ed7b4-a80f-489d-9d90-505a48ccfb91","subtype":"command","commandType":"auto","position":39.5,"command":"","commandVersion":0,"state":"finished","results":null,"errorSummary":"<span class=\"ansired\">TypeError</span>: cannot concatenate &apos;str&apos; and &apos;int&apos; objects","error":null,"workflows":[],"startTime":0,"submitTime":1495116949509,"finishTime":0,"collapsed":false,"bindings":{},"inputWidgets":{},"displayType":"table","width":"auto","height":"auto","xColumns":null,"yColumns":null,"pivotColumns":null,"pivotAggregation":null,"customPlotOptions":{},"commentThread":[],"commentsVisible":false,"parentHierarchy":[],"diffInserts":[],"diffDeletes":[],"globalVars":{},"latestUser":"amarildolikmeta@gmail.com","latestUserId":null,"commandTitle":"","showCommandTitle":false,"hideCommandCode":false,"hideCommandResult":false,"iPythonMetadata":null,"streamStates":{},"datasetPreviewNameToCmdIdMap":{},"nuid":"ecca263c-61f3-4426-8a37-21b7a86a5297"},{"version":"CommandV1","origId":2502345787138480,"guid":"0638ea57-804b-498b-8f89-036e9cd26a7f","subtype":"command","commandType":"auto","position":39.25,"command":"print len(users)","commandVersion":0,"state":"finished","results":{"type":"html","data":"<div class=\"ansiout\">4196\n</div>","arguments":{},"addedWidgets":{},"removedWidgets":[],"datasetInfos":[]},"errorSummary":null,"error":null,"workflows":[],"startTime":1495294679844,"submitTime":1495294679841,"finishTime":1495294679915,"collapsed":false,"bindings":{},"inputWidgets":{},"displayType":"table","width":"auto","height":"auto","xColumns":null,"yColumns":null,"pivotColumns":null,"pivotAggregation":null,"customPlotOptions":{},"commentThread":[],"commentsVisible":false,"parentHierarchy":[],"diffInserts":[],"diffDeletes":[],"globalVars":{},"latestUser":"amarildolikmeta@gmail.com","latestUserId":null,"commandTitle":"","showCommandTitle":false,"hideCommandCode":false,"hideCommandResult":false,"iPythonMetadata":null,"streamStates":{},"datasetPreviewNameToCmdIdMap":{},"nuid":"81666953-01ea-4b78-aaa6-e0f6e679ebc2"},{"version":"CommandV1","origId":2502345787138481,"guid":"3dfd4ab3-59ae-4acf-9f81-51a2fdc1f967","subtype":"command","commandType":"auto","position":36.5,"command":"activeUsers=sqlContext.sql(\"Select userId , count(rating) as numRatings from train group by userId having numRatings>200\")\nactiveUsers.count()","commandVersion":0,"state":"finished","results":{"type":"html","data":"<div class=\"ansiout\"><span class=\"ansired\">Out[</span><span class=\"ansired\">45</span><span class=\"ansired\">]: </span>97\n</div>","arguments":{},"addedWidgets":{},"removedWidgets":[],"datasetInfos":[]},"errorSummary":"<span class=\"ansired\">AnalysisException</span>: u&quot;expression &apos;userId&apos; is neither present in the group by, nor is it an aggregate function. Add to group by or wrap in first() (or first_value) if you don&apos;t care which value you get.;&quot;","error":"<div class=\"ansiout\"><span class=\"ansired\">---------------------------------------------------------------------------</span>\n<span class=\"ansired\">AnalysisException</span>                         Traceback (most recent call last)\n<span class=\"ansigreen\">&lt;ipython-input-72-b57693cddd3b&gt;</span> in <span class=\"ansicyan\">&lt;module&gt;</span><span class=\"ansiblue\">()</span>\n<span class=\"ansigreen\">----&gt; 1</span><span class=\"ansiyellow\"> </span>activeUsers<span class=\"ansiyellow\">=</span>sqlContext<span class=\"ansiyellow\">.</span>sql<span class=\"ansiyellow\">(</span><span class=\"ansiblue\">&quot;Select userId , count(rating) as numRatings from train having numRatings&gt;50&quot;</span><span class=\"ansiyellow\">)</span><span class=\"ansiyellow\"></span>\n<span class=\"ansigreen\">      2</span> activeUsers<span class=\"ansiyellow\">.</span>count<span class=\"ansiyellow\">(</span><span class=\"ansiyellow\">)</span><span class=\"ansiyellow\"></span>\n\n<span class=\"ansigreen\">/databricks/spark/python/pyspark/sql/context.py</span> in <span class=\"ansicyan\">sql</span><span class=\"ansiblue\">(self, sqlQuery)</span>\n<span class=\"ansigreen\">    578</span>         <span class=\"ansiyellow\">[</span>Row<span class=\"ansiyellow\">(</span>f1<span class=\"ansiyellow\">=</span><span class=\"ansicyan\">1</span><span class=\"ansiyellow\">,</span> f2<span class=\"ansiyellow\">=</span><span class=\"ansiblue\">u&apos;row1&apos;</span><span class=\"ansiyellow\">)</span><span class=\"ansiyellow\">,</span> Row<span class=\"ansiyellow\">(</span>f1<span class=\"ansiyellow\">=</span><span class=\"ansicyan\">2</span><span class=\"ansiyellow\">,</span> f2<span class=\"ansiyellow\">=</span><span class=\"ansiblue\">u&apos;row2&apos;</span><span class=\"ansiyellow\">)</span><span class=\"ansiyellow\">,</span> Row<span class=\"ansiyellow\">(</span>f1<span class=\"ansiyellow\">=</span><span class=\"ansicyan\">3</span><span class=\"ansiyellow\">,</span> f2<span class=\"ansiyellow\">=</span><span class=\"ansiblue\">u&apos;row3&apos;</span><span class=\"ansiyellow\">)</span><span class=\"ansiyellow\">]</span><span class=\"ansiyellow\"></span>\n<span class=\"ansigreen\">    579</span>         &quot;&quot;&quot;\n<span class=\"ansigreen\">--&gt; 580</span><span class=\"ansiyellow\">         </span><span class=\"ansigreen\">return</span> DataFrame<span class=\"ansiyellow\">(</span>self<span class=\"ansiyellow\">.</span>_ssql_ctx<span class=\"ansiyellow\">.</span>sql<span class=\"ansiyellow\">(</span>sqlQuery<span class=\"ansiyellow\">)</span><span class=\"ansiyellow\">,</span> self<span class=\"ansiyellow\">)</span><span class=\"ansiyellow\"></span>\n<span class=\"ansigreen\">    581</span> <span class=\"ansiyellow\"></span>\n<span class=\"ansigreen\">    582</span>     <span class=\"ansiyellow\">@</span>since<span class=\"ansiyellow\">(</span><span class=\"ansicyan\">1.0</span><span class=\"ansiyellow\">)</span><span class=\"ansiyellow\"></span>\n\n<span class=\"ansigreen\">/databricks/spark/python/lib/py4j-0.9-src.zip/py4j/java_gateway.py</span> in <span class=\"ansicyan\">__call__</span><span class=\"ansiblue\">(self, *args)</span>\n<span class=\"ansigreen\">    811</span>         answer <span class=\"ansiyellow\">=</span> self<span class=\"ansiyellow\">.</span>gateway_client<span class=\"ansiyellow\">.</span>send_command<span class=\"ansiyellow\">(</span>command<span class=\"ansiyellow\">)</span><span class=\"ansiyellow\"></span>\n<span class=\"ansigreen\">    812</span>         return_value = get_return_value(\n<span class=\"ansigreen\">--&gt; 813</span><span class=\"ansiyellow\">             answer, self.gateway_client, self.target_id, self.name)\n</span><span class=\"ansigreen\">    814</span> <span class=\"ansiyellow\"></span>\n<span class=\"ansigreen\">    815</span>         <span class=\"ansigreen\">for</span> temp_arg <span class=\"ansigreen\">in</span> temp_args<span class=\"ansiyellow\">:</span><span class=\"ansiyellow\"></span>\n\n<span class=\"ansigreen\">/databricks/spark/python/pyspark/sql/utils.py</span> in <span class=\"ansicyan\">deco</span><span class=\"ansiblue\">(*a, **kw)</span>\n<span class=\"ansigreen\">     49</span>                                              e.java_exception.getStackTrace()))\n<span class=\"ansigreen\">     50</span>             <span class=\"ansigreen\">if</span> s<span class=\"ansiyellow\">.</span>startswith<span class=\"ansiyellow\">(</span><span class=\"ansiblue\">&apos;org.apache.spark.sql.AnalysisException: &apos;</span><span class=\"ansiyellow\">)</span><span class=\"ansiyellow\">:</span><span class=\"ansiyellow\"></span>\n<span class=\"ansigreen\">---&gt; 51</span><span class=\"ansiyellow\">                 </span><span class=\"ansigreen\">raise</span> AnalysisException<span class=\"ansiyellow\">(</span>s<span class=\"ansiyellow\">.</span>split<span class=\"ansiyellow\">(</span><span class=\"ansiblue\">&apos;: &apos;</span><span class=\"ansiyellow\">,</span> <span class=\"ansicyan\">1</span><span class=\"ansiyellow\">)</span><span class=\"ansiyellow\">[</span><span class=\"ansicyan\">1</span><span class=\"ansiyellow\">]</span><span class=\"ansiyellow\">,</span> stackTrace<span class=\"ansiyellow\">)</span><span class=\"ansiyellow\"></span>\n<span class=\"ansigreen\">     52</span>             <span class=\"ansigreen\">if</span> s<span class=\"ansiyellow\">.</span>startswith<span class=\"ansiyellow\">(</span><span class=\"ansiblue\">&apos;java.lang.IllegalArgumentException: &apos;</span><span class=\"ansiyellow\">)</span><span class=\"ansiyellow\">:</span><span class=\"ansiyellow\"></span>\n<span class=\"ansigreen\">     53</span>                 <span class=\"ansigreen\">raise</span> IllegalArgumentException<span class=\"ansiyellow\">(</span>s<span class=\"ansiyellow\">.</span>split<span class=\"ansiyellow\">(</span><span class=\"ansiblue\">&apos;: &apos;</span><span class=\"ansiyellow\">,</span> <span class=\"ansicyan\">1</span><span class=\"ansiyellow\">)</span><span class=\"ansiyellow\">[</span><span class=\"ansicyan\">1</span><span class=\"ansiyellow\">]</span><span class=\"ansiyellow\">,</span> stackTrace<span class=\"ansiyellow\">)</span><span class=\"ansiyellow\"></span>\n\n<span class=\"ansired\">AnalysisException</span>: u&quot;expression &apos;userId&apos; is neither present in the group by, nor is it an aggregate function. Add to group by or wrap in first() (or first_value) if you don&apos;t care which value you get.;&quot;\n</div>","workflows":[],"startTime":1495266962683,"submitTime":1495266854253,"finishTime":1495266965001,"collapsed":false,"bindings":{},"inputWidgets":{},"displayType":"table","width":"auto","height":"auto","xColumns":null,"yColumns":null,"pivotColumns":null,"pivotAggregation":null,"customPlotOptions":{},"commentThread":[],"commentsVisible":false,"parentHierarchy":[],"diffInserts":[],"diffDeletes":[],"globalVars":{},"latestUser":"amarildolikmeta@gmail.com","latestUserId":null,"commandTitle":"","showCommandTitle":false,"hideCommandCode":false,"hideCommandResult":false,"iPythonMetadata":null,"streamStates":{},"datasetPreviewNameToCmdIdMap":{},"nuid":"5823594b-11c2-41df-864b-67a45f1f9746"}],"dashboards":[],"guid":"4d5d2c25-abd6-4bb5-906c-2ffc4c29a573","globalVars":{},"iPythonMetadata":null,"inputWidgets":{}}